{"id": "indicator--648f3730-79a6-4c4b-a4c8-5fc232026810", "created_by_ref": "identity--ad50f24a-3ac1-491e-aff4-a76840e123db", "name": "kernel_modules_and_extensions", "pattern": "{\"query\": \" select usr.username, sht.command, sht.history_file from shell_history sht JOIN users usr ON sht.uid = usr.uid WHERE sht.uid IN (SELECT uid from users) AND (sht.command LIKE '%modprobe%' OR sht.command LIKE '%insmod%' OR sht.command  LIKE '%lsmod%' OR sht.command  LIKE '%rmmod%' OR sht.command LIKE '%modinfo%' OR sht.command LIKE '%linux-headers-$%'OR sht.command LIKE '%kernel-devel-$%');\", \"interval\": 3600, \"description\": \"Detect loading, unloading, and manipulating modules on Linux systems - ATT&CK T1215\"}", "pattern_type": "osquery", "valid_from": "2020-04-02T12:13:47.89601Z", "indicator_types": ["malicious-activity"], "object_marking_refs": ["marking-definition--17e2aadf-7b8e-41fb-b70d-18b864b89a64"], "type": "indicator", "spec_version": "2.1", "created": "2020-04-02T10:13:47.896Z", "modified": "2020-04-02T10:13:47.896Z"}