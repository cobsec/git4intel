{"name": "Direct Autorun Keys Modification", "description": "Detects direct modification of autostart extensibility point (ASEP) in registry using reg.exe.", "created": "2019-10-25T00:00:00.000Z", "modified": "2019-11-10T00:00:00.000Z", "valid_from": "2019-10-25T00:00:00Z", "indicator_types": ["malicious-activity"], "pattern_type": "sigma", "pattern": "title: Direct Autorun Keys Modification\nid: 24357373-078f-44ed-9ac4-6d334a668a11\ndescription: Detects direct modification of autostart extensibility point (ASEP) in registry using reg.exe.\nstatus: experimental\nreferences:\n    - https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1060/T1060.yaml\ntags:\n    - attack.persistence\n    - attack.t1060\ndate: 2019/10/25\nmodified: 2019/11/10\nauthor: Victor Sergeev, Daniil Yugoslavskiy, oscd.community\nlogsource:\n    category: process_creation\n    product: windows\ndetection:\n    selection_1:\n        Image|endswith: '*\\reg.exe'\n        CommandLine|contains: 'add' # to avoid intersection with discovery tactic rules\n    selection_2:\n        CommandLine|contains:       # need to improve this list, there are plenty of ASEP reg keys\n            - '\\software\\Microsoft\\Windows\\CurrentVersion\\Run'\n            - '\\software\\Microsoft\\Windows\\CurrentVersion\\RunOnce'\n            - '\\software\\Microsoft\\Windows\\CurrentVersion\\RunOnceEx'\n            - '\\software\\Microsoft\\Windows\\CurrentVersion\\RunServices'\n            - '\\software\\Microsoft\\Windows\\CurrentVersion\\RunServicesOnce'\n            - '\\software\\Microsoft\\Windows NT\\CurrentVersion\\Winlogon\\Userinit'\n            - '\\software\\Microsoft\\Windows NT\\CurrentVersion\\Winlogon\\Shell'\n            - '\\software\\Microsoft\\Windows NT\\CurrentVersion\\Windows'\n            - '\\software\\Microsoft\\Windows\\CurrentVersion\\Explorer\\User Shell Folders'\n            - '\\system\\CurrentControlSet\\Control\\SafeBoot\\AlternateShell'\n    condition: selection_1 and selection_2\nfields:\n    - CommandLine\n    - ParentCommandLine\nfalsepositives:\n    - Legitimate software automatically (mostly, during installation) sets up autorun keys for legitimate reason\n    - Legitimate administrator sets up autorun keys for legitimate reason\nlevel: medium\n", "object_marking_refs": ["marking-definition--0a872d70-1d05-45dd-a25f-031af547a102"], "created_by_ref": "identity--082ca4f0-d825-45b6-aa42-ab9afd1e5503", "type": "indicator", "spec_version": "2.1", "id": "indicator--83b4fa31-44f0-4c03-bdad-33fb0a8d34df"}