{"name": "Suspicious PowerShell Keywords", "description": "Detects keywords that could indicate the use of some PowerShell exploitation framework", "created": "2019-02-11T00:00:00.000Z", "valid_from": "2019-02-11T00:00:00Z", "indicator_types": ["malicious-activity"], "pattern_type": "sigma", "pattern": "title: Suspicious PowerShell Keywords\nid: 1f49f2ab-26bc-48b3-96cc-dcffbc93eadf\nstatus: experimental\ndescription: Detects keywords that could indicate the use of some PowerShell exploitation framework\ndate: 2019/02/11\nauthor: Florian Roth, Perez Diego (@darkquassar)\nreferences:\n    - https://posts.specterops.io/entering-a-covenant-net-command-and-control-e11038bcf462\n    - https://github.com/PowerShellMafia/PowerSploit/blob/master/CodeExecution/Invoke-ReflectivePEInjection.ps1\n    - https://github.com/hlldz/Invoke-Phant0m/blob/master/Invoke-Phant0m.ps1\ntags:\n    - attack.execution\n    - attack.t1086\nlogsource:\n    product: windows\n    service: powershell\n    definition: 'It is recommended to use the new \"Script Block Logging\" of PowerShell v5 https://adsecurity.org/?p=2277. Monitor for EventID 4104'\ndetection:\n    keywords:\n        Message:\n            - \"System.Reflection.Assembly.Load\"\n            - \"[System.Reflection.Assembly]::Load\"\n            - \"[Reflection.Assembly]::Load\"\n            - \"System.Reflection.AssemblyName\"\n            - \"Reflection.Emit.AssemblyBuilderAccess\"\n            - \"Runtime.InteropServices.DllImportAttribute\"\n            - \"SuspendThread\"\n    condition: keywords\nfalsepositives:\n    - Penetration tests\nlevel: high\n", "object_marking_refs": ["marking-definition--0a872d70-1d05-45dd-a25f-031af547a102"], "created_by_ref": "identity--082ca4f0-d825-45b6-aa42-ab9afd1e5503", "type": "indicator", "spec_version": "2.1", "id": "indicator--b166b8ad-bfaa-41e8-9f5c-e4e9776e0418", "modified": "2020-04-02T10:14:32.746Z"}