{"name": "MSHTA Suspicious Execution 01", "description": "Detection for mshta.exe suspicious execution patterns sometimes involving file polyglotism", "created": "2019-02-22T00:00:00.000Z", "modified": "2019-02-22T00:00:00.000Z", "valid_from": "2019-02-22T00:00:00Z", "indicator_types": ["malicious-activity"], "pattern_type": "sigma", "pattern": "title: MSHTA Suspicious Execution 01\nid: cc7abbd0-762b-41e3-8a26-57ad50d2eea3\nstatus: experimental\ndescription: Detection for mshta.exe suspicious execution patterns sometimes involving file polyglotism\ndate: 2019/02/22\nmodified: 2019/02/22\nauthor: Diego Perez (@darkquassar), Markus Neis, Swisscom (Improve Rule)\nreferences:\n    - http://blog.sevagas.com/?Hacking-around-HTA-files\n    - https://0x00sec.org/t/clientside-exploitation-in-2018-how-pentesting-has-changed/7356\n    - https://docs.microsoft.com/en-us/dotnet/standard/data/xml/xslt-stylesheet-scripting-using-msxsl-script\n    - https://medium.com/tsscyber/pentesting-and-hta-bypassing-powershell-constrained-language-mode-53a42856c997\ntags:\n    - attack.defense_evasion\n    - attack.t1140\nlogsource:\n    category: process_creation\n    product: windows\nfalsepositives: \n    - False positives depend on scripts and administrative tools used in the monitored environment\nlevel: high\ndetection:\n    selection1:\n        Image: '*\\mshta.exe'\n        CommandLine: \n            - '*vbscript*' \n            - '*.jpg*'\n            - '*.png*'\n            - '*.lnk*'\n            # - '*.chm*'  # could be prone to false positives\n            - '*.xls*'\n            - '*.doc*'\n            - '*.zip*'\n    condition:\n        selection1 \n", "object_marking_refs": ["marking-definition--0a872d70-1d05-45dd-a25f-031af547a102"], "created_by_ref": "identity--082ca4f0-d825-45b6-aa42-ab9afd1e5503", "type": "indicator", "spec_version": "2.1", "id": "indicator--2548f815-b6af-4ae4-b263-a96b99691e49"}