{"name": "Regsvr32 Anomaly", "description": "Detects various anomalies in relation to regsvr32.exe", "created": "2019-01-16T00:00:00.000Z", "valid_from": "2019-01-16T00:00:00Z", "indicator_types": ["malicious-activity"], "pattern_type": "sigma", "pattern": "title: Regsvr32 Anomaly\nid: 8e2b24c9-4add-46a0-b4bb-0057b4e6187d\nstatus: experimental\ndescription: Detects various anomalies in relation to regsvr32.exe\nauthor: Florian Roth\ndate: 2019/01/16\nreferences:\n    - https://subt0x10.blogspot.de/2017/04/bypass-application-whitelisting-script.html\ntags:\n    - attack.t1117\n    - attack.defense_evasion\n    - attack.execution\n    - car.2019-04-002\n    - car.2019-04-003\nlogsource:\n    category: process_creation\n    product: windows\ndetection:\n    selection1:\n        Image: '*\\regsvr32.exe'\n        CommandLine: '*\\Temp\\\\*'\n    selection2:\n        Image: '*\\regsvr32.exe'\n        ParentImage: '*\\powershell.exe'\n    selection3:\n        Image: '*\\regsvr32.exe'\n        ParentImage: '*\\cmd.exe'\n    selection4:\n        Image: '*\\regsvr32.exe'\n        CommandLine:\n            - '*/i:http* scrobj.dll'\n            - '*/i:ftp* scrobj.dll'\n    selection5:\n        Image: '*\\wscript.exe'\n        ParentImage: '*\\regsvr32.exe'\n    selection6:\n        Image: '*\\EXCEL.EXE'\n        CommandLine: '*..\\..\\..\\Windows\\System32\\regsvr32.exe *'\n    condition: 1 of them\nfields:\n    - CommandLine\n    - ParentCommandLine\nfalsepositives:\n    - Unknown\nlevel: high\n", "object_marking_refs": ["marking-definition--0a872d70-1d05-45dd-a25f-031af547a102"], "created_by_ref": "identity--082ca4f0-d825-45b6-aa42-ab9afd1e5503", "type": "indicator", "spec_version": "2.1", "id": "indicator--e0063b9d-b848-417c-a911-05fb5cffd867", "modified": "2020-04-02T10:14:48.700Z"}