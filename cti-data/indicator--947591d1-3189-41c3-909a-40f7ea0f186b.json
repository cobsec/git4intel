{"name": "Hiding Files with Attrib.exe", "description": "Detects usage of attrib.exe to hide files from users.", "created": "2019-01-16T00:00:00.000Z", "valid_from": "2019-01-16T00:00:00Z", "indicator_types": ["malicious-activity"], "pattern_type": "sigma", "pattern": "title: Hiding Files with Attrib.exe\nid: 4281cb20-2994-4580-aa63-c8b86d019934\nstatus: experimental\ndescription: Detects usage of attrib.exe to hide files from users.\nauthor: Sami Ruohonen\ndate: 2019/01/16\nlogsource:\n    category: process_creation\n    product: windows\ndetection:\n    selection:\n        Image: '*\\attrib.exe'\n        CommandLine: '* +h *'\n    ini:\n        CommandLine: '*\\desktop.ini *'\n    intel:\n        ParentImage: '*\\cmd.exe'\n        CommandLine: +R +H +S +A \\\\*.cui\n        ParentCommandLine: C:\\WINDOWS\\system32\\\\*.bat\n    condition: selection and not (ini or intel)\nfields:\n    - CommandLine\n    - ParentCommandLine\n    - User\ntags:\n    - attack.defense_evasion\n    - attack.persistence\n    - attack.t1158\nfalsepositives:\n    - igfxCUIService.exe hiding *.cui files via .bat script (attrib.exe a child of cmd.exe and igfxCUIService.exe is the parent of the cmd.exe)\n    - msiexec.exe hiding desktop.ini\nlevel: low\n", "object_marking_refs": ["marking-definition--0a872d70-1d05-45dd-a25f-031af547a102"], "created_by_ref": "identity--082ca4f0-d825-45b6-aa42-ab9afd1e5503", "type": "indicator", "spec_version": "2.1", "id": "indicator--947591d1-3189-41c3-909a-40f7ea0f186b", "modified": "2020-04-02T10:14:41.191Z"}