{"name": "Suspicious Scripting in a WMI Consumer", "description": "Detects suspicious scripting in WMI Event Consumers", "created": "2019-04-15T00:00:00.000Z", "valid_from": "2019-04-15T00:00:00Z", "indicator_types": ["malicious-activity"], "pattern_type": "sigma", "pattern": "title: Suspicious Scripting in a WMI Consumer\nid: fe21810c-2a8c-478f-8dd3-5a287fb2a0e0\nstatus: experimental\ndescription: Detects suspicious scripting in WMI Event Consumers\nauthor: Florian Roth\nreferences:\n    - https://in.security/an-intro-into-abusing-and-identifying-wmi-event-subscriptions-for-persistence/\n    - https://github.com/Neo23x0/signature-base/blob/master/yara/gen_susp_lnk_files.yar#L19\ndate: 2019/04/15\ntags:\n    - attack.t1086\n    - attack.execution\nlogsource:\n   product: windows\n   service: sysmon\ndetection:\n    selection:\n        EventID: 20\n        Destination:\n            - '*new-object system.net.webclient).downloadstring(*'\n            - '*new-object system.net.webclient).downloadfile(*'\n            - '*new-object net.webclient).downloadstring(*'\n            - '*new-object net.webclient).downloadfile(*'\n            - '* iex(*'\n            - '*WScript.shell*'\n            - '* -nop *'\n            - '* -noprofile *'\n            - '* -decode *'\n            - '* -enc *'\n    condition: selection\nfields:\n    - CommandLine\n    - ParentCommandLine\nfalsepositives:\n    - Administrative scripts\nlevel: high\n", "object_marking_refs": ["marking-definition--0a872d70-1d05-45dd-a25f-031af547a102"], "created_by_ref": "identity--082ca4f0-d825-45b6-aa42-ab9afd1e5503", "type": "indicator", "spec_version": "2.1", "id": "indicator--998a4e6e-2952-48ce-94c0-d023d1310fba", "modified": "2020-04-02T10:14:59.124Z"}