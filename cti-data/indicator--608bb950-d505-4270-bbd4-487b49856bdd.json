{"name": "Possible Privilege Escalation via Weak Service Permissions", "description": "Detection of sc.exe utility spawning by user with Medium integrity level to change service ImagePath or FailureCommand", "created": "2019-10-26T00:00:00.000Z", "modified": "2019-11-11T00:00:00.000Z", "valid_from": "2019-10-26T00:00:00Z", "indicator_types": ["malicious-activity"], "pattern_type": "sigma", "pattern": "title: Possible Privilege Escalation via Weak Service Permissions\nid: d937b75f-a665-4480-88a5-2f20e9f9b22a\ndescription: Detection of sc.exe utility spawning by user with Medium integrity level to change service ImagePath or FailureCommand\nreferences:\n    - https://speakerdeck.com/heirhabarov/hunting-for-privilege-escalation-in-windows-environment\n    - https://pentestlab.blog/2017/03/30/weak-service-permissions/\ntags:\n    - attack.privilege_escalation\n    - attack.t1134\nstatus: experimental\nauthor: Teymur Kheirkhabarov\ndate: 2019/10/26\nmodified: 2019/11/11\nlogsource:\n    category: process_creation\n    product: windows\ndetection:\n    scbynonadmin:\n        Image|endswith: '\\sc.exe'\n        IntegrityLevel: 'Medium'\n    binpath:\n        CommandLine|contains|all:\n            - 'config'\n            - 'binPath'\n    failurecommand:\n        CommandLine|contains|all: \n            - 'failure'\n            - 'command'\n    condition: scbynonadmin and (binpath or failurecommand)\nfalsepositives:\n    - Unknown\nlevel: high\n", "object_marking_refs": ["marking-definition--0a872d70-1d05-45dd-a25f-031af547a102"], "created_by_ref": "identity--082ca4f0-d825-45b6-aa42-ab9afd1e5503", "type": "indicator", "spec_version": "2.1", "id": "indicator--608bb950-d505-4270-bbd4-487b49856bdd"}