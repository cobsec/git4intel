{"name": "Local Accounts Discovery", "description": "Local accounts, System Owner/User discovery using operating systems utilities", "created": "2019-10-21T00:00:00.000Z", "modified": "2019-11-04T00:00:00.000Z", "valid_from": "2019-10-21T00:00:00Z", "indicator_types": ["malicious-activity"], "pattern_type": "sigma", "pattern": "title: Local Accounts Discovery\nid: 502b42de-4306-40b4-9596-6f590c81f073\nstatus: experimental\ndescription: Local accounts, System Owner/User discovery using operating systems utilities\nauthor: Timur Zinniatullin, Daniil Yugoslavskiy, oscd.community\ndate: 2019/10/21\nmodified: 2019/11/04\nreferences:\n    - https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1033/T1033.yaml\nlogsource:\n    category: process_creation\n    product: windows\ndetection:\n    selection_1:\n      - Image|endswith: '\\whoami.exe'\n      - Image|endswith: '\\wmic.exe'\n        CommandLine|contains|all:\n            - 'useraccount'\n            - 'get'\n      - Image|endswith: \n            - '\\quser.exe'\n            - '\\qwinsta.exe'\n      - Image|endswith: '\\cmdkey.exe'\n        CommandLine|contains: '/list'\n      - Image|endswith: '\\cmd.exe'\n        CommandLine|contains|all: \n            - '/c'\n            - 'dir '\n            - '\\Users\\'\n    filter_1:\n        CommandLine|contains:\n            - ' rmdir '       # don't match on 'dir'   \"C:\\Windows\\System32\\cmd.exe\" /q /c rmdir /s /q \"C:\\Users\\XX\\AppData\\Local\\Microsoft\\OneDrive\\19.232.1124.0005\"\n    selection_2:\n        Image|endswith:\n            - '\\net.exe'\n            - '\\net1.exe'\n        CommandLine|contains: 'user'\n    filter_2:\n        CommandLine|contains:\n            - '/domain'       # local account discovery only\n            - '/add'          # discovery only\n            - '/delete'       # discovery only\n            - '/active'       # discovery only\n            - '/expires'      # discovery only\n            - '/passwordreq'  # discovery only\n            - '/scriptpath'   # discovery only\n            - '/times'        # discovery only\n            - '/workstations' # discovery only\n    condition: (selection_1 and not filter_1) or ( selection_2 and not filter_2)\nfields:\n    - Image\n    - CommandLine\n    - User\n    - LogonGuid\n    - Hashes\n    - ParentProcessGuid\n    - ParentCommandLine\nfalsepositives:\n     - Legitimate administrator or user enumerates local users for legitimate reason\nlevel: low\ntags:\n    - attack.discovery\n    - attack.t1033\n    - attack.t1087\n", "object_marking_refs": ["marking-definition--0a872d70-1d05-45dd-a25f-031af547a102"], "created_by_ref": "identity--082ca4f0-d825-45b6-aa42-ab9afd1e5503", "type": "indicator", "spec_version": "2.1", "id": "indicator--ed71ced1-e6d0-4056-aaa1-27acc32b2f88"}