{"name": "Malicious Nishang PowerShell Commandlets", "description": "Detects Commandlet names and arguments from the Nishang exploitation framework", "created": "2019-05-16T00:00:00.000Z", "valid_from": "2019-05-16T00:00:00Z", "indicator_types": ["malicious-activity"], "pattern_type": "sigma", "pattern": "title: Malicious Nishang PowerShell Commandlets\nid: f772cee9-b7c2-4cb2-8f07-49870adc02e0\nstatus: experimental\ndescription: Detects Commandlet names and arguments from the Nishang exploitation framework\ndate: 2019/05/16\nreferences:\n    - https://github.com/samratashok/nishang\ntags:\n    - attack.execution\n    - attack.t1086\nauthor: Alec Costello\nlogsource:\n    product: windows\n    service: powershell\n    definition: It is recommanded to use the new \"Script Block Logging\" of PowerShell v5 https://adsecurity.org/?p=2277\ndetection:\n    keywords:\n        - Add-ConstrainedDelegationBackdoor\n        - Set-DCShadowPermissions\n        - DNS_TXT_Pwnage\n        - Execute-OnTime\n        - HTTP-Backdoor\n        - Set-RemotePSRemoting\n        - Set-RemoteWMI\n        - Invoke-AmsiBypass\n        - Out-CHM\n        - Out-HTA\n        - Out-SCF\n        - Out-SCT\n        - Out-Shortcut\n        - Out-WebQuery\n        - Out-Word\n        - Enable-Duplication\n        - Remove-Update\n        - Download-Execute-PS\n        - Download_Execute\n        - Execute-Command-MSSQL\n        - Execute-DNSTXT-Code\n        - Out-RundllCommand\n        - Copy-VSS\n        - FireBuster\n        - FireListener\n        - Get-Information\n        - Get-PassHints\n        - Get-WLAN-Keys\n        - Get-Web-Credentials\n        - Invoke-CredentialsPhish\n        - Invoke-MimikatzWDigestDowngrade\n        - Invoke-SSIDExfil\n        - Invoke-SessionGopher\n        - Keylogger\n        - Invoke-Interceptor\n        - Create-MultipleSessions\n        - Invoke-NetworkRelay\n        - Run-EXEonRemote\n        - Invoke-Prasadhak\n        - Invoke-BruteForce\n        - Password-List\n        - Invoke-JSRatRegsvr\n        - Invoke-JSRatRundll\n        - Invoke-PoshRatHttps\n        - Invoke-PowerShellIcmp\n        - Invoke-PowerShellUdp\n        - Invoke-PSGcat\n        - Invoke-PsGcatAgent\n        - Remove-PoshRat\n        - Add-Persistance\n        - ExetoText\n        - Invoke-Decode\n        - Invoke-Encode\n        - Parse_Keys\n        - Remove-Persistence\n        - StringtoBase64\n        - TexttoExe\n        - Powerpreter\n        - Nishang\n        - EncodedData\n        - DataToEncode\n        - LoggedKeys\n        - OUT-DNSTXT\n        - Jitter\n        - ExfilOption\n        - Tamper\n        - DumpCerts\n        - DumpCreds\n        - Shellcode32\n        - Shellcode64\n        - NotAllNameSpaces\n        - exfill\n        - FakeDC\n        - Exploit\n    condition: keywords\nfalsepositives:\n    - Penetration testing\nlevel: high\n", "object_marking_refs": ["marking-definition--0a872d70-1d05-45dd-a25f-031af547a102"], "created_by_ref": "identity--082ca4f0-d825-45b6-aa42-ab9afd1e5503", "type": "indicator", "spec_version": "2.1", "id": "indicator--fa72bbbe-1c8f-46db-b7be-7c2f3826e23c", "modified": "2020-04-02T10:14:33.215Z"}