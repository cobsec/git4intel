{"name": "New DLL Added to AppCertDlls Registry Key", "description": "Dynamic-link libraries (DLLs) that are specified in the AppCertDLLs value in the Registry key can be abused to obtain persistence and privilege escalation by causing a malicious DLL to be loaded and run in the context of separate processes on the computer.", "created": "2019-10-25T00:00:00.000Z", "modified": "2019-11-13T00:00:00.000Z", "valid_from": "2019-10-25T00:00:00Z", "indicator_types": ["malicious-activity"], "pattern_type": "sigma", "pattern": "title: New DLL Added to AppCertDlls Registry Key\nid: 6aa1d992-5925-4e9f-a49b-845e51d1de01\nstatus: experimental\ndescription: Dynamic-link libraries (DLLs) that are specified in the AppCertDLLs value in the Registry key can be abused to obtain persistence and privilege escalation\n    by causing a malicious DLL to be loaded and run in the context of separate processes on the computer.\nreferences:\n    - http://www.hexacorn.com/blog/2013/01/19/beyond-good-ol-run-key-part-3/\n    - https://eqllib.readthedocs.io/en/latest/analytics/14f90406-10a0-4d36-a672-31cabe149f2f.html\ntags:\n    - attack.persistence\n    - attack.t1182\nauthor: Ilyas Ochkov, oscd.community\ndate: 2019/10/25\nmodified: 2019/11/13\nlogsource:\n    product: windows\n    service: sysmon\ndetection:\n    selection:\n      - EventID: \n            - 12  # key create\n            - 13  # value set\n        # Sysmon gives us HKLM\\SYSTEM\\CurrentControlSet\\.. if ControlSetXX is the selected one\n        TargetObject: 'HKLM\\SYSTEM\\CurrentControlSet\\Control\\Session Manager\\AppCertDlls'\n      - EventID: 14  # key rename\n        NewName: 'HKLM\\SYSTEM\\CurentControlSet\\Control\\Session Manager\\AppCertDlls'\n    condition: selection\nfields:\n    - EventID\n    - Image\n    - TargetObject\n    - NewName\nfalsepositives:\n    - Unkown\nlevel: medium\n", "object_marking_refs": ["marking-definition--0a872d70-1d05-45dd-a25f-031af547a102"], "created_by_ref": "identity--082ca4f0-d825-45b6-aa42-ab9afd1e5503", "type": "indicator", "spec_version": "2.1", "id": "indicator--779edef4-9222-46c2-a9b3-45f94978e5cd"}