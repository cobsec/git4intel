{"name": "Suspicious Remote Thread Created", "description": "Offensive tradecraft is switching away from using APIs like \"CreateRemoteThread\", however, this is still largely observed in the wild. This rule aims to detect suspicious processes (those we would not expect to behave in this way like word.exe or outlook.exe) creating remote threads on other processes. It is a generalistic rule, but it should have a low FP ratio due to the selected range of processes.", "created": "2019-10-27T00:00:00.000Z", "modified": "2019-11-13T00:00:00.000Z", "valid_from": "2019-10-27T00:00:00Z", "indicator_types": ["malicious-activity"], "pattern_type": "sigma", "pattern": "title: Suspicious Remote Thread Created\nid: 66d31e5f-52d6-40a4-9615-002d3789a119\ndescription: Offensive tradecraft is switching away from using APIs like \"CreateRemoteThread\", however, this is still largely observed in the wild. This rule aims\n    to detect suspicious processes (those we would not expect to behave in this way like word.exe or outlook.exe) creating remote threads on other processes. It is\n    a generalistic rule, but it should have a low FP ratio due to the selected range of processes.\nnotes:\n    - MonitoringHost.exe is a process that loads .NET CLR by default and thus a favorite for process injection for .NET in-memory offensive tools.\nstatus: experimental\ndate: 2019/10/27\nmodified: 2019/11/13\nauthor: Perez Diego (@darkquassar), oscd.community\nreferences:\n    - Personal research, statistical analysis\n    - https://lolbas-project.github.io\nlogsource:\n    product: windows\n    service: sysmon\ntags:\n    - attack.privilege_escalation\n    - attack.t1055\ndetection:\n    selection: \n        EventID: 8\n        SourceImage|endswith:\n            - '\\bash.exe'\n            - '\\cvtres.exe'\n            - '\\defrag.exe'\n            - '\\dnx.exe'\n            - '\\esentutl.exe'\n            - '\\excel.exe'\n            - '\\expand.exe'\n            - '\\explorer.exe'\n            - '\\find.exe'\n            - '\\findstr.exe'\n            - '\\forfiles.exe'\n            - '\\git.exe'\n            - '\\gpupdate.exe'\n            - '\\hh.exe'\n            - '\\iexplore.exe'\n            - '\\installutil.exe'\n            - '\\lync.exe'\n            - '\\makecab.exe'\n            - '\\mDNSResponder.exe'\n            - '\\monitoringhost.exe'\n            - '\\msbuild.exe'\n            - '\\mshta.exe'\n            - '\\msiexec.exe'\n            - '\\mspaint.exe'\n            - '\\outlook.exe'\n            - '\\ping.exe'\n            - '\\powerpnt.exe'\n            - '\\powershell.exe'\n            - '\\provtool.exe'\n            - '\\python.exe'\n            - '\\regsvr32.exe'\n            - '\\robocopy.exe'\n            - '\\runonce.exe'\n            - '\\sapcimc.exe'\n            - '\\schtasks.exe'\n            - '\\smartscreen.exe'\n            - '\\spoolsv.exe'\n            # - '\\taskhost.exe'  # disabled due to false positives\n            - '\\tstheme.exe'\n            - '\\userinit.exe'\n            - '\\vssadmin.exe'\n            - '\\vssvc.exe'\n            - '\\w3wp.exe*'       \n            - '\\winlogon.exe'\n            - '\\winscp.exe'\n            - '\\wmic.exe'\n            - '\\word.exe'\n            - '\\wscript.exe'\n    filter:\n        SourceImage|contains: 'Visual Studio'\n    condition: selection AND NOT filter\nfields:\n    - ComputerName\n    - User\n    - SourceImage\n    - TargetImage\nlevel: high\nfalsepositives:\n    - Unknown\n", "object_marking_refs": ["marking-definition--0a872d70-1d05-45dd-a25f-031af547a102"], "created_by_ref": "identity--082ca4f0-d825-45b6-aa42-ab9afd1e5503", "type": "indicator", "spec_version": "2.1", "id": "indicator--a30660e5-bbc4-4168-846c-045d3d1d7b88"}