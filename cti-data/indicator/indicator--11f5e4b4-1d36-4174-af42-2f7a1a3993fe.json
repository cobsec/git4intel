{"name": "CMSTP UAC Bypass via COM Object Access", "description": "Detects UAC Bypass Attempt Using Microsoft Connection Manager Profile Installer Autoelevate-capable COM Objects", "created": "2019-01-16T00:00:00.000Z", "modified": "2019-07-31T00:00:00.000Z", "valid_from": "2019-01-16T00:00:00Z", "indicator_types": ["malicious-activity"], "pattern_type": "sigma", "pattern": "title: CMSTP UAC Bypass via COM Object Access\nid: 4b60e6f2-bf39-47b4-b4ea-398e33cfe253\nstatus: stable\ndescription: Detects UAC Bypass Attempt Using Microsoft Connection Manager Profile Installer Autoelevate-capable COM Objects\ntags:\n    - attack.defense_evasion\n    - attack.privilege_escalation\n    - attack.execution\n    - attack.t1088\n    - attack.t1191\n    - attack.g0069\n    - car.2019-04-001\nauthor: Nik Seetharaman\nmodified: 2019/07/31\ndate: 2019/01/16\nreferences:\n    - http://www.endurant.io/cmstp/detecting-cmstp-enabled-code-execution-and-uac-bypass-with-sysmon/\n    - https://twitter.com/hFireF0X/status/897640081053364225\nlogsource:\n    category: process_creation\n    product: windows\ndetection:\n    selection1:\n        ParentCommandLine: '*\\DllHost.exe'\n    selection2:\n        ParentCommandLine:\n            - '*{3E5FC7F9-9A51-4367-9063-A120244FBEC7}'\n            - '*{3E000D72-A845-4CD9-BD83-80C07C3B881F}'\n    condition: selection1 and selection2\nfields:\n    - CommandLine\n    - ParentCommandLine\n    - Hashes\nfalsepositives:\n    - Legitimate CMSTP use (unlikely in modern enterprise environments)\nlevel: high\n", "object_marking_refs": ["marking-definition--0a872d70-1d05-45dd-a25f-031af547a102"], "created_by_ref": "identity--082ca4f0-d825-45b6-aa42-ab9afd1e5503", "type": "indicator", "spec_version": "2.1", "id": "indicator--11f5e4b4-1d36-4174-af42-2f7a1a3993fe"}