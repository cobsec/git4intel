{"name": "Clear Command History", "description": "Clear command history in linux which is used for defense evasion.", "created": "2019-03-24T00:00:00.000Z", "valid_from": "2019-03-24T00:00:00Z", "indicator_types": ["malicious-activity"], "pattern_type": "sigma", "pattern": "title: Clear Command History\nid: fdc88d25-96fb-4b7c-9633-c0e417fdbd4e\nstatus: experimental\ndescription: Clear command history in linux which is used for defense evasion.\nreferences:\n    - https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1146/T1146.yaml\n    - https://attack.mitre.org/techniques/T1146/\n    - https://www.hackers-arise.com/single-post/2016/06/20/Covering-your-BASH-Shell-Tracks-AntiForensics\nauthor: Patrick Bareiss\ndate: 2019/03/24\nlogsource:\n    product: linux\ndetection:\n    keywords:\n        - 'rm *bash_history'\n        - 'echo \"\" > *bash_history'\n        - 'cat /dev/null > *bash_history' \n        - 'ln -sf /dev/null *bash_history'\n        - 'truncate -s0 *bash_history'\n        # - 'unset HISTFILE'  # prone to false positives\n        - 'export HISTFILESIZE=0'\n        - 'history -c'\n        - 'history -w'\n        - 'shred *bash_history'\n    condition: keywords\nfalsepositives:\n    - Unknown\nlevel: high\ntags:\n    - attack.defense_evasion\n    - attack.t1146\n", "object_marking_refs": ["marking-definition--0a872d70-1d05-45dd-a25f-031af547a102"], "created_by_ref": "identity--082ca4f0-d825-45b6-aa42-ab9afd1e5503", "type": "indicator", "spec_version": "2.1", "id": "indicator--72bfc871-0ce1-476d-abf7-8d55da79d453", "modified": "2020-04-02T10:14:28.962Z"}