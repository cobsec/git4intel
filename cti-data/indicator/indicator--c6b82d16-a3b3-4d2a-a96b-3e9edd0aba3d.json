{"id": "indicator--c6b82d16-a3b3-4d2a-a96b-3e9edd0aba3d", "created_by_ref": "identity--ad50f24a-3ac1-491e-aff4-a76840e123db", "name": "linux_kernel_modules_and_extensions", "pattern": "{\"platform\": \"linux\", \"description\": \"ATT&CK: T1215\", \"queries\": {\"kernel_modules_and_extensions\": {\"query\": \" select usr.username, sht.command, sht.history_file from shell_history sht JOIN users usr ON sht.uid = usr.uid WHERE sht.uid IN (SELECT uid from users) AND (sht.command LIKE '%modprobe%' OR sht.command LIKE '%insmod%' OR sht.command  LIKE '%lsmod%' OR sht.command  LIKE '%rmmod%' OR sht.command LIKE '%modinfo%' OR sht.command LIKE '%linux-headers-$%'OR sht.command LIKE '%kernel-devel-$%');\", \"interval\": 3600, \"description\": \"Detect loading, unloading, and manipulating modules on Linux systems - ATT&CK T1215\"}}, \"name\": \"linux_kernel_modules_and_extensions\"}", "pattern_type": "osquery-pack", "valid_from": "2020-04-02T12:13:47.787821Z", "indicator_types": ["malicious-activity"], "object_marking_refs": ["marking-definition--17e2aadf-7b8e-41fb-b70d-18b864b89a64"], "type": "indicator", "spec_version": "2.1", "created": "2020-04-02T10:13:47.787Z", "modified": "2020-04-02T10:13:47.787Z"}