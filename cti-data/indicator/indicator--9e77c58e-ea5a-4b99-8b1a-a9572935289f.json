{"name": "Malicious PowerShell Commandlet Names", "description": "Detects the creation of known powershell scripts for exploitation", "created": "2018-04-07T00:00:00.000Z", "valid_from": "2018-04-07T00:00:00Z", "indicator_types": ["malicious-activity"], "pattern_type": "sigma", "pattern": "title: Malicious PowerShell Commandlet Names\nid: f331aa1f-8c53-4fc3-b083-cc159bc971cb\nstatus: experimental\ndescription: Detects the creation of known powershell scripts for exploitation\nreferences:\n    - https://raw.githubusercontent.com/Neo23x0/sigma/f35c50049fa896dff91ff545cb199319172701e8/rules/windows/powershell/powershell_malicious_commandlets.yml\ntags:\n    - attack.execution\n    - attack.t1086\nauthor: Markus Neis\ndate: 2018/04/07\nlogsource:\n    product: windows\n    service: sysmon\ndetection:\n    selection:\n        EventID: 11\n        TargetFilename:\n            - '*\\Invoke-DllInjection.ps1'   \n            - '*\\Invoke-WmiCommand.ps1'\n            - '*\\Get-GPPPassword.ps1'\n            - '*\\Get-Keystrokes.ps1'\n            - '*\\Get-VaultCredential.ps1'\n            - '*\\Invoke-CredentialInjection.ps1'\n            - '*\\Invoke-Mimikatz.ps1'\n            - '*\\Invoke-NinjaCopy.ps1'\n            - '*\\Invoke-TokenManipulation.ps1'\n            - '*\\Out-Minidump.ps1'\n            - '*\\VolumeShadowCopyTools.ps1'\n            - '*\\Invoke-ReflectivePEInjection.ps1'\n            - '*\\Get-TimedScreenshot.ps1'\n            - '*\\Invoke-UserHunter.ps1'\n            - '*\\Find-GPOLocation.ps1'\n            - '*\\Invoke-ACLScanner.ps1'\n            - '*\\Invoke-DowngradeAccount.ps1'\n            - '*\\Get-ServiceUnquoted.ps1'\n            - '*\\Get-ServiceFilePermission.ps1'\n            - '*\\Get-ServicePermission.ps1'\n            - '*\\Invoke-ServiceAbuse.ps1'\n            - '*\\Install-ServiceBinary.ps1'\n            - '*\\Get-RegAutoLogon.ps1'\n            - '*\\Get-VulnAutoRun.ps1'\n            - '*\\Get-VulnSchTask.ps1'\n            - '*\\Get-UnattendedInstallFile.ps1'\n            - '*\\Get-WebConfig.ps1'\n            - '*\\Get-ApplicationHost.ps1'\n            - '*\\Get-RegAlwaysInstallElevated.ps1'\n            - '*\\Get-Unconstrained.ps1'\n            - '*\\Add-RegBackdoor.ps1'\n            - '*\\Add-ScrnSaveBackdoor.ps1'\n            - '*\\Gupt-Backdoor.ps1'\n            - '*\\Invoke-ADSBackdoor.ps1'\n            - '*\\Enabled-DuplicateToken.ps1'\n            - '*\\Invoke-PsUaCme.ps1'\n            - '*\\Remove-Update.ps1'\n            - '*\\Check-VM.ps1'\n            - '*\\Get-LSASecret.ps1'\n            - '*\\Get-PassHashes.ps1'\n            - '*\\Show-TargetScreen.ps1'\n            - '*\\Port-Scan.ps1'\n            - '*\\Invoke-PoshRatHttp.ps1'\n            - '*\\Invoke-PowerShellTCP.ps1'\n            - '*\\Invoke-PowerShellWMI.ps1'\n            - '*\\Add-Exfiltration.ps1'\n            - '*\\Add-Persistence.ps1'\n            - '*\\Do-Exfiltration.ps1'\n            - '*\\Start-CaptureServer.ps1'\n            - '*\\Invoke-ShellCode.ps1'\n            - '*\\Get-ChromeDump.ps1'\n            - '*\\Get-ClipboardContents.ps1'\n            - '*\\Get-FoxDump.ps1'\n            - '*\\Get-IndexedItem.ps1'\n            - '*\\Get-Screenshot.ps1'\n            - '*\\Invoke-Inveigh.ps1'\n            - '*\\Invoke-NetRipper.ps1'\n            - '*\\Invoke-EgressCheck.ps1'\n            - '*\\Invoke-PostExfil.ps1'\n            - '*\\Invoke-PSInject.ps1'\n            - '*\\Invoke-RunAs.ps1'\n            - '*\\MailRaider.ps1'\n            - '*\\New-HoneyHash.ps1'\n            - '*\\Set-MacAttribute.ps1'\n            - '*\\Invoke-DCSync.ps1'\n            - '*\\Invoke-PowerDump.ps1'\n            - '*\\Exploit-Jboss.ps1'\n            - '*\\Invoke-ThunderStruck.ps1'\n            - '*\\Invoke-VoiceTroll.ps1'\n            - '*\\Set-Wallpaper.ps1'\n            - '*\\Invoke-InveighRelay.ps1'\n            - '*\\Invoke-PsExec.ps1'\n            - '*\\Invoke-SSHCommand.ps1'\n            - '*\\Get-SecurityPackages.ps1'\n            - '*\\Install-SSP.ps1'\n            - '*\\Invoke-BackdoorLNK.ps1'\n            - '*\\PowerBreach.ps1'\n            - '*\\Get-SiteListPassword.ps1'\n            - '*\\Get-System.ps1'\n            - '*\\Invoke-BypassUAC.ps1'\n            - '*\\Invoke-Tater.ps1'\n            - '*\\Invoke-WScriptBypassUAC.ps1'\n            - '*\\PowerUp.ps1'\n            - '*\\PowerView.ps1'\n            - '*\\Get-RickAstley.ps1'\n            - '*\\Find-Fruit.ps1'\n            - '*\\HTTP-Login.ps1'\n            - '*\\Find-TrustedDocuments.ps1'\n            - '*\\Invoke-Paranoia.ps1'\n            - '*\\Invoke-WinEnum.ps1'\n            - '*\\Invoke-ARPScan.ps1'\n            - '*\\Invoke-PortScan.ps1'\n            - '*\\Invoke-ReverseDNSLookup.ps1'\n            - '*\\Invoke-SMBScanner.ps1'\n            - '*\\Invoke-Mimikittenz.ps1'\n    condition: selection\nfalsepositives:\n    - Penetration Tests\nlevel: high\n        \n", "object_marking_refs": ["marking-definition--0a872d70-1d05-45dd-a25f-031af547a102"], "created_by_ref": "identity--082ca4f0-d825-45b6-aa42-ab9afd1e5503", "type": "indicator", "spec_version": "2.1", "id": "indicator--9e77c58e-ea5a-4b99-8b1a-a9572935289f", "modified": "2020-04-02T10:15:04.471Z"}