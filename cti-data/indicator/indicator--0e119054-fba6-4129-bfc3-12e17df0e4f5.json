{"name": "Suspicious Use of Procdump", "description": "Detects suspicious uses of the SysInternals Procdump utility by using a special command line parameter in combination with the lsass.exe process. This way we're also able to catch cases in which the attacker has renamed the procdump executable.", "created": "2018-10-30T00:00:00.000Z", "modified": "2019-10-14T00:00:00.000Z", "valid_from": "2018-10-30T00:00:00Z", "indicator_types": ["malicious-activity"], "pattern_type": "sigma", "pattern": "title: Suspicious Use of Procdump\nid: 5afee48e-67dd-4e03-a783-f74259dcf998\ndescription: Detects suspicious uses of the SysInternals Procdump utility by using a special command line parameter in combination with the lsass.exe process. This way we're also able to catch cases in which the attacker has renamed the procdump executable.\nstatus: experimental\nreferences:\n    - Internal Research\nauthor: Florian Roth\ndate: 2018/10/30\nmodified: 2019/10/14\ntags:\n    - attack.defense_evasion\n    - attack.t1036\n    - attack.credential_access\n    - attack.t1003\n    - car.2013-05-009\nlogsource:\n    category: process_creation\n    product: windows\ndetection:\n    selection1:\n        CommandLine:\n            - '* -ma *'\n    selection2:\n        CommandLine:\n            - '* lsass*'\n    selection3:\n        CommandLine:\n            - '* -ma ls*'\n    condition: ( selection1 and selection2 ) or selection3\nfalsepositives:\n    - Unlikely, because no one should dump an lsass process memory\n    - Another tool that uses the command line switches of Procdump\nlevel: high\n", "object_marking_refs": ["marking-definition--0a872d70-1d05-45dd-a25f-031af547a102"], "created_by_ref": "identity--082ca4f0-d825-45b6-aa42-ab9afd1e5503", "type": "indicator", "spec_version": "2.1", "id": "indicator--0e119054-fba6-4129-bfc3-12e17df0e4f5"}