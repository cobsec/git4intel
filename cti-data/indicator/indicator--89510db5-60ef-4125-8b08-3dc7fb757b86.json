{"name": "Malware Shellcode in Verclsid Target Process", "description": "Detects a process access to verclsid.exe that injects shellcode from a Microsoft Office application / VBA macro", "created": "2017-03-04T00:00:00.000Z", "valid_from": "2017-03-04T00:00:00Z", "indicator_types": ["malicious-activity"], "pattern_type": "sigma", "pattern": "title: Malware Shellcode in Verclsid Target Process\nid: b7967e22-3d7e-409b-9ed5-cdae3f9243a1\nstatus: experimental\ndescription: Detects a process access to verclsid.exe that injects shellcode from a Microsoft Office application / VBA macro\nreferences:\n    - https://twitter.com/JohnLaTwC/status/837743453039534080\ntags:\n    - attack.defense_evasion\n    - attack.privilege_escalation\n    - attack.t1055\nauthor: John Lambert (tech), Florian Roth (rule)\ndate: 2017/03/04\nlogsource:\n    product: windows\n    service: sysmon\n    definition: 'Use the following config to generate the necessary Event ID 10 Process Access events: <ProcessAccess onmatch=\"include\"><CallTrace condition=\"contains\">VBE7.DLL</CallTrace></ProcessAccess><ProcessAccess onmatch=\"exclude\"><CallTrace condition=\"excludes\">UNKNOWN</CallTrace></ProcessAccess>'\ndetection:\n    selection:\n        EventID: 10\n        TargetImage: '*\\verclsid.exe'\n        GrantedAccess: '0x1FFFFF'\n    combination1:\n        CallTrace: '*|UNKNOWN(*VBE7.DLL*'\n    combination2:\n        SourceImage: '*\\Microsoft Office\\\\*'\n        CallTrace: '*|UNKNOWN*'\n    condition: selection and 1 of combination*\nfalsepositives:\n    - unknown\nlevel: high\n\n\n", "object_marking_refs": ["marking-definition--0a872d70-1d05-45dd-a25f-031af547a102"], "created_by_ref": "identity--082ca4f0-d825-45b6-aa42-ab9afd1e5503", "type": "indicator", "spec_version": "2.1", "id": "indicator--89510db5-60ef-4125-8b08-3dc7fb757b86", "modified": "2020-04-02T10:14:57.986Z"}