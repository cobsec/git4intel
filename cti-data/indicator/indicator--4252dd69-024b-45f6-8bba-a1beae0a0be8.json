{"name": "Suspicious Debugger Registration Cmdline", "description": "Detects the registration of a debugger for a program that is available in the logon screen (sticky key backdoor).", "created": "2019-09-06T00:00:00.000Z", "valid_from": "2019-09-06T00:00:00Z", "indicator_types": ["malicious-activity"], "pattern_type": "sigma", "pattern": "title: Suspicious Debugger Registration Cmdline\nid: ae215552-081e-44c7-805f-be16f975c8a2\nstatus: experimental\ndescription: Detects the registration of a debugger for a program that is available in the logon screen (sticky key backdoor).\nreferences:\n    - https://blogs.technet.microsoft.com/jonathantrull/2016/10/03/detecting-sticky-key-backdoors/\ntags:\n    - attack.persistence\n    - attack.privilege_escalation\n    - attack.t1015\nauthor: Florian Roth\ndate: 2019/09/06\nlogsource:\n    category: process_creation\n    product: windows\ndetection:\n    selection:\n        CommandLine:\n            - '*\\CurrentVersion\\Image File Execution Options\\sethc.exe*'\n            - '*\\CurrentVersion\\Image File Execution Options\\utilman.exe*'\n            - '*\\CurrentVersion\\Image File Execution Options\\osk.exe*'\n            - '*\\CurrentVersion\\Image File Execution Options\\magnify.exe*'\n            - '*\\CurrentVersion\\Image File Execution Options\\narrator.exe*'\n            - '*\\CurrentVersion\\Image File Execution Options\\displayswitch.exe*'\n            - '*\\CurrentVersion\\Image File Execution Options\\atbroker.exe*'\n    condition: selection\nfalsepositives:\n    - Penetration Tests\nlevel: high\n        \n", "object_marking_refs": ["marking-definition--0a872d70-1d05-45dd-a25f-031af547a102"], "created_by_ref": "identity--082ca4f0-d825-45b6-aa42-ab9afd1e5503", "type": "indicator", "spec_version": "2.1", "id": "indicator--4252dd69-024b-45f6-8bba-a1beae0a0be8", "modified": "2020-04-02T10:14:39.427Z"}