{"name": "Generic Password Dumper Activity on LSASS", "description": "Detects process handle on LSASS process with certain access mask", "created": "2019-11-01T00:00:00.000Z", "modified": "2019-11-07T00:00:00.000Z", "valid_from": "2019-11-01T00:00:00Z", "indicator_types": ["malicious-activity"], "pattern_type": "sigma", "pattern": "title: Generic Password Dumper Activity on LSASS\nid: 4a1b6da0-d94f-4fc3-98fc-2d9cb9e5ee76\ndescription: Detects process handle on LSASS process with certain access mask\nstatus: experimental\nauthor: Roberto Rodriguez, Teymur Kheirkhabarov, Dimitrios Slamaris, Mark Russinovich, Aleksey Potapov, oscd.community (update)\ndate: 2019/11/01\nmodified: 2019/11/07\nreferences:\n    - https://cyberwardog.blogspot.com/2017/03/chronicles-of-threat-hunter-hunting-for_22.html\n    - https://www.slideshare.net/heirhabarov/hunting-for-credentials-dumping-in-windows-environment\ntags:\n    - attack.credential_access\n    - attack.t1003\n    - car.2019-04-004\nlogsource:\n    product: windows\n    service: security\ndetection:\n    selection_1:\n        EventID: 4656\n        ObjectName|endswith: '\\lsass.exe'\n        AccessMask|contains:\n            - '0x40'\n            - '0x1400'\n            - '0x1000'\n            - '0x100000'\n            - '0x1410'    # car.2019-04-004\n            - '0x1010'    # car.2019-04-004\n            - '0x1438'    # car.2019-04-004\n            - '0x143a'    # car.2019-04-004\n            - '0x1418'    # car.2019-04-004\n            - '0x1f0fff'\n            - '0x1f1fff'\n            - '0x1f2fff'\n            - '0x1f3fff'\n    selection_2:\n        EventID: 4663\n        ObjectName|endswith: '\\lsass.exe'\n        AccessList|contains:\n            - '4484'\n            - '4416'\n    filter:\n        ProcessName|endswith: \n            - '\\wmiprvse.exe'\n            - '\\taskmgr.exe'\n            - '\\procexp64.exe'\n            - '\\procexp.exe'\n            - '\\lsm.exe'\n            - '\\csrss.exe'\n            - '\\wininit.exe'\n            - '\\vmtoolsd.exe'\n    condition: selection_1 or selection_2 and not filter\nfields:\n    - ComputerName\n    - SubjectDomainName\n    - SubjectUserName\n    - ProcessName\n    - ProcessID\nfalsepositives:\n    - Legitimate software accessing LSASS process for legitimate reason; update the whitelist with it\nlevel: high\n", "object_marking_refs": ["marking-definition--0a872d70-1d05-45dd-a25f-031af547a102"], "created_by_ref": "identity--082ca4f0-d825-45b6-aa42-ab9afd1e5503", "type": "indicator", "spec_version": "2.1", "id": "indicator--7c5ff75e-cd12-4d32-a5b7-bc8d607d3e3f"}