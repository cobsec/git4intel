{"name": "Windows Registry Persistence COM Key Linking", "description": "Detects COM object hijacking via TreatAs subkey", "created": "2019-10-23T00:00:00.000Z", "modified": "2019-11-07T00:00:00.000Z", "valid_from": "2019-10-23T00:00:00Z", "indicator_types": ["malicious-activity"], "pattern_type": "sigma", "pattern": "title: Windows Registry Persistence COM Key Linking\nid: 9b0f8a61-91b2-464f-aceb-0527e0a45020\nstatus: experimental\ndescription: Detects COM object hijacking via TreatAs subkey\nreferences:\n    - https://bohops.com/2018/08/18/abusing-the-com-registry-structure-part-2-loading-techniques-for-evasion-and-persistence/\nauthor: Kutepov Anton, oscd.community\ndate: 2019/10/23\nmodified: 2019/11/07\ntags:\n    - attack.persistence\n    - attack.t1122\nlogsource:\n    product: windows\n    service: sysmon\ndetection:\n    selection:\n        EventID: 12\n        TargetObject: 'HKU\\\\*_Classes\\CLSID\\\\*\\TreatAs'\n    condition: selection\nfalsepositives:\n    - Maybe some system utilities in rare cases use linking keys for backward compability\nlevel: medium\n", "object_marking_refs": ["marking-definition--0a872d70-1d05-45dd-a25f-031af547a102"], "created_by_ref": "identity--082ca4f0-d825-45b6-aa42-ab9afd1e5503", "type": "indicator", "spec_version": "2.1", "id": "indicator--f84ea21d-d6ee-45d4-b0c5-ebd2073b3a1a"}