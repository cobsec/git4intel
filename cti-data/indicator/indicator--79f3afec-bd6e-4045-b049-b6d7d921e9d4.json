{"name": "Alternate PowerShell Hosts", "description": "Detects alternate PowerShell hosts potentially bypassing detections looking for powershell.exe", "created": "2019-08-11T00:00:00.000Z", "modified": "2020-02-25T00:00:00.000Z", "valid_from": "2019-08-11T00:00:00Z", "indicator_types": ["malicious-activity"], "pattern_type": "sigma", "pattern": "title: Alternate PowerShell Hosts\nid: 64e8e417-c19a-475a-8d19-98ea705394cc\ndescription: Detects alternate PowerShell hosts potentially bypassing detections looking for powershell.exe\nstatus: experimental\ndate: 2019/08/11\nmodified: 2020/02/25\nauthor: Roberto Rodriguez @Cyb3rWard0g\nreferences:\n    - https://github.com/Cyb3rWard0g/ThreatHunter-Playbook/tree/master/playbooks/windows/02_execution/T1086_powershell/alternate_signed_powershell_hosts.md\ntags:\n    - attack.execution\n    - attack.t1086\nlogsource:\n    product: windows\n    service: powershell\ndetection:\n    selection: \n        EventID:\n            - 4103\n            - 400\n        ContextInfo: '*'\n    filter:\n        - ContextInfo: 'powershell.exe'\n        - Message: 'powershell.exe'\n        # Both fields contain key=value pairs where the key HostApplication ist relevant but\n        # can't be referred directly as event field.\n    condition: selection and not filter\nfalsepositives:\n    - Programs using PowerShell directly without invocation of a dedicated interpreter\n    - MSP Detection Searcher\n    - Citrix ConfigSync.ps1\nlevel: medium\n", "object_marking_refs": ["marking-definition--0a872d70-1d05-45dd-a25f-031af547a102"], "created_by_ref": "identity--082ca4f0-d825-45b6-aa42-ab9afd1e5503", "type": "indicator", "spec_version": "2.1", "id": "indicator--79f3afec-bd6e-4045-b049-b6d7d921e9d4"}