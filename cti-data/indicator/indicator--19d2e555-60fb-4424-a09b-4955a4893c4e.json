{"name": "Malicious PowerShell Commandlets", "description": "Detects Commandlet names from well-known PowerShell exploitation frameworks", "created": "2017-03-05T00:00:00.000Z", "modified": "2019-01-22T00:00:00.000Z", "valid_from": "2017-03-05T00:00:00Z", "indicator_types": ["malicious-activity"], "pattern_type": "sigma", "pattern": "title: Malicious PowerShell Commandlets\nid: 89819aa4-bbd6-46bc-88ec-c7f7fe30efa6\nstatus: experimental\ndescription: Detects Commandlet names from well-known PowerShell exploitation frameworks\nmodified: 2019/01/22\nreferences:\n    - https://adsecurity.org/?p=2921\ntags:\n    - attack.execution\n    - attack.t1086\nauthor: Sean Metcalf (source), Florian Roth (rule)\ndate: 2017/03/05\nlogsource:\n    product: windows\n    service: powershell\n    definition: 'It is recommended to use the new \"Script Block Logging\" of PowerShell v5 https://adsecurity.org/?p=2277'\ndetection:\n    keywords:\n        Message:\n            - \"*Invoke-DllInjection*\"\n            - \"*Invoke-Shellcode*\"\n            - \"*Invoke-WmiCommand*\"\n            - \"*Get-GPPPassword*\"\n            - \"*Get-Keystrokes*\"\n            - \"*Get-TimedScreenshot*\"\n            - \"*Get-VaultCredential*\"\n            - \"*Invoke-CredentialInjection*\"\n            - \"*Invoke-Mimikatz*\"\n            - \"*Invoke-NinjaCopy*\"\n            - \"*Invoke-TokenManipulation*\"\n            - \"*Out-Minidump*\"\n            - \"*VolumeShadowCopyTools*\"\n            - \"*Invoke-ReflectivePEInjection*\"\n            - \"*Invoke-UserHunter*\"\n            - \"*Find-GPOLocation*\"\n            - \"*Invoke-ACLScanner*\"\n            - \"*Invoke-DowngradeAccount*\"\n            - \"*Get-ServiceUnquoted*\"\n            - \"*Get-ServiceFilePermission*\"\n            - \"*Get-ServicePermission*\"\n            - \"*Invoke-ServiceAbuse*\"\n            - \"*Install-ServiceBinary*\"\n            - \"*Get-RegAutoLogon*\"\n            - \"*Get-VulnAutoRun*\"\n            - \"*Get-VulnSchTask*\"\n            - \"*Get-UnattendedInstallFile*\"\n            - \"*Get-ApplicationHost*\"\n            - \"*Get-RegAlwaysInstallElevated*\"\n            - \"*Get-Unconstrained*\"\n            - \"*Add-RegBackdoor*\"\n            - \"*Add-ScrnSaveBackdoor*\"\n            - \"*Gupt-Backdoor*\"\n            - \"*Invoke-ADSBackdoor*\"\n            - \"*Enabled-DuplicateToken*\"\n            - \"*Invoke-PsUaCme*\"\n            - \"*Remove-Update*\"\n            - \"*Check-VM*\"\n            - \"*Get-LSASecret*\"\n            - \"*Get-PassHashes*\"\n            - \"*Show-TargetScreen*\"\n            - \"*Port-Scan*\"\n            - \"*Invoke-PoshRatHttp*\"\n            - \"*Invoke-PowerShellTCP*\"\n            - \"*Invoke-PowerShellWMI*\"\n            - \"*Add-Exfiltration*\"\n            - \"*Add-Persistence*\"\n            - \"*Do-Exfiltration*\"\n            - \"*Start-CaptureServer*\"\n            - \"*Get-ChromeDump*\"\n            - \"*Get-ClipboardContents*\"\n            - \"*Get-FoxDump*\"\n            - \"*Get-IndexedItem*\"\n            - \"*Get-Screenshot*\"\n            - \"*Invoke-Inveigh*\"\n            - \"*Invoke-NetRipper*\"\n            - \"*Invoke-EgressCheck*\"\n            - \"*Invoke-PostExfil*\"\n            - \"*Invoke-PSInject*\"\n            - \"*Invoke-RunAs*\"\n            - \"*MailRaider*\"\n            - \"*New-HoneyHash*\"\n            - \"*Set-MacAttribute*\"\n            - \"*Invoke-DCSync*\"\n            - \"*Invoke-PowerDump*\"\n            - \"*Exploit-Jboss*\"\n            - \"*Invoke-ThunderStruck*\"\n            - \"*Invoke-VoiceTroll*\"\n            - \"*Set-Wallpaper*\"\n            - \"*Invoke-InveighRelay*\"\n            - \"*Invoke-PsExec*\"\n            - \"*Invoke-SSHCommand*\"\n            - \"*Get-SecurityPackages*\"\n            - \"*Install-SSP*\"\n            - \"*Invoke-BackdoorLNK*\"\n            - \"*PowerBreach*\"\n            - \"*Get-SiteListPassword*\"\n            - \"*Get-System*\"\n            - \"*Invoke-BypassUAC*\"\n            - \"*Invoke-Tater*\"\n            - \"*Invoke-WScriptBypassUAC*\"\n            - \"*PowerUp*\"\n            - \"*PowerView*\"\n            - \"*Get-RickAstley*\"\n            - \"*Find-Fruit*\"\n            - \"*HTTP-Login*\"\n            - \"*Find-TrustedDocuments*\"\n            - \"*Invoke-Paranoia*\"\n            - \"*Invoke-WinEnum*\"\n            - \"*Invoke-ARPScan*\"\n            - \"*Invoke-PortScan*\"\n            - \"*Invoke-ReverseDNSLookup*\"\n            - \"*Invoke-SMBScanner*\"\n            - \"*Invoke-Mimikittenz*\"\n            - \"*Invoke-AllChecks*\"\n    false_positives:\n        - Get-SystemDriveInfo  # http://bheltborg.dk/Windows/WinSxS/amd64_microsoft-windows-maintenancediagnostic_31bf3856ad364e35_10.0.10240.16384_none_91ef7543a4514b5e/CL_Utility.ps1\n    condition: keywords and not false_positives\nfalsepositives:\n    - Penetration testing\nlevel: high\n", "object_marking_refs": ["marking-definition--0a872d70-1d05-45dd-a25f-031af547a102"], "created_by_ref": "identity--082ca4f0-d825-45b6-aa42-ab9afd1e5503", "type": "indicator", "spec_version": "2.1", "id": "indicator--19d2e555-60fb-4424-a09b-4955a4893c4e"}