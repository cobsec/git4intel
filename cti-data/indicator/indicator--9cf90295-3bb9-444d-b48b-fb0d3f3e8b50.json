{"name": "Query Registry", "description": "Adversaries may interact with the Windows Registry to gather information about the system, configuration, and installed software.", "created": "2019-10-21T00:00:00.000Z", "modified": "2019-11-04T00:00:00.000Z", "valid_from": "2019-10-21T00:00:00Z", "indicator_types": ["malicious-activity"], "pattern_type": "sigma", "pattern": "title: Query Registry\nid: 970007b7-ce32-49d0-a4a4-fbef016950bd\nstatus: experimental\ndescription: Adversaries may interact with the Windows Registry to gather information about the system, configuration, and installed software.\nauthor: Timur Zinniatullin, oscd.community\ndate: 2019/10/21\nmodified: 2019/11/04\nreferences:\n    - https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1012/T1012.yaml\nlogsource:\n    category: process_creation\n    product: windows\ndetection:\n    selection_1:\n        Image|endswith: '\\reg.exe'\n        CommandLine|contains: \n            - 'query'\n            - 'save'\n            - 'export'\n    selection_2:\n        CommandLine|contains:\n            - 'currentVersion\\windows'\n            - 'currentVersion\\runServicesOnce'\n            - 'currentVersion\\runServices'\n            - 'winlogon\\'\n            - 'currentVersion\\shellServiceObjectDelayLoad'\n            - 'currentVersion\\runOnce'\n            - 'currentVersion\\runOnceEx'\n            - 'currentVersion\\run'\n            - 'currentVersion\\policies\\explorer\\run'\n            - 'currentcontrolset\\services'\n    condition: selection_1 and selection_2\nfields:\n    - Image\n    - CommandLine\n    - User\n    - LogonGuid\n    - Hashes\n    - ParentProcessGuid\n    - ParentCommandLine\nlevel: low\ntags:\n    - attack.discovery\n    - attack.t1012\n    - attack.t1007\n", "object_marking_refs": ["marking-definition--0a872d70-1d05-45dd-a25f-031af547a102"], "created_by_ref": "identity--082ca4f0-d825-45b6-aa42-ab9afd1e5503", "type": "indicator", "spec_version": "2.1", "id": "indicator--9cf90295-3bb9-444d-b48b-fb0d3f3e8b50"}