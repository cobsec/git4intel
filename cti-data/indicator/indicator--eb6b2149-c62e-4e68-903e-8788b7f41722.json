{"name": "Privilege Escalation Preparation", "description": "Detects suspicious shell commands indicating the information gathering phase as preparation for the Privilege Escalation.", "created": "2019-04-05T00:00:00.000Z", "valid_from": "2019-04-05T00:00:00Z", "indicator_types": ["malicious-activity"], "pattern_type": "sigma", "pattern": "title: Privilege Escalation Preparation\nid: 444ade84-c362-4260-b1f3-e45e20e1a905\nstatus: experimental\ndescription: Detects suspicious shell commands indicating the information gathering phase as preparation for the Privilege Escalation.\nreferences:\n    - https://blog.g0tmi1k.com/2011/08/basic-linux-privilege-escalation/\n    - https://patrick-bareiss.com/detect-privilege-escalation-preparation-in-linux-with-sigma/\nauthor: Patrick Bareiss\ndate: 2019/04/05\ntags:\n    - attack.privilege_escalation\n    - attack.t1068\nlevel: medium\nlogsource:\n    product: linux\ndetection:\n    keywords:\n        # distribution type and kernel version\n        - 'cat /etc/issue'\n        - 'cat /etc/*-release'\n        - 'cat /proc/version'\n        - 'uname -a'\n        - 'uname -mrs'\n        - 'rpm -q kernel'\n        - 'dmesg | grep Linux'\n        - 'ls /boot | grep vmlinuz-'\n        # environment variables\n        - 'cat /etc/profile'\n        - 'cat /etc/bashrc'\n        - 'cat ~/.bash_profile'\n        - 'cat ~/.bashrc'\n        - 'cat ~/.bash_logout'\n        # applications and services as root\n        - 'ps -aux | grep root'\n        - 'ps -ef | grep root'\n        # scheduled tasks\n        - 'crontab -l'\n        - 'cat /etc/cron*'\n        - 'cat /etc/cron.allow'\n        - 'cat /etc/cron.deny'\n        - 'cat /etc/crontab'\n        # search for plain text user/passwords\n        - 'grep -i user *'\n        - 'grep -i pass *'\n        # networking\n        - 'ifconfig'\n        - 'cat /etc/network/interfaces'\n        - 'cat /etc/sysconfig/network'\n        - 'cat /etc/resolv.conf'\n        - 'cat /etc/networks'\n        - 'iptables -L'\n        - 'lsof -i'\n        - 'netstat -antup'\n        - 'netstat -antpx'\n        - 'netstat -tulpn'\n        - 'arp -e'\n        - 'route'\n        # sensitive files\n        - 'cat /etc/passwd'\n        - 'cat /etc/group'\n        - 'cat /etc/shadow'\n        # sticky bits\n        - 'find / -perm -u=s'\n        - 'find / -perm -g=s'\n        - 'find / -perm -4000'\n        - 'find / -perm -2000'\n    timeframe: 30m\n    condition: keywords | count() by host > 6\nfalsepositives:\n    - Troubleshooting on Linux Machines\n", "object_marking_refs": ["marking-definition--0a872d70-1d05-45dd-a25f-031af547a102"], "created_by_ref": "identity--082ca4f0-d825-45b6-aa42-ab9afd1e5503", "type": "indicator", "spec_version": "2.1", "id": "indicator--eb6b2149-c62e-4e68-903e-8788b7f41722", "modified": "2020-04-02T10:14:30.559Z"}