{"name": "Windows Shell Spawning Suspicious Program", "description": "Detects a suspicious child process of a Windows shell", "created": "2018-04-06T00:00:00.000Z", "modified": "2019-02-05T00:00:00.000Z", "valid_from": "2018-04-06T00:00:00Z", "indicator_types": ["malicious-activity"], "pattern_type": "sigma", "pattern": "title: Windows Shell Spawning Suspicious Program\nid: 3a6586ad-127a-4d3b-a677-1e6eacdf8fde\nstatus: experimental\ndescription: Detects a suspicious child process of a Windows shell\nreferences:\n    - https://mgreen27.github.io/posts/2018/04/02/DownloadCradle.html\nauthor: Florian Roth\ndate: 2018/04/06\nmodified: 2019/02/05\ntags:\n    - attack.execution\n    - attack.defense_evasion\n    - attack.t1064\nlogsource:\n    category: process_creation\n    product: windows\ndetection:\n    selection:\n        ParentImage:\n            - '*\\mshta.exe'\n            - '*\\powershell.exe'\n            # - '*\\cmd.exe'  # too many false positives\n            - '*\\rundll32.exe'\n            - '*\\cscript.exe'\n            - '*\\wscript.exe'\n            - '*\\wmiprvse.exe'\n        Image:\n            - '*\\schtasks.exe'\n            - '*\\nslookup.exe'\n            - '*\\certutil.exe'\n            - '*\\bitsadmin.exe'\n            - '*\\mshta.exe'\n    falsepositives:\n        CurrentDirectory: '*\\ccmcache\\\\*'\n    condition: selection and not falsepositives\nfields:\n    - CommandLine\n    - ParentCommandLine\nfalsepositives:\n    - Administrative scripts\n    - Microsoft SCCM\nlevel: high\n", "object_marking_refs": ["marking-definition--0a872d70-1d05-45dd-a25f-031af547a102"], "created_by_ref": "identity--082ca4f0-d825-45b6-aa42-ab9afd1e5503", "type": "indicator", "spec_version": "2.1", "id": "indicator--9f521424-48d3-4031-bee8-accb5fec2f03"}