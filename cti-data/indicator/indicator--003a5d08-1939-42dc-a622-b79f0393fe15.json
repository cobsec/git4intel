{"name": "Invoke-Obfuscation Obfuscated IEX Invocation", "description": "Detects all variations of obfuscated powershell IEX invocation code generated by Invoke-Obfuscation framework from the following code block \u2014 https://github.com/danielbohannon/Invoke-Obfuscation/blob/master/Out-ObfuscatedStringCommand.ps1#L873-L888", "created": "2019-11-08T00:00:00.000Z", "valid_from": "2019-11-08T00:00:00Z", "indicator_types": ["malicious-activity"], "pattern_type": "sigma", "pattern": "action: global\ntitle: Invoke-Obfuscation Obfuscated IEX Invocation\nid: 51aa9387-1c53-4153-91cc-d73c59ae1ca9\ndescription: \"Detects all variations of obfuscated powershell IEX invocation code generated by Invoke-Obfuscation framework from the following code block \\u2014 https://github.com/danielbohannon/Invoke-Obfuscation/blob/master/Out-ObfuscatedStringCommand.ps1#L873-L888\"\nstatus: experimental\nauthor: Daniel Bohannon (@Mandiant/@FireEye), oscd.community\ndate: 2019/11/08\ntags:\n    - attack.defense_evasion\n    - attack.t1027\nfalsepositives:\n    - Unknown\nlevel: high\ndetection:\n    selection:\n        - ImagePath|re: '\\$PSHome\\[\\s*\\d{1,3}\\s*\\]\\s*\\+\\s*\\$PSHome\\['\n        - ImagePath|re: '\\$ShellId\\[\\s*\\d{1,3}\\s*\\]\\s*\\+\\s*\\$ShellId\\['\n        - ImagePath|re: '\\$env:Public\\[\\s*\\d{1,3}\\s*\\]\\s*\\+\\s*\\$env:Public\\['\n        - ImagePath|re: '\\$env:ComSpec\\[(\\s*\\d{1,3}\\s*,){2}'\n        - ImagePath|re: '\\*mdr\\*\\W\\s*\\)\\.Name'\n        - ImagePath|re: '\\$VerbosePreference\\.ToString\\('\n        - ImagePath|re: '\\String\\]\\s*\\$VerbosePreference'\n    condition: selection\n", "object_marking_refs": ["marking-definition--0a872d70-1d05-45dd-a25f-031af547a102"], "created_by_ref": "identity--082ca4f0-d825-45b6-aa42-ab9afd1e5503", "type": "indicator", "spec_version": "2.1", "id": "indicator--003a5d08-1939-42dc-a622-b79f0393fe15", "modified": "2020-04-02T10:15:08.508Z"}