{"name": "In-memory PowerShell", "description": "Detects loading of essential DLL used by PowerShell, but not by the process powershell.exe. Detects meterpreter's \"load powershell\" extension.", "created": "2019-11-14T00:00:00.000Z", "modified": "2019-11-30T00:00:00.000Z", "valid_from": "2019-11-14T00:00:00Z", "indicator_types": ["malicious-activity"], "pattern_type": "sigma", "pattern": "title: In-memory PowerShell\nid: 092bc4b9-3d1d-43b4-a6b4-8c8acd83522f\nstatus: experimental\ndescription: Detects loading of essential DLL used by PowerShell, but not by the process powershell.exe. Detects meterpreter's \"load powershell\" extension.\nauthor: Tom Kern, oscd.community\ndate: 2019/11/14\nmodified: 2019/11/30\nreferences:\n    - https://adsecurity.org/?p=2921\n    - https://github.com/p3nt4/PowerShdll\ntags:\n    - attack.t1086\n    - attack.execution\nlogsource:\n    product: windows\n    service: sysmon\ndetection:\n    selection:\n        EventID: 7\n        ImageLoaded|endswith:\n            - '\\System.Management.Automation.Dll'\n            - '\\System.Management.Automation.ni.Dll'\n    filter:\n        Image|endswith:\n            - '\\powershell.exe'\n            - '\\WINDOWS\\System32\\sdiagnhost.exe'\n        User: 'NT AUTHORITY\\SYSTEM'\n    condition: selection and not filter\nfalsepositives:\n    - Used by some .NET binaries, minimal on user workstation.\nlevel: high\nenrichment:\n    - EN_0001_cache_sysmon_event_id_1_info                      # http://bit.ly/314zc6x\n    - EN_0003_enrich_other_sysmon_events_with_event_id_1_data   # http://bit.ly/2ojW7fw\n", "object_marking_refs": ["marking-definition--0a872d70-1d05-45dd-a25f-031af547a102"], "created_by_ref": "identity--082ca4f0-d825-45b6-aa42-ab9afd1e5503", "type": "indicator", "spec_version": "2.1", "id": "indicator--cfca0744-3514-4dc0-bdcb-f627a3ec8018"}