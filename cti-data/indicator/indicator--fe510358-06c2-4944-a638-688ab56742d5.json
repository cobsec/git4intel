{"name": "Malicious PowerShell Keywords", "description": "Detects keywords from well-known PowerShell exploitation frameworks", "created": "2017-03-05T00:00:00.000Z", "modified": "2019-01-22T00:00:00.000Z", "valid_from": "2017-03-05T00:00:00Z", "indicator_types": ["malicious-activity"], "pattern_type": "sigma", "pattern": "title: Malicious PowerShell Keywords\nid: f62176f3-8128-4faa-bf6c-83261322e5eb\nstatus: experimental\ndescription: Detects keywords from well-known PowerShell exploitation frameworks\nmodified: 2019/01/22\nreferences:\n    - https://adsecurity.org/?p=2921\ntags:\n    - attack.execution\n    - attack.t1086\nauthor: Sean Metcalf (source), Florian Roth (rule)\ndate: 2017/03/05\nlogsource:\n    product: windows\n    service: powershell\n    definition: 'It is recommended to use the new \"Script Block Logging\" of PowerShell v5 https://adsecurity.org/?p=2277'\ndetection:\n    keywords:\n        Message:\n            - \"*AdjustTokenPrivileges*\"\n            - \"*IMAGE_NT_OPTIONAL_HDR64_MAGIC*\"\n            - \"*Microsoft.Win32.UnsafeNativeMethods*\"\n            - \"*ReadProcessMemory.Invoke*\"\n            - \"*SE_PRIVILEGE_ENABLED*\"\n            - \"*LSA_UNICODE_STRING*\"\n            - \"*MiniDumpWriteDump*\"\n            - \"*PAGE_EXECUTE_READ*\"\n            - \"*SECURITY_DELEGATION*\"\n            - \"*TOKEN_ADJUST_PRIVILEGES*\"\n            - \"*TOKEN_ALL_ACCESS*\"\n            - \"*TOKEN_ASSIGN_PRIMARY*\"\n            - \"*TOKEN_DUPLICATE*\"\n            - \"*TOKEN_ELEVATION*\"\n            - \"*TOKEN_IMPERSONATE*\"\n            - \"*TOKEN_INFORMATION_CLASS*\"\n            - \"*TOKEN_PRIVILEGES*\"\n            - \"*TOKEN_QUERY*\"\n            - \"*Metasploit*\"\n            - \"*Mimikatz*\"\n    condition: keywords\nfalsepositives:\n    - Penetration tests\nlevel: high\n", "object_marking_refs": ["marking-definition--0a872d70-1d05-45dd-a25f-031af547a102"], "created_by_ref": "identity--082ca4f0-d825-45b6-aa42-ab9afd1e5503", "type": "indicator", "spec_version": "2.1", "id": "indicator--fe510358-06c2-4944-a638-688ab56742d5"}