{"name": "Suspicious desktop.ini Action", "description": "Detects unusual processes accessing desktop.ini, which can be leveraged to alter how Explorer displays a folder's content (i.e. renaming files) without changing them on disk.", "created": "2020-03-19T00:00:00.000Z", "valid_from": "2020-03-19T00:00:00Z", "indicator_types": ["malicious-activity"], "pattern_type": "sigma", "pattern": "title: Suspicious desktop.ini Action\nid: 81315b50-6b60-4d8f-9928-3466e1022515\nstatus: experimental\ndescription: Detects unusual processes accessing desktop.ini, which can be leveraged to alter how Explorer displays a folder's content (i.e. renaming files) without changing them on disk.\nreferences:\n    - https://isc.sans.edu/forums/diary/Desktopini+as+a+postexploitation+tool/25912/\nauthor: Maxime Thiebaut (@0xThiebaut)\ndate: 2020/03/19\ntags:\n    - attack.persistence\n    - attack.t1023\nlogsource:\n    product: windows\n    service: sysmon\ndetection:\n    filter:\n        Image:\n            - 'C:\\Windows\\explorer.exe'\n            - 'C:\\Windows\\System32\\msiexec.exe'\n            - 'C:\\Windows\\System32\\mmc.exe'\n    selection:\n        EventID: 11\n        TargetFilename|endswith: '\\desktop.ini'\n    condition: selection and not filter\nfalsepositives:\n    - Operations performed through Windows SCCM or equivalent\nlevel: medium\n", "object_marking_refs": ["marking-definition--0a872d70-1d05-45dd-a25f-031af547a102"], "created_by_ref": "identity--082ca4f0-d825-45b6-aa42-ab9afd1e5503", "type": "indicator", "spec_version": "2.1", "id": "indicator--330204f0-b7a9-4d43-9015-e335375bc451", "modified": "2020-04-02T10:15:01.598Z"}