{"name": "Possible DNS Rebinding", "description": "Detects several different DNS-answers by one domain with IPs from internal and external networks. Normally, DNS-answer contain TTL >100. (DNS-record will saved in host cache for a while TTL).", "created": "2019-10-25T00:00:00.000Z", "modified": "2019-11-13T00:00:00.000Z", "valid_from": "2019-10-25T00:00:00Z", "indicator_types": ["malicious-activity"], "pattern_type": "sigma", "pattern": "title: Possible DNS Rebinding\nid: eb07e747-2552-44cd-af36-b659ae0958e4\nstatus: experimental\ndescription: Detects several different DNS-answers by one domain with IPs from internal and external networks. Normally, DNS-answer contain TTL >100. (DNS-record\n    will saved in host cache for a while TTL).\ndate: 2019/10/25\nmodified: 2019/11/13\nauthor: Ilyas Ochkov, oscd.community\nreferences:\n    - https://medium.com/@brannondorsey/attacking-private-networks-from-the-internet-with-dns-rebinding-ea7098a2d325\ntags:\n    - attack.command_and_control\n    - attack.t1043\nlogsource:\n    product: windows\n    service: sysmon\ndetection:\n    dns_answer:\n        EventID: 22\n        QueryName: '*'\n        QueryStatus: '0' \n    filter_int_ip:\n        QueryResults|startswith: \n            - '(::ffff:)?10.'\n            - '(::ffff:)?192.168.'\n            - '(::ffff:)?172.16.'\n            - '(::ffff:)?172.17.'\n            - '(::ffff:)?172.18.'\n            - '(::ffff:)?172.19.'\n            - '(::ffff:)?172.20.'\n            - '(::ffff:)?172.21.'\n            - '(::ffff:)?172.22.'\n            - '(::ffff:)?172.23.'\n            - '(::ffff:)?172.24.'\n            - '(::ffff:)?172.25.'\n            - '(::ffff:)?172.26.'\n            - '(::ffff:)?172.27.'\n            - '(::ffff:)?172.28.'\n            - '(::ffff:)?172.29.'\n            - '(::ffff:)?172.30.'\n            - '(::ffff:)?172.31.'\n            - '(::ffff:)?127.'        \n    timeframe: 30s\n    condition: (dns_answer and filter_int_ip) and (dns_answer and not filter_int_ip) | count(QueryName) by ComputerName > 3\nlevel: medium\n", "object_marking_refs": ["marking-definition--0a872d70-1d05-45dd-a25f-031af547a102"], "created_by_ref": "identity--082ca4f0-d825-45b6-aa42-ab9afd1e5503", "type": "indicator", "spec_version": "2.1", "id": "indicator--aeae8469-26e8-4445-97c1-dd5bf71c8b75"}