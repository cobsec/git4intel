{"name": "Renamed Binary", "description": "Detects the execution of a renamed binary often used by attackers or malware leveraging new Sysmon OriginalFileName datapoint.", "created": "2019-06-15T00:00:00.000Z", "modified": "2019-11-11T00:00:00.000Z", "valid_from": "2019-06-15T00:00:00Z", "indicator_types": ["malicious-activity"], "pattern_type": "sigma", "pattern": "title: Renamed Binary\nid: 36480ae1-a1cb-4eaa-a0d6-29801d7e9142\nstatus: experimental\ndescription: Detects the execution of a renamed binary often used by attackers or malware leveraging new Sysmon OriginalFileName datapoint.\nauthor: Matthew Green - @mgreen27, Ecco, James Pemberton / @4A616D6573, oscd.community (improvements)\ndate: 2019/06/15\nmodified: 2019/11/11\nreferences:\n    - https://attack.mitre.org/techniques/T1036/\n    - https://mgreen27.github.io/posts/2019/05/12/BinaryRename.html\n    - https://mgreen27.github.io/posts/2019/05/29/BinaryRename2.html\ntags:\n    - attack.t1036\n    - attack.defense_evasion\nlogsource:\n    category: process_creation\n    product: windows\ndetection:\n    selection:\n        OriginalFileName:\n            - 'cmd.exe'\n            - 'powershell.exe'\n            - 'powershell_ise.exe'\n            - 'psexec.exe'\n            - 'psexec.c'  # old versions of psexec (2016 seen)\n            - 'cscript.exe'\n            - 'wscript.exe'\n            - 'mshta.exe'\n            - 'regsvr32.exe'\n            - 'wmic.exe'\n            - 'certutil.exe'\n            - 'rundll32.exe'\n            - 'cmstp.exe'\n            - 'msiexec.exe'\n            - '7z.exe'\n            - 'winrar.exe'\n            - 'wevtutil.exe'\n            - 'net.exe'\n            - 'net1.exe'\n    filter:\n        Image|endswith:\n            - '\\cmd.exe'\n            - '\\powershell.exe'\n            - '\\powershell_ise.exe'\n            - '\\psexec.exe'\n            - '\\psexec64.exe'\n            - '\\cscript.exe'\n            - '\\wscript.exe'\n            - '\\mshta.exe'\n            - '\\regsvr32.exe'\n            - '\\wmic.exe'\n            - '\\certutil.exe'\n            - '\\rundll32.exe'\n            - '\\cmstp.exe'\n            - '\\msiexec.exe'\n            - '\\7z.exe'\n            - '\\winrar.exe'\n            - '\\wevtutil.exe'\n            - '\\net.exe'\n            - '\\net1.exe'\n    condition: selection and not filter\nfalsepositives:\n    - Custom applications use renamed binaries adding slight change to binary name. Typically this is easy to spot and add to whitelist\nlevel: medium\n", "object_marking_refs": ["marking-definition--0a872d70-1d05-45dd-a25f-031af547a102"], "created_by_ref": "identity--082ca4f0-d825-45b6-aa42-ab9afd1e5503", "type": "indicator", "spec_version": "2.1", "id": "indicator--33a20c3a-c250-4829-acf5-d299611da688"}