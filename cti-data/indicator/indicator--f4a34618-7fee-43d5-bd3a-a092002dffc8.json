{"name": "Clear PowerShell History", "description": "Detects keywords that could indicate clearing PowerShell history", "created": "2019-10-25T00:00:00.000Z", "valid_from": "2019-10-25T00:00:00Z", "indicator_types": ["malicious-activity"], "pattern_type": "sigma", "pattern": "title: Clear PowerShell History\nid: dfba4ce1-e0ea-495f-986e-97140f31af2d\nstatus: experimental\ndescription: Detects keywords that could indicate clearing PowerShell history\ndate: 2019/10/25\nauthor: Ilyas Ochkov, oscd.community\nreferences:\n    - https://gist.github.com/hook-s3c/7363a856c3cdbadeb71085147f042c1a\ntags:\n    - attack.defense_evasion\n    - attack.t1146\nlogsource:\n    product: windows\n    service: powershell\ndetection:\n    keywords:\n        - 'del (Get-PSReadlineOption).HistorySavePath'\n        - 'Set-PSReadlineOption \u2013HistorySaveStyle SaveNothing'\n        - 'Remove-Item (Get-PSReadlineOption).HistorySavePath'\n        - 'rm (Get-PSReadlineOption).HistorySavePath'\n    condition: keywords\nfalsepositives:\n    - some PS-scripts\nlevel: medium\n", "object_marking_refs": ["marking-definition--0a872d70-1d05-45dd-a25f-031af547a102"], "created_by_ref": "identity--082ca4f0-d825-45b6-aa42-ab9afd1e5503", "type": "indicator", "spec_version": "2.1", "id": "indicator--f4a34618-7fee-43d5-bd3a-a092002dffc8", "modified": "2020-04-02T10:14:34.242Z"}