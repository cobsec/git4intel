{"name": "Highly Relevant Renamed Binary", "description": "Detects the execution of a renamed binary often used by attackers or malware leveraging new Sysmon OriginalFileName datapoint.", "created": "2019-06-15T00:00:00.000Z", "valid_from": "2019-06-15T00:00:00Z", "indicator_types": ["malicious-activity"], "pattern_type": "sigma", "pattern": "title: Highly Relevant Renamed Binary\nid: 0ba1da6d-b6ce-4366-828c-18826c9de23e\nstatus: experimental\ndescription: Detects the execution of a renamed binary often used by attackers or malware leveraging new Sysmon OriginalFileName datapoint.\nauthor: Matthew Green - @mgreen27, Florian Roth\ndate: 2019/06/15\nreferences:\n    - https://attack.mitre.org/techniques/T1036/\n    - https://mgreen27.github.io/posts/2019/05/12/BinaryRename.html\n    - https://mgreen27.github.io/posts/2019/05/29/BinaryRename2.html\ntags:\n    - attack.t1036\n    - attack.defense_evasion\nlogsource:\n    category: process_creation\n    product: windows\ndetection:\n    selection:\n        OriginalFileName:\n            - \"powershell.exe\"\n            - \"powershell_ise.exe\"\n            - \"psexec.exe\"\n            - \"psexec.c\"  # old versions of psexec (2016 seen)\n            - \"cscript.exe\"\n            - \"wscript.exe\"\n            - \"mshta.exe\"\n            - \"regsvr32.exe\"\n            - \"wmic.exe\"\n            - \"certutil.exe\"\n            - \"rundll32.exe\"\n            - \"cmstp.exe\"\n            - \"msiexec.exe\"\n    filter:\n        Image:\n            - '*\\powershell.exe'\n            - '*\\powershell_ise.exe'\n            - '*\\psexec.exe'\n            - '*\\psexec64.exe'\n            - '*\\cscript.exe'\n            - '*\\wscript.exe'\n            - '*\\mshta.exe'\n            - '*\\regsvr32.exe'\n            - '*\\wmic.exe'\n            - '*\\certutil.exe'\n            - '*\\rundll32.exe'\n            - '*\\cmstp.exe'\n            - '*\\msiexec.exe'\n    condition: selection and not filter\nfalsepositives:\n    - Custom applications use renamed binaries adding slight change to binary name. Typically this is easy to spot and add to whitelist\nlevel: high\n", "object_marking_refs": ["marking-definition--0a872d70-1d05-45dd-a25f-031af547a102"], "created_by_ref": "identity--082ca4f0-d825-45b6-aa42-ab9afd1e5503", "type": "indicator", "spec_version": "2.1", "id": "indicator--f92fc9cf-75ae-49f2-95fe-fa7bbddaae08", "modified": "2020-04-02T10:14:56.430Z"}