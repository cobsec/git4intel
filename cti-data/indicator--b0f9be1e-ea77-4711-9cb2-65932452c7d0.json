{"name": "Possible DNS Tunneling", "description": "Normally, DNS logs contain a limited amount of different dns queries for a single domain. This rule detects a high amount of queries for a single domain, which can be an indicator that DNS is used to transfer data.", "created": "2019-04-07T00:00:00.000Z", "valid_from": "2019-04-07T00:00:00Z", "indicator_types": ["malicious-activity"], "pattern_type": "sigma", "pattern": "title: Possible DNS Tunneling\nid: 1ec4b281-aa65-46a2-bdae-5fd830ed914e\nstatus: experimental\ndescription: Normally, DNS logs contain a limited amount of different dns queries for a single domain. This rule detects a high amount of queries for a single domain,\n    which can be an indicator that DNS is used to transfer data.\nreferences:\n    - https://zeltser.com/c2-dns-tunneling/\n    - https://patrick-bareiss.com/detect-c2-traffic-over-dns-using-sigma/\nauthor: Patrick Bareiss\ndate: 2019/04/07\nlogsource:\n    category: dns\ndetection:\n    selection:\n        parent_domain: '*'\n    condition: selection | count(dns_query) by parent_domain > 1000\nfalsepositives:\n    - Valid software, which uses dns for transferring data\nlevel: high\ntags:\n    - attack.t1048\n    - attack.exfiltration\n", "object_marking_refs": ["marking-definition--0a872d70-1d05-45dd-a25f-031af547a102"], "created_by_ref": "identity--082ca4f0-d825-45b6-aa42-ab9afd1e5503", "type": "indicator", "spec_version": "2.1", "id": "indicator--b0f9be1e-ea77-4711-9cb2-65932452c7d0", "modified": "2020-04-02T10:14:25.236Z"}