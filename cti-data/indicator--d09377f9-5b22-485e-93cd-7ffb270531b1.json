{"name": "Malicious Named Pipe", "description": "Detects the creation of a named pipe used by known APT malware", "created": "2017-11-06T00:00:00.000Z", "valid_from": "2017-11-06T00:00:00Z", "indicator_types": ["malicious-activity"], "pattern_type": "sigma", "pattern": "title: Malicious Named Pipe\nid: fe3ac066-98bb-432a-b1e7-a5229cb39d4a\nstatus: experimental\ndescription: Detects the creation of a named pipe used by known APT malware\nreferences:\n    - Various sources\ndate: 2017/11/06\nauthor: Florian Roth\nlogsource:\n   product: windows\n   service: sysmon\n   definition: 'Note that you have to configure logging for PipeEvents in Symson config'\ndetection:\n   selection:\n      EventID: \n         - 17\n         - 18\n      PipeName: \n         - '\\isapi_http'  # Uroburos Malware Named Pipe\n         - '\\isapi_dg'  # Uroburos Malware Named Pipe\n         - '\\isapi_dg2'  # Uroburos Malware Named Pipe\n         - '\\sdlrpc'  # Cobra Trojan Named Pipe http://goo.gl/8rOZUX\n         - '\\ahexec'  # Sofacy group malware\n         - '\\winsession'  # Wild Neutron APT malware https://goo.gl/pivRZJ\n         - '\\lsassw'  # Wild Neutron APT malware https://goo.gl/pivRZJ\n         - '\\46a676ab7f179e511e30dd2dc41bd388'  # Project Sauron https://goo.gl/eFoP4A\n         - '\\9f81f59bc58452127884ce513865ed20'  # Project Sauron https://goo.gl/eFoP4A\n         - '\\e710f28d59aa529d6792ca6ff0ca1b34'  # Project Sauron https://goo.gl/eFoP4A\n         - '\\rpchlp_3'  # Project Sauron https://goo.gl/eFoP4A - Technical Analysis Input\n         - '\\NamePipe_MoreWindows'  # Cloud Hopper Annex B https://www.pwc.co.uk/cyber-security/pdf/cloud-hopper-annex-b-final.pdf, US-CERT Alert - RedLeaves https://www.us-cert.gov/ncas/alerts/TA17-117A\n         - '\\pcheap_reuse'  # Pipe used by Equation Group malware 77486bb828dba77099785feda0ca1d4f33ad0d39b672190079c508b3feb21fb0\n         - '\\msagent_*'  # CS default named pipes https://github.com/Neo23x0/sigma/issues/253\n         - '\\gruntsvc' # Covenant default named pipe\n         # - '\\status_*'  # CS default named pipes https://github.com/Neo23x0/sigma/issues/253\n   condition: selection\ntags:\n    - attack.defense_evasion\n    - attack.privilege_escalation\n    - attack.t1055\nfalsepositives:\n   - Unkown\nlevel: critical\n", "object_marking_refs": ["marking-definition--0a872d70-1d05-45dd-a25f-031af547a102"], "created_by_ref": "identity--082ca4f0-d825-45b6-aa42-ab9afd1e5503", "type": "indicator", "spec_version": "2.1", "id": "indicator--d09377f9-5b22-485e-93cd-7ffb270531b1", "modified": "2020-04-02T10:15:03.055Z"}