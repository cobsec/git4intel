{"name": "Suspicious PowerShell Invocation Based on Parent Process", "description": "Detects suspicious powershell invocations from interpreters or unusual programs", "created": "2019-01-16T00:00:00.000Z", "valid_from": "2019-01-16T00:00:00Z", "indicator_types": ["malicious-activity"], "pattern_type": "sigma", "pattern": "title: Suspicious PowerShell Invocation Based on Parent Process\nid: 95eadcb2-92e4-4ed1-9031-92547773a6db\nstatus: experimental\ndescription: Detects suspicious powershell invocations from interpreters or unusual programs\nauthor: Florian Roth\ndate: 2019/01/16\nreferences:\n    - https://www.carbonblack.com/2017/03/15/attackers-leverage-excel-powershell-dns-latest-non-malware-attack/\ntags:\n    - attack.execution\n    - attack.t1086\nlogsource:\n    category: process_creation\n    product: windows\ndetection:\n    selection:\n        ParentImage:\n            - '*\\wscript.exe'\n            - '*\\cscript.exe'\n        Image:\n            - '*\\powershell.exe'\n    falsepositive:\n        CurrentDirectory: '*\\Health Service State\\\\*'\n    condition: selection and not falsepositive\nfields:\n    - CommandLine\n    - ParentCommandLine\nfalsepositives:\n    - Microsoft Operations Manager (MOM)\n    - Other scripts\nlevel: medium\n", "object_marking_refs": ["marking-definition--0a872d70-1d05-45dd-a25f-031af547a102"], "created_by_ref": "identity--082ca4f0-d825-45b6-aa42-ab9afd1e5503", "type": "indicator", "spec_version": "2.1", "id": "indicator--d9d6e1b6-9bfc-4068-bdce-ab2e9481e7bd", "modified": "2020-04-02T10:14:34.862Z"}