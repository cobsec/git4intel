{"name": "Fsutil Suspicious Invocation", "description": "Detects suspicious parameters of fsutil (deleting USN journal, configuring it with small size..). Might be used by ransomwares during the attack (seen by NotPetya and others)", "created": "2019-09-26T00:00:00.000Z", "modified": "2019-11-11T00:00:00.000Z", "valid_from": "2019-09-26T00:00:00Z", "indicator_types": ["malicious-activity"], "pattern_type": "sigma", "pattern": "title: Fsutil Suspicious Invocation\nid: add64136-62e5-48ea-807e-88638d02df1e\ndescription: Detects suspicious parameters of fsutil (deleting USN journal, configuring it with small size..). Might be used by ransomwares during the attack (seen by NotPetya and others)\nauthor: Ecco, E.M. Anhaus, oscd.community\ndate: 2019/09/26\nmodified: 2019/11/11\nlevel: high\nreferences:\n    - https://docs.microsoft.com/en-us/windows-server/administration/windows-commands/fsutil-usn\n    - https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1070/T1070.yaml\n    - https://eqllib.readthedocs.io/en/latest/analytics/c91f422a-5214-4b17-8664-c5fcf115c0a2.html\ntags:\n    - attack.defense_evasion\n    - attack.t1070\nlogsource:\n    category: process_creation\n    product: windows\ndetection:\n    binary_1:\n        Image|endswith: '\\fsutil.exe'\n    binary_2:\n        OriginalFileName: 'fsutil.exe'\n    selection:\n        CommandLine|contains: \n            - 'deletejournal'  # usn deletejournal ==> generally ransomware or attacker\n            - 'createjournal'  # usn createjournal ==> can modify config to set it to a tiny size\n    condition: (1 of binary_*) and selection\nfalsepositives:\n    - Admin activity\n    - Scripts and administrative tools used in the monitored environment\n", "object_marking_refs": ["marking-definition--0a872d70-1d05-45dd-a25f-031af547a102"], "created_by_ref": "identity--082ca4f0-d825-45b6-aa42-ab9afd1e5503", "type": "indicator", "spec_version": "2.1", "id": "indicator--56aeef27-d82b-4284-b750-dcaf4a841e7b"}