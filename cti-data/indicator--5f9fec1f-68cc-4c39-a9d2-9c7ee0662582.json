{"name": "Suspicious ADSI-Cache Usage By Unknown Tool", "description": "detects the usage of ADSI (LDAP) operations by tools. This may also detect tools like LDAPFragger.", "created": "2019-03-24T00:00:00.000Z", "valid_from": "2019-03-24T00:00:00Z", "indicator_types": ["malicious-activity"], "pattern_type": "sigma", "pattern": "title: Suspicious ADSI-Cache Usage By Unknown Tool\nid: 75bf09fa-1dd7-4d18-9af9-dd9e492562eb\ndescription: detects the usage of ADSI (LDAP) operations by tools. This may also detect tools like LDAPFragger.\nstatus: experimental\ndate: 2019/03/24\nauthor: xknow @xknow_infosec\nreferences:\n    - https://medium.com/@ivecodoe/detecting-ldapfragger-a-newly-released-cobalt-strike-beacon-using-ldap-for-c2-communication-c274a7f00961\n    - https://blog.fox-it.com/2020/03/19/ldapfragger-command-and-control-over-ldap-attributes/\n    - https://github.com/fox-it/LDAPFragger\ntags:\n    - attack.t1041\n    - attack.persistence\nlogsource:\n    product: windows\n    service: sysmon\ndetection:\n    selection_1:\n        EventID: 11\n        TargetFilename: '*\\Local\\Microsoft\\Windows\\SchCache\\*.sch'\n    selection_2:\n        Image|contains:\n            - 'C:\\windows\\system32\\svchost.exe'\n            - 'C:\\windows\\system32\\dllhost.exe'\n            - 'C:\\windows\\system32\\mmc.exe'\n            - 'C:\\windows\\system32\\WindowsPowerShell\\v1.0\\powershell.exe'\n    condition: selection_1 and not selection_2\nfalsepositives:\n    - Other legimate tools, which do ADSI (LDAP) operations, e.g. any remoting activity by MMC, Powershell, Windows etc.\nlevel: high\n", "object_marking_refs": ["marking-definition--0a872d70-1d05-45dd-a25f-031af547a102"], "created_by_ref": "identity--082ca4f0-d825-45b6-aa42-ab9afd1e5503", "type": "indicator", "spec_version": "2.1", "id": "indicator--5f9fec1f-68cc-4c39-a9d2-9c7ee0662582", "modified": "2020-04-02T10:15:05.410Z"}