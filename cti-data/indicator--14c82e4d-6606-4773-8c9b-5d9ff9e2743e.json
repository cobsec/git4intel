{"name": "Credentials Dumping Tools Accessing LSASS Memory", "description": "Detects process access LSASS memory which is typical for credentials dumping tools", "created": "2017-02-16T00:00:00.000Z", "modified": "2019-11-08T00:00:00.000Z", "valid_from": "2017-02-16T00:00:00Z", "indicator_types": ["malicious-activity"], "pattern_type": "sigma", "pattern": "title: Credentials Dumping Tools Accessing LSASS Memory\nid: 32d0d3e2-e58d-4d41-926b-18b520b2b32d\nstatus: experimental\ndescription: Detects process access LSASS memory which is typical for credentials dumping tools\nauthor: Florian Roth, Roberto Rodriguez, Dimitrios Slamaris, Mark Russinovich, Thomas Patzke, Teymur Kheirkhabarov, Sherif Eldeeb, James Dickenson, Aleksey Potapov,\n    oscd.community (update)\ndate: 2017/02/16\nmodified: 2019/11/08\nreferences:\n    - https://onedrive.live.com/view.aspx?resid=D026B4699190F1E6!2843&ithint=file%2cpptx&app=PowerPoint&authkey=!AMvCRTKB_V1J5ow\n    - https://cyberwardog.blogspot.com/2017/03/chronicles-of-threat-hunter-hunting-for_22.html\n    - https://www.slideshare.net/heirhabarov/hunting-for-credentials-dumping-in-windows-environment\n    - http://security-research.dyndns.org/pub/slides/FIRST2017/FIRST-2017_Tom-Ueltschi_Sysmon_FINAL_notes.pdf\ntags:\n    - attack.t1003\n    - attack.s0002\n    - attack.credential_access\n    - car.2019-04-004\nlogsource:\n    product: windows\n    service: sysmon\ndetection:\n    selection:\n        EventID: 10\n        TargetImage|endswith: '\\lsass.exe'\n        GrantedAccess|contains:\n            - '0x40'\n            - '0x1000'\n            - '0x1400'\n            - '0x100000'\n            - '0x1410'    # car.2019-04-004\n            - '0x1010'    # car.2019-04-004\n            - '0x1438'    # car.2019-04-004\n            - '0x143a'    # car.2019-04-004\n            - '0x1418'    # car.2019-04-004\n            - '0x1f0fff'\n            - '0x1f1fff'\n            - '0x1f2fff'\n            - '0x1f3fff'\n    filter:\n        ProcessName|endswith: # easy to bypass. need to implement supportive rule to detect bypass attempts\n            - '\\wmiprvse.exe'\n            - '\\taskmgr.exe'\n            - '\\procexp64.exe'\n            - '\\procexp.exe'\n            - '\\lsm.exe'\n            - '\\csrss.exe'\n            - '\\wininit.exe'\n            - '\\vmtoolsd.exe'\n    condition: selection and not filter\nfields:\n    - ComputerName\n    - User\n    - SourceImage\nfalsepositives:\n    - Legitimate software accessing LSASS process for legitimate reason; update the whitelist with it\nlevel: high\n", "object_marking_refs": ["marking-definition--0a872d70-1d05-45dd-a25f-031af547a102"], "created_by_ref": "identity--082ca4f0-d825-45b6-aa42-ab9afd1e5503", "type": "indicator", "spec_version": "2.1", "id": "indicator--14c82e4d-6606-4773-8c9b-5d9ff9e2743e"}