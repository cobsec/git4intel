{"type": "bundle", "id": "bundle--9d0a52cb-d044-4f62-a60f-3a1f89c058a1", "objects": [{"created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5", "name": "Cobalt Group", "description": "[Cobalt Group](https://attack.mitre.org/groups/G0080) is a financially motivated threat group that has primarily targeted financial institutions. The group has conducted intrusions to steal money via targeting ATM systems, card processing, payment systems and SWIFT systems. [Cobalt Group](https://attack.mitre.org/groups/G0080) has mainly targeted banks in Eastern Europe, Central Asia, and Southeast Asia. One of the alleged leaders was arrested in Spain in early 2018, but the group still appears to be active. The group has been known to target organizations in order to use their access to then compromise additional victims. (Citation: Talos Cobalt Group July 2018) (Citation: PTSecurity Cobalt Group Aug 2017) (Citation: PTSecurity Cobalt Dec 2016) (Citation: Group IB Cobalt Aug 2017) (Citation: Proofpoint Cobalt June 2017) (Citation: RiskIQ Cobalt Nov 2017) (Citation: RiskIQ Cobalt Jan 2018) Reporting indicates there may be links between [Cobalt Group](https://attack.mitre.org/groups/G0080) and both the malware [Carbanak](https://attack.mitre.org/software/S0030) and the group [Carbanak](https://attack.mitre.org/groups/G0008). (Citation: Europol Cobalt Mar 2018)", "type": "intrusion-set", "aliases": ["Cobalt Group", "Cobalt Gang", "Cobalt Spider"], "object_marking_refs": ["marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"], "id": "intrusion-set--dc6fe6ee-04c2-49be-ba3d-f38d2463c02a", "external_references": [{"external_id": "G0080", "source_name": "mitre-attack", "url": "https://attack.mitre.org/groups/G0080"}, {"source_name": "Cobalt Group", "description": "(Citation: Talos Cobalt Group July 2018) (Citation: PTSecurity Cobalt Group Aug 2017) (Citation: PTSecurity Cobalt Dec 2016) (Citation: Proofpoint Cobalt June 2017) (Citation: RiskIQ Cobalt Nov 2017) (Citation: RiskIQ Cobalt Jan 2018)"}, {"source_name": "Cobalt Gang", "description": "(Citation: Talos Cobalt Group July 2018) (Citation: Crowdstrike Global Threat Report Feb 2018)(Citation: Morphisec Cobalt Gang Oct 2018)"}, {"source_name": "Cobalt Spider", "description": "(Citation: Crowdstrike Global Threat Report Feb 2018)"}, {"source_name": "Talos Cobalt Group July 2018", "description": "Svajcer, V. (2018, July 31). Multiple Cobalt Personality Disorder. Retrieved September 5, 2018.", "url": "https://blog.talosintelligence.com/2018/07/multiple-cobalt-personality-disorder.html"}, {"source_name": "PTSecurity Cobalt Group Aug 2017", "description": "Positive Technologies. (2017, August 16). Cobalt Strikes Back: An Evolving Multinational Threat to Finance. Retrieved September 5, 2018.", "url": "https://www.ptsecurity.com/upload/corporate/ww-en/analytics/Cobalt-2017-eng.pdf"}, {"source_name": "PTSecurity Cobalt Dec 2016", "description": "Positive Technologies. (2016, December 16). Cobalt Snatch. Retrieved October 9, 2018.", "url": "https://www.ptsecurity.com/upload/corporate/ww-en/analytics/Cobalt-Snatch-eng.pdf"}, {"source_name": "Group IB Cobalt Aug 2017", "description": "Matveeva, V. (2017, August 15). Secrets of Cobalt. Retrieved October 10, 2018.", "url": "https://www.group-ib.com/blog/cobalt"}, {"source_name": "Proofpoint Cobalt June 2017", "description": "Mesa, M, et al. (2017, June 1). Microsoft Word Intruder Integrates CVE-2017-0199, Utilized by Cobalt Group to Target Financial Institutions. Retrieved October 10, 2018.", "url": "https://www.proofpoint.com/us/threat-insight/post/microsoft-word-intruder-integrates-cve-2017-0199-utilized-cobalt-group-target"}, {"source_name": "RiskIQ Cobalt Nov 2017", "description": "Klijnsma, Y.. (2017, November 28). Gaffe Reveals Full List of Targets in Spear Phishing Attack Using Cobalt Strike Against Financial Institutions. Retrieved October 10, 2018.", "url": "https://www.riskiq.com/blog/labs/cobalt-strike/"}, {"source_name": "RiskIQ Cobalt Jan 2018", "description": "Klijnsma, Y.. (2018, January 16). First Activities of Cobalt Group in 2018: Spear Phishing Russian Banks. Retrieved October 10, 2018.", "url": "https://www.riskiq.com/blog/labs/cobalt-group-spear-phishing-russian-banks/"}, {"source_name": "Europol Cobalt Mar 2018", "description": "Europol. (2018, March 26). Mastermind Behind EUR 1 Billion Cyber Bank Robbery Arrested in Spain. Retrieved October 10, 2018.", "url": "https://www.europol.europa.eu/newsroom/news/mastermind-behind-eur-1-billion-cyber-bank-robbery-arrested-in-spain"}, {"source_name": "Crowdstrike Global Threat Report Feb 2018", "description": "CrowdStrike. (2018, February 26). CrowdStrike 2018 Global Threat Report. Retrieved October 10, 2018.", "url": "https://crowdstrike.lookbookhq.com/global-threat-report-2018-web/cs-2018-global-threat-report"}, {"source_name": "Morphisec Cobalt Gang Oct 2018", "description": "Gorelik, M. (2018, October 08). Cobalt Group 2.0. Retrieved November 5, 2018.", "url": "https://blog.morphisec.com/cobalt-gang-2.0"}], "modified": "2019-07-26T23:38:32.356Z", "created": "2018-10-17T00:14:20.652Z", "x_mitre_version": "1.1"}, {"created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5", "description": "[APT19](https://attack.mitre.org/groups/G0073) is a Chinese-based threat group that has targeted a variety of industries, including defense, finance, energy, pharmaceutical, telecommunications, high tech, education, manufacturing, and legal services. In 2017, a phishing campaign was used to target seven law and investment firms. (Citation: FireEye APT19) Some analysts track [APT19](https://attack.mitre.org/groups/G0073) and [Deep Panda](https://attack.mitre.org/groups/G0009) as the same group, but it is unclear from open source information if the groups are the same. (Citation: ICIT China's Espionage Jul 2016) (Citation: FireEye APT Groups) (Citation: Unit 42 C0d0so0 Jan 2016)", "aliases": ["APT19", "Codoso", "C0d0so0", "Codoso Team", "Sunshop Group"], "id": "intrusion-set--fe8796a4-2a02-41a0-9d27-7aa1e995feb6", "external_references": [{"external_id": "G0073", "source_name": "mitre-attack", "url": "https://attack.mitre.org/groups/G0073"}, {"source_name": "APT19", "description": "(Citation: FireEye APT19)"}, {"source_name": "Codoso", "description": "(Citation: Unit 42 C0d0so0 Jan 2016)"}, {"source_name": "C0d0so0", "description": "(Citation: Unit 42 C0d0so0 Jan 2016)"}, {"source_name": "Codoso Team", "description": "(Citation: FireEye APT Groups)"}, {"source_name": "Sunshop Group", "description": "(Citation: Dark Reading Codoso Feb 2015)"}, {"source_name": "FireEye APT19", "description": "Ahl, I. (2017, June 06). Privileges and Credentials: Phished at the Request of Counsel. Retrieved May 17, 2018.", "url": "https://www.fireeye.com/blog/threat-research/2017/06/phished-at-the-request-of-counsel.html"}, {"source_name": "ICIT China's Espionage Jul 2016", "description": "Scott, J. and Spaniel, D. (2016, July 28). ICIT Brief - China\u2019s Espionage Dynasty: Economic Death by a Thousand Cuts. Retrieved June 7, 2018.", "url": "https://icitech.org/icit-brief-chinas-espionage-dynasty-economic-death-by-a-thousand-cuts/"}, {"source_name": "FireEye APT Groups", "description": "FireEye. (n.d.). Advanced Persistent Threat Groups. Retrieved August 3, 2018.", "url": "https://www.fireeye.com/current-threats/apt-groups.html#apt19"}, {"source_name": "Unit 42 C0d0so0 Jan 2016", "description": "Grunzweig, J., Lee, B. (2016, January 22). New Attacks Linked to C0d0so0 Group. Retrieved August 2, 2018.", "url": "https://researchcenter.paloaltonetworks.com/2016/01/new-attacks-linked-to-c0d0s0-group/"}, {"source_name": "Dark Reading Codoso Feb 2015", "description": "Chickowski, E. (2015, February 10). Chinese Hacking Group Codoso Team Uses Forbes.com As Watering Hole. Retrieved September 13, 2018.", "url": "https://www.darkreading.com/attacks-breaches/chinese-hacking-group-codoso-team-uses-forbescom-as-watering-hole-/d/d-id/1319059"}], "modified": "2019-04-25T11:39:51.802Z", "type": "intrusion-set", "created": "2018-10-17T00:14:20.652Z", "object_marking_refs": ["marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"], "name": "APT19", "x_mitre_version": "1.1", "x_mitre_contributors": ["FS-ISAC", "Darren Spruell"]}, {"created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5", "name": "DarkHydrus", "description": "[DarkHydrus](https://attack.mitre.org/groups/G0079) is a threat group that has targeted government agencies and educational institutions in the Middle East since at least 2016. The group heavily leverages open-source tools and custom payloads for carrying out attacks. (Citation: Unit 42 DarkHydrus July 2018) (Citation: Unit 42 Playbook Dec 2017)", "type": "intrusion-set", "aliases": ["DarkHydrus"], "object_marking_refs": ["marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"], "id": "intrusion-set--6b9ebeb5-20bf-48b0-afb7-988d769a2f01", "external_references": [{"external_id": "G0079", "source_name": "mitre-attack", "url": "https://attack.mitre.org/groups/G0079"}, {"source_name": "DarkHydrus", "description": "(Citation: Unit 42 DarkHydrus July 2018)"}, {"source_name": "Unit 42 DarkHydrus July 2018", "description": "Falcone, R., et al. (2018, July 27). New Threat Actor Group DarkHydrus Targets Middle East Government. Retrieved August 2, 2018.", "url": "https://researchcenter.paloaltonetworks.com/2018/07/unit42-new-threat-actor-group-darkhydrus-targets-middle-east-government/"}, {"source_name": "Unit 42 Playbook Dec 2017", "description": "Unit 42. (2017, December 15). Unit 42 Playbook Viewer. Retrieved December 20, 2017.", "url": "https://pan-unit42.github.io/playbook_viewer/"}], "modified": "2019-04-22T19:23:13.144Z", "created": "2018-10-17T00:14:20.652Z", "x_mitre_version": "1.0"}, {"created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5", "description": "[Leviathan](https://attack.mitre.org/groups/G0065) is a cyber espionage group that has been active since at least 2013. The group generally targets defense and government organizations, but has also targeted a range of industries including engineering firms, shipping and transportation, manufacturing, defense, government offices, and research universities in the United States, Western Europe, and along the South China Sea. (Citation: Proofpoint Leviathan Oct 2017) (Citation: FireEye Periscope March 2018)", "aliases": ["Leviathan", "TEMP.Jumper", "APT40", "TEMP.Periscope"], "id": "intrusion-set--7113eaa5-ba79-4fb3-b68a-398ee9cd698e", "external_references": [{"external_id": "G0065", "source_name": "mitre-attack", "url": "https://attack.mitre.org/groups/G0065"}, {"source_name": "Leviathan", "description": "(Citation: Proofpoint Leviathan Oct 2017)"}, {"source_name": "TEMP.Jumper", "description": "Leviathan was previously reported upon by FireEye as TEMP.Periscope and TEMP.Jumper.(Citation: FireEye APT40 March 2019)"}, {"source_name": "APT40", "description": "The group identified by Proofpoint as Leviathan appears to significantly overlap with FireEye's reporting on APT40. Additionally, FireEye reporting on TEMP.Periscope (which was combined into APT40) indicated TEMP.Periscope was reported upon as Leviathan.(Citation: FireEye Periscope March 2018)(Citation: FireEye APT40 March 2019)(Citation: Proofpoint Leviathan Oct 2017)"}, {"source_name": "TEMP.Periscope", "description": "Leviathan was previously reported upon by FireEye as TEMP.Periscope and TEMP.Jumper.(Citation: FireEye Periscope March 2018)(Citation: FireEye APT40 March 2019)"}, {"source_name": "Proofpoint Leviathan Oct 2017", "description": "Axel F, Pierre T. (2017, October 16). Leviathan: Espionage actor spearphishes maritime and defense targets. Retrieved February 15, 2018.", "url": "https://www.proofpoint.com/us/threat-insight/post/leviathan-espionage-actor-spearphishes-maritime-and-defense-targets"}, {"source_name": "FireEye Periscope March 2018", "description": "FireEye. (2018, March 16). Suspected Chinese Cyber Espionage Group (TEMP.Periscope) Targeting U.S. Engineering and Maritime Industries. Retrieved April 11, 2018.", "url": "https://www.fireeye.com/blog/threat-research/2018/03/suspected-chinese-espionage-group-targeting-maritime-and-engineering-industries.html"}, {"source_name": "FireEye APT40 March 2019", "description": "Plan, F., et all. (2019, March 4). APT40: Examining a China-Nexus Espionage Actor. Retrieved March 18, 2019.", "url": "https://www.fireeye.com/blog/threat-research/2019/03/apt40-examining-a-china-nexus-espionage-actor.html"}], "modified": "2019-04-25T12:24:56.934Z", "type": "intrusion-set", "created": "2018-04-18T17:59:24.739Z", "object_marking_refs": ["marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"], "name": "Leviathan", "x_mitre_version": "2.0", "x_mitre_contributors": ["Valerii Marchuk, Cybersecurity Help s.r.o."]}, {"created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5", "name": "CopyKittens", "description": "[CopyKittens](https://attack.mitre.org/groups/G0052) is an Iranian cyber espionage group that has been operating since at least 2013. It has targeted countries including Israel, Saudi Arabia, Turkey, the U.S., Jordan, and Germany. The group is responsible for the campaign known as Operation Wilted Tulip. (Citation: ClearSky CopyKittens March 2017) (Citation: ClearSky Wilted Tulip July 2017) (Citation: CopyKittens Nov 2015)", "type": "intrusion-set", "aliases": ["CopyKittens"], "object_marking_refs": ["marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"], "id": "intrusion-set--dcd81c6e-ebf7-4a16-93e0-9a97fa49c88a", "external_references": [{"external_id": "G0052", "source_name": "mitre-attack", "url": "https://attack.mitre.org/groups/G0052"}, {"source_name": "CopyKittens", "description": "(Citation: ClearSky CopyKittens March 2017) (Citation: ClearSky Wilted Tulip July 2017) (Citation: CopyKittens Nov 2015)"}, {"source_name": "ClearSky CopyKittens March 2017", "description": "ClearSky Cyber Security. (2017, March 30). Jerusalem Post and other Israeli websites compromised by Iranian threat agent CopyKitten. Retrieved August 21, 2017.", "url": "http://www.clearskysec.com/copykitten-jpost/"}, {"source_name": "ClearSky Wilted Tulip July 2017", "description": "ClearSky Cyber Security and Trend Micro. (2017, July). Operation Wilted Tulip: Exposing a cyber espionage apparatus. Retrieved August 21, 2017.", "url": "http://www.clearskysec.com/wp-content/uploads/2017/07/Operation_Wilted_Tulip.pdf"}, {"source_name": "CopyKittens Nov 2015", "description": "Minerva Labs LTD and ClearSky Cyber Security. (2015, November 23). CopyKittens Attack Group. Retrieved September 11, 2017.", "url": "https://s3-eu-west-1.amazonaws.com/minervaresearchpublic/CopyKittens/CopyKittens.pdf"}], "modified": "2019-05-03T16:42:19.026Z", "created": "2018-01-16T16:13:52.465Z", "x_mitre_version": "1.1"}, {"created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5", "description": "[APT32](https://attack.mitre.org/groups/G0050) is a threat group that has been active since at least 2014. The group has targeted multiple private sector industries as well as with foreign governments, dissidents, and journalists with a strong focus on Southeast Asian countries like Vietnam, the Philippines, Laos, and Cambodia. They have extensively used strategic web compromises to compromise victims. The group is believed to be Vietnam-based. (Citation: FireEye APT32 May 2017) (Citation: Volexity OceanLotus Nov 2017) (Citation: ESET OceanLotus)", "aliases": ["APT32", "SeaLotus", "OceanLotus", "APT-C-00"], "id": "intrusion-set--247cb30b-955f-42eb-97a5-a89fef69341e", "external_references": [{"external_id": "G0050", "source_name": "mitre-attack", "url": "https://attack.mitre.org/groups/G0050"}, {"source_name": "APT32", "description": "(Citation: FireEye APT32 May 2017) (Citation: Volexity OceanLotus Nov 2017)(Citation: Cybereason Oceanlotus May 2017)"}, {"source_name": "SeaLotus", "description": "(Citation: Cybereason Oceanlotus May 2017)"}, {"source_name": "OceanLotus", "description": "(Citation: FireEye APT32 May 2017) (Citation: Volexity OceanLotus Nov 2017)(Citation: Cybereason Oceanlotus May 2017)"}, {"source_name": "APT-C-00", "description": "(Citation: ESET OceanLotus)(Citation: Cybereason Oceanlotus May 2017)"}, {"source_name": "FireEye APT32 May 2017", "description": "Carr, N.. (2017, May 14). Cyber Espionage is Alive and Well: APT32 and the Threat to Global Corporations. Retrieved June 18, 2017.", "url": "https://www.fireeye.com/blog/threat-research/2017/05/cyber-espionage-apt32.html"}, {"source_name": "Volexity OceanLotus Nov 2017", "description": "Lassalle, D., et al. (2017, November 6). OceanLotus Blossoms: Mass Digital Surveillance and Attacks Targeting ASEAN, Asian Nations, the Media, Human Rights Groups, and Civil Society. Retrieved November 6, 2017.", "url": "https://www.volexity.com/blog/2017/11/06/oceanlotus-blossoms-mass-digital-surveillance-and-exploitation-of-asean-nations-the-media-human-rights-and-civil-society/"}, {"source_name": "ESET OceanLotus", "description": "Folt\u00fdn, T. (2018, March 13). OceanLotus ships new backdoor using old tricks. Retrieved May 22, 2018.", "url": "https://www.welivesecurity.com/2018/03/13/oceanlotus-ships-new-backdoor/"}, {"source_name": "Cybereason Oceanlotus May 2017", "description": "Dahan, A. (2017, May 24). OPERATION COBALT KITTY: A LARGE-SCALE APT IN ASIA CARRIED OUT BY THE OCEANLOTUS GROUP. Retrieved November 5, 2018.", "url": "https://www.cybereason.com/blog/operation-cobalt-kitty-apt"}], "modified": "2019-07-17T13:11:37.402Z", "type": "intrusion-set", "created": "2017-12-14T16:46:06.044Z", "object_marking_refs": ["marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"], "name": "APT32", "x_mitre_version": "2.0", "x_mitre_contributors": ["Romain Dumont, ESET"]}, {"created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5", "name": "FIN6", "description": "[FIN6](https://attack.mitre.org/groups/G0037) is a cyber crime group that has stolen payment card data and sold it for profit on underground marketplaces. This group has aggressively targeted and compromised point of sale (PoS) systems in the hospitality and retail sectors.(Citation: FireEye FIN6 April 2016)(Citation: FireEye FIN6 Apr 2019)", "type": "intrusion-set", "aliases": ["FIN6"], "object_marking_refs": ["marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"], "id": "intrusion-set--2a7914cf-dff3-428d-ab0f-1014d1c28aeb", "external_references": [{"external_id": "G0037", "source_name": "mitre-attack", "url": "https://attack.mitre.org/groups/G0037"}, {"source_name": "FIN6", "description": "(Citation: FireEye FIN6 April 2016)"}, {"source_name": "FireEye FIN6 April 2016", "description": "FireEye Threat Intelligence. (2016, April). Follow the Money: Dissecting the Operations of the Cyber Crime Group FIN6. Retrieved June 1, 2016.", "url": "https://www2.fireeye.com/rs/848-DID-242/images/rpt-fin6.pdf"}, {"source_name": "FireEye FIN6 Apr 2019", "description": "McKeague, B. et al. (2019, April 5). Pick-Six: Intercepting a FIN6 Intrusion, an Actor Recently Tied to Ryuk and LockerGoga Ransomware. Retrieved April 17, 2019.", "url": "https://www.fireeye.com/blog/threat-research/2019/04/pick-six-intercepting-a-fin6-intrusion.html"}], "modified": "2019-06-28T14:59:17.367Z", "created": "2017-05-31T21:32:06.015Z", "x_mitre_version": "1.1"}, {"created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5", "name": "APT29", "description": "[APT29](https://attack.mitre.org/groups/G0016) is threat group that has been attributed to the Russian government and has operated since at least 2008. (Citation: F-Secure The Dukes) (Citation: GRIZZLY STEPPE JAR) This group reportedly compromised the Democratic National Committee starting in the summer of 2015. (Citation: Crowdstrike DNC June 2016)", "type": "intrusion-set", "aliases": ["APT29", "YTTRIUM", "The Dukes", "Cozy Bear", "CozyDuke"], "object_marking_refs": ["marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"], "id": "intrusion-set--899ce53f-13a0-479b-a0e4-67d46e241542", "external_references": [{"external_id": "G0016", "source_name": "mitre-attack", "url": "https://attack.mitre.org/groups/G0016"}, {"source_name": "APT29", "description": "(Citation: F-Secure The Dukes)(Citation: FireEye APT29 Nov 2018)"}, {"source_name": "YTTRIUM", "description": "(Citation: Microsoft Unidentified Dec 2018)"}, {"source_name": "The Dukes", "description": "(Citation: F-Secure The Dukes)"}, {"source_name": "Cozy Bear", "description": "(Citation: Crowdstrike DNC June 2016)"}, {"source_name": "CozyDuke", "description": "(Citation: Crowdstrike DNC June 2016)"}, {"source_name": "F-Secure The Dukes", "description": "F-Secure Labs. (2015, September 17). The Dukes: 7 years of Russian cyberespionage. Retrieved December 10, 2015.", "url": "https://www.f-secure.com/documents/996508/1030745/dukes_whitepaper.pdf"}, {"source_name": "GRIZZLY STEPPE JAR", "description": "Department of Homeland Security and Federal Bureau of Investigation. (2016, December 29). GRIZZLY STEPPE \u2013 Russian Malicious Cyber Activity. Retrieved January 11, 2017.", "url": "https://www.us-cert.gov/sites/default/files/publications/JAR_16-20296A_GRIZZLY%20STEPPE-2016-1229.pdf"}, {"source_name": "Crowdstrike DNC June 2016", "description": "Alperovitch, D.. (2016, June 15). Bears in the Midst: Intrusion into the Democratic National Committee. Retrieved August 3, 2016.", "url": "https://www.crowdstrike.com/blog/bears-midst-intrusion-democratic-national-committee/"}, {"source_name": "FireEye APT29 Nov 2018", "description": "Dunwoody, M., et al. (2018, November 19). Not So Cozy: An Uncomfortable Examination of a Suspected APT29 Phishing Campaign. Retrieved November 27, 2018.", "url": "https://www.fireeye.com/blog/threat-research/2018/11/not-so-cozy-an-uncomfortable-examination-of-a-suspected-apt29-phishing-campaign.html"}, {"source_name": "Microsoft Unidentified Dec 2018", "description": "Microsoft Defender Research Team. (2018, December 3). Analysis of cyberattack on U.S. think tanks, non-profits, public sector by unidentified attackers. Retrieved April 15, 2019.", "url": "https://www.microsoft.com/security/blog/2018/12/03/analysis-of-cyberattack-on-u-s-think-tanks-non-profits-public-sector-by-unidentified-attackers/"}], "modified": "2019-07-25T14:25:52.859Z", "created": "2017-05-31T21:31:52.748Z", "x_mitre_version": "1.2"}, {"created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5", "description": "Configure Windows User Account Control to mitigate risk of adversaries obtaining elevated process access.", "type": "course-of-action", "id": "course-of-action--2c2ad92a-d710-41ab-a996-1db143bb4808", "object_marking_refs": ["marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"], "name": "User Account Control", "external_references": [{"external_id": "M1052", "source_name": "mitre-attack", "url": "https://attack.mitre.org/mitigations/M1052"}], "modified": "2019-06-11T17:14:35.170Z", "created": "2019-06-11T17:14:35.170Z", "x_mitre_version": "1.0"}, {"created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5", "description": "Perform regular software updates to mitigate exploitation risk.", "type": "course-of-action", "name": "Update Software", "object_marking_refs": ["marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"], "id": "course-of-action--e5d930e9-775a-40ad-9bdb-b941d8dfe86b", "external_references": [{"external_id": "M1051", "source_name": "mitre-attack", "url": "https://attack.mitre.org/mitigations/M1051"}], "modified": "2019-06-11T17:12:55.207Z", "created": "2019-06-11T17:12:55.207Z", "x_mitre_version": "1.0"}, {"created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5", "description": "Use capabilities to detect and block conditions that may lead to or be indicative of a software exploit occurring.", "type": "course-of-action", "name": "Exploit Protection", "object_marking_refs": ["marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"], "id": "course-of-action--d2a24649-9694-4c97-9c62-ce7b270bf6a3", "external_references": [{"external_id": "M1050", "source_name": "mitre-attack", "url": "https://attack.mitre.org/mitigations/M1050"}], "modified": "2019-06-11T17:10:57.070Z", "created": "2019-06-11T17:10:57.070Z", "x_mitre_version": "1.0"}, {"created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5", "description": "Restrict execution of code to a virtual environment on or in transit to an endpoint system.", "type": "course-of-action", "id": "course-of-action--b9f0c069-abbe-4a07-a245-2481219a1463", "object_marking_refs": ["marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"], "name": "Application Isolation and Sandboxing", "external_references": [{"external_id": "M1048", "source_name": "mitre-attack", "url": "https://attack.mitre.org/mitigations/M1048"}], "modified": "2019-06-11T17:06:56.230Z", "created": "2019-06-11T17:06:56.230Z", "x_mitre_version": "1.0"}, {"created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5", "description": "Perform audits or scans of systems, permissions, insecure software, insecure configurations, etc. to identify potential weaknesses.", "type": "course-of-action", "name": "Audit", "object_marking_refs": ["marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"], "id": "course-of-action--cc2399fd-3cd3-4319-8d0a-fbd6420cdaf8", "external_references": [{"external_id": "M1047", "source_name": "mitre-attack", "url": "https://attack.mitre.org/mitigations/M1047"}], "modified": "2019-06-11T17:06:14.029Z", "created": "2019-06-11T17:06:14.029Z", "x_mitre_version": "1.0"}, {"created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5", "description": "Enforce binary and application integrity with digital signature verification to prevent untrusted code from executing.", "type": "course-of-action", "id": "course-of-action--590777b3-b475-4c7c-aaf8-f4a73b140312", "object_marking_refs": ["marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"], "name": "Code Signing", "external_references": [{"external_id": "M1045", "source_name": "mitre-attack", "url": "https://attack.mitre.org/mitigations/M1045"}], "modified": "2019-06-11T17:01:25.405Z", "created": "2019-06-11T17:01:25.405Z", "x_mitre_version": "1.0"}, {"created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5", "description": "Use capabilities to prevent successful credential access by adversaries; including blocking forms of credential dumping.", "type": "course-of-action", "name": "Credential Access Protection", "object_marking_refs": ["marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"], "id": "course-of-action--49c06d54-9002-491d-9147-8efb537fbd26", "external_references": [{"external_id": "M1043", "source_name": "mitre-attack", "url": "https://attack.mitre.org/mitigations/M1043"}], "modified": "2019-06-11T16:47:12.860Z", "created": "2019-06-11T16:47:12.859Z", "x_mitre_version": "1.0"}, {"created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5", "description": "Remove or deny access to unnecessary and potentially vulnerable software to prevent abuse by adversaries.", "type": "course-of-action", "name": "Disable or Remove Feature or Program", "object_marking_refs": ["marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"], "id": "course-of-action--eb88d97c-32f1-40be-80f0-d61a4b0b4b31", "external_references": [{"external_id": "M1042", "source_name": "mitre-attack", "url": "https://attack.mitre.org/mitigations/M1042"}], "modified": "2019-06-11T16:45:19.740Z", "created": "2019-06-11T16:45:19.740Z", "x_mitre_version": "1.0"}, {"created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5", "description": "Use capabilities to prevent suspicious behavior patterns from occurring on endpoint systems. This could include suspicious process, file, API call, etc. behavior.", "type": "course-of-action", "id": "course-of-action--90f39ee1-d5a3-4aaa-9f28-3b42815b0d46", "object_marking_refs": ["marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"], "name": "Behavior Prevention on Endpoint", "external_references": [{"external_id": "M1040", "source_name": "mitre-attack", "url": "https://attack.mitre.org/mitigations/M1040"}], "modified": "2019-06-11T16:43:05.712Z", "created": "2019-06-11T16:43:05.712Z", "x_mitre_version": "1.0"}, {"created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5", "description": "Block execution of code on a system through application whitelisting, blacklisting, and/or script blocking.", "type": "course-of-action", "id": "course-of-action--47e0e9fe-96ce-4f65-8bb1-8be1feacb5db", "object_marking_refs": ["marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"], "name": "Execution Prevention", "external_references": [{"external_id": "M1038", "source_name": "mitre-attack", "url": "https://attack.mitre.org/mitigations/M1038"}], "modified": "2019-06-11T16:35:25.488Z", "created": "2019-06-11T16:35:25.488Z", "x_mitre_version": "1.0"}, {"created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5", "description": "Use network appliances to filter ingress or egress traffic and perform protocol-based filtering.", "type": "course-of-action", "name": "Filter Network Traffic", "object_marking_refs": ["marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"], "id": "course-of-action--20f6a9df-37c4-4e20-9e47-025983b1b39d", "external_references": [{"external_id": "M1037", "source_name": "mitre-attack", "url": "https://attack.mitre.org/mitigations/M1037"}], "modified": "2019-06-11T16:33:55.337Z", "created": "2019-06-11T16:33:55.337Z", "x_mitre_version": "1.0"}, {"created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5", "description": "Prevent access to file shares, remote access to systems, unnecessary services. Mechanisms to limit access may include use of network concentrators, RDP gateways, etc.", "type": "course-of-action", "id": "course-of-action--1dcaeb21-9348-42ea-950a-f842aaf1ae1f", "object_marking_refs": ["marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"], "name": "Limit Access to Resource Over Network", "external_references": [{"external_id": "M1035", "source_name": "mitre-attack", "url": "https://attack.mitre.org/mitigations/M1035"}], "modified": "2019-06-11T16:30:16.672Z", "created": "2019-06-11T16:30:16.672Z", "x_mitre_version": "1.0"}, {"created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5", "description": "Use two or more pieces of evidence to authenticate to a system; such as username and password in addition to a token from a physical smart card or token generator.", "type": "course-of-action", "name": "Multi-factor Authentication", "object_marking_refs": ["marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"], "id": "course-of-action--b045d015-6bed-4490-bd38-56b41ece59a0", "external_references": [{"external_id": "M1032", "source_name": "mitre-attack", "url": "https://attack.mitre.org/mitigations/M1032"}], "modified": "2019-06-10T20:53:36.319Z", "created": "2019-06-10T20:53:36.319Z", "x_mitre_version": "1.0"}, {"created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5", "description": "Use intrusion detection signatures to block traffic at network boundaries.", "type": "course-of-action", "name": "Network Intrusion Prevention", "object_marking_refs": ["marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"], "id": "course-of-action--12241367-a8b7-49b4-b86e-2236901ba50c", "external_references": [{"external_id": "M1031", "source_name": "mitre-attack", "url": "https://attack.mitre.org/mitigations/M1031"}], "modified": "2019-06-10T20:46:02.263Z", "created": "2019-06-10T20:46:02.263Z", "x_mitre_version": "1.0"}, {"created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5", "description": "Architect sections of the network to isolate critical systems, functions, or resources. Use physical and logical segmentation to prevent access to potentially sensitive systems and information. Use a DMZ to contain any internet-facing services that should not be exposed from the internal network.", "type": "course-of-action", "id": "course-of-action--86598de0-b347-4928-9eb0-0acbfc21908c", "object_marking_refs": ["marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"], "name": "Network Segmentation", "external_references": [{"external_id": "M1030", "source_name": "mitre-attack", "url": "https://attack.mitre.org/mitigations/M1030"}], "modified": "2019-06-10T20:41:03.271Z", "created": "2019-06-10T20:41:03.271Z", "x_mitre_version": "1.0"}, {"created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5", "description": "Make configuration changes related to the operating system or a common feature of the operating system that result in system hardening against techniques.", "type": "course-of-action", "name": "Operating System Configuration", "object_marking_refs": ["marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"], "id": "course-of-action--2f316f6c-ae42-44fe-adf8-150989e0f6d3", "external_references": [{"external_id": "M1028", "source_name": "mitre-attack", "url": "https://attack.mitre.org/mitigations/M1028"}], "modified": "2019-06-06T21:16:18.709Z", "created": "2019-06-06T21:16:18.709Z", "x_mitre_version": "1.0"}, {"created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5", "description": "Set and enforce secure password policies for accounts.", "type": "course-of-action", "id": "course-of-action--90c218c3-fbf8-4830-98a7-e8cfb7eaa485", "object_marking_refs": ["marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"], "name": "Password Policies", "external_references": [{"external_id": "M1027", "source_name": "mitre-attack", "url": "https://attack.mitre.org/mitigations/M1027"}], "modified": "2019-06-06T21:10:35.792Z", "created": "2019-06-06T21:10:35.792Z", "x_mitre_version": "1.0"}, {"created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5", "description": "Manage the creation, modification, use, and permissions associated to privileged accounts, including SYSTEM and root.", "type": "course-of-action", "name": "Privileged Account Management", "object_marking_refs": ["marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"], "id": "course-of-action--9bb9e696-bff8-4ae1-9454-961fc7d91d5f", "external_references": [{"external_id": "M1026", "source_name": "mitre-attack", "url": "https://attack.mitre.org/mitigations/M1026"}], "modified": "2019-06-06T21:09:47.115Z", "created": "2019-06-06T21:09:47.115Z", "x_mitre_version": "1.0"}, {"created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5", "description": "Protect processes with high privileges that can be used to interact with critical system components through use of protected process light, anti-process injection defenses, or other process integrity enforcement measures.", "type": "course-of-action", "name": "Privileged Process Integrity", "object_marking_refs": ["marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"], "id": "course-of-action--72dade3e-1cba-4182-b3b3-a77ca52f02a1", "external_references": [{"external_id": "M1025", "source_name": "mitre-attack", "url": "https://attack.mitre.org/mitigations/M1025"}], "modified": "2019-06-06T21:08:58.465Z", "created": "2019-06-06T21:08:58.465Z", "x_mitre_version": "1.0"}, {"created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5", "description": "Restrict access by setting directory and file permissions that are not specific to users or privileged accounts.", "type": "course-of-action", "name": "Restrict File and Directory Permissions", "object_marking_refs": ["marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"], "id": "course-of-action--987988f0-cf86-4680-a875-2f6456ab2448", "external_references": [{"external_id": "M1022", "source_name": "mitre-attack", "url": "https://attack.mitre.org/mitigations/M1022"}], "modified": "2019-06-06T20:54:49.964Z", "created": "2019-06-06T20:54:49.964Z", "x_mitre_version": "1.0"}, {"created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5", "description": "A threat intelligence program helps an organization generate their own threat intelligence information and track trends to inform defensive priorities to mitigate risk.", "type": "course-of-action", "name": "Threat Intelligence Program", "object_marking_refs": ["marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"], "id": "course-of-action--874c0166-e407-45c2-a1d9-e4e3a6570fd8", "external_references": [{"external_id": "M1019", "source_name": "mitre-attack", "url": "https://attack.mitre.org/mitigations/M1019"}], "modified": "2019-06-06T19:55:50.927Z", "created": "2019-06-06T19:55:50.927Z", "x_mitre_version": "1.0"}, {"created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5", "description": "Manage the creation, modification, use, and permissions associated to user accounts.", "type": "course-of-action", "id": "course-of-action--93e7968a-9074-4eac-8ae9-9f5200ec3317", "object_marking_refs": ["marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"], "name": "User Account Management", "external_references": [{"external_id": "M1018", "source_name": "mitre-attack", "url": "https://attack.mitre.org/mitigations/M1018"}], "modified": "2019-06-06T16:50:58.767Z", "created": "2019-06-06T16:50:58.767Z", "x_mitre_version": "1.0"}, {"created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5", "description": "Train users to to be aware of access or manipulation attempts by an adversary to reduce the risk of successful spearphishing, social engineering, and other techniques that involve user interaction.", "type": "course-of-action", "name": "User Training", "object_marking_refs": ["marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"], "id": "course-of-action--2a4f6c11-a4a7-4cb9-b0ef-6ae1bb3a718a", "external_references": [{"external_id": "M1017", "source_name": "mitre-attack", "url": "https://attack.mitre.org/mitigations/M1017"}], "modified": "2019-06-06T16:50:04.963Z", "created": "2019-06-06T16:50:04.963Z", "x_mitre_version": "1.0"}, {"created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5", "description": "Configure Active Directory to prevent use of certain techniques; use SID Filtering, etc.", "type": "course-of-action", "name": "Active Directory Configuration", "object_marking_refs": ["marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"], "id": "course-of-action--e3388c78-2a8d-47c2-8422-c1398b324462", "external_references": [{"external_id": "M1015", "source_name": "mitre-attack", "url": "https://attack.mitre.org/mitigations/M1015"}], "modified": "2019-06-13T16:10:26.227Z", "created": "2019-06-06T16:39:58.291Z", "x_mitre_version": "1.0"}, {"created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5", "description": "This type of attack technique cannot be easily mitigated with preventive controls since it is based on the abuse of operating system design features. For example, disabling all BITS functionality will likely have unintended side effects, such as preventing legitimate software patching and updating. Efforts should be focused on preventing adversary tools from running earlier in the chain of activity and on identification of subsequent malicious behavior. (Citation: Mondok Windows PiggyBack BITS May 2007)\n\nModify network and/or host firewall rules, as well as other network controls, to only allow legitimate BITS traffic.\n\nConsider limiting access to the BITS interface to specific users or groups. (Citation: Symantec BITS May 2007)\n\nConsider reducing the default BITS job lifetime in Group Policy or by editing the <code>JobInactivityTimeout</code> and <code>MaxDownloadTime</code> Registry values in <code> HKEY_LOCAL_MACHINE\\Software\\Policies\\Microsoft\\Windows\\BITS</code>. (Citation: Microsoft BITS)", "type": "course-of-action", "name": "BITS Jobs Mitigation", "object_marking_refs": ["marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"], "id": "course-of-action--cb825b86-3f3b-4686-ba99-44878f5d3173", "external_references": [{"external_id": "T1197", "source_name": "mitre-attack", "url": "https://attack.mitre.org/mitigations/T1197"}, {"source_name": "Mondok Windows PiggyBack BITS May 2007", "description": "Mondok, M. (2007, May 11). Malware piggybacks on Windows\u2019 Background Intelligent Transfer Service. Retrieved January 12, 2018.", "url": "https://arstechnica.com/information-technology/2007/05/malware-piggybacks-on-windows-background-intelligent-transfer-service/"}, {"source_name": "Symantec BITS May 2007", "description": "Florio, E. (2007, May 9). Malware Update with Windows Update. Retrieved January 12, 2018.", "url": "https://www.symantec.com/connect/blogs/malware-update-windows-update"}, {"source_name": "Microsoft BITS", "description": "Microsoft. (n.d.). Background Intelligent Transfer Service. Retrieved January 12, 2018.", "url": "https://msdn.microsoft.com/library/windows/desktop/bb968799.aspx"}], "modified": "2019-07-24T14:08:16.317Z", "created": "2018-10-17T00:14:20.652Z", "x_mitre_deprecated": true, "x_mitre_version": "1.0"}, {"created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5", "description": "Remove users from the local administrator group on systems. Although UAC bypass techniques exist, it is still prudent to use the highest enforcement level for UAC when possible and mitigate bypass opportunities that exist with techniques such as [DLL Search Order Hijacking](https://attack.mitre.org/techniques/T1038). \n\nCheck for common UAC bypass weaknesses on Windows systems to be aware of the risk posture and address issues where appropriate. (Citation: Github UACMe)", "type": "course-of-action", "name": "Bypass User Account Control Mitigation", "object_marking_refs": ["marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"], "id": "course-of-action--beb45abb-11e8-4aef-9778-1f9ac249784f", "external_references": [{"external_id": "T1088", "source_name": "mitre-attack", "url": "https://attack.mitre.org/mitigations/T1088"}, {"source_name": "Github UACMe", "description": "UACME Project. (2016, June 16). UACMe. Retrieved July 26, 2016.", "url": "https://github.com/hfiref0x/UACME"}], "modified": "2019-07-24T14:13:23.637Z", "created": "2018-10-17T00:14:20.652Z", "x_mitre_deprecated": true, "x_mitre_version": "1.0"}, {"created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5", "description": "Network intrusion detection and prevention systems that use network signatures to identify traffic for specific adversary malware can be used to mitigate activity at the network level. Signatures are often for unique indicators within protocols and may be based on the specific C2 protocol used by a particular adversary or tool, and will likely be different across various malware families and versions. Adversaries will likely change tool C2 signatures over time or construct protocols in such a way as to avoid detection by common defensive tools. (Citation: University of Birmingham C2)", "type": "course-of-action", "name": "Connection Proxy Mitigation", "object_marking_refs": ["marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"], "id": "course-of-action--d75a3d1b-b536-4f15-a23c-f4bcc17837b8", "external_references": [{"external_id": "T1090", "source_name": "mitre-attack", "url": "https://attack.mitre.org/mitigations/T1090"}, {"source_name": "University of Birmingham C2", "description": "Gardiner, J.,  Cova, M., Nagaraja, S. (2014, February). Command & Control Understanding, Denying and Detecting. Retrieved April 20, 2016.", "url": "https://arxiv.org/ftp/arxiv/papers/1408/1408.1136.pdf"}], "modified": "2019-07-24T18:10:46.757Z", "created": "2018-10-17T00:14:20.652Z", "x_mitre_deprecated": true, "x_mitre_version": "1.0"}, {"created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5", "description": "Properly configure firewalls and proxies to limit outgoing traffic to only necessary ports and through proper network gateway systems. Also ensure hosts are only provisioned to communicate over authorized interfaces.\n\nNetwork intrusion detection and prevention systems that use network signatures to identify traffic for specific adversary malware can be used to mitigate activity at the network level. Signatures are often for unique indicators within protocols and may be based on the specific protocol used by a particular adversary or tool, and will likely be different across various malware families and versions. Adversaries will likely change tool C2 signatures over time or construct protocols in such a way as to avoid detection by common defensive tools. (Citation: University of Birmingham C2)", "type": "course-of-action", "name": "Custom Command and Control Protocol Mitigation", "object_marking_refs": ["marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"], "id": "course-of-action--f3d0c735-330f-43c2-8e8e-51bcfa51e8c3", "external_references": [{"external_id": "T1094", "source_name": "mitre-attack", "url": "https://attack.mitre.org/mitigations/T1094"}, {"source_name": "University of Birmingham C2", "description": "Gardiner, J.,  Cova, M., Nagaraja, S. (2014, February). Command & Control Understanding, Denying and Detecting. Retrieved April 20, 2016.", "url": "https://arxiv.org/ftp/arxiv/papers/1408/1408.1136.pdf"}], "modified": "2019-07-24T18:13:22.017Z", "created": "2018-10-17T00:14:20.652Z", "x_mitre_deprecated": true, "x_mitre_version": "1.0"}, {"created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5", "description": "Identify unnecessary system utilities or potentially malicious software that may be used to collect data from the local system, and audit and/or block them by using whitelisting (Citation: Beechey 2010) tools, like AppLocker, (Citation: Windows Commands JPCERT) (Citation: NSA MS AppLocker) or Software Restriction Policies (Citation: Corio 2008) where appropriate. (Citation: TechNet Applocker vs SRP)", "type": "course-of-action", "name": "Data from Local System Mitigation", "object_marking_refs": ["marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"], "id": "course-of-action--7ee0879d-ce4f-4f54-a96b-c532dfb98ffd", "external_references": [{"external_id": "T1005", "source_name": "mitre-attack", "url": "https://attack.mitre.org/mitigations/T1005"}, {"source_name": "Beechey 2010", "description": "Beechey, J. (2010, December). Application Whitelisting: Panacea or Propaganda?. Retrieved November 18, 2014.", "url": "http://www.sans.org/reading-room/whitepapers/application/application-whitelisting-panacea-propaganda-33599"}, {"source_name": "Windows Commands JPCERT", "description": "Tomonaga, S. (2016, January 26). Windows Commands Abused by Attackers. Retrieved February 2, 2016.", "url": "http://blog.jpcert.or.jp/2016/01/windows-commands-abused-by-attackers.html"}, {"source_name": "NSA MS AppLocker", "description": "NSA Information Assurance Directorate. (2014, August). Application Whitelisting Using Microsoft AppLocker. Retrieved March 31, 2016.", "url": "https://www.iad.gov/iad/library/ia-guidance/tech-briefs/application-whitelisting-using-microsoft-applocker.cfm"}, {"source_name": "Corio 2008", "description": "Corio, C., & Sayana, D. P. (2008, June). Application Lockdown with Software Restriction Policies. Retrieved November 18, 2014.", "url": "http://technet.microsoft.com/en-us/magazine/2008.06.srp.aspx"}, {"source_name": "TechNet Applocker vs SRP", "description": "Microsoft. (2012, June 27). Using Software Restriction Policies and AppLocker Policies. Retrieved April 7, 2016.", "url": "https://technet.microsoft.com/en-us/library/ee791851.aspx"}], "modified": "2019-07-24T19:07:01.048Z", "created": "2018-10-17T00:14:20.652Z", "x_mitre_deprecated": true, "x_mitre_version": "1.0"}, {"created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5", "description": "Network intrusion detection and prevention systems that use network signatures to identify traffic for specific adversary malware can be used to mitigate activity at the network level. Signatures are often for unique indicators within protocols and may be based on the specific protocol used by a particular adversary or tool, and will likely be different across various malware families and versions. Adversaries will likely change tool C2 signatures over time or construct protocols in such a way as to avoid detection by common defensive tools. (Citation: University of Birmingham C2)", "type": "course-of-action", "name": "Multiband Communication Mitigation", "object_marking_refs": ["marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"], "id": "course-of-action--da987565-27b6-4b31-bbcd-74b909847116", "external_references": [{"external_id": "T1026", "source_name": "mitre-attack", "url": "https://attack.mitre.org/mitigations/T1026"}, {"source_name": "University of Birmingham C2", "description": "Gardiner, J.,  Cova, M., Nagaraja, S. (2014, February). Command & Control Understanding, Denying and Detecting. Retrieved April 20, 2016.", "url": "https://arxiv.org/ftp/arxiv/papers/1408/1408.1136.pdf"}], "modified": "2019-07-25T11:15:17.942Z", "created": "2018-10-17T00:14:20.652Z", "x_mitre_deprecated": true, "x_mitre_version": "1.0"}, {"created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5", "description": "Since browser pivoting requires a high integrity process to launch from, restricting user permissions and addressing Privilege Escalation and [Bypass User Account Control](https://attack.mitre.org/techniques/T1088) opportunities can limit the exposure to this technique. \n\nClose all browser sessions regularly and when they are no longer needed.", "type": "course-of-action", "name": "Man in the Browser Mitigation", "object_marking_refs": ["marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"], "id": "course-of-action--94f6b4f5-b528-4f50-91d5-f66457c2f8f7", "external_references": [{"external_id": "T1185", "source_name": "mitre-attack", "url": "https://attack.mitre.org/mitigations/T1185"}], "modified": "2019-07-25T11:12:34.303Z", "created": "2018-10-17T00:14:20.652Z", "x_mitre_deprecated": true, "x_mitre_version": "1.0"}, {"created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5", "description": "Limit privileges of user accounts and remediate Privilege Escalation vectors so only  authorized administrators can create new services.\n\nIdentify and block unnecessary system utilities or potentially malicious software that may be used to create services by using whitelisting (Citation: Beechey 2010) tools, like AppLocker, (Citation: Windows Commands JPCERT) (Citation: NSA MS AppLocker) or Software Restriction Policies (Citation: Corio 2008) where appropriate. (Citation: TechNet Applocker vs SRP)", "type": "course-of-action", "name": "New Service Mitigation", "object_marking_refs": ["marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"], "id": "course-of-action--b7b2c89c-09c1-4b71-ae7c-000ec2893aab", "external_references": [{"external_id": "T1050", "source_name": "mitre-attack", "url": "https://attack.mitre.org/mitigations/T1050"}, {"source_name": "Beechey 2010", "description": "Beechey, J. (2010, December). Application Whitelisting: Panacea or Propaganda?. Retrieved November 18, 2014.", "url": "http://www.sans.org/reading-room/whitepapers/application/application-whitelisting-panacea-propaganda-33599"}, {"source_name": "Windows Commands JPCERT", "description": "Tomonaga, S. (2016, January 26). Windows Commands Abused by Attackers. Retrieved February 2, 2016.", "url": "http://blog.jpcert.or.jp/2016/01/windows-commands-abused-by-attackers.html"}, {"source_name": "NSA MS AppLocker", "description": "NSA Information Assurance Directorate. (2014, August). Application Whitelisting Using Microsoft AppLocker. Retrieved March 31, 2016.", "url": "https://www.iad.gov/iad/library/ia-guidance/tech-briefs/application-whitelisting-using-microsoft-applocker.cfm"}, {"source_name": "Corio 2008", "description": "Corio, C., & Sayana, D. P. (2008, June). Application Lockdown with Software Restriction Policies. Retrieved November 18, 2014.", "url": "http://technet.microsoft.com/en-us/magazine/2008.06.srp.aspx"}, {"source_name": "TechNet Applocker vs SRP", "description": "Microsoft. (2012, June 27). Using Software Restriction Policies and AppLocker Policies. Retrieved April 7, 2016.", "url": "https://technet.microsoft.com/en-us/library/ee791851.aspx"}], "modified": "2019-07-25T11:19:10.201Z", "created": "2018-10-17T00:14:20.652Z", "x_mitre_deprecated": true, "x_mitre_version": "1.0"}, {"created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5", "description": "It may be possible to remove PowerShell from systems when not needed, but a review should be performed to assess the impact to an environment, since it could be in use for many legitimate purposes and administrative functions. When PowerShell is necessary, restrict PowerShell execution policy to administrators and to only execute signed scripts. Be aware that there are methods of bypassing the PowerShell execution policy, depending on environment configuration. (Citation: Netspi PowerShell Execution Policy Bypass) Disable/restrict the WinRM Service to help prevent uses of PowerShell for remote execution.", "type": "course-of-action", "name": "PowerShell Mitigation", "object_marking_refs": ["marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"], "id": "course-of-action--d0415180-51e9-40ce-b57c-c332b0b441f2", "external_references": [{"external_id": "T1086", "source_name": "mitre-attack", "url": "https://attack.mitre.org/mitigations/T1086"}, {"source_name": "Netspi PowerShell Execution Policy Bypass", "description": "Sutherland, S. (2014, September 9). 15 Ways to Bypass the PowerShell Execution Policy. Retrieved July 23, 2015.", "url": "https://blog.netspi.com/15-ways-to-bypass-the-powershell-execution-policy/"}], "modified": "2019-07-25T11:26:37.066Z", "created": "2018-10-17T00:14:20.652Z", "x_mitre_deprecated": true, "x_mitre_version": "1.0"}, {"created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5", "description": "Identify unnecessary system utilities or potentially malicious software that may be used to acquire information on remotely available systems, and audit and/or block them by using whitelisting (Citation: Beechey 2010) tools, like AppLocker, (Citation: Windows Commands JPCERT) (Citation: NSA MS AppLocker) or Software Restriction Policies (Citation: Corio 2008) where appropriate. (Citation: TechNet Applocker vs SRP)", "type": "course-of-action", "name": "Remote System Discovery Mitigation", "object_marking_refs": ["marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"], "id": "course-of-action--9a902722-cecd-4fbe-a6c9-49333aa0f8c2", "external_references": [{"external_id": "T1018", "source_name": "mitre-attack", "url": "https://attack.mitre.org/mitigations/T1018"}, {"source_name": "Beechey 2010", "description": "Beechey, J. (2010, December). Application Whitelisting: Panacea or Propaganda?. Retrieved November 18, 2014.", "url": "http://www.sans.org/reading-room/whitepapers/application/application-whitelisting-panacea-propaganda-33599"}, {"source_name": "Windows Commands JPCERT", "description": "Tomonaga, S. (2016, January 26). Windows Commands Abused by Attackers. Retrieved February 2, 2016.", "url": "http://blog.jpcert.or.jp/2016/01/windows-commands-abused-by-attackers.html"}, {"source_name": "NSA MS AppLocker", "description": "NSA Information Assurance Directorate. (2014, August). Application Whitelisting Using Microsoft AppLocker. Retrieved March 31, 2016.", "url": "https://www.iad.gov/iad/library/ia-guidance/tech-briefs/application-whitelisting-using-microsoft-applocker.cfm"}, {"source_name": "Corio 2008", "description": "Corio, C., & Sayana, D. P. (2008, June). Application Lockdown with Software Restriction Policies. Retrieved November 18, 2014.", "url": "http://technet.microsoft.com/en-us/magazine/2008.06.srp.aspx"}, {"source_name": "TechNet Applocker vs SRP", "description": "Microsoft. (2012, June 27). Using Software Restriction Policies and AppLocker Policies. Retrieved April 7, 2016.", "url": "https://technet.microsoft.com/en-us/library/ee791851.aspx"}], "modified": "2019-07-25T11:34:52.329Z", "created": "2018-10-17T00:14:20.652Z", "x_mitre_deprecated": true, "x_mitre_version": "1.0"}, {"created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5", "description": "Network intrusion detection and prevention systems that use network signatures to identify traffic for specific adversary command and control infrastructure and malware can be used to mitigate activity at the network level. Signatures are often for unique indicators within protocols and may be based on the specific obfuscation technique used by a particular adversary or tool, and will likely be different across various malware families and versions. Adversaries will likely change tool command and control signatures over time or construct protocols in such a way to avoid detection by common defensive tools. (Citation: University of Birmingham C2)", "type": "course-of-action", "name": "Scheduled Transfer Mitigation", "object_marking_refs": ["marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"], "id": "course-of-action--1c0711c8-2a73-48a1-893d-ff88bcd23824", "external_references": [{"external_id": "T1029", "source_name": "mitre-attack", "url": "https://attack.mitre.org/mitigations/T1029"}, {"source_name": "University of Birmingham C2", "description": "Gardiner, J.,  Cova, M., Nagaraja, S. (2014, February). Command & Control Understanding, Denying and Detecting. Retrieved April 20, 2016.", "url": "https://arxiv.org/ftp/arxiv/papers/1408/1408.1136.pdf"}], "modified": "2019-07-25T11:39:28.002Z", "created": "2018-10-17T00:14:20.652Z", "x_mitre_deprecated": true, "x_mitre_version": "1.0"}, {"created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5", "description": "Do not reuse local administrator account passwords across systems. Ensure password complexity and uniqueness such that the passwords cannot be cracked or guessed. Deny remote use of local admin credentials to log into systems. Do not allow domain user accounts to be in the local Administrators group multiple systems.\n\nIdentify unnecessary system utilities or potentially malicious software that may be used to leverage SMB and the Windows admin shares, and audit and/or block them by using whitelisting (Citation: Beechey 2010) tools, like AppLocker, (Citation: Windows Commands JPCERT) (Citation: NSA MS AppLocker) or Software Restriction Policies (Citation: Corio 2008) where appropriate. (Citation: TechNet Applocker vs SRP)", "type": "course-of-action", "name": "Windows Admin Shares Mitigation", "object_marking_refs": ["marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"], "id": "course-of-action--308855d1-078b-47ad-8d2a-8f9b2713ffb5", "external_references": [{"external_id": "T1077", "source_name": "mitre-attack", "url": "https://attack.mitre.org/mitigations/T1077"}, {"source_name": "Beechey 2010", "description": "Beechey, J. (2010, December). Application Whitelisting: Panacea or Propaganda?. Retrieved November 18, 2014.", "url": "http://www.sans.org/reading-room/whitepapers/application/application-whitelisting-panacea-propaganda-33599"}, {"source_name": "Windows Commands JPCERT", "description": "Tomonaga, S. (2016, January 26). Windows Commands Abused by Attackers. Retrieved February 2, 2016.", "url": "http://blog.jpcert.or.jp/2016/01/windows-commands-abused-by-attackers.html"}, {"source_name": "NSA MS AppLocker", "description": "NSA Information Assurance Directorate. (2014, August). Application Whitelisting Using Microsoft AppLocker. Retrieved March 31, 2016.", "url": "https://www.iad.gov/iad/library/ia-guidance/tech-briefs/application-whitelisting-using-microsoft-applocker.cfm"}, {"source_name": "Corio 2008", "description": "Corio, C., & Sayana, D. P. (2008, June). Application Lockdown with Software Restriction Policies. Retrieved November 18, 2014.", "url": "http://technet.microsoft.com/en-us/magazine/2008.06.srp.aspx"}, {"source_name": "TechNet Applocker vs SRP", "description": "Microsoft. (2012, June 27). Using Software Restriction Policies and AppLocker Policies. Retrieved April 7, 2016.", "url": "https://technet.microsoft.com/en-us/library/ee791851.aspx"}], "modified": "2019-07-25T12:34:42.283Z", "created": "2018-10-17T00:14:20.652Z", "x_mitre_deprecated": true, "x_mitre_version": "1.0"}, {"created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5", "description": "Monitor systems and domain logs for unusual credential logon activity. Prevent access to [Valid Accounts](https://attack.mitre.org/techniques/T1078). Apply patch KB2871997 to Windows 7 and higher systems to limit the default access of accounts in the local administrator group. \n\nEnable pass the hash mitigations to apply UAC restrictions to local accounts on network logon. The associated Registry key is located <code>HKLM\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\System\\LocalAccountTokenFilterPolicy</code> Through GPO: Computer Configuration > [Policies] > Administrative Templates > SCM: Pass the Hash Mitigations: Apply UAC restrictions to local accounts on network logons. (Citation: GitHub IAD Secure Host Baseline UAC Filtering)\n\nLimit credential overlap across systems to prevent the damage of credential compromise and reduce the adversary's ability to perform Lateral Movement between systems. Ensure that built-in and created local administrator accounts have complex, unique passwords. Do not allow a domain user to be in the local administrator group on multiple systems.", "type": "course-of-action", "name": "Pass the Hash Mitigation", "object_marking_refs": ["marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"], "id": "course-of-action--bcee7b05-89a6-41a5-b7aa-fce4da7ede9e", "external_references": [{"external_id": "T1075", "source_name": "mitre-attack", "url": "https://attack.mitre.org/mitigations/T1075"}, {"source_name": "GitHub IAD Secure Host Baseline UAC Filtering", "description": "NSA IAD. (2017, January 24). MS Security Guide. Retrieved December 18, 2017.", "url": "https://github.com/iadgov/Secure-Host-Baseline/blob/master/Windows/Group%20Policy%20Templates/en-US/SecGuide.adml"}], "modified": "2019-07-25T11:21:20.411Z", "created": "2018-10-17T00:14:20.652Z", "x_mitre_deprecated": true, "x_mitre_version": "1.0"}, {"created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5", "description": "Identify unnecessary system utilities or potentially malicious software that may be used to acquire information about processes, and audit and/or block them by using whitelisting (Citation: Beechey 2010) tools, like AppLocker, (Citation: Windows Commands JPCERT) (Citation: NSA MS AppLocker) or Software Restriction Policies (Citation: Corio 2008) where appropriate. (Citation: TechNet Applocker vs SRP)", "type": "course-of-action", "name": "Process Discovery Mitigation", "object_marking_refs": ["marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"], "id": "course-of-action--f6469191-1814-4dbe-a081-2a6daf83a10b", "external_references": [{"external_id": "T1057", "source_name": "mitre-attack", "url": "https://attack.mitre.org/mitigations/T1057"}, {"source_name": "Beechey 2010", "description": "Beechey, J. (2010, December). Application Whitelisting: Panacea or Propaganda?. Retrieved November 18, 2014.", "url": "http://www.sans.org/reading-room/whitepapers/application/application-whitelisting-panacea-propaganda-33599"}, {"source_name": "Windows Commands JPCERT", "description": "Tomonaga, S. (2016, January 26). Windows Commands Abused by Attackers. Retrieved February 2, 2016.", "url": "http://blog.jpcert.or.jp/2016/01/windows-commands-abused-by-attackers.html"}, {"source_name": "NSA MS AppLocker", "description": "NSA Information Assurance Directorate. (2014, August). Application Whitelisting Using Microsoft AppLocker. Retrieved March 31, 2016.", "url": "https://www.iad.gov/iad/library/ia-guidance/tech-briefs/application-whitelisting-using-microsoft-applocker.cfm"}, {"source_name": "Corio 2008", "description": "Corio, C., & Sayana, D. P. (2008, June). Application Lockdown with Software Restriction Policies. Retrieved November 18, 2014.", "url": "http://technet.microsoft.com/en-us/magazine/2008.06.srp.aspx"}, {"source_name": "TechNet Applocker vs SRP", "description": "Microsoft. (2012, June 27). Using Software Restriction Policies and AppLocker Policies. Retrieved April 7, 2016.", "url": "https://technet.microsoft.com/en-us/library/ee791851.aspx"}], "modified": "2019-07-25T11:27:30.259Z", "created": "2018-10-17T00:14:20.652Z", "x_mitre_deprecated": true, "x_mitre_version": "1.0"}, {"created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5", "description": "Limit the number of accounts that may use remote services. Use multifactor authentication where possible. Limit the permissions for accounts that are at higher risk of compromise; for example, configure SSH so users can only run specific programs. Prevent Credential Access techniques that may allow an adversary to acquire [Valid Accounts](https://attack.mitre.org/techniques/T1078) that can be used by existing services.", "type": "course-of-action", "name": "Remote Services Mitigation", "object_marking_refs": ["marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"], "id": "course-of-action--979e6485-7a2f-42bd-ae96-4e622c3cd173", "external_references": [{"external_id": "T1021", "source_name": "mitre-attack", "url": "https://attack.mitre.org/mitigations/T1021"}], "modified": "2019-07-25T11:34:25.376Z", "created": "2018-10-17T00:14:20.652Z", "x_mitre_deprecated": true, "x_mitre_version": "1.0"}, {"created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5", "description": "Use network intrusion detection/prevention systems to detect and prevent remote service scans. Ensure that unnecessary ports and services are closed and proper network segmentation is followed to protect critical servers and devices.\n\nIdentify unnecessary system utilities or potentially malicious software that may be used to acquire information about services running on remote systems, and audit and/or block them by using whitelisting (Citation: Beechey 2010) tools, like AppLocker, (Citation: Windows Commands JPCERT) (Citation: NSA MS AppLocker) or Software Restriction Policies (Citation: Corio 2008) where appropriate. (Citation: TechNet Applocker vs SRP)", "type": "course-of-action", "name": "Network Service Scanning Mitigation", "object_marking_refs": ["marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"], "id": "course-of-action--d256cb63-b021-4b4a-bb6d-1b42eea179a3", "external_references": [{"external_id": "T1046", "source_name": "mitre-attack", "url": "https://attack.mitre.org/mitigations/T1046"}, {"source_name": "Beechey 2010", "description": "Beechey, J. (2010, December). Application Whitelisting: Panacea or Propaganda?. Retrieved November 18, 2014.", "url": "http://www.sans.org/reading-room/whitepapers/application/application-whitelisting-panacea-propaganda-33599"}, {"source_name": "Windows Commands JPCERT", "description": "Tomonaga, S. (2016, January 26). Windows Commands Abused by Attackers. Retrieved February 2, 2016.", "url": "http://blog.jpcert.or.jp/2016/01/windows-commands-abused-by-attackers.html"}, {"source_name": "NSA MS AppLocker", "description": "NSA Information Assurance Directorate. (2014, August). Application Whitelisting Using Microsoft AppLocker. Retrieved March 31, 2016.", "url": "https://www.iad.gov/iad/library/ia-guidance/tech-briefs/application-whitelisting-using-microsoft-applocker.cfm"}, {"source_name": "Corio 2008", "description": "Corio, C., & Sayana, D. P. (2008, June). Application Lockdown with Software Restriction Policies. Retrieved November 18, 2014.", "url": "http://technet.microsoft.com/en-us/magazine/2008.06.srp.aspx"}, {"source_name": "TechNet Applocker vs SRP", "description": "Microsoft. (2012, June 27). Using Software Restriction Policies and AppLocker Policies. Retrieved April 7, 2016.", "url": "https://technet.microsoft.com/en-us/library/ee791851.aspx"}], "modified": "2019-07-25T11:17:30.100Z", "created": "2018-10-17T00:14:20.652Z", "x_mitre_deprecated": true, "x_mitre_version": "1.0"}, {"created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5", "description": "This type of attack technique cannot be easily mitigated with preventive controls since it is based on the abuse of operating system design features. For example, mitigating specific API calls will likely have unintended side effects, such as preventing legitimate software (i.e., security products) from operating properly. Efforts should be focused on preventing adversary tools from running earlier in the chain of activity and on identifying subsequent malicious behavior. \n\nAlthough process hollowing may be used to evade certain types of defenses, it is still good practice to identify potentially malicious software that may be used to perform adversarial actions and audit and/or block it by using whitelisting (Citation: Beechey 2010) tools, like AppLocker, (Citation: Windows Commands JPCERT) (Citation: NSA MS AppLocker) or Software Restriction Policies (Citation: Corio 2008) where appropriate. (Citation: TechNet Applocker vs SRP)", "type": "course-of-action", "name": "Process Hollowing Mitigation", "object_marking_refs": ["marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"], "id": "course-of-action--7c39ebbf-244e-4d1c-b0ac-b282453ece43", "external_references": [{"external_id": "T1093", "source_name": "mitre-attack", "url": "https://attack.mitre.org/mitigations/T1093"}, {"source_name": "Beechey 2010", "description": "Beechey, J. (2010, December). Application Whitelisting: Panacea or Propaganda?. Retrieved November 18, 2014.", "url": "http://www.sans.org/reading-room/whitepapers/application/application-whitelisting-panacea-propaganda-33599"}, {"source_name": "Windows Commands JPCERT", "description": "Tomonaga, S. (2016, January 26). Windows Commands Abused by Attackers. Retrieved February 2, 2016.", "url": "http://blog.jpcert.or.jp/2016/01/windows-commands-abused-by-attackers.html"}, {"source_name": "NSA MS AppLocker", "description": "NSA Information Assurance Directorate. (2014, August). Application Whitelisting Using Microsoft AppLocker. Retrieved March 31, 2016.", "url": "https://www.iad.gov/iad/library/ia-guidance/tech-briefs/application-whitelisting-using-microsoft-applocker.cfm"}, {"source_name": "Corio 2008", "description": "Corio, C., & Sayana, D. P. (2008, June). Application Lockdown with Software Restriction Policies. Retrieved November 18, 2014.", "url": "http://technet.microsoft.com/en-us/magazine/2008.06.srp.aspx"}, {"source_name": "TechNet Applocker vs SRP", "description": "Microsoft. (2012, June 27). Using Software Restriction Policies and AppLocker Policies. Retrieved April 7, 2016.", "url": "https://technet.microsoft.com/en-us/library/ee791851.aspx"}], "modified": "2019-07-25T11:28:17.117Z", "created": "2018-10-17T00:14:20.652Z", "x_mitre_deprecated": true, "x_mitre_version": "1.0"}, {"created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5", "description": "Access tokens are an integral part of the security system within Windows and cannot be turned off. However, an attacker must already have administrator level access on the local system to make full use of this technique; be sure to restrict users and accounts to the least privileges they require to do their job.\n\nAny user can also spoof access tokens if they have legitimate credentials. Follow mitigation guidelines for preventing adversary use of [Valid Accounts](https://attack.mitre.org/techniques/T1078). Limit permissions so that users and user groups cannot create tokens. This setting should be defined for the local system account only. GPO: Computer Configuration > [Policies] > Windows Settings > Security Settings > Local Policies > User Rights Assignment: Create a token object. (Citation: Microsoft Create Token) Also define who can create a process level token to only the local and network service through GPO: Computer Configuration > [Policies] > Windows Settings > Security Settings > Local Policies > User Rights Assignment: Replace a process level token. (Citation: Microsoft Replace Process Token)\n\nAlso limit opportunities for adversaries to increase privileges by limiting Privilege Escalation opportunities.", "type": "course-of-action", "name": "Access Token Manipulation Mitigation", "object_marking_refs": ["marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"], "id": "course-of-action--c61fee9f-16fb-4f8c-bbf0-869093fcd4a6", "external_references": [{"external_id": "T1134", "source_name": "mitre-attack", "url": "https://attack.mitre.org/mitigations/T1134"}, {"source_name": "Microsoft Create Token", "description": "Brower, N., Lich, B. (2017, April 19). Create a token object. Retrieved December 19, 2017.", "url": "https://docs.microsoft.com/windows/device-security/security-policy-settings/create-a-token-object"}, {"source_name": "Microsoft Replace Process Token", "description": "Brower, N., Lich, B. (2017, April 19). Replace a process level token. Retrieved December 19, 2017.", "url": "https://docs.microsoft.com/windows/device-security/security-policy-settings/replace-a-process-level-token"}], "modified": "2019-07-24T14:29:27.367Z", "created": "2018-10-17T00:14:20.652Z", "x_mitre_deprecated": true, "x_mitre_version": "1.0"}, {"created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5", "description": "Audit and/or block command-line interpreters by using whitelisting (Citation: Beechey 2010) tools, like AppLocker, (Citation: Windows Commands JPCERT) (Citation: NSA MS AppLocker) or Software Restriction Policies (Citation: Corio 2008) where appropriate. (Citation: TechNet Applocker vs SRP)", "type": "course-of-action", "name": "Command-Line Interface Mitigation", "object_marking_refs": ["marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"], "id": "course-of-action--f28a20fd-d173-4603-807e-2cb3f51bdf04", "external_references": [{"external_id": "T1059", "source_name": "mitre-attack", "url": "https://attack.mitre.org/mitigations/T1059"}, {"source_name": "Beechey 2010", "description": "Beechey, J. (2010, December). Application Whitelisting: Panacea or Propaganda?. Retrieved November 18, 2014.", "url": "http://www.sans.org/reading-room/whitepapers/application/application-whitelisting-panacea-propaganda-33599"}, {"source_name": "Windows Commands JPCERT", "description": "Tomonaga, S. (2016, January 26). Windows Commands Abused by Attackers. Retrieved February 2, 2016.", "url": "http://blog.jpcert.or.jp/2016/01/windows-commands-abused-by-attackers.html"}, {"source_name": "NSA MS AppLocker", "description": "NSA Information Assurance Directorate. (2014, August). Application Whitelisting Using Microsoft AppLocker. Retrieved March 31, 2016.", "url": "https://www.iad.gov/iad/library/ia-guidance/tech-briefs/application-whitelisting-using-microsoft-applocker.cfm"}, {"source_name": "Corio 2008", "description": "Corio, C., & Sayana, D. P. (2008, June). Application Lockdown with Software Restriction Policies. Retrieved November 18, 2014.", "url": "http://technet.microsoft.com/en-us/magazine/2008.06.srp.aspx"}, {"source_name": "TechNet Applocker vs SRP", "description": "Microsoft. (2012, June 27). Using Software Restriction Policies and AppLocker Policies. Retrieved April 7, 2016.", "url": "https://technet.microsoft.com/en-us/library/ee791851.aspx"}], "modified": "2019-07-24T18:09:00.664Z", "created": "2018-10-17T00:14:20.652Z", "x_mitre_deprecated": true, "x_mitre_version": "1.0"}, {"created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5", "description": "Network intrusion detection and prevention systems that use network signatures to identify traffic for specific adversary malware can be used to mitigate activity at the network level. Signatures are often for unique indicators within protocols and may be based on the specific protocol used by a particular adversary or tool, and will likely be different across various malware families and versions. Adversaries will likely change tool C2 signatures over time or construct protocols in such a way as to avoid detection by common defensive tools. (Citation: University of Birmingham C2)", "type": "course-of-action", "name": "Commonly Used Port Mitigation", "object_marking_refs": ["marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"], "id": "course-of-action--7c1796c7-9fc3-4c3e-9416-527295bf5d95", "external_references": [{"external_id": "T1043", "source_name": "mitre-attack", "url": "https://attack.mitre.org/mitigations/T1043"}, {"source_name": "University of Birmingham C2", "description": "Gardiner, J.,  Cova, M., Nagaraja, S. (2014, February). Command & Control Understanding, Denying and Detecting. Retrieved April 20, 2016.", "url": "https://arxiv.org/ftp/arxiv/papers/1408/1408.1136.pdf"}], "modified": "2019-07-24T14:17:58.966Z", "created": "2018-10-17T00:14:20.652Z", "x_mitre_deprecated": true, "x_mitre_version": "1.0"}, {"created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5", "description": "### Windows\nMonitor/harden access to LSASS and SAM table with tools that allow process whitelisting. Limit credential overlap across systems to prevent lateral movement opportunities using [Valid Accounts](https://attack.mitre.org/techniques/T1078) if passwords and hashes are obtained. Ensure that local administrator accounts have complex, unique passwords across all systems on the network. Do not put user or admin domain accounts in the local administrator groups across systems unless they are tightly controlled, as this is often equivalent to having a local administrator account with the same password on all systems. Follow best practices for design and administration of an enterprise network to limit privileged account use across administrative tiers. (Citation: Microsoft Securing Privileged Access)\n\nOn Windows 8.1 and Windows Server 2012 R2, enable Protected Process Light for LSA. (Citation: Microsoft LSA)\n\nIdentify and block potentially malicious software that may be used to dump credentials by using whitelisting (Citation: Beechey 2010) tools, like AppLocker, (Citation: Windows Commands JPCERT) (Citation: NSA MS AppLocker) or Software Restriction Policies (Citation: Corio 2008) where appropriate. (Citation: TechNet Applocker vs SRP)\n\nWith Windows 10, Microsoft implemented new protections called Credential Guard to protect the LSA secrets that can be used to obtain credentials through forms of credential dumping. It is not configured by default and has hardware and firmware system requirements. (Citation: TechNet Credential Guard) It also does not protect against all forms of credential dumping. (Citation: GitHub SHB Credential Guard)\n\nManage the access control list for \u201cReplicating Directory Changes\u201d and other permissions associated with domain controller replication. (Citation: AdSecurity DCSync Sept 2015) (Citation: Microsoft Replication ACL)\n\nConsider disabling or restricting NTLM traffic. (Citation: Microsoft Disable NTLM Nov 2012)\n\n### Linux\nScraping the passwords from memory requires root privileges. Follow best practices in restricting access to escalated privileges to avoid hostile programs from accessing such sensitive regions of memory.", "type": "course-of-action", "name": "Credential Dumping Mitigation", "object_marking_refs": ["marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"], "id": "course-of-action--aeff5887-8f9e-48d5-a523-9b395e2ce80a", "external_references": [{"external_id": "T1003", "source_name": "mitre-attack", "url": "https://attack.mitre.org/mitigations/T1003"}, {"source_name": "Microsoft Securing Privileged Access", "description": "Plett, C., Poggemeyer, L. (12, October 26). Securing Privileged Access Reference Material. Retrieved April 25, 2017.", "url": "https://docs.microsoft.com/en-us/windows-server/identity/securing-privileged-access/securing-privileged-access-reference-material#a-nameesaebmaesae-administrative-forest-design-approach"}, {"source_name": "Microsoft LSA", "description": "Microsoft. (2013, July 31). Configuring Additional LSA Protection. Retrieved February 13, 2015.", "url": "https://technet.microsoft.com/en-us/library/dn408187.aspx"}, {"source_name": "Beechey 2010", "description": "Beechey, J. (2010, December). Application Whitelisting: Panacea or Propaganda?. Retrieved November 18, 2014.", "url": "http://www.sans.org/reading-room/whitepapers/application/application-whitelisting-panacea-propaganda-33599"}, {"source_name": "Windows Commands JPCERT", "description": "Tomonaga, S. (2016, January 26). Windows Commands Abused by Attackers. Retrieved February 2, 2016.", "url": "http://blog.jpcert.or.jp/2016/01/windows-commands-abused-by-attackers.html"}, {"source_name": "NSA MS AppLocker", "description": "NSA Information Assurance Directorate. (2014, August). Application Whitelisting Using Microsoft AppLocker. Retrieved March 31, 2016.", "url": "https://www.iad.gov/iad/library/ia-guidance/tech-briefs/application-whitelisting-using-microsoft-applocker.cfm"}, {"source_name": "Corio 2008", "description": "Corio, C., & Sayana, D. P. (2008, June). Application Lockdown with Software Restriction Policies. Retrieved November 18, 2014.", "url": "http://technet.microsoft.com/en-us/magazine/2008.06.srp.aspx"}, {"source_name": "TechNet Applocker vs SRP", "description": "Microsoft. (2012, June 27). Using Software Restriction Policies and AppLocker Policies. Retrieved April 7, 2016.", "url": "https://technet.microsoft.com/en-us/library/ee791851.aspx"}, {"source_name": "TechNet Credential Guard", "description": "Lich, B. (2016, May 31). Protect derived domain credentials with Credential Guard. Retrieved June 1, 2016.", "url": "https://technet.microsoft.com/en-us/itpro/windows/keep-secure/credential-guard"}, {"source_name": "GitHub SHB Credential Guard", "description": "NSA IAD. (2017, April 20). Secure Host Baseline - Credential Guard. Retrieved April 25, 2017.", "url": "https://github.com/iadgov/Secure-Host-Baseline/tree/master/Credential%20Guard"}, {"source_name": "AdSecurity DCSync Sept 2015", "description": "Metcalf, S. (2015, September 25). Mimikatz DCSync Usage, Exploitation, and Detection. Retrieved December 4, 2017.", "url": "https://adsecurity.org/?p=1729"}, {"source_name": "Microsoft Replication ACL", "description": "Microsoft. (n.d.). How to grant the \"Replicating Directory Changes\" permission for the Microsoft Metadirectory Services ADMA service account. Retrieved December 4, 2017.", "url": "https://support.microsoft.com/help/303972/how-to-grant-the-replicating-directory-changes-permission-for-the-micr"}, {"source_name": "Microsoft Disable NTLM Nov 2012", "description": "Microsoft. (2012, November 29). Using security policies to restrict NTLM traffic. Retrieved December 4, 2017.", "url": "https://technet.microsoft.com/library/jj865668.aspx"}], "modified": "2019-07-24T14:21:52.632Z", "created": "2018-10-17T00:14:20.652Z", "x_mitre_deprecated": true, "x_mitre_version": "1.0"}, {"created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5", "description": "Modify Registry settings (directly or using Dcomcnfg.exe) in <code>HKEY_LOCAL_MACHINE\\SOFTWARE\\Classes\\AppID\\{AppID_GUID}</code> associated with the process-wide security of individual COM applications. (Citation: Microsoft Process Wide Com Keys)\n\nModify Registry settings (directly or using Dcomcnfg.exe) in <code>HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Ole</code> associated with system-wide security defaults for all COM applications that do no set their own process-wide security. (Citation: Microsoft System Wide Com Keys) (Citation: Microsoft COM ACL)\n\nConsider disabling DCOM through Dcomcnfg.exe. (Citation: Microsoft Disable DCOM)\n\nEnable Windows firewall, which prevents DCOM instantiation by default.\n\nEnsure all COM alerts and Protected View are enabled. (Citation: Microsoft Protected View)", "type": "course-of-action", "name": "Distributed Component Object Model Mitigation", "object_marking_refs": ["marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"], "id": "course-of-action--910482b1-6749-4934-abcb-3e34d58294fc", "external_references": [{"external_id": "T1175", "source_name": "mitre-attack", "url": "https://attack.mitre.org/mitigations/T1175"}, {"source_name": "Microsoft Process Wide Com Keys", "description": "Microsoft. (n.d.). Setting Process-Wide Security Through the Registry. Retrieved November 21, 2017.", "url": "https://msdn.microsoft.com/en-us/library/windows/desktop/ms687317(v=vs.85).aspx"}, {"source_name": "Microsoft System Wide Com Keys", "description": "Microsoft. (n.d.). Registry Values for System-Wide Security. Retrieved November 21, 2017.", "url": "https://msdn.microsoft.com/en-us/library/windows/desktop/ms694331(v=vs.85).aspx"}, {"source_name": "Microsoft COM ACL", "description": "Microsoft. (n.d.). DCOM Security Enhancements in Windows XP Service Pack 2 and Windows Server 2003 Service Pack 1. Retrieved November 22, 2017.", "url": "https://docs.microsoft.com/en-us/windows/desktop/com/dcom-security-enhancements-in-windows-xp-service-pack-2-and-windows-server-2003-service-pack-1"}, {"source_name": "Microsoft Disable DCOM", "description": "Microsoft. (n.d.). Enable or Disable DCOM. Retrieved November 22, 2017.", "url": "https://technet.microsoft.com/library/cc771387.aspx"}, {"source_name": "Microsoft Protected View", "description": "Microsoft. (n.d.). What is Protected View?. Retrieved November 22, 2017.", "url": "https://support.office.com/en-us/article/What-is-Protected-View-d6f09ac7-e6b9-4495-8e43-2bbcdbcb6653"}], "modified": "2019-07-24T19:12:02.818Z", "created": "2018-10-17T00:14:20.652Z", "x_mitre_deprecated": true, "x_mitre_version": "1.0"}, {"created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5", "description": "Blocking software based on screen capture functionality may be difficult, and there may be legitimate software that performs those actions. Instead, identify potentially malicious software that may have functionality to acquire screen captures, and audit and/or block it by using whitelisting (Citation: Beechey 2010) tools, like AppLocker, (Citation: Windows Commands JPCERT) (Citation: NSA MS AppLocker) or Software Restriction Policies (Citation: Corio 2008) where appropriate. (Citation: TechNet Applocker vs SRP)", "type": "course-of-action", "name": "Screen Capture Mitigation", "object_marking_refs": ["marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"], "id": "course-of-action--51b37302-b844-4c08-ac98-ae6955ed1f55", "external_references": [{"external_id": "T1113", "source_name": "mitre-attack", "url": "https://attack.mitre.org/mitigations/T1113"}, {"source_name": "Beechey 2010", "description": "Beechey, J. (2010, December). Application Whitelisting: Panacea or Propaganda?. Retrieved November 18, 2014.", "url": "http://www.sans.org/reading-room/whitepapers/application/application-whitelisting-panacea-propaganda-33599"}, {"source_name": "Windows Commands JPCERT", "description": "Tomonaga, S. (2016, January 26). Windows Commands Abused by Attackers. Retrieved February 2, 2016.", "url": "http://blog.jpcert.or.jp/2016/01/windows-commands-abused-by-attackers.html"}, {"source_name": "NSA MS AppLocker", "description": "NSA Information Assurance Directorate. (2014, August). Application Whitelisting Using Microsoft AppLocker. Retrieved March 31, 2016.", "url": "https://www.iad.gov/iad/library/ia-guidance/tech-briefs/application-whitelisting-using-microsoft-applocker.cfm"}, {"source_name": "Corio 2008", "description": "Corio, C., & Sayana, D. P. (2008, June). Application Lockdown with Software Restriction Policies. Retrieved November 18, 2014.", "url": "http://technet.microsoft.com/en-us/magazine/2008.06.srp.aspx"}, {"source_name": "TechNet Applocker vs SRP", "description": "Microsoft. (2012, June 27). Using Software Restriction Policies and AppLocker Policies. Retrieved April 7, 2016.", "url": "https://technet.microsoft.com/en-us/library/ee791851.aspx"}], "modified": "2019-07-25T11:39:54.228Z", "created": "2018-10-17T00:14:20.652Z", "x_mitre_deprecated": true, "x_mitre_version": "1.0"}, {"created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5", "description": "Ensure that permissions disallow services that run at a higher permissions level from being created or interacted with by a user with a lower permission level. Also ensure that high permission level service binaries cannot be replaced or modified by users with a lower permission level.\n\nIdentify unnecessary system utilities or potentially malicious software that may be used to interact with Windows services, and audit and/or block them by using whitelisting (Citation: Beechey 2010) tools, like AppLocker, (Citation: Windows Commands JPCERT) (Citation: NSA MS AppLocker) or Software Restriction Policies (Citation: Corio 2008) where appropriate. (Citation: TechNet Applocker vs SRP)", "type": "course-of-action", "name": "Service Execution Mitigation", "object_marking_refs": ["marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"], "id": "course-of-action--d5dce4b9-f1fa-4c03-aff9-ce177246cb64", "external_references": [{"external_id": "T1035", "source_name": "mitre-attack", "url": "https://attack.mitre.org/mitigations/T1035"}, {"source_name": "Beechey 2010", "description": "Beechey, J. (2010, December). Application Whitelisting: Panacea or Propaganda?. Retrieved November 18, 2014.", "url": "http://www.sans.org/reading-room/whitepapers/application/application-whitelisting-panacea-propaganda-33599"}, {"source_name": "Windows Commands JPCERT", "description": "Tomonaga, S. (2016, January 26). Windows Commands Abused by Attackers. Retrieved February 2, 2016.", "url": "http://blog.jpcert.or.jp/2016/01/windows-commands-abused-by-attackers.html"}, {"source_name": "NSA MS AppLocker", "description": "NSA Information Assurance Directorate. (2014, August). Application Whitelisting Using Microsoft AppLocker. Retrieved March 31, 2016.", "url": "https://www.iad.gov/iad/library/ia-guidance/tech-briefs/application-whitelisting-using-microsoft-applocker.cfm"}, {"source_name": "Corio 2008", "description": "Corio, C., & Sayana, D. P. (2008, June). Application Lockdown with Software Restriction Policies. Retrieved November 18, 2014.", "url": "http://technet.microsoft.com/en-us/magazine/2008.06.srp.aspx"}, {"source_name": "TechNet Applocker vs SRP", "description": "Microsoft. (2012, June 27). Using Software Restriction Policies and AppLocker Policies. Retrieved April 7, 2016.", "url": "https://technet.microsoft.com/en-us/library/ee791851.aspx"}], "modified": "2019-07-25T11:42:04.284Z", "created": "2018-10-17T00:14:20.652Z", "x_mitre_deprecated": true, "x_mitre_version": "1.0"}, {"created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5", "description": "Network intrusion detection and prevention systems that use network signatures to identify traffic for specific adversary malware can be used to mitigate activity at the network level. Signatures are often for unique indicators within protocols and will be different across various malware families and versions. Adversaries will likely change tool signatures over time or construct protocols in such a way to avoid detection by common defensive tools. (Citation: University of Birmingham C2)", "type": "course-of-action", "name": "Standard Application Layer Protocol Mitigation", "object_marking_refs": ["marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"], "id": "course-of-action--addb3703-5a59-4461-9bcd-7e2b5d4e92a0", "external_references": [{"external_id": "T1071", "source_name": "mitre-attack", "url": "https://attack.mitre.org/mitigations/T1071"}, {"source_name": "University of Birmingham C2", "description": "Gardiner, J.,  Cova, M., Nagaraja, S. (2014, February). Command & Control Understanding, Denying and Detecting. Retrieved April 20, 2016.", "url": "https://arxiv.org/ftp/arxiv/papers/1408/1408.1136.pdf"}], "modified": "2019-07-25T12:00:42.159Z", "created": "2018-10-17T00:14:20.652Z", "x_mitre_deprecated": true, "x_mitre_version": "1.0"}, {"created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5", "description": "Update software regularly by employing patch management for internal enterprise endpoints and servers. Develop a robust cyber threat intelligence capability to determine what types and levels of threat may use software exploits and 0-days against a particular organization. Make it difficult for adversaries to advance their operation through exploitation of undiscovered or unpatched vulnerabilities by using sandboxing, if available. Other types of virtualization and application microsegmentation may also mitigate the impact of some types of client-side exploitation. The risks of additional exploits and weaknesses in implementation may still exist. (Citation: Ars Technica Pwn2Own 2017 VM Escape)\n\nSecurity applications that look for behavior used during exploitation such as Windows Defender Exploit Guard (WDEG) and the Enhanced Mitigation Experience Toolkit (EMET) can be used to mitigate some exploitation behavior. (Citation: TechNet Moving Beyond EMET) Control flow integrity checking is another way to potentially identify and stop a software exploit from occurring. (Citation: Wikipedia Control Flow Integrity) Many of these protections depend on the architecture and target application binary for compatibility and may not work for software components targeted for privilege escalation.", "type": "course-of-action", "name": "Exploitation for Privilege Escalation Mitigation", "object_marking_refs": ["marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"], "id": "course-of-action--92e6d080-ca3f-4f95-bc45-172a32c4e502", "external_references": [{"external_id": "T1068", "source_name": "mitre-attack", "url": "https://attack.mitre.org/mitigations/T1068"}, {"source_name": "Ars Technica Pwn2Own 2017 VM Escape", "description": "Goodin, D. (2017, March 17). Virtual machine escape fetches $105,000 at Pwn2Own hacking contest - updated. Retrieved March 12, 2018.", "url": "https://arstechnica.com/information-technology/2017/03/hack-that-escapes-vm-by-exploiting-edge-browser-fetches-105000-at-pwn2own/"}, {"source_name": "TechNet Moving Beyond EMET", "description": "Nunez, N. (2017, August 9). Moving Beyond EMET II \u2013 Windows Defender Exploit Guard. Retrieved March 12, 2018.", "url": "https://blogs.technet.microsoft.com/srd/2017/08/09/moving-beyond-emet-ii-windows-defender-exploit-guard/"}, {"source_name": "Wikipedia Control Flow Integrity", "description": "Wikipedia. (2018, January 11). Control-flow integrity. Retrieved March 12, 2018.", "url": "https://en.wikipedia.org/wiki/Control-flow_integrity"}], "modified": "2019-07-24T19:26:18.998Z", "created": "2018-10-17T00:14:20.652Z", "x_mitre_deprecated": true, "x_mitre_version": "1.0"}, {"created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5", "description": "Mitigation is difficult in instances like this because the adversary may have access to the system through another channel and can learn what techniques or tools are blocked by resident defenses. Exercising best practices with configuration and security as well as ensuring that proper process is followed during investigation of potential compromise is essential to detecting a larger intrusion through discrete alerts.\n\nIdentify and block potentially malicious software that may be used by an adversary by using whitelisting (Citation: Beechey 2010) tools like AppLocker (Citation: Windows Commands JPCERT) (Citation: NSA MS AppLocker) or Software Restriction Policies (Citation: Corio 2008) where appropriate. (Citation: TechNet Applocker vs SRP)", "type": "course-of-action", "name": "Indicator Removal from Tools Mitigation", "object_marking_refs": ["marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"], "id": "course-of-action--4b998a71-7b8f-4dcc-8f3f-277f2e740271", "external_references": [{"external_id": "T1066", "source_name": "mitre-attack", "url": "https://attack.mitre.org/mitigations/T1066"}, {"source_name": "Beechey 2010", "description": "Beechey, J. (2010, December). Application Whitelisting: Panacea or Propaganda?. Retrieved November 18, 2014.", "url": "http://www.sans.org/reading-room/whitepapers/application/application-whitelisting-panacea-propaganda-33599"}, {"source_name": "Windows Commands JPCERT", "description": "Tomonaga, S. (2016, January 26). Windows Commands Abused by Attackers. Retrieved February 2, 2016.", "url": "http://blog.jpcert.or.jp/2016/01/windows-commands-abused-by-attackers.html"}, {"source_name": "NSA MS AppLocker", "description": "NSA Information Assurance Directorate. (2014, August). Application Whitelisting Using Microsoft AppLocker. Retrieved March 31, 2016.", "url": "https://www.iad.gov/iad/library/ia-guidance/tech-briefs/application-whitelisting-using-microsoft-applocker.cfm"}, {"source_name": "Corio 2008", "description": "Corio, C., & Sayana, D. P. (2008, June). Application Lockdown with Software Restriction Policies. Retrieved November 18, 2014.", "url": "http://technet.microsoft.com/en-us/magazine/2008.06.srp.aspx"}, {"source_name": "TechNet Applocker vs SRP", "description": "Microsoft. (2012, June 27). Using Software Restriction Policies and AppLocker Policies. Retrieved April 7, 2016.", "url": "https://technet.microsoft.com/en-us/library/ee791851.aspx"}], "modified": "2019-07-24T19:40:00.118Z", "created": "2018-10-17T00:14:20.652Z", "x_mitre_deprecated": true, "x_mitre_version": "1.0"}, {"created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5", "description": "Identify unnecessary system utilities or potentially malicious software that may be used to acquire network share information, and audit and/or block them by using whitelisting (Citation: Beechey 2010) tools, like AppLocker, (Citation: Windows Commands JPCERT) (Citation: NSA MS AppLocker) or Software Restriction Policies (Citation: Corio 2008) where appropriate. (Citation: TechNet Applocker vs SRP)", "type": "course-of-action", "name": "Network Share Discovery Mitigation", "object_marking_refs": ["marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"], "id": "course-of-action--1f34230d-b6ae-4dc7-8599-78c18820bd21", "external_references": [{"external_id": "T1135", "source_name": "mitre-attack", "url": "https://attack.mitre.org/mitigations/T1135"}, {"source_name": "Beechey 2010", "description": "Beechey, J. (2010, December). Application Whitelisting: Panacea or Propaganda?. Retrieved November 18, 2014.", "url": "http://www.sans.org/reading-room/whitepapers/application/application-whitelisting-panacea-propaganda-33599"}, {"source_name": "Windows Commands JPCERT", "description": "Tomonaga, S. (2016, January 26). Windows Commands Abused by Attackers. Retrieved February 2, 2016.", "url": "http://blog.jpcert.or.jp/2016/01/windows-commands-abused-by-attackers.html"}, {"source_name": "NSA MS AppLocker", "description": "NSA Information Assurance Directorate. (2014, August). Application Whitelisting Using Microsoft AppLocker. Retrieved March 31, 2016.", "url": "https://www.iad.gov/iad/library/ia-guidance/tech-briefs/application-whitelisting-using-microsoft-applocker.cfm"}, {"source_name": "Corio 2008", "description": "Corio, C., & Sayana, D. P. (2008, June). Application Lockdown with Software Restriction Policies. Retrieved November 18, 2014.", "url": "http://technet.microsoft.com/en-us/magazine/2008.06.srp.aspx"}, {"source_name": "TechNet Applocker vs SRP", "description": "Microsoft. (2012, June 27). Using Software Restriction Policies and AppLocker Policies. Retrieved April 7, 2016.", "url": "https://technet.microsoft.com/en-us/library/ee791851.aspx"}], "modified": "2019-07-25T11:18:18.170Z", "created": "2018-10-17T00:14:20.652Z", "x_mitre_deprecated": true, "x_mitre_version": "1.0"}, {"created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5", "description": "Turn off unused features or restrict access to scripting engines such as VBScript or scriptable administration frameworks such as PowerShell.\n\nConfigure Office security settings enable Protected View, to execute within a sandbox environment, and to block macros through Group Policy. (Citation: Microsoft Block Office Macros) Other types of virtualization and application microsegmentation may also mitigate the impact of compromise. The risks of additional exploits and weaknesses in implementation may still exist. (Citation: Ars Technica Pwn2Own 2017 VM Escape)", "type": "course-of-action", "name": "Scripting Mitigation", "object_marking_refs": ["marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"], "id": "course-of-action--57019a80-8523-46b6-be7d-f763a15a2cc6", "external_references": [{"external_id": "T1064", "source_name": "mitre-attack", "url": "https://attack.mitre.org/mitigations/T1064"}, {"source_name": "Microsoft Block Office Macros", "description": "Windows Defender Research. (2016, March 22). New feature in Office 2016 can block macros and help prevent infection. Retrieved April 11, 2018.", "url": "https://cloudblogs.microsoft.com/microsoftsecure/2016/03/22/new-feature-in-office-2016-can-block-macros-and-help-prevent-infection/"}, {"source_name": "Ars Technica Pwn2Own 2017 VM Escape", "description": "Goodin, D. (2017, March 17). Virtual machine escape fetches $105,000 at Pwn2Own hacking contest - updated. Retrieved March 12, 2018.", "url": "https://arstechnica.com/information-technology/2017/03/hack-that-escapes-vm-by-exploiting-edge-browser-fetches-105000-at-pwn2own/"}], "modified": "2019-07-25T11:40:52.342Z", "created": "2018-10-17T00:14:20.652Z", "x_mitre_deprecated": true, "x_mitre_version": "1.0"}, {"created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5", "description": "Mitigating specific API calls will likely have unintended side effects, such as preventing legitimate software from operating properly. Efforts should be focused on preventing adversary tools from running earlier in the chain of activity and on identifying subsequent malicious behavior. Audit and/or block potentially malicious software by using whitelisting (Citation: Beechey 2010) tools, like AppLocker, (Citation: Windows Commands JPCERT) (Citation: NSA MS AppLocker) or Software Restriction Policies (Citation: Corio 2008) where appropriate. (Citation: TechNet Applocker vs SRP)", "type": "course-of-action", "name": "Execution through API Mitigation", "object_marking_refs": ["marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"], "id": "course-of-action--56db6ccc-433d-4411-8383-c3fd7053e2c8", "external_references": [{"external_id": "T1106", "source_name": "mitre-attack", "url": "https://attack.mitre.org/mitigations/T1106"}, {"source_name": "Beechey 2010", "description": "Beechey, J. (2010, December). Application Whitelisting: Panacea or Propaganda?. Retrieved November 18, 2014.", "url": "http://www.sans.org/reading-room/whitepapers/application/application-whitelisting-panacea-propaganda-33599"}, {"source_name": "Windows Commands JPCERT", "description": "Tomonaga, S. (2016, January 26). Windows Commands Abused by Attackers. Retrieved February 2, 2016.", "url": "http://blog.jpcert.or.jp/2016/01/windows-commands-abused-by-attackers.html"}, {"source_name": "NSA MS AppLocker", "description": "NSA Information Assurance Directorate. (2014, August). Application Whitelisting Using Microsoft AppLocker. Retrieved March 31, 2016.", "url": "https://www.iad.gov/iad/library/ia-guidance/tech-briefs/application-whitelisting-using-microsoft-applocker.cfm"}, {"source_name": "Corio 2008", "description": "Corio, C., & Sayana, D. P. (2008, June). Application Lockdown with Software Restriction Policies. Retrieved November 18, 2014.", "url": "http://technet.microsoft.com/en-us/magazine/2008.06.srp.aspx"}, {"source_name": "TechNet Applocker vs SRP", "description": "Microsoft. (2012, June 27). Using Software Restriction Policies and AppLocker Policies. Retrieved April 7, 2016.", "url": "https://technet.microsoft.com/en-us/library/ee791851.aspx"}], "modified": "2019-07-24T19:17:59.534Z", "created": "2018-10-17T00:14:20.652Z", "x_mitre_deprecated": true, "x_mitre_version": "1.0"}, {"created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5", "description": "Identify and block potentially malicious software that may be used to acquire credentials or information from the user by using whitelisting (Citation: Beechey 2010) tools, like AppLocker, (Citation: Windows Commands JPCERT) (Citation: NSA MS AppLocker) or Software Restriction Policies (Citation: Corio 2008) where appropriate. (Citation: TechNet Applocker vs SRP)\n\nIn cases where this behavior is difficult to detect or mitigate, efforts can be made to lessen some of the impact that might result from an adversary acquiring credential information. It is also good practice to follow mitigation recommendations for adversary use of [Valid Accounts](https://attack.mitre.org/techniques/T1078).", "type": "course-of-action", "name": "Input Capture Mitigation", "object_marking_refs": ["marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"], "id": "course-of-action--da8a87d2-946d-4c34-9a30-709058b98996", "external_references": [{"external_id": "T1056", "source_name": "mitre-attack", "url": "https://attack.mitre.org/mitigations/T1056"}, {"source_name": "Beechey 2010", "description": "Beechey, J. (2010, December). Application Whitelisting: Panacea or Propaganda?. Retrieved November 18, 2014.", "url": "http://www.sans.org/reading-room/whitepapers/application/application-whitelisting-panacea-propaganda-33599"}, {"source_name": "Windows Commands JPCERT", "description": "Tomonaga, S. (2016, January 26). Windows Commands Abused by Attackers. Retrieved February 2, 2016.", "url": "http://blog.jpcert.or.jp/2016/01/windows-commands-abused-by-attackers.html"}, {"source_name": "NSA MS AppLocker", "description": "NSA Information Assurance Directorate. (2014, August). Application Whitelisting Using Microsoft AppLocker. Retrieved March 31, 2016.", "url": "https://www.iad.gov/iad/library/ia-guidance/tech-briefs/application-whitelisting-using-microsoft-applocker.cfm"}, {"source_name": "Corio 2008", "description": "Corio, C., & Sayana, D. P. (2008, June). Application Lockdown with Software Restriction Policies. Retrieved November 18, 2014.", "url": "http://technet.microsoft.com/en-us/magazine/2008.06.srp.aspx"}, {"source_name": "TechNet Applocker vs SRP", "description": "Microsoft. (2012, June 27). Using Software Restriction Policies and AppLocker Policies. Retrieved April 7, 2016.", "url": "https://technet.microsoft.com/en-us/library/ee791851.aspx"}], "modified": "2019-07-24T19:42:17.622Z", "created": "2018-10-17T00:14:20.652Z", "x_mitre_deprecated": true, "x_mitre_version": "1.0"}, {"created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5", "description": "This type of attack technique cannot be easily mitigated with preventive controls since it is based on the abuse of operating system design features. For example, mitigating specific Windows API calls will likely have unintended side effects, such as preventing legitimate software (i.e., security products) from operating properly. Efforts should be focused on preventing adversary tools from running earlier in the chain of activity and on identification of subsequent malicious behavior. (Citation: GDSecurity Linux injection)\n\nIdentify or block potentially malicious software that may contain process injection functionality by using whitelisting (Citation: Beechey 2010) tools, like AppLocker, (Citation: Windows Commands JPCERT) (Citation: NSA MS AppLocker) or Software Restriction Policies (Citation: Corio 2008) where appropriate. (Citation: TechNet Applocker vs SRP)\n\nUtilize Yama  (Citation: Linux kernel Yama) to mitigate ptrace based process injection by restricting the use of ptrace to privileged users only. Other mitigation controls involve the deployment of security kernel modules that provide advanced access control and process restrictions such as SELinux  (Citation: SELinux official), grsecurity  (Citation: grsecurity official), and AppAmour  (Citation: AppArmor official).", "type": "course-of-action", "name": "Process Injection Mitigation", "object_marking_refs": ["marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"], "id": "course-of-action--74febc44-8955-4e4d-aca0-d4dad2f967d7", "external_references": [{"external_id": "T1055", "source_name": "mitre-attack", "url": "https://attack.mitre.org/mitigations/T1055"}, {"source_name": "GDSecurity Linux injection", "description": "McNamara, R. (2017, September 5). Linux Based Inter-Process Code Injection Without Ptrace(2). Retrieved December 20, 2017.", "url": "https://blog.gdssecurity.com/labs/2017/9/5/linux-based-inter-process-code-injection-without-ptrace2.html"}, {"source_name": "Beechey 2010", "description": "Beechey, J. (2010, December). Application Whitelisting: Panacea or Propaganda?. Retrieved November 18, 2014.", "url": "http://www.sans.org/reading-room/whitepapers/application/application-whitelisting-panacea-propaganda-33599"}, {"source_name": "Windows Commands JPCERT", "description": "Tomonaga, S. (2016, January 26). Windows Commands Abused by Attackers. Retrieved February 2, 2016.", "url": "http://blog.jpcert.or.jp/2016/01/windows-commands-abused-by-attackers.html"}, {"source_name": "NSA MS AppLocker", "description": "NSA Information Assurance Directorate. (2014, August). Application Whitelisting Using Microsoft AppLocker. Retrieved March 31, 2016.", "url": "https://www.iad.gov/iad/library/ia-guidance/tech-briefs/application-whitelisting-using-microsoft-applocker.cfm"}, {"source_name": "Corio 2008", "description": "Corio, C., & Sayana, D. P. (2008, June). Application Lockdown with Software Restriction Policies. Retrieved November 18, 2014.", "url": "http://technet.microsoft.com/en-us/magazine/2008.06.srp.aspx"}, {"source_name": "TechNet Applocker vs SRP", "description": "Microsoft. (2012, June 27). Using Software Restriction Policies and AppLocker Policies. Retrieved April 7, 2016.", "url": "https://technet.microsoft.com/en-us/library/ee791851.aspx"}, {"source_name": "Linux kernel Yama", "description": "Linux Kernel Archives. (n.d.). Yama Documentation - ptrace_scope. Retrieved December 20, 2017.", "url": "https://www.kernel.org/doc/Documentation/security/Yama.txt"}, {"source_name": "SELinux official", "description": "SELinux Project. (2017, November 30). SELinux Project Wiki. Retrieved December 20, 2017.", "url": "https://selinuxproject.org/page/Main_Page"}, {"source_name": "grsecurity official", "description": "grsecurity. (2017, December 12). What is grsecurity?. Retrieved December 20, 2017.", "url": "https://grsecurity.net/"}, {"source_name": "AppArmor official", "description": "AppArmor. (2017, October 19). AppArmor Security Project Wiki. Retrieved December 20, 2017.", "url": "http://wiki.apparmor.net/index.php/Main_Page"}], "modified": "2019-07-25T11:28:40.438Z", "created": "2018-10-17T00:14:20.652Z", "x_mitre_deprecated": true, "x_mitre_version": "1.0"}, {"created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5", "description": "Disable the RDP service if it is unnecessary, remove unnecessary accounts and groups from Remote Desktop Users groups, and enable firewall rules to block RDP traffic between network security zones. Audit the Remote Desktop Users group membership regularly. Remove the local Administrators group from the list of groups allowed to log in through RDP. Limit remote user permissions if remote access is necessary. Use remote desktop gateways and multifactor authentication for remote logins. (Citation: Berkley Secure) Do not leave RDP accessible from the internet. Change GPOs to define shorter timeouts sessions and maximum amount of time any single session can be active. Change GPOs to specify the maximum amount of time that a disconnected session stays active on the RD session host server. (Citation: Windows RDP Sessions)", "type": "course-of-action", "name": "Remote Desktop Protocol Mitigation", "object_marking_refs": ["marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"], "id": "course-of-action--53b3b027-bed3-480c-9101-1247047d0fe6", "external_references": [{"external_id": "T1076", "source_name": "mitre-attack", "url": "https://attack.mitre.org/mitigations/T1076"}, {"source_name": "Berkley Secure", "description": "Berkeley Security, University of California. (n.d.). Securing Remote Desktop for System Administrators. Retrieved November 4, 2014.", "url": "https://security.berkeley.edu/node/94"}, {"source_name": "Windows RDP Sessions", "description": "Microsoft. (n.d.). Configure Timeout and Reconnection Settings for Remote Desktop Services Sessions. Retrieved December 11, 2017.", "url": "https://technet.microsoft.com/en-us/library/cc754272(v=ws.11).aspx"}], "modified": "2019-07-25T11:33:10.069Z", "created": "2018-10-17T00:14:20.652Z", "x_mitre_deprecated": true, "x_mitre_version": "1.0"}, {"created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5", "description": "Mitigation of timestomping specifically is likely difficult. Efforts should be focused on preventing potentially malicious software from running. Identify and block potentially malicious software that may contain functionality to perform timestomping by using whitelisting (Citation: Beechey 2010) tools like AppLocker (Citation: Windows Commands JPCERT) (Citation: NSA MS AppLocker) or Software Restriction Policies (Citation: Corio 2008) where appropriate. (Citation: TechNet Applocker vs SRP)", "type": "course-of-action", "name": "Timestomp Mitigation", "object_marking_refs": ["marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"], "id": "course-of-action--5c167af7-c2cb-42c8-ae67-3fb275bf8488", "external_references": [{"external_id": "T1099", "source_name": "mitre-attack", "url": "https://attack.mitre.org/mitigations/T1099"}, {"source_name": "Beechey 2010", "description": "Beechey, J. (2010, December). Application Whitelisting: Panacea or Propaganda?. Retrieved November 18, 2014.", "url": "http://www.sans.org/reading-room/whitepapers/application/application-whitelisting-panacea-propaganda-33599"}, {"source_name": "Windows Commands JPCERT", "description": "Tomonaga, S. (2016, January 26). Windows Commands Abused by Attackers. Retrieved February 2, 2016.", "url": "http://blog.jpcert.or.jp/2016/01/windows-commands-abused-by-attackers.html"}, {"source_name": "NSA MS AppLocker", "description": "NSA Information Assurance Directorate. (2014, August). Application Whitelisting Using Microsoft AppLocker. Retrieved March 31, 2016.", "url": "https://www.iad.gov/iad/library/ia-guidance/tech-briefs/application-whitelisting-using-microsoft-applocker.cfm"}, {"source_name": "Corio 2008", "description": "Corio, C., & Sayana, D. P. (2008, June). Application Lockdown with Software Restriction Policies. Retrieved November 18, 2014.", "url": "http://technet.microsoft.com/en-us/magazine/2008.06.srp.aspx"}, {"source_name": "TechNet Applocker vs SRP", "description": "Microsoft. (2012, June 27). Using Software Restriction Policies and AppLocker Policies. Retrieved April 7, 2016.", "url": "https://technet.microsoft.com/en-us/library/ee791851.aspx"}], "modified": "2019-07-25T12:28:38.388Z", "created": "2018-10-17T00:14:20.652Z", "x_mitre_deprecated": true, "x_mitre_version": "1.0"}, {"created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5", "description": "Disabling WMI or RPCS may cause system instability and should be evaluated to assess the impact to a network. By default, only administrators are allowed to connect remotely using WMI. Restrict other users who are allowed to connect, or disallow all users to connect remotely to WMI. Prevent credential overlap across systems of administrator and privileged accounts. (Citation: FireEye WMI 2015)", "type": "course-of-action", "name": "Windows Management Instrumentation Mitigation", "object_marking_refs": ["marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"], "id": "course-of-action--ba2ec548-fb75-4b8c-88d6-d91a77a943cf", "external_references": [{"external_id": "T1047", "source_name": "mitre-attack", "url": "https://attack.mitre.org/mitigations/T1047"}, {"source_name": "FireEye WMI 2015", "description": "Ballenthin, W., et al. (2015). Windows Management Instrumentation (WMI) Offense, Defense, and Forensics. Retrieved March 30, 2016.", "url": "https://www.fireeye.com/content/dam/fireeye-www/global/en/current-threats/pdfs/wp-windows-management-instrumentation.pdf"}], "modified": "2019-07-25T12:35:34.895Z", "created": "2018-10-17T00:14:20.652Z", "x_mitre_deprecated": true, "x_mitre_version": "1.0"}, {"created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5", "description": "Take measures to detect or prevent techniques such as [Credential Dumping](https://attack.mitre.org/techniques/T1003) or installation of keyloggers to acquire credentials through [Input Capture](https://attack.mitre.org/techniques/T1056). Limit credential overlap across systems to prevent access if account credentials are obtained. Ensure that local administrator accounts have complex, unique passwords across all systems on the network. Do not put user or admin domain accounts in the local administrator groups across systems unless they are tightly controlled and use of accounts is segmented, as this is often equivalent to having a local administrator account with the same password on all systems. \n\nFollow best practices for design and administration of an enterprise network to limit privileged account use across administrative tiers. (Citation: Microsoft Securing Privileged Access) \n\nAudit domain and local accounts as well as their permission levels routinely to look for situations that could allow an adversary to gain wide access by obtaining credentials of a privileged account. (Citation: TechNet Credential Theft) (Citation: TechNet Least Privilege) These audits should also include if default accounts have been enabled, or if new local accounts are created that have not be authorized. \n\nApplications and appliances that utilize default username and password should be changed immediately after the installation, and before deployment to a production environment. (Citation: US-CERT Alert TA13-175A Risks of Default Passwords on the Internet) When possible, applications that use SSH keys should be updated periodically and properly secured. ", "type": "course-of-action", "name": "Valid Accounts Mitigation", "object_marking_refs": ["marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"], "id": "course-of-action--d45f03a8-790a-4f90-b956-cd7e5b8886bf", "external_references": [{"external_id": "T1078", "source_name": "mitre-attack", "url": "https://attack.mitre.org/mitigations/T1078"}, {"source_name": "Microsoft Securing Privileged Access", "description": "Plett, C., Poggemeyer, L. (12, October 26). Securing Privileged Access Reference Material. Retrieved April 25, 2017.", "url": "https://docs.microsoft.com/en-us/windows-server/identity/securing-privileged-access/securing-privileged-access-reference-material#a-nameesaebmaesae-administrative-forest-design-approach"}, {"source_name": "TechNet Credential Theft", "description": "Microsoft. (2016, April 15). Attractive Accounts for Credential Theft. Retrieved June 3, 2016.", "url": "https://technet.microsoft.com/en-us/library/dn535501.aspx"}, {"source_name": "TechNet Least Privilege", "description": "Microsoft. (2016, April 16). Implementing Least-Privilege Administrative Models. Retrieved June 3, 2016.", "url": "https://technet.microsoft.com/en-us/library/dn487450.aspx"}, {"source_name": "US-CERT Alert TA13-175A Risks of Default Passwords on the Internet", "description": "undefined. (n.d.). Risks of Default Passwords on the Internet. Retrieved April 12, 2019.", "url": "https://www.us-cert.gov/ncas/alerts/TA13-175A"}], "modified": "2019-07-25T12:32:31.844Z", "created": "2018-10-17T00:14:20.652Z", "x_mitre_deprecated": true, "x_mitre_version": "1.0"}, {"created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5", "description": "Disable the WinRM service. If the service is necessary, lock down critical enclaves with separate WinRM infrastructure, accounts, and permissions. Follow WinRM best practices on configuration of authentication methods and use of host firewalls to restrict WinRM access to allow communication only to/from specific devices. (Citation: NSA Spotting)", "type": "course-of-action", "name": "Windows Remote Management Mitigation", "object_marking_refs": ["marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"], "id": "course-of-action--3e9f8875-d2f7-4380-a578-84393bd3b025", "external_references": [{"external_id": "T1028", "source_name": "mitre-attack", "url": "https://attack.mitre.org/mitigations/T1028"}, {"source_name": "NSA Spotting", "description": "National Security Agency/Central Security Service Information Assurance Directorate. (2015, August 7). Spotting the Adversary with Windows Event Log Monitoring. Retrieved September 6, 2018.", "url": "https://www.iad.gov/iad/library/reports/spotting-the-adversary-with-windows-event-log-monitoring.cfm"}], "modified": "2019-07-25T12:35:58.687Z", "created": "2018-10-17T00:14:20.652Z", "x_mitre_deprecated": true, "x_mitre_version": "1.0"}, {"created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5", "description": "Identify and block potentially malicious software executed that may be executed through this technique by using application whitelisting tools, like Windows Defender Application Control, AppLocker, or Software Restriction Policies where appropriate.", "type": "relationship", "created": "2019-06-20T14:28:20.218Z", "object_marking_refs": ["marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"], "id": "relationship--42f4db8f-ef8b-4dcc-8c8f-4d0b5219c8b7", "external_references": [{"source_name": "Beechey 2010", "description": "Beechey, J. (2010, December). Application Whitelisting: Panacea or Propaganda?. Retrieved November 18, 2014.", "url": "http://www.sans.org/reading-room/whitepapers/application/application-whitelisting-panacea-propaganda-33599"}, {"source_name": "Microsoft Windows Defender Application Control", "description": "Gorzelany, A., Hall, J., Poggemeyer, L.. (2019, January 7). Windows Defender Application Control. Retrieved July 16, 2019.", "url": "https://docs.microsoft.com/en-us/windows/security/threat-protection/windows-defender-application-control/windows-defender-application-control"}, {"source_name": "Windows Commands JPCERT", "description": "Tomonaga, S. (2016, January 26). Windows Commands Abused by Attackers. Retrieved February 2, 2016.", "url": "http://blog.jpcert.or.jp/2016/01/windows-commands-abused-by-attackers.html"}, {"source_name": "NSA MS AppLocker", "description": "NSA Information Assurance Directorate. (2014, August). Application Whitelisting Using Microsoft AppLocker. Retrieved March 31, 2016.", "url": "https://www.iad.gov/iad/library/ia-guidance/tech-briefs/application-whitelisting-using-microsoft-applocker.cfm"}, {"source_name": "Corio 2008", "description": "Corio, C., & Sayana, D. P. (2008, June). Application Lockdown with Software Restriction Policies. Retrieved November 18, 2014.", "url": "http://technet.microsoft.com/en-us/magazine/2008.06.srp.aspx"}, {"source_name": "TechNet Applocker vs SRP", "description": "Microsoft. (2012, June 27). Using Software Restriction Policies and AppLocker Policies. Retrieved April 7, 2016.", "url": "https://technet.microsoft.com/en-us/library/ee791851.aspx"}], "modified": "2019-07-17T20:10:02.242Z", "source_ref": "course-of-action--47e0e9fe-96ce-4f65-8bb1-8be1feacb5db", "relationship_type": "mitigates", "target_ref": "attack-pattern--391d824f-0ef1-47a0-b0ee-c59a75e27670"}, {"created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5", "description": "Network intrusion detection and prevention systems that use network signatures to identify traffic for specific adversary malware can be used to mitigate activity at the network level. Signatures are often for unique indicators within protocols and may be based on the specific protocol used by a particular adversary or tool, and will likely be different across various malware families and versions. Adversaries will likely change tool C2 signatures over time or construct protocols in such a way as to avoid detection by common defensive tools.", "type": "relationship", "created": "2019-06-14T17:27:00.791Z", "object_marking_refs": ["marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"], "id": "relationship--82f1fa31-c796-474d-a58a-5ea8250a3118", "external_references": [{"source_name": "University of Birmingham C2", "description": "Gardiner, J.,  Cova, M., Nagaraja, S. (2014, February). Command & Control Understanding, Denying and Detecting. Retrieved April 20, 2016.", "url": "https://arxiv.org/ftp/arxiv/papers/1408/1408.1136.pdf"}], "modified": "2019-07-17T18:20:50.682Z", "source_ref": "course-of-action--12241367-a8b7-49b4-b86e-2236901ba50c", "relationship_type": "mitigates", "target_ref": "attack-pattern--f72eb8a8-cd4c-461d-a814-3f862befbf00"}, {"created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5", "description": "Properly configure firewalls and proxies to limit outgoing traffic to only necessary ports and through proper network gateway systems. Also ensure hosts are only provisioned to communicate over authorized interfaces.", "type": "relationship", "created": "2019-06-14T17:27:00.773Z", "object_marking_refs": ["marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"], "id": "relationship--4a8ad303-7a40-4396-8553-daef264dac71", "modified": "2019-07-17T18:20:50.675Z", "source_ref": "course-of-action--86598de0-b347-4928-9eb0-0acbfc21908c", "relationship_type": "mitigates", "target_ref": "attack-pattern--f72eb8a8-cd4c-461d-a814-3f862befbf00"}, {"created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5", "description": "With Windows 10, Microsoft implemented new protections called Credential Guard to protect the LSA secrets that can be used to obtain credentials through forms of credential dumping. It is not configured by default and has hardware and firmware system requirements. It also does not protect against all forms of credential dumping.", "type": "relationship", "created": "2019-06-14T17:21:38.632Z", "object_marking_refs": ["marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"], "id": "relationship--ee8ef62a-fcde-44b0-aa63-4028dad703aa", "external_references": [{"source_name": "TechNet Credential Guard", "description": "Lich, B. (2016, May 31). Protect derived domain credentials with Credential Guard. Retrieved June 1, 2016.", "url": "https://technet.microsoft.com/en-us/itpro/windows/keep-secure/credential-guard"}, {"source_name": "GitHub SHB Credential Guard", "description": "NSA IAD. (2017, April 20). Secure Host Baseline - Credential Guard. Retrieved April 25, 2017.", "url": "https://github.com/iadgov/Secure-Host-Baseline/tree/master/Credential%20Guard"}], "modified": "2019-07-26T19:54:07.416Z", "source_ref": "course-of-action--49c06d54-9002-491d-9147-8efb537fbd26", "relationship_type": "mitigates", "target_ref": "attack-pattern--0a3ead4e-6d47-4ccb-854c-a6a4f9d96b22"}, {"created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5", "description": "Ensure that local administrator accounts have complex, unique passwords across all systems on the network.", "type": "relationship", "created": "2019-06-14T17:21:38.582Z", "object_marking_refs": ["marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"], "id": "relationship--7a3426bf-1751-43db-b844-6bf388a4c817", "modified": "2019-07-26T19:54:07.390Z", "source_ref": "course-of-action--90c218c3-fbf8-4830-98a7-e8cfb7eaa485", "relationship_type": "mitigates", "target_ref": "attack-pattern--0a3ead4e-6d47-4ccb-854c-a6a4f9d96b22"}, {"created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5", "description": "###Windows\nDo not put user or admin domain accounts in the local administrator groups across systems unless they are tightly controlled, as this is often equivalent to having a local administrator account with the same password on all systems. Follow best practices for design and administration of an enterprise network to limit privileged account use across administrative tiers.\n\n###Linux\nScraping the passwords from memory requires root privileges. Follow best practices in restricting access to privileged accounts to avoid hostile programs from accessing such sensitive regions of memory.", "type": "relationship", "created": "2019-06-14T17:21:38.567Z", "object_marking_refs": ["marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"], "id": "relationship--a266294c-18a7-4a6e-8291-a901748c929c", "external_references": [{"source_name": "Microsoft Securing Privileged Access", "description": "Plett, C., Poggemeyer, L. (12, October 26). Securing Privileged Access Reference Material. Retrieved April 25, 2017.", "url": "https://docs.microsoft.com/en-us/windows-server/identity/securing-privileged-access/securing-privileged-access-reference-material#a-nameesaebmaesae-administrative-forest-design-approach"}], "modified": "2019-07-26T19:54:07.381Z", "source_ref": "course-of-action--9bb9e696-bff8-4ae1-9454-961fc7d91d5f", "relationship_type": "mitigates", "target_ref": "attack-pattern--0a3ead4e-6d47-4ccb-854c-a6a4f9d96b22"}, {"created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5", "description": "Network intrusion detection and prevention systems that use network signatures to identify traffic for specific adversary malware can be used to mitigate activity at the network level. Signatures are often for unique indicators within protocols and may be based on the specific C2 protocol used by a particular adversary or tool, and will likely be different across various malware families and versions. Adversaries will likely change tool C2 signatures over time or construct protocols in such a way as to avoid detection by common defensive tools.", "type": "relationship", "created": "2019-06-14T17:11:30.497Z", "object_marking_refs": ["marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"], "id": "relationship--d50b5687-ea69-40f9-86f3-eecd7e015bac", "external_references": [{"source_name": "University of Birmingham C2", "description": "Gardiner, J.,  Cova, M., Nagaraja, S. (2014, February). Command & Control Understanding, Denying and Detecting. Retrieved April 20, 2016.", "url": "https://arxiv.org/ftp/arxiv/papers/1408/1408.1136.pdf"}], "modified": "2019-07-08T21:11:18.486Z", "source_ref": "course-of-action--12241367-a8b7-49b4-b86e-2236901ba50c", "relationship_type": "mitigates", "target_ref": "attack-pattern--731f4f55-b6d0-41d1-a7a9-072a66389aea"}, {"created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5", "description": "Network intrusion detection and prevention systems that use network signatures to identify traffic for specific adversary malware can be used to mitigate activity at the network level. Signatures are often for unique indicators within protocols and may be based on the specific protocol used by a particular adversary or tool, and will likely be different across various malware families and versions. Adversaries will likely change tool C2 signatures over time or construct protocols in such a way as to avoid detection by common defensive tools.", "type": "relationship", "created": "2019-06-13T18:58:06.815Z", "object_marking_refs": ["marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"], "id": "relationship--a1505946-76d9-4acb-8b1a-02c926915702", "external_references": [{"source_name": "University of Birmingham C2", "description": "Gardiner, J.,  Cova, M., Nagaraja, S. (2014, February). Command & Control Understanding, Denying and Detecting. Retrieved April 20, 2016.", "url": "https://arxiv.org/ftp/arxiv/papers/1408/1408.1136.pdf"}], "modified": "2019-07-16T20:51:40.464Z", "source_ref": "course-of-action--12241367-a8b7-49b4-b86e-2236901ba50c", "relationship_type": "mitigates", "target_ref": "attack-pattern--f879d51c-5476-431c-aedf-f14d207e4d1e"}, {"created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5", "description": "Although UAC bypass techniques exist, it is still prudent to use the highest enforcement level for UAC when possible and mitigate bypass opportunities that exist with techniques such as [DLL Search Order Hijacking](https://attack.mitre.org/techniques/T1038).", "type": "relationship", "created": "2019-06-13T18:50:51.747Z", "object_marking_refs": ["marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"], "id": "relationship--f5ba1404-3e7e-4692-8a39-9e62e5d9542c", "modified": "2019-07-16T20:28:55.439Z", "source_ref": "course-of-action--2c2ad92a-d710-41ab-a996-1db143bb4808", "relationship_type": "mitigates", "target_ref": "attack-pattern--ca1a3f50-5ebd-41f8-8320-2c7d6a6e88be"}, {"created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5", "description": "Remove users from the local administrator group on systems.", "type": "relationship", "created": "2019-06-13T18:50:51.732Z", "object_marking_refs": ["marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"], "id": "relationship--629ac426-ec81-4183-80c0-b7fead5e3b19", "modified": "2019-07-16T20:28:55.440Z", "source_ref": "course-of-action--9bb9e696-bff8-4ae1-9454-961fc7d91d5f", "relationship_type": "mitigates", "target_ref": "attack-pattern--ca1a3f50-5ebd-41f8-8320-2c7d6a6e88be"}, {"created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5", "description": "Modify network and/or host firewall rules, as well as other network controls, to only allow legitimate BITS traffic.", "type": "relationship", "created": "2019-06-13T16:47:56.005Z", "object_marking_refs": ["marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"], "id": "relationship--4b4d8f9e-a416-4af6-9c20-582892601668", "modified": "2019-07-16T20:02:53.337Z", "source_ref": "course-of-action--20f6a9df-37c4-4e20-9e47-025983b1b39d", "relationship_type": "mitigates", "target_ref": "attack-pattern--c8e87b83-edbb-48d4-9295-4974897525b7"}, {"created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5", "description": "\nConsider reducing the default BITS job lifetime in Group Policy or by editing the <code>JobInactivityTimeout</code> and <code>MaxDownloadTime</code> Registry values in <code> HKEY_LOCAL_MACHINE\\Software\\Policies\\Microsoft\\Windows\\BITS</code>.", "type": "relationship", "created": "2019-06-13T16:47:55.972Z", "object_marking_refs": ["marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"], "id": "relationship--57d1a497-ef75-46de-b284-eefa90a99172", "external_references": [{"source_name": "Microsoft BITS", "description": "Microsoft. (n.d.). Background Intelligent Transfer Service. Retrieved January 12, 2018.", "url": "https://msdn.microsoft.com/library/windows/desktop/bb968799.aspx"}], "modified": "2019-07-16T20:02:53.339Z", "source_ref": "course-of-action--2f316f6c-ae42-44fe-adf8-150989e0f6d3", "relationship_type": "mitigates", "target_ref": "attack-pattern--c8e87b83-edbb-48d4-9295-4974897525b7"}, {"created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5", "description": "Limit permissions so that users and user groups cannot create tokens. This setting should be defined for the local system account only. GPO: Computer Configuration > [Policies] > Windows Settings > Security Settings > Local Policies > User Rights Assignment: Create a token object. Also define who can create a process level token to only the local and network service through GPO: Computer Configuration > [Policies] > Windows Settings > Security Settings > Local Policies > User Rights Assignment: Replace a process level token.", "type": "relationship", "created": "2019-06-13T15:56:45.879Z", "object_marking_refs": ["marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"], "id": "relationship--b82ceba5-d988-472d-acd4-b7b1bc49ebbc", "external_references": [{"source_name": "Microsoft Create Token", "description": "Brower, N., Lich, B. (2017, April 19). Create a token object. Retrieved December 19, 2017.", "url": "https://docs.microsoft.com/windows/device-security/security-policy-settings/create-a-token-object"}, {"source_name": "Microsoft Replace Process Token", "description": "Brower, N., Lich, B. (2017, April 19). Replace a process level token. Retrieved December 19, 2017.", "url": "https://docs.microsoft.com/windows/device-security/security-policy-settings/replace-a-process-level-token"}], "modified": "2019-07-16T17:30:44.149Z", "source_ref": "course-of-action--9bb9e696-bff8-4ae1-9454-961fc7d91d5f", "relationship_type": "mitigates", "target_ref": "attack-pattern--dcaa092b-7de9-4a21-977f-7fcb77e89c48"}, {"created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5", "modified": "2019-07-25T14:25:53.638Z", "type": "relationship", "created": "2019-01-30T14:19:17.921Z", "object_marking_refs": ["marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"], "id": "relationship--2ad95088-71af-462d-a18d-51c35a0cc6b3", "external_references": [{"source_name": "FireEye APT29 Nov 2018", "description": "Dunwoody, M., et al. (2018, November 19). Not So Cozy: An Uncomfortable Examination of a Suspected APT29 Phishing Campaign. Retrieved November 27, 2018.", "url": "https://www.fireeye.com/blog/threat-research/2018/11/not-so-cozy-an-uncomfortable-examination-of-a-suspected-apt29-phishing-campaign.html"}], "source_ref": "intrusion-set--899ce53f-13a0-479b-a0e4-67d46e241542", "relationship_type": "uses", "target_ref": "tool--aafea02e-ece5-4bb2-91a6-3bf8c7f38a39"}, {"created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5", "modified": "2019-07-26T23:38:34.317Z", "type": "relationship", "created": "2018-10-17T00:14:20.652Z", "object_marking_refs": ["marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"], "id": "relationship--522c0d0b-74aa-457f-8c2c-43a6fd75f35d", "external_references": [{"source_name": "Talos Cobalt Group July 2018", "description": "Svajcer, V. (2018, July 31). Multiple Cobalt Personality Disorder. Retrieved September 5, 2018.", "url": "https://blog.talosintelligence.com/2018/07/multiple-cobalt-personality-disorder.html"}, {"source_name": "PTSecurity Cobalt Group Aug 2017", "description": "Positive Technologies. (2017, August 16). Cobalt Strikes Back: An Evolving Multinational Threat to Finance. Retrieved September 5, 2018.", "url": "https://www.ptsecurity.com/upload/corporate/ww-en/analytics/Cobalt-2017-eng.pdf"}, {"source_name": "Group IB Cobalt Aug 2017", "description": "Matveeva, V. (2017, August 15). Secrets of Cobalt. Retrieved October 10, 2018.", "url": "https://www.group-ib.com/blog/cobalt"}, {"source_name": "Proofpoint Cobalt June 2017", "description": "Mesa, M, et al. (2017, June 1). Microsoft Word Intruder Integrates CVE-2017-0199, Utilized by Cobalt Group to Target Financial Institutions. Retrieved October 10, 2018.", "url": "https://www.proofpoint.com/us/threat-insight/post/microsoft-word-intruder-integrates-cve-2017-0199-utilized-cobalt-group-target"}, {"source_name": "RiskIQ Cobalt Nov 2017", "description": "Klijnsma, Y.. (2017, November 28). Gaffe Reveals Full List of Targets in Spear Phishing Attack Using Cobalt Strike Against Financial Institutions. Retrieved October 10, 2018.", "url": "https://www.riskiq.com/blog/labs/cobalt-strike/"}, {"source_name": "RiskIQ Cobalt Jan 2018", "description": "Klijnsma, Y.. (2018, January 16). First Activities of Cobalt Group in 2018: Spear Phishing Russian Banks. Retrieved October 10, 2018.", "url": "https://www.riskiq.com/blog/labs/cobalt-group-spear-phishing-russian-banks/"}, {"source_name": "Crowdstrike Global Threat Report Feb 2018", "description": "CrowdStrike. (2018, February 26). CrowdStrike 2018 Global Threat Report. Retrieved October 10, 2018.", "url": "https://crowdstrike.lookbookhq.com/global-threat-report-2018-web/cs-2018-global-threat-report"}, {"source_name": "TrendMicro Cobalt Group Nov 2017", "description": "Giagone, R., Bermejo, L., and Yarochkin, F. (2017, November 20). Cobalt Strikes Again: Spam Runs Use Macros and CVE-2017-8759 Exploit Against Russian Banks. Retrieved March 7, 2019.", "url": "https://blog.trendmicro.com/trendlabs-security-intelligence/cobalt-spam-runs-use-macros-cve-2017-8759-exploit/"}], "source_ref": "intrusion-set--dc6fe6ee-04c2-49be-ba3d-f38d2463c02a", "relationship_type": "uses", "target_ref": "tool--aafea02e-ece5-4bb2-91a6-3bf8c7f38a39"}, {"created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5", "description": "[Cobalt Strike](https://attack.mitre.org/software/S0154) can collect data from a local system.", "type": "relationship", "created": "2018-01-16T16:13:52.465Z", "object_marking_refs": ["marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"], "id": "relationship--f4865a5c-c17c-408a-94de-2feac0d006fd", "external_references": [{"source_name": "Cobalt Strike TTPs Dec 2017", "description": "Cobalt Strike. (2017, December 8). Tactics, Techniques, and Procedures. Retrieved December 20, 2017.", "url": "https://www.cobaltstrike.com/downloads/reports/tacticstechniquesandprocedures.pdf"}], "modified": "2019-06-06T19:04:39.417Z", "source_ref": "tool--aafea02e-ece5-4bb2-91a6-3bf8c7f38a39", "relationship_type": "uses", "target_ref": "attack-pattern--3c4a2599-71ee-4405-ba1e-0e28414b4bc5"}, {"created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5", "description": "[Cobalt Strike](https://attack.mitre.org/software/S0154) uses a command-line interface to interact with systems.", "type": "relationship", "created": "2018-01-16T16:13:52.465Z", "object_marking_refs": ["marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"], "id": "relationship--a6929a8b-e9b4-4122-8dd8-4030173346c9", "external_references": [{"source_name": "Cobalt Strike TTPs Dec 2017", "description": "Cobalt Strike. (2017, December 8). Tactics, Techniques, and Procedures. Retrieved December 20, 2017.", "url": "https://www.cobaltstrike.com/downloads/reports/tacticstechniquesandprocedures.pdf"}], "modified": "2019-06-06T19:04:39.177Z", "source_ref": "tool--aafea02e-ece5-4bb2-91a6-3bf8c7f38a39", "relationship_type": "uses", "target_ref": "attack-pattern--7385dfaf-6886-4229-9ecd-6fd678040830"}, {"created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5", "description": "[Cobalt Strike](https://attack.mitre.org/software/S0154) can install a new service.", "type": "relationship", "created": "2018-01-16T16:13:52.465Z", "object_marking_refs": ["marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"], "id": "relationship--d4f48744-0564-4ef3-bdae-421076912495", "external_references": [{"source_name": "Cobalt Strike TTPs Dec 2017", "description": "Cobalt Strike. (2017, December 8). Tactics, Techniques, and Procedures. Retrieved December 20, 2017.", "url": "https://www.cobaltstrike.com/downloads/reports/tacticstechniquesandprocedures.pdf"}], "modified": "2019-06-06T19:04:39.234Z", "source_ref": "tool--aafea02e-ece5-4bb2-91a6-3bf8c7f38a39", "relationship_type": "uses", "target_ref": "attack-pattern--478aa214-2ca7-4ec0-9978-18798e514790"}, {"created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5", "description": "[Cobalt Strike](https://attack.mitre.org/software/S0154) can use Window admin shares (C$ and ADMIN$) for lateral movement.", "type": "relationship", "created": "2018-01-16T16:13:52.465Z", "object_marking_refs": ["marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"], "id": "relationship--dac7355a-9d13-4155-a053-d0c18fe92f53", "external_references": [{"source_name": "Cobalt Strike TTPs Dec 2017", "description": "Cobalt Strike. (2017, December 8). Tactics, Techniques, and Procedures. Retrieved December 20, 2017.", "url": "https://www.cobaltstrike.com/downloads/reports/tacticstechniquesandprocedures.pdf"}], "modified": "2019-06-06T19:04:39.331Z", "source_ref": "tool--aafea02e-ece5-4bb2-91a6-3bf8c7f38a39", "relationship_type": "uses", "target_ref": "attack-pattern--ffe742ed-9100-4686-9e00-c331da544787"}, {"created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5", "description": "[Cobalt Strike](https://attack.mitre.org/software/S0154) can use [PowerShell](https://attack.mitre.org/techniques/T1086), Python, VBA, [PowerSploit](https://attack.mitre.org/software/S0194), other scripting frameworks to perform execution.", "type": "relationship", "created": "2018-01-16T16:13:52.465Z", "object_marking_refs": ["marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"], "id": "relationship--23dca74f-2b3e-46c0-b7a3-9d9eab932f58", "external_references": [{"source_name": "Cobalt Strike TTPs Dec 2017", "description": "Cobalt Strike. (2017, December 8). Tactics, Techniques, and Procedures. Retrieved December 20, 2017.", "url": "https://www.cobaltstrike.com/downloads/reports/tacticstechniquesandprocedures.pdf"}, {"source_name": "CobaltStrike Daddy May 2017", "description": "Mudge, R. (2017, May 23). Cobalt Strike 3.8 \u2013 Who\u2019s Your Daddy?. Retrieved June 4, 2019.", "url": "https://blog.cobaltstrike.com/2017/05/23/cobalt-strike-3-8-whos-your-daddy/"}], "modified": "2019-06-06T19:04:39.333Z", "source_ref": "tool--aafea02e-ece5-4bb2-91a6-3bf8c7f38a39", "relationship_type": "uses", "target_ref": "attack-pattern--7fd87010-3a00-4da3-b905-410525e8ec44"}, {"created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5", "description": "[Cobalt Strike](https://attack.mitre.org/software/S0154) can perform browser pivoting and inject into a user's browser to inherit cookies, authenticated HTTP sessions, and client SSL certificates.", "type": "relationship", "created": "2018-01-16T16:13:52.465Z", "object_marking_refs": ["marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"], "id": "relationship--c1fd6ce6-26e7-49a7-abff-a64fd0fc8a35", "external_references": [{"source_name": "cobaltstrike manual", "description": "Strategic Cyber LLC. (2017, March 14). Cobalt Strike Manual. Retrieved May 24, 2017.", "url": "https://cobaltstrike.com/downloads/csmanual38.pdf"}], "modified": "2019-06-06T19:04:39.467Z", "source_ref": "tool--aafea02e-ece5-4bb2-91a6-3bf8c7f38a39", "relationship_type": "uses", "target_ref": "attack-pattern--544b0346-29ad-41e1-a808-501bb4193f47"}, {"created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5", "description": "[Cobalt Strike](https://attack.mitre.org/software/S0154) can SSH to a remote service.", "type": "relationship", "created": "2018-01-16T16:13:52.465Z", "object_marking_refs": ["marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"], "id": "relationship--66eb9cc1-4eb4-4b84-8140-bd48da33e93d", "external_references": [{"source_name": "Cobalt Strike TTPs Dec 2017", "description": "Cobalt Strike. (2017, December 8). Tactics, Techniques, and Procedures. Retrieved December 20, 2017.", "url": "https://www.cobaltstrike.com/downloads/reports/tacticstechniquesandprocedures.pdf"}], "modified": "2019-06-06T19:04:39.334Z", "source_ref": "tool--aafea02e-ece5-4bb2-91a6-3bf8c7f38a39", "relationship_type": "uses", "target_ref": "attack-pattern--54a649ff-439a-41a4-9856-8d144a2551ba"}, {"created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5", "description": "[Cobalt Strike](https://attack.mitre.org/software/S0154) can query shared drives on the local system.", "type": "relationship", "created": "2018-01-16T16:13:52.465Z", "object_marking_refs": ["marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"], "id": "relationship--e8048bf8-3931-4d6b-b4a6-475ff717cbae", "external_references": [{"source_name": "Cobalt Strike TTPs Dec 2017", "description": "Cobalt Strike. (2017, December 8). Tactics, Techniques, and Procedures. Retrieved December 20, 2017.", "url": "https://www.cobaltstrike.com/downloads/reports/tacticstechniquesandprocedures.pdf"}], "modified": "2019-06-06T19:04:39.541Z", "source_ref": "tool--aafea02e-ece5-4bb2-91a6-3bf8c7f38a39", "relationship_type": "uses", "target_ref": "attack-pattern--3489cfc5-640f-4bb3-a103-9137b97de79f"}, {"created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5", "description": "[Cobalt Strike](https://attack.mitre.org/software/S0154) can use process hollowing for execution.", "type": "relationship", "created": "2018-01-16T16:13:52.465Z", "object_marking_refs": ["marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"], "id": "relationship--6c303446-f8d1-424c-b1ac-8c10f82d33d7", "external_references": [{"source_name": "Cobalt Strike TTPs Dec 2017", "description": "Cobalt Strike. (2017, December 8). Tactics, Techniques, and Procedures. Retrieved December 20, 2017.", "url": "https://www.cobaltstrike.com/downloads/reports/tacticstechniquesandprocedures.pdf"}], "modified": "2019-06-06T19:04:39.509Z", "source_ref": "tool--aafea02e-ece5-4bb2-91a6-3bf8c7f38a39", "relationship_type": "uses", "target_ref": "attack-pattern--1c338d0f-a65e-4073-a5c1-c06878849f21"}, {"created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5", "description": "[Cobalt Strike](https://attack.mitre.org/software/S0154) can perform pass the hash.", "type": "relationship", "created": "2018-01-16T16:13:52.465Z", "object_marking_refs": ["marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"], "id": "relationship--9a286577-ccfc-4793-96ce-02c17dc0f4ae", "external_references": [{"source_name": "Cobalt Strike TTPs Dec 2017", "description": "Cobalt Strike. (2017, December 8). Tactics, Techniques, and Procedures. Retrieved December 20, 2017.", "url": "https://www.cobaltstrike.com/downloads/reports/tacticstechniquesandprocedures.pdf"}], "modified": "2019-06-06T19:04:39.283Z", "source_ref": "tool--aafea02e-ece5-4bb2-91a6-3bf8c7f38a39", "relationship_type": "uses", "target_ref": "attack-pattern--c23b740b-a42b-47a1-aec2-9d48ddd547ff"}, {"created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5", "modified": "2019-07-24T19:12:03.011Z", "type": "relationship", "id": "relationship--65a4317d-86b2-40c1-9d27-a067bcc2ad80", "object_marking_refs": ["marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"], "created": "2018-01-16T16:13:52.465Z", "source_ref": "course-of-action--910482b1-6749-4934-abcb-3e34d58294fc", "relationship_type": "mitigates", "target_ref": "attack-pattern--772bc7a8-a157-42cc-8728-d648e25c7fe7"}, {"created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5", "description": "[Cobalt Strike](https://attack.mitre.org/software/S0154) can exploit vulnerabilities such as MS14-058.", "type": "relationship", "created": "2018-01-16T16:13:52.465Z", "object_marking_refs": ["marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"], "id": "relationship--b942cd55-6fed-49a1-ba05-af23836b518f", "external_references": [{"source_name": "Cobalt Strike TTPs Dec 2017", "description": "Cobalt Strike. (2017, December 8). Tactics, Techniques, and Procedures. Retrieved December 20, 2017.", "url": "https://www.cobaltstrike.com/downloads/reports/tacticstechniquesandprocedures.pdf"}], "modified": "2019-06-06T19:04:39.421Z", "source_ref": "tool--aafea02e-ece5-4bb2-91a6-3bf8c7f38a39", "relationship_type": "uses", "target_ref": "attack-pattern--b21c3b2d-02e6-45b1-980b-e69051040839"}, {"created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5", "description": "[Cobalt Strike](https://attack.mitre.org/software/S0154)'s \"beacon\" payload can collect information on process details.", "type": "relationship", "created": "2017-12-14T16:46:06.044Z", "object_marking_refs": ["marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"], "id": "relationship--2c417522-9fa6-4f95-b9d6-062c9c2401b5", "external_references": [{"source_name": "cobaltstrike manual", "description": "Strategic Cyber LLC. (2017, March 14). Cobalt Strike Manual. Retrieved May 24, 2017.", "url": "https://cobaltstrike.com/downloads/csmanual38.pdf"}], "modified": "2019-06-06T19:04:39.207Z", "source_ref": "tool--aafea02e-ece5-4bb2-91a6-3bf8c7f38a39", "relationship_type": "uses", "target_ref": "attack-pattern--8f4a33ec-8b1f-4b80-a2f6-642b2e479580"}, {"created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5", "description": "[Cobalt Strike](https://attack.mitre.org/software/S0154) can deliver \"beacon\" payloads for lateral movement by leveraging remote COM execution.", "type": "relationship", "created": "2018-01-16T16:13:52.465Z", "object_marking_refs": ["marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"], "id": "relationship--2b469307-a635-4392-a18f-ed1f24b3a684", "external_references": [{"source_name": "Cobalt Strike DCOM Jan 2017", "description": "Mudge, R. (2017, January 24). Scripting Matt Nelson\u2019s MMC20.Application Lateral Movement Technique. Retrieved November 21, 2017.", "url": "https://blog.cobaltstrike.com/2017/01/24/scripting-matt-nelsons-mmc20-application-lateral-movement-technique/"}], "modified": "2019-06-06T19:04:39.538Z", "source_ref": "tool--aafea02e-ece5-4bb2-91a6-3bf8c7f38a39", "relationship_type": "uses", "target_ref": "attack-pattern--772bc7a8-a157-42cc-8728-d648e25c7fe7"}, {"created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5", "modified": "2019-07-25T11:12:34.468Z", "type": "relationship", "id": "relationship--efa2ae6b-8942-4ea2-80ca-b4181dd01427", "object_marking_refs": ["marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"], "created": "2018-01-16T16:13:52.465Z", "source_ref": "course-of-action--94f6b4f5-b528-4f50-91d5-f66457c2f8f7", "relationship_type": "mitigates", "target_ref": "attack-pattern--544b0346-29ad-41e1-a808-501bb4193f47"}, {"created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5", "description": "[Cobalt Strike](https://attack.mitre.org/software/S0154)'s \"beacon\" payload is capable of capturing screen shots.", "type": "relationship", "created": "2017-12-14T16:46:06.044Z", "object_marking_refs": ["marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"], "id": "relationship--854a3a7e-09a7-4523-ac7f-d625a0b50b6b", "external_references": [{"source_name": "cobaltstrike manual", "description": "Strategic Cyber LLC. (2017, March 14). Cobalt Strike Manual. Retrieved May 24, 2017.", "url": "https://cobaltstrike.com/downloads/csmanual38.pdf"}], "modified": "2019-06-06T19:04:39.416Z", "source_ref": "tool--aafea02e-ece5-4bb2-91a6-3bf8c7f38a39", "relationship_type": "uses", "target_ref": "attack-pattern--0259baeb-9f63-4c69-bf10-eb038c390688"}, {"created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5", "description": "[Cobalt Strike](https://attack.mitre.org/software/S0154) can use [PsExec](https://attack.mitre.org/software/S0029) to execute a payload on a remote host. It can also use Service Control Manager to start new services.", "type": "relationship", "created": "2017-12-14T16:46:06.044Z", "object_marking_refs": ["marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"], "id": "relationship--d26a9de1-0ec7-41dd-94fe-21a51bedf37f", "external_references": [{"source_name": "cobaltstrike manual", "description": "Strategic Cyber LLC. (2017, March 14). Cobalt Strike Manual. Retrieved May 24, 2017.", "url": "https://cobaltstrike.com/downloads/csmanual38.pdf"}, {"source_name": "Cobalt Strike TTPs Dec 2017", "description": "Cobalt Strike. (2017, December 8). Tactics, Techniques, and Procedures. Retrieved December 20, 2017.", "url": "https://www.cobaltstrike.com/downloads/reports/tacticstechniquesandprocedures.pdf"}], "modified": "2019-06-06T19:04:39.469Z", "source_ref": "tool--aafea02e-ece5-4bb2-91a6-3bf8c7f38a39", "relationship_type": "uses", "target_ref": "attack-pattern--f44731de-ea9f-406d-9b83-30ecbb9b4392"}, {"created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5", "description": "[Cobalt Strike](https://attack.mitre.org/software/S0154) can recover hashed passwords.", "type": "relationship", "created": "2017-12-14T16:46:06.044Z", "object_marking_refs": ["marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"], "id": "relationship--6dc0543b-1a60-4e9a-9527-595220854f53", "external_references": [{"source_name": "cobaltstrike manual", "description": "Strategic Cyber LLC. (2017, March 14). Cobalt Strike Manual. Retrieved May 24, 2017.", "url": "https://cobaltstrike.com/downloads/csmanual38.pdf"}], "modified": "2019-06-06T19:04:39.465Z", "source_ref": "tool--aafea02e-ece5-4bb2-91a6-3bf8c7f38a39", "relationship_type": "uses", "target_ref": "attack-pattern--0a3ead4e-6d47-4ccb-854c-a6a4f9d96b22"}, {"created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5", "modified": "2019-07-24T14:29:27.545Z", "type": "relationship", "id": "relationship--dd315296-ffee-4f1b-aef7-2d914c458fd2", "object_marking_refs": ["marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"], "created": "2017-12-14T16:46:06.044Z", "source_ref": "course-of-action--c61fee9f-16fb-4f8c-bbf0-869093fcd4a6", "relationship_type": "mitigates", "target_ref": "attack-pattern--dcaa092b-7de9-4a21-977f-7fcb77e89c48"}, {"created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5", "description": "[Cobalt Strike](https://attack.mitre.org/software/S0154) can use a number of known techniques to bypass Windows UAC.", "type": "relationship", "created": "2017-12-14T16:46:06.044Z", "object_marking_refs": ["marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"], "id": "relationship--6c030461-42c5-44db-908a-85ac9a5a9822", "external_references": [{"source_name": "cobaltstrike manual", "description": "Strategic Cyber LLC. (2017, March 14). Cobalt Strike Manual. Retrieved May 24, 2017.", "url": "https://cobaltstrike.com/downloads/csmanual38.pdf"}], "modified": "2019-06-06T19:04:39.339Z", "source_ref": "tool--aafea02e-ece5-4bb2-91a6-3bf8c7f38a39", "relationship_type": "uses", "target_ref": "attack-pattern--ca1a3f50-5ebd-41f8-8320-2c7d6a6e88be"}, {"created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5", "description": "[Cobalt Strike](https://attack.mitre.org/software/S0154) allows adversaries to modify the way the \"beacon\" payload communicates. This is called \"Malleable C2\" in the [Cobalt Strike](https://attack.mitre.org/software/S0154) manual and is intended to allow a penetration test team to mimic known APT C2 methods.", "type": "relationship", "created": "2017-12-14T16:46:06.044Z", "object_marking_refs": ["marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"], "id": "relationship--e873321b-0d76-4cd6-bc46-8231cfcdeba0", "external_references": [{"source_name": "cobaltstrike manual", "description": "Strategic Cyber LLC. (2017, March 14). Cobalt Strike Manual. Retrieved May 24, 2017.", "url": "https://cobaltstrike.com/downloads/csmanual38.pdf"}, {"source_name": "GitHub Malleable C2", "description": "Mudge, R. (2014, July 14). Github Malleable-C2-Profiles safebrowsing.profile. Retrieved June 18, 2017.", "url": "https://github.com/rsmudge/Malleable-C2-Profiles/blob/master/normal/safebrowsing.profile"}], "modified": "2019-06-06T19:04:39.414Z", "source_ref": "tool--aafea02e-ece5-4bb2-91a6-3bf8c7f38a39", "relationship_type": "uses", "target_ref": "attack-pattern--f72eb8a8-cd4c-461d-a814-3f862befbf00"}, {"created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5", "modified": "2019-07-17T13:11:38.962Z", "type": "relationship", "created": "2017-12-14T16:46:06.044Z", "object_marking_refs": ["marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"], "id": "relationship--ab9b78cc-2b83-4074-beeb-0af4aad906d3", "external_references": [{"source_name": "FireEye APT32 May 2017", "description": "Carr, N.. (2017, May 14). Cyber Espionage is Alive and Well: APT32 and the Threat to Global Corporations. Retrieved June 18, 2017.", "url": "https://www.fireeye.com/blog/threat-research/2017/05/cyber-espionage-apt32.html"}, {"source_name": "Volexity OceanLotus Nov 2017", "description": "Lassalle, D., et al. (2017, November 6). OceanLotus Blossoms: Mass Digital Surveillance and Attacks Targeting ASEAN, Asian Nations, the Media, Human Rights Groups, and Civil Society. Retrieved November 6, 2017.", "url": "https://www.volexity.com/blog/2017/11/06/oceanlotus-blossoms-mass-digital-surveillance-and-exploitation-of-asean-nations-the-media-human-rights-and-civil-society/"}, {"source_name": "Cybereason Oceanlotus May 2017", "description": "Dahan, A. (2017, May 24). OPERATION COBALT KITTY: A LARGE-SCALE APT IN ASIA CARRIED OUT BY THE OCEANLOTUS GROUP. Retrieved November 5, 2018.", "url": "https://www.cybereason.com/blog/operation-cobalt-kitty-apt"}, {"source_name": "Cybereason Cobalt Kitty 2017", "description": "Dahan, A. (2017). Operation Cobalt Kitty. Retrieved December 27, 2018.", "url": "https://cdn2.hubspot.net/hubfs/3354902/Cybereason%20Labs%20Analysis%20Operation%20Cobalt%20Kitty.pdf"}], "source_ref": "intrusion-set--247cb30b-955f-42eb-97a5-a89fef69341e", "relationship_type": "uses", "target_ref": "tool--aafea02e-ece5-4bb2-91a6-3bf8c7f38a39"}, {"created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5", "description": "[Cobalt Strike](https://attack.mitre.org/software/S0154) uses a custom command and control protocol that communicates over commonly used ports. The C2 protocol is encapsulated in common application layer protocols.", "type": "relationship", "created": "2017-12-14T16:46:06.044Z", "object_marking_refs": ["marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"], "id": "relationship--8924eb12-0841-48ca-9d36-69de932b1f21", "external_references": [{"source_name": "cobaltstrike manual", "description": "Strategic Cyber LLC. (2017, March 14). Cobalt Strike Manual. Retrieved May 24, 2017.", "url": "https://cobaltstrike.com/downloads/csmanual38.pdf"}], "modified": "2019-06-06T19:04:39.505Z", "source_ref": "tool--aafea02e-ece5-4bb2-91a6-3bf8c7f38a39", "relationship_type": "uses", "target_ref": "attack-pattern--f879d51c-5476-431c-aedf-f14d207e4d1e"}, {"created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5", "description": "[Cobalt Strike](https://attack.mitre.org/software/S0154) can track key presses with a keylogger module.", "type": "relationship", "created": "2017-12-14T16:46:06.044Z", "object_marking_refs": ["marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"], "id": "relationship--be20faa9-64bf-4a65-86c2-dc12f5695d22", "external_references": [{"source_name": "cobaltstrike manual", "description": "Strategic Cyber LLC. (2017, March 14). Cobalt Strike Manual. Retrieved May 24, 2017.", "url": "https://cobaltstrike.com/downloads/csmanual38.pdf"}], "modified": "2019-06-06T19:04:39.507Z", "source_ref": "tool--aafea02e-ece5-4bb2-91a6-3bf8c7f38a39", "relationship_type": "uses", "target_ref": "attack-pattern--bb5a00de-e086-4859-a231-fa793f6797e2"}, {"created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5", "description": "[Cobalt Strike](https://attack.mitre.org/software/S0154) uses the native Windows Network Enumeration APIs to interrogate and discover targets in a Windows Active Directory network.", "type": "relationship", "created": "2017-12-14T16:46:06.044Z", "object_marking_refs": ["marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"], "id": "relationship--b26eb7d2-1147-4c2b-a1eb-4a457e081e22", "external_references": [{"source_name": "cobaltstrike manual", "description": "Strategic Cyber LLC. (2017, March 14). Cobalt Strike Manual. Retrieved May 24, 2017.", "url": "https://cobaltstrike.com/downloads/csmanual38.pdf"}], "modified": "2019-06-06T19:04:39.540Z", "source_ref": "tool--aafea02e-ece5-4bb2-91a6-3bf8c7f38a39", "relationship_type": "uses", "target_ref": "attack-pattern--e358d692-23c0-4a31-9eb6-ecc13a8d7735"}, {"created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5", "description": "[Cobalt Strike](https://attack.mitre.org/software/S0154) can start a VNC-based remote desktop server and tunnel the connection through the already established C2 channel.", "type": "relationship", "created": "2017-12-14T16:46:06.044Z", "object_marking_refs": ["marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"], "id": "relationship--3cb99d8e-8a3d-47ed-b4b7-e217cea48013", "external_references": [{"source_name": "cobaltstrike manual", "description": "Strategic Cyber LLC. (2017, March 14). Cobalt Strike Manual. Retrieved May 24, 2017.", "url": "https://cobaltstrike.com/downloads/csmanual38.pdf"}], "modified": "2019-06-06T19:04:39.504Z", "source_ref": "tool--aafea02e-ece5-4bb2-91a6-3bf8c7f38a39", "relationship_type": "uses", "target_ref": "attack-pattern--51dea151-0898-4a45-967c-3ebee0420484"}, {"created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5", "description": "[Cobalt Strike](https://attack.mitre.org/software/S0154)'s \"beacon\" payload can receive C2 from one protocol and respond on another. This is typically a mixture of HTTP, HTTPS, and DNS traffic.", "type": "relationship", "created": "2017-12-14T16:46:06.044Z", "object_marking_refs": ["marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"], "id": "relationship--290c0a54-2702-4d6e-97db-1eafa9a7a1f3", "external_references": [{"source_name": "cobaltstrike manual", "description": "Strategic Cyber LLC. (2017, March 14). Cobalt Strike Manual. Retrieved May 24, 2017.", "url": "https://cobaltstrike.com/downloads/csmanual38.pdf"}], "modified": "2019-06-06T19:04:39.260Z", "source_ref": "tool--aafea02e-ece5-4bb2-91a6-3bf8c7f38a39", "relationship_type": "uses", "target_ref": "attack-pattern--99709758-2b96-48f2-a68a-ad7fbd828091"}, {"created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5", "description": "[Cobalt Strike](https://attack.mitre.org/software/S0154) can perform port scans from an infected host.", "type": "relationship", "created": "2017-12-14T16:46:06.044Z", "object_marking_refs": ["marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"], "id": "relationship--df6bc111-0e49-4e61-b38a-ee79cf682d09", "external_references": [{"source_name": "cobaltstrike manual", "description": "Strategic Cyber LLC. (2017, March 14). Cobalt Strike Manual. Retrieved May 24, 2017.", "url": "https://cobaltstrike.com/downloads/csmanual38.pdf"}], "modified": "2019-06-06T19:04:39.259Z", "source_ref": "tool--aafea02e-ece5-4bb2-91a6-3bf8c7f38a39", "relationship_type": "uses", "target_ref": "attack-pattern--e3a12395-188d-4051-9a16-ea8e14d07b88"}, {"created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5", "description": "[Cobalt Strike](https://attack.mitre.org/software/S0154) includes a capability to modify the \"beacon\" payload to eliminate known signatures or unpacking methods.", "type": "relationship", "created": "2017-12-14T16:46:06.044Z", "object_marking_refs": ["marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"], "id": "relationship--cf7cd81f-3684-469f-936b-a6098ff76dbd", "external_references": [{"source_name": "cobaltstrike manual", "description": "Strategic Cyber LLC. (2017, March 14). Cobalt Strike Manual. Retrieved May 24, 2017.", "url": "https://cobaltstrike.com/downloads/csmanual38.pdf"}], "modified": "2019-06-06T19:04:39.284Z", "source_ref": "tool--aafea02e-ece5-4bb2-91a6-3bf8c7f38a39", "relationship_type": "uses", "target_ref": "attack-pattern--00d0b012-8a03-410e-95de-5826bf542de6"}, {"created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5", "modified": "2019-07-25T11:18:18.322Z", "type": "relationship", "id": "relationship--fb1a7bbd-9dec-4038-9935-1647378f739f", "object_marking_refs": ["marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"], "created": "2017-12-14T16:46:06.044Z", "source_ref": "course-of-action--1f34230d-b6ae-4dc7-8599-78c18820bd21", "relationship_type": "mitigates", "target_ref": "attack-pattern--3489cfc5-640f-4bb3-a103-9137b97de79f"}, {"created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5", "modified": "2019-07-24T19:17:59.682Z", "type": "relationship", "id": "relationship--678be242-66fd-40b8-bbf1-24c3dda77895", "object_marking_refs": ["marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"], "created": "2017-05-31T21:33:27.029Z", "source_ref": "course-of-action--56db6ccc-433d-4411-8383-c3fd7053e2c8", "relationship_type": "mitigates", "target_ref": "attack-pattern--391d824f-0ef1-47a0-b0ee-c59a75e27670"}, {"created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5", "modified": "2019-07-25T11:39:54.362Z", "type": "relationship", "id": "relationship--366214ea-29b0-458a-a852-7a76420783d2", "object_marking_refs": ["marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"], "created": "2017-05-31T21:33:27.029Z", "source_ref": "course-of-action--51b37302-b844-4c08-ac98-ae6955ed1f55", "relationship_type": "mitigates", "target_ref": "attack-pattern--0259baeb-9f63-4c69-bf10-eb038c390688"}, {"created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5", "modified": "2019-07-25T12:28:38.499Z", "type": "relationship", "id": "relationship--4fa2cbf0-9721-4bbe-86b4-334848cd3dd6", "object_marking_refs": ["marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"], "created": "2017-05-31T21:33:27.028Z", "source_ref": "course-of-action--5c167af7-c2cb-42c8-ae67-3fb275bf8488", "relationship_type": "mitigates", "target_ref": "attack-pattern--128c55d3-aeba-469f-bd3e-c8996ab4112a"}, {"created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5", "modified": "2019-07-25T11:28:17.246Z", "type": "relationship", "id": "relationship--13f5fad8-1b6f-4b65-9803-155f93b5d357", "object_marking_refs": ["marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"], "created": "2017-05-31T21:33:27.027Z", "source_ref": "course-of-action--7c39ebbf-244e-4d1c-b0ac-b282453ece43", "relationship_type": "mitigates", "target_ref": "attack-pattern--1c338d0f-a65e-4073-a5c1-c06878849f21"}, {"created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5", "modified": "2019-07-24T18:10:46.871Z", "type": "relationship", "id": "relationship--eede138c-9745-453c-a8b5-684b696c2ad0", "object_marking_refs": ["marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"], "created": "2017-05-31T21:33:27.027Z", "source_ref": "course-of-action--d75a3d1b-b536-4f15-a23c-f4bcc17837b8", "relationship_type": "mitigates", "target_ref": "attack-pattern--731f4f55-b6d0-41d1-a7a9-072a66389aea"}, {"created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5", "modified": "2019-07-24T18:13:22.089Z", "type": "relationship", "id": "relationship--647032ac-0432-4785-9d50-06b9970bcbcb", "object_marking_refs": ["marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"], "created": "2017-05-31T21:33:27.027Z", "source_ref": "course-of-action--f3d0c735-330f-43c2-8e8e-51bcfa51e8c3", "relationship_type": "mitigates", "target_ref": "attack-pattern--f72eb8a8-cd4c-461d-a814-3f862befbf00"}, {"created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5", "modified": "2019-07-24T14:13:23.722Z", "type": "relationship", "id": "relationship--483a70b9-eae9-4d5f-925c-95c2dd7b9fa5", "object_marking_refs": ["marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"], "created": "2017-05-31T21:33:27.026Z", "source_ref": "course-of-action--beb45abb-11e8-4aef-9778-1f9ac249784f", "relationship_type": "mitigates", "target_ref": "attack-pattern--ca1a3f50-5ebd-41f8-8320-2c7d6a6e88be"}, {"created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5", "modified": "2019-07-25T11:26:37.158Z", "type": "relationship", "id": "relationship--1f8f6283-6004-4204-a54f-759e9c0519b1", "object_marking_refs": ["marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"], "created": "2017-05-31T21:33:27.026Z", "source_ref": "course-of-action--d0415180-51e9-40ce-b57c-c332b0b441f2", "relationship_type": "mitigates", "target_ref": "attack-pattern--f4882e23-8aa7-4b12-b28a-b349c12ee9e0"}, {"created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5", "modified": "2019-07-25T11:21:20.607Z", "type": "relationship", "id": "relationship--396287ea-36d9-4d84-bf22-af559eb20f58", "object_marking_refs": ["marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"], "created": "2017-05-31T21:33:27.025Z", "source_ref": "course-of-action--bcee7b05-89a6-41a5-b7aa-fce4da7ede9e", "relationship_type": "mitigates", "target_ref": "attack-pattern--c23b740b-a42b-47a1-aec2-9d48ddd547ff"}, {"created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5", "modified": "2019-07-25T11:33:10.166Z", "type": "relationship", "id": "relationship--1d0bbeb7-5477-4321-81cd-ef66607d7972", "object_marking_refs": ["marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"], "created": "2017-05-31T21:33:27.025Z", "source_ref": "course-of-action--53b3b027-bed3-480c-9101-1247047d0fe6", "relationship_type": "mitigates", "target_ref": "attack-pattern--51dea151-0898-4a45-967c-3ebee0420484"}, {"created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5", "modified": "2019-07-25T12:32:32.064Z", "type": "relationship", "id": "relationship--3c3f26b3-d676-4e17-adca-2a8ea4643148", "object_marking_refs": ["marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"], "created": "2017-05-31T21:33:27.025Z", "source_ref": "course-of-action--d45f03a8-790a-4f90-b956-cd7e5b8886bf", "relationship_type": "mitigates", "target_ref": "attack-pattern--b17a1a56-e99c-403c-8948-561df0cffe81"}, {"created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5", "modified": "2019-07-25T12:34:42.436Z", "type": "relationship", "id": "relationship--243bf0fe-68eb-4d82-bbbf-d551611a0cd8", "object_marking_refs": ["marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"], "created": "2017-05-31T21:33:27.025Z", "source_ref": "course-of-action--308855d1-078b-47ad-8d2a-8f9b2713ffb5", "relationship_type": "mitigates", "target_ref": "attack-pattern--ffe742ed-9100-4686-9e00-c331da544787"}, {"created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5", "modified": "2019-07-24T19:40:00.342Z", "type": "relationship", "id": "relationship--5978c8e0-8b60-4ad5-8fc9-9fa1ee4d7387", "object_marking_refs": ["marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"], "created": "2017-05-31T21:33:27.024Z", "source_ref": "course-of-action--4b998a71-7b8f-4dcc-8f3f-277f2e740271", "relationship_type": "mitigates", "target_ref": "attack-pattern--00d0b012-8a03-410e-95de-5826bf542de6"}, {"created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5", "modified": "2019-07-25T12:00:42.338Z", "type": "relationship", "id": "relationship--2a0b74b3-cbc3-45fa-aba4-eabdb0cb89b5", "object_marking_refs": ["marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"], "created": "2017-05-31T21:33:27.024Z", "source_ref": "course-of-action--addb3703-5a59-4461-9bcd-7e2b5d4e92a0", "relationship_type": "mitigates", "target_ref": "attack-pattern--355be19c-ffc9-46d5-8d50-d6a036c675b6"}, {"created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5", "modified": "2019-07-26T19:55:06.530Z", "type": "relationship", "id": "relationship--d2a028a0-3c4f-4984-be51-80dbcf93a1a9", "object_marking_refs": ["marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"], "created": "2017-05-31T21:33:27.024Z", "source_ref": "course-of-action--92e6d080-ca3f-4f95-bc45-172a32c4e502", "relationship_type": "mitigates", "target_ref": "attack-pattern--b21c3b2d-02e6-45b1-980b-e69051040839"}, {"created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5", "modified": "2019-07-25T11:40:52.445Z", "type": "relationship", "id": "relationship--edbef2c6-4005-4fdb-b978-9699a7b2a309", "object_marking_refs": ["marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"], "created": "2017-05-31T21:33:27.024Z", "source_ref": "course-of-action--57019a80-8523-46b6-be7d-f763a15a2cc6", "relationship_type": "mitigates", "target_ref": "attack-pattern--7fd87010-3a00-4da3-b905-410525e8ec44"}, {"created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5", "modified": "2019-07-24T19:42:17.752Z", "type": "relationship", "id": "relationship--403863dd-5b73-4987-9397-e8c5b25041cc", "object_marking_refs": ["marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"], "created": "2017-05-31T21:33:27.023Z", "source_ref": "course-of-action--da8a87d2-946d-4c34-9a30-709058b98996", "relationship_type": "mitigates", "target_ref": "attack-pattern--bb5a00de-e086-4859-a231-fa793f6797e2"}, {"created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5", "modified": "2019-07-25T11:27:30.401Z", "type": "relationship", "id": "relationship--03f30a17-095b-4656-a7db-87d98628dfd8", "object_marking_refs": ["marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"], "created": "2017-05-31T21:33:27.023Z", "source_ref": "course-of-action--f6469191-1814-4dbe-a081-2a6daf83a10b", "relationship_type": "mitigates", "target_ref": "attack-pattern--8f4a33ec-8b1f-4b80-a2f6-642b2e479580"}, {"created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5", "modified": "2019-07-24T18:09:00.776Z", "type": "relationship", "id": "relationship--b1ee5cba-d4e0-4af0-aa5c-5faacfdb0dbc", "object_marking_refs": ["marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"], "created": "2017-05-31T21:33:27.023Z", "source_ref": "course-of-action--f28a20fd-d173-4603-807e-2cb3f51bdf04", "relationship_type": "mitigates", "target_ref": "attack-pattern--7385dfaf-6886-4229-9ecd-6fd678040830"}, {"created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5", "modified": "2019-07-25T11:28:40.651Z", "type": "relationship", "id": "relationship--f004e6c4-0c37-4060-9627-9ec0940aee9c", "object_marking_refs": ["marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"], "created": "2017-05-31T21:33:27.022Z", "source_ref": "course-of-action--74febc44-8955-4e4d-aca0-d4dad2f967d7", "relationship_type": "mitigates", "target_ref": "attack-pattern--43e7dc91-05b2-474c-b9ac-2ed4fe101f4d"}, {"created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5", "modified": "2019-07-25T11:19:10.350Z", "type": "relationship", "id": "relationship--bb1de6e6-23ce-42a8-bcd7-fd75aec24c50", "object_marking_refs": ["marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"], "created": "2017-05-31T21:33:27.022Z", "source_ref": "course-of-action--b7b2c89c-09c1-4b71-ae7c-000ec2893aab", "relationship_type": "mitigates", "target_ref": "attack-pattern--478aa214-2ca7-4ec0-9978-18798e514790"}, {"created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5", "modified": "2019-07-25T12:35:34.988Z", "type": "relationship", "id": "relationship--a2ee3987-f7c9-41ce-8aca-fae8e8c2ef9a", "object_marking_refs": ["marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"], "created": "2017-05-31T21:33:27.022Z", "source_ref": "course-of-action--ba2ec548-fb75-4b8c-88d6-d91a77a943cf", "relationship_type": "mitigates", "target_ref": "attack-pattern--01a5a209-b94c-450b-b7f9-946497d91055"}, {"created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5", "modified": "2019-07-25T11:17:30.282Z", "type": "relationship", "id": "relationship--371d43af-ef68-4471-9db9-f2d40d2baefc", "object_marking_refs": ["marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"], "created": "2017-05-31T21:33:27.022Z", "source_ref": "course-of-action--d256cb63-b021-4b4a-bb6d-1b42eea179a3", "relationship_type": "mitigates", "target_ref": "attack-pattern--e3a12395-188d-4051-9a16-ea8e14d07b88"}, {"created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5", "modified": "2019-07-25T11:42:04.414Z", "type": "relationship", "id": "relationship--87131e3c-9d73-4910-a56d-f917d6660a7d", "object_marking_refs": ["marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"], "created": "2017-05-31T21:33:27.021Z", "source_ref": "course-of-action--d5dce4b9-f1fa-4c03-aff9-ce177246cb64", "relationship_type": "mitigates", "target_ref": "attack-pattern--f44731de-ea9f-406d-9b83-30ecbb9b4392"}, {"created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5", "modified": "2019-07-24T14:17:59.077Z", "type": "relationship", "id": "relationship--a34d1e30-dcf5-4743-93e5-e4834e980f0f", "object_marking_refs": ["marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"], "created": "2017-05-31T21:33:27.021Z", "source_ref": "course-of-action--7c1796c7-9fc3-4c3e-9416-527295bf5d95", "relationship_type": "mitigates", "target_ref": "attack-pattern--f879d51c-5476-431c-aedf-f14d207e4d1e"}, {"created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5", "modified": "2019-07-25T11:39:28.080Z", "type": "relationship", "id": "relationship--130275cb-368e-4168-a4bf-60b39566bc50", "object_marking_refs": ["marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"], "created": "2017-05-31T21:33:27.020Z", "source_ref": "course-of-action--1c0711c8-2a73-48a1-893d-ff88bcd23824", "relationship_type": "mitigates", "target_ref": "attack-pattern--4eeaf8a9-c86b-4954-a663-9555fb406466"}, {"created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5", "modified": "2019-07-25T11:15:18.044Z", "type": "relationship", "id": "relationship--c57efd0b-817e-45c2-9f11-e8e7ac11b44c", "object_marking_refs": ["marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"], "created": "2017-05-31T21:33:27.020Z", "source_ref": "course-of-action--da987565-27b6-4b31-bbcd-74b909847116", "relationship_type": "mitigates", "target_ref": "attack-pattern--99709758-2b96-48f2-a68a-ad7fbd828091"}, {"created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5", "modified": "2019-07-25T12:35:58.772Z", "type": "relationship", "id": "relationship--d35b9e63-a236-47f4-9fa8-d04719858115", "object_marking_refs": ["marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"], "created": "2017-05-31T21:33:27.020Z", "source_ref": "course-of-action--3e9f8875-d2f7-4380-a578-84393bd3b025", "relationship_type": "mitigates", "target_ref": "attack-pattern--c3bce4f4-9795-46c6-976e-8676300bbc39"}, {"created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5", "modified": "2019-07-25T11:34:52.480Z", "type": "relationship", "id": "relationship--863d6b6f-9e13-4925-a736-5e719a10a0b8", "object_marking_refs": ["marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"], "created": "2017-05-31T21:33:27.019Z", "source_ref": "course-of-action--9a902722-cecd-4fbe-a6c9-49333aa0f8c2", "relationship_type": "mitigates", "target_ref": "attack-pattern--e358d692-23c0-4a31-9eb6-ecc13a8d7735"}, {"created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5", "modified": "2019-07-25T11:34:25.507Z", "type": "relationship", "id": "relationship--2c0fe330-edcf-4519-a577-c3c9b086d60a", "object_marking_refs": ["marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"], "created": "2017-05-31T21:33:27.019Z", "source_ref": "course-of-action--979e6485-7a2f-42bd-ae96-4e622c3cd173", "relationship_type": "mitigates", "target_ref": "attack-pattern--54a649ff-439a-41a4-9856-8d144a2551ba"}, {"created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5", "modified": "2019-07-24T19:07:01.179Z", "type": "relationship", "id": "relationship--1b4cd403-8e3a-43da-bc25-a7e8d707794b", "object_marking_refs": ["marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"], "created": "2017-05-31T21:33:27.017Z", "source_ref": "course-of-action--7ee0879d-ce4f-4f54-a96b-c532dfb98ffd", "relationship_type": "mitigates", "target_ref": "attack-pattern--3c4a2599-71ee-4405-ba1e-0e28414b4bc5"}, {"created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5", "modified": "2019-07-26T19:54:07.332Z", "type": "relationship", "id": "relationship--ef79ec2f-fd7f-4f0b-851c-d215693987be", "object_marking_refs": ["marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"], "created": "2017-05-31T21:33:27.017Z", "source_ref": "course-of-action--aeff5887-8f9e-48d5-a523-9b395e2ce80a", "relationship_type": "mitigates", "target_ref": "attack-pattern--0a3ead4e-6d47-4ccb-854c-a6a4f9d96b22"}, {"created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5", "description": "Modify Registry settings (directly or using Dcomcnfg.exe) in <code>HKEY_LOCAL_MACHINE\\\\SOFTWARE\\\\Classes\\\\AppID\\\\{AppID_GUID}</code> associated with the process-wide security of individual COM applications.\n\nModify Registry settings (directly or using Dcomcnfg.exe) in <code>HKEY_LOCAL_MACHINE\\\\SOFTWARE\\\\Microsoft\\\\Ole</code> associated with system-wide security defaults for all COM applications that do no set their own process-wide security.", "type": "relationship", "id": "relationship--9fab5f0b-d10e-45e3-ab0f-56cadb7ccae9", "object_marking_refs": ["marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"], "created": "2019-06-24T14:19:22.426Z", "modified": "2019-06-24T14:19:22.426Z", "source_ref": "course-of-action--9bb9e696-bff8-4ae1-9454-961fc7d91d5f", "relationship_type": "mitigates", "target_ref": "attack-pattern--772bc7a8-a157-42cc-8728-d648e25c7fe7"}, {"created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5", "description": "Make it difficult for adversaries to advance their operation through exploitation of undiscovered or unpatched vulnerabilities by using sandboxing. Other types of virtualization and application microsegmentation may also mitigate the impact of some types of exploitation. Risks of additional exploits and weaknesses in these systems may still exist.", "type": "relationship", "created": "2019-06-24T13:52:51.891Z", "object_marking_refs": ["marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"], "id": "relationship--5edeca3e-96aa-45e6-b99b-044e25cb3245", "external_references": [{"source_name": "Ars Technica Pwn2Own 2017 VM Escape", "description": "Goodin, D. (2017, March 17). Virtual machine escape fetches $105,000 at Pwn2Own hacking contest - updated. Retrieved March 12, 2018.", "url": "https://arstechnica.com/information-technology/2017/03/hack-that-escapes-vm-by-exploiting-edge-browser-fetches-105000-at-pwn2own/"}], "modified": "2019-07-26T19:55:06.578Z", "source_ref": "course-of-action--b9f0c069-abbe-4a07-a245-2481219a1463", "relationship_type": "mitigates", "target_ref": "attack-pattern--b21c3b2d-02e6-45b1-980b-e69051040839"}, {"created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5", "description": "Security applications that look for behavior used during exploitation such as Windows Defender Exploit Guard (WDEG) and the Enhanced Mitigation Experience Toolkit (EMET) can be used to mitigate some exploitation behavior. Control flow integrity checking is another way to potentially identify and stop a software exploit from occurring. Many of these protections depend on the architecture and target application binary for compatibility and may not work for software components targeted for privilege escalation.", "type": "relationship", "created": "2019-06-24T13:52:51.890Z", "object_marking_refs": ["marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"], "id": "relationship--267fa35c-7748-40eb-87ba-bddc0c88d643", "external_references": [{"source_name": "TechNet Moving Beyond EMET", "description": "Nunez, N. (2017, August 9). Moving Beyond EMET II \u2013 Windows Defender Exploit Guard. Retrieved March 12, 2018.", "url": "https://blogs.technet.microsoft.com/srd/2017/08/09/moving-beyond-emet-ii-windows-defender-exploit-guard/"}, {"source_name": "Wikipedia Control Flow Integrity", "description": "Wikipedia. (2018, January 11). Control-flow integrity. Retrieved March 12, 2018.", "url": "https://en.wikipedia.org/wiki/Control-flow_integrity"}], "modified": "2019-07-26T19:55:06.570Z", "source_ref": "course-of-action--d2a24649-9694-4c97-9c62-ce7b270bf6a3", "relationship_type": "mitigates", "target_ref": "attack-pattern--b21c3b2d-02e6-45b1-980b-e69051040839"}, {"created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5", "description": "Develop a robust cyber threat intelligence capability to determine what types and levels of threat may use software exploits and 0-days against a particular organization.", "type": "relationship", "created": "2019-06-24T13:52:51.878Z", "object_marking_refs": ["marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"], "id": "relationship--c6615e27-5984-44b3-82dc-f710c6823834", "modified": "2019-07-26T19:55:06.563Z", "source_ref": "course-of-action--874c0166-e407-45c2-a1d9-e4e3a6570fd8", "relationship_type": "mitigates", "target_ref": "attack-pattern--b21c3b2d-02e6-45b1-980b-e69051040839"}, {"created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5", "description": "Update software regularly by employing patch management for internal enterprise endpoints and servers.", "type": "relationship", "created": "2019-06-24T13:52:51.861Z", "object_marking_refs": ["marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"], "id": "relationship--22d11711-5794-42aa-a9c5-02895fe3420d", "modified": "2019-07-26T19:55:06.550Z", "source_ref": "course-of-action--e5d930e9-775a-40ad-9bdb-b941d8dfe86b", "relationship_type": "mitigates", "target_ref": "attack-pattern--b21c3b2d-02e6-45b1-980b-e69051040839"}, {"created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5", "description": "Configure Office security settings enable Protected View, to execute within a sandbox environment, and to block macros through Group Policy. Other types of virtualization and application microsegmentation may also mitigate the impact of compromise.", "type": "relationship", "id": "relationship--11767ed3-e938-4d0f-97dd-2a190e55f8db", "object_marking_refs": ["marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"], "created": "2019-06-24T13:41:54.141Z", "modified": "2019-06-24T13:41:54.141Z", "source_ref": "course-of-action--b9f0c069-abbe-4a07-a245-2481219a1463", "relationship_type": "mitigates", "target_ref": "attack-pattern--7fd87010-3a00-4da3-b905-410525e8ec44"}, {"created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5", "description": "Turn off unused features or restrict access to scripting engines such as VBScript or scriptable administration frameworks such as PowerShell.", "type": "relationship", "id": "relationship--ef3d56d7-2339-4ee7-9086-293d04230fd4", "object_marking_refs": ["marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"], "created": "2019-06-24T13:41:54.122Z", "modified": "2019-06-24T13:41:54.122Z", "source_ref": "course-of-action--eb88d97c-32f1-40be-80f0-d61a4b0b4b31", "relationship_type": "mitigates", "target_ref": "attack-pattern--7fd87010-3a00-4da3-b905-410525e8ec44"}, {"created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5", "description": "Network intrusion detection and prevention systems that use network signatures to identify traffic for specific adversary command and control infrastructure and malware can be used to mitigate activity at the network level. Signatures are often for unique indicators within protocols and may be based on the specific obfuscation technique used by a particular adversary or tool, and will likely be different across various malware families and versions. Adversaries will likely change tool command and control signatures over time or construct protocols in such a way to avoid detection by common defensive tools.", "type": "relationship", "created": "2019-06-24T12:15:33.150Z", "object_marking_refs": ["marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"], "id": "relationship--9802575b-e7bf-417b-8c4e-cfa922e2792b", "external_references": [{"source_name": "University of Birmingham C2", "description": "Gardiner, J.,  Cova, M., Nagaraja, S. (2014, February). Command & Control Understanding, Denying and Detecting. Retrieved April 20, 2016.", "url": "https://arxiv.org/ftp/arxiv/papers/1408/1408.1136.pdf"}], "modified": "2019-07-18T18:24:58.950Z", "source_ref": "course-of-action--12241367-a8b7-49b4-b86e-2236901ba50c", "relationship_type": "mitigates", "target_ref": "attack-pattern--4eeaf8a9-c86b-4954-a663-9555fb406466"}, {"created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5", "description": "Ensure that permissions disallow services that run at a higher permissions level from being created or interacted with by a user with a lower permission level.", "type": "relationship", "created": "2019-06-24T12:13:11.562Z", "object_marking_refs": ["marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"], "id": "relationship--07be2a52-df69-4d03-aca6-e3d136eefc04", "modified": "2019-07-18T19:12:52.393Z", "source_ref": "course-of-action--9bb9e696-bff8-4ae1-9454-961fc7d91d5f", "relationship_type": "mitigates", "target_ref": "attack-pattern--f44731de-ea9f-406d-9b83-30ecbb9b4392"}, {"created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5", "description": "Ensure that unnecessary ports and services are closed to prevent risk of discovery and potential exploitation.", "type": "relationship", "created": "2019-06-25T12:25:23.800Z", "object_marking_refs": ["marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"], "id": "relationship--32d482c4-2c0d-4688-a38b-d73b5b2962a3", "modified": "2019-07-18T16:38:51.192Z", "source_ref": "course-of-action--eb88d97c-32f1-40be-80f0-d61a4b0b4b31", "relationship_type": "mitigates", "target_ref": "attack-pattern--e3a12395-188d-4051-9a16-ea8e14d07b88"}, {"created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5", "description": "Use network intrusion detection/prevention systems to detect and prevent remote service scans.", "type": "relationship", "created": "2019-06-25T12:25:23.792Z", "object_marking_refs": ["marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"], "id": "relationship--651225d6-5454-4c44-8d62-776bd7ddaed2", "modified": "2019-07-18T16:38:51.170Z", "source_ref": "course-of-action--12241367-a8b7-49b4-b86e-2236901ba50c", "relationship_type": "mitigates", "target_ref": "attack-pattern--e3a12395-188d-4051-9a16-ea8e14d07b88"}, {"created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5", "description": "It may be possible to remove PowerShell from systems when not needed, but a review should be performed to assess the impact to an environment, since it could be in use for many legitimate purposes and administrative functions.\n\nDisable/restrict the WinRM Service to help prevent uses of PowerShell for remote execution.", "type": "relationship", "created": "2019-06-25T11:53:20.331Z", "object_marking_refs": ["marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"], "id": "relationship--39962764-cf46-4f39-9dd9-95b0ced56d93", "modified": "2019-07-18T17:15:10.832Z", "source_ref": "course-of-action--eb88d97c-32f1-40be-80f0-d61a4b0b4b31", "relationship_type": "mitigates", "target_ref": "attack-pattern--f4882e23-8aa7-4b12-b28a-b349c12ee9e0"}, {"created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5", "description": "Audit and/or block unnecessary command-line interpreters by using application whitelisting tools, like Windows Defender Application Control, AppLocker, or Software Restriction Policies where appropriate.", "type": "relationship", "created": "2019-06-24T18:00:41.676Z", "object_marking_refs": ["marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"], "id": "relationship--87fd0088-41da-47ac-bd69-a8ac151a0d39", "external_references": [{"source_name": "Beechey 2010", "description": "Beechey, J. (2010, December). Application Whitelisting: Panacea or Propaganda?. Retrieved November 18, 2014.", "url": "http://www.sans.org/reading-room/whitepapers/application/application-whitelisting-panacea-propaganda-33599"}, {"source_name": "Microsoft Windows Defender Application Control", "description": "Gorzelany, A., Hall, J., Poggemeyer, L.. (2019, January 7). Windows Defender Application Control. Retrieved July 16, 2019.", "url": "https://docs.microsoft.com/en-us/windows/security/threat-protection/windows-defender-application-control/windows-defender-application-control"}, {"source_name": "Windows Commands JPCERT", "description": "Tomonaga, S. (2016, January 26). Windows Commands Abused by Attackers. Retrieved February 2, 2016.", "url": "http://blog.jpcert.or.jp/2016/01/windows-commands-abused-by-attackers.html"}, {"source_name": "NSA MS AppLocker", "description": "NSA Information Assurance Directorate. (2014, August). Application Whitelisting Using Microsoft AppLocker. Retrieved March 31, 2016.", "url": "https://www.iad.gov/iad/library/ia-guidance/tech-briefs/application-whitelisting-using-microsoft-applocker.cfm"}, {"source_name": "Corio 2008", "description": "Corio, C., & Sayana, D. P. (2008, June). Application Lockdown with Software Restriction Policies. Retrieved November 18, 2014.", "url": "http://technet.microsoft.com/en-us/magazine/2008.06.srp.aspx"}, {"source_name": "TechNet Applocker vs SRP", "description": "Microsoft. (2012, June 27). Using Software Restriction Policies and AppLocker Policies. Retrieved April 7, 2016.", "url": "https://technet.microsoft.com/en-us/library/ee791851.aspx"}], "modified": "2019-07-16T20:46:59.483Z", "source_ref": "course-of-action--47e0e9fe-96ce-4f65-8bb1-8be1feacb5db", "relationship_type": "mitigates", "target_ref": "attack-pattern--7385dfaf-6886-4229-9ecd-6fd678040830"}, {"created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5", "description": "Use multi-factor authentication on remote service logons where possible.", "type": "relationship", "created": "2019-06-24T16:04:41.149Z", "object_marking_refs": ["marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"], "id": "relationship--a70d8d81-4d88-404c-81f3-c3ddd57d6b69", "modified": "2019-07-18T17:50:43.822Z", "source_ref": "course-of-action--b045d015-6bed-4490-bd38-56b41ece59a0", "relationship_type": "mitigates", "target_ref": "attack-pattern--54a649ff-439a-41a4-9856-8d144a2551ba"}, {"created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5", "description": "Audit the Remote Desktop Users group membership regularly. Remove unnecessary accounts and groups from Remote Desktop Users groups", "type": "relationship", "created": "2019-06-24T16:00:50.015Z", "object_marking_refs": ["marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"], "id": "relationship--0a5b4837-54e4-46e0-80e9-03c39919aec4", "modified": "2019-07-18T17:46:12.387Z", "source_ref": "course-of-action--cc2399fd-3cd3-4319-8d0a-fbd6420cdaf8", "relationship_type": "mitigates", "target_ref": "attack-pattern--51dea151-0898-4a45-967c-3ebee0420484"}, {"created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5", "description": "Disable the RDP service if it is unnecessary.", "type": "relationship", "created": "2019-06-24T16:00:50.009Z", "object_marking_refs": ["marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"], "id": "relationship--d02e0a35-ab09-49a9-958f-d71fbb1e3e6f", "modified": "2019-07-18T17:46:12.386Z", "source_ref": "course-of-action--eb88d97c-32f1-40be-80f0-d61a4b0b4b31", "relationship_type": "mitigates", "target_ref": "attack-pattern--51dea151-0898-4a45-967c-3ebee0420484"}, {"created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5", "description": "Use multi-factor authentication for remote logins.", "type": "relationship", "created": "2019-06-24T16:00:50.000Z", "object_marking_refs": ["marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"], "id": "relationship--3eb59d14-a07f-493a-8bee-5877c6c1d478", "external_references": [{"source_name": "Berkley Secure", "description": "Berkeley Security, University of California. (n.d.). Securing Remote Desktop for System Administrators. Retrieved November 4, 2014.", "url": "https://security.berkeley.edu/node/94"}], "modified": "2019-07-18T17:46:12.382Z", "source_ref": "course-of-action--b045d015-6bed-4490-bd38-56b41ece59a0", "relationship_type": "mitigates", "target_ref": "attack-pattern--51dea151-0898-4a45-967c-3ebee0420484"}, {"created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5", "description": "Do not leave RDP accessible from the internet. Enable firewall rules to block RDP traffic between network security zones within a network.", "type": "relationship", "created": "2019-06-24T16:00:49.996Z", "object_marking_refs": ["marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"], "id": "relationship--bff585a5-6a32-4361-a72c-dfb1f6e6fe3d", "modified": "2019-07-18T17:46:12.385Z", "source_ref": "course-of-action--86598de0-b347-4928-9eb0-0acbfc21908c", "relationship_type": "mitigates", "target_ref": "attack-pattern--51dea151-0898-4a45-967c-3ebee0420484"}, {"created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5", "description": "Change GPOs to define shorter timeouts sessions and maximum amount of time any single session can be active. Change GPOs to specify the maximum amount of time that a disconnected session stays active on the RD session host server.", "type": "relationship", "created": "2019-06-24T16:00:49.986Z", "object_marking_refs": ["marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"], "id": "relationship--65e07f9e-91cd-4b91-8707-83b4ffdb29bd", "external_references": [{"source_name": "Windows RDP Sessions", "description": "Microsoft. (n.d.). Configure Timeout and Reconnection Settings for Remote Desktop Services Sessions. Retrieved December 11, 2017.", "url": "https://technet.microsoft.com/en-us/library/cc754272(v=ws.11).aspx"}], "modified": "2019-07-18T17:46:12.353Z", "source_ref": "course-of-action--2f316f6c-ae42-44fe-adf8-150989e0f6d3", "relationship_type": "mitigates", "target_ref": "attack-pattern--51dea151-0898-4a45-967c-3ebee0420484"}, {"created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5", "description": "Consider removing the local Administrators group from the list of groups allowed to log in through RDP.", "type": "relationship", "created": "2019-06-24T15:55:14.055Z", "object_marking_refs": ["marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"], "id": "relationship--48925883-c396-49a2-8b1b-2d7220959e2c", "modified": "2019-07-18T17:46:12.350Z", "source_ref": "course-of-action--9bb9e696-bff8-4ae1-9454-961fc7d91d5f", "relationship_type": "mitigates", "target_ref": "attack-pattern--51dea151-0898-4a45-967c-3ebee0420484"}, {"created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5", "description": "Ensure that built-in and created local administrator accounts have complex, unique passwords.", "type": "relationship", "created": "2019-06-24T14:27:52.180Z", "object_marking_refs": ["marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"], "id": "relationship--14fa80e7-9e59-403c-8e1b-ea3145438b48", "modified": "2019-07-18T16:56:40.337Z", "source_ref": "course-of-action--90c218c3-fbf8-4830-98a7-e8cfb7eaa485", "relationship_type": "mitigates", "target_ref": "attack-pattern--c23b740b-a42b-47a1-aec2-9d48ddd547ff"}, {"created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5", "description": "Limit credential overlap across systems to prevent the damage of credential compromise and reduce the adversary's ability to perform Lateral Movement between systems.", "type": "relationship", "created": "2019-06-24T14:27:52.179Z", "object_marking_refs": ["marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"], "id": "relationship--159d35c3-673d-4c42-be26-d53ab11e277e", "modified": "2019-07-18T16:56:40.308Z", "source_ref": "course-of-action--9bb9e696-bff8-4ae1-9454-961fc7d91d5f", "relationship_type": "mitigates", "target_ref": "attack-pattern--c23b740b-a42b-47a1-aec2-9d48ddd547ff"}, {"created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5", "description": "Enable pass the hash mitigations to apply UAC restrictions to local accounts on network logon. The associated Registry key is located <code>HKLM\\\\SOFTWARE\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\Policies\\\\System\\\\LocalAccountTokenFilterPolicy</code> Through GPO: Computer Configuration > [Policies] > Administrative Templates > SCM: Pass the Hash Mitigations: Apply UAC restrictions to local accounts on network logons.", "type": "relationship", "created": "2019-06-24T14:27:52.161Z", "object_marking_refs": ["marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"], "id": "relationship--4af1337b-478f-43e1-b0b7-07ab53c22a64", "external_references": [{"source_name": "GitHub IAD Secure Host Baseline UAC Filtering", "description": "NSA IAD. (2017, January 24). MS Security Guide. Retrieved December 18, 2017.", "url": "https://github.com/iadgov/Secure-Host-Baseline/blob/master/Windows/Group%20Policy%20Templates/en-US/SecGuide.adml"}], "modified": "2019-07-18T16:56:40.304Z", "source_ref": "course-of-action--2c2ad92a-d710-41ab-a996-1db143bb4808", "relationship_type": "mitigates", "target_ref": "attack-pattern--c23b740b-a42b-47a1-aec2-9d48ddd547ff"}, {"created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5", "description": "Consider disabling DCOM through Dcomcnfg.exe.", "type": "relationship", "id": "relationship--055bd398-635f-45e2-94d2-711af316bed7", "object_marking_refs": ["marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"], "created": "2019-06-24T14:19:22.455Z", "modified": "2019-06-24T14:19:22.455Z", "source_ref": "course-of-action--eb88d97c-32f1-40be-80f0-d61a4b0b4b31", "relationship_type": "mitigates", "target_ref": "attack-pattern--772bc7a8-a157-42cc-8728-d648e25c7fe7"}, {"created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5", "description": "Ensure all COM alerts and Protected View are enabled.", "type": "relationship", "id": "relationship--e9c5a8f9-571e-4c08-88bb-6baca6dad6ea", "object_marking_refs": ["marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"], "created": "2019-06-24T14:19:22.453Z", "modified": "2019-06-24T14:19:22.453Z", "source_ref": "course-of-action--b9f0c069-abbe-4a07-a245-2481219a1463", "relationship_type": "mitigates", "target_ref": "attack-pattern--772bc7a8-a157-42cc-8728-d648e25c7fe7"}, {"created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5", "description": "Enable Windows firewall, which prevents DCOM instantiation by default.", "type": "relationship", "id": "relationship--47257f80-df2c-4090-9c2b-6ef23eccdbf3", "object_marking_refs": ["marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"], "created": "2019-06-24T14:19:22.440Z", "modified": "2019-06-24T14:19:22.440Z", "source_ref": "course-of-action--86598de0-b347-4928-9eb0-0acbfc21908c", "relationship_type": "mitigates", "target_ref": "attack-pattern--772bc7a8-a157-42cc-8728-d648e25c7fe7"}, {"created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5", "description": "Do not reuse local administrator account passwords across systems. Ensure password complexity and uniqueness such that the passwords cannot be cracked or guessed.", "type": "relationship", "id": "relationship--9f424168-dc5b-45ea-998f-2d5bd48e524b", "object_marking_refs": ["marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"], "created": "2019-06-21T14:16:08.448Z", "modified": "2019-06-21T14:16:08.448Z", "source_ref": "course-of-action--90c218c3-fbf8-4830-98a7-e8cfb7eaa485", "relationship_type": "mitigates", "target_ref": "attack-pattern--ffe742ed-9100-4686-9e00-c331da544787"}, {"created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5", "description": "Deny remote use of local admin credentials to log into systems. Do not allow domain user accounts to be in the local Administrators group multiple systems.", "type": "relationship", "id": "relationship--287b5cdf-1828-41aa-a2c3-16fc5ff5e53f", "object_marking_refs": ["marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"], "created": "2019-06-21T14:16:08.441Z", "modified": "2019-06-21T14:16:08.441Z", "source_ref": "course-of-action--9bb9e696-bff8-4ae1-9454-961fc7d91d5f", "relationship_type": "mitigates", "target_ref": "attack-pattern--ffe742ed-9100-4686-9e00-c331da544787"}, {"created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5", "description": "Close all browser sessions regularly and when they are no longer needed.", "type": "relationship", "created": "2019-06-21T13:58:04.205Z", "object_marking_refs": ["marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"], "id": "relationship--8d6d88c3-dbfe-492a-8c4c-ee4bfc10bdc3", "modified": "2019-07-18T15:36:27.537Z", "source_ref": "course-of-action--2a4f6c11-a4a7-4cb9-b0ef-6ae1bb3a718a", "relationship_type": "mitigates", "target_ref": "attack-pattern--544b0346-29ad-41e1-a808-501bb4193f47"}, {"created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5", "description": "Prevent credential overlap across systems of administrator and privileged accounts.", "type": "relationship", "created": "2019-06-21T13:56:39.436Z", "object_marking_refs": ["marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"], "id": "relationship--1e0c4d65-a4db-42e0-9eb0-93354ad56d06", "external_references": [{"source_name": "FireEye WMI 2015", "description": "Ballenthin, W., et al. (2015). Windows Management Instrumentation (WMI) Offense, Defense, and Forensics. Retrieved March 30, 2016.", "url": "https://www.fireeye.com/content/dam/fireeye-www/global/en/current-threats/pdfs/wp-windows-management-instrumentation.pdf"}], "modified": "2019-07-17T20:04:40.552Z", "source_ref": "course-of-action--9bb9e696-bff8-4ae1-9454-961fc7d91d5f", "relationship_type": "mitigates", "target_ref": "attack-pattern--01a5a209-b94c-450b-b7f9-946497d91055"}, {"created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5", "description": "Disable the WinRM service.", "type": "relationship", "created": "2019-06-21T13:29:36.123Z", "object_marking_refs": ["marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"], "id": "relationship--08b93e63-6485-47fe-bc22-7d744fa700b9", "modified": "2019-07-17T23:22:27.921Z", "source_ref": "course-of-action--eb88d97c-32f1-40be-80f0-d61a4b0b4b31", "relationship_type": "mitigates", "target_ref": "attack-pattern--c3bce4f4-9795-46c6-976e-8676300bbc39"}, {"created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5", "description": "If the service is necessary, lock down critical enclaves with separate WinRM infrastructure and follow WinRM best practices on use of host firewalls to restrict WinRM access to allow communication only to/from specific devices.", "type": "relationship", "created": "2019-06-21T13:29:36.121Z", "object_marking_refs": ["marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"], "id": "relationship--b0bb68cb-2dae-4012-b5fb-3e369dce0be0", "external_references": [{"source_name": "NSA Spotting", "description": "National Security Agency/Central Security Service Information Assurance Directorate. (2015, August 7). Spotting the Adversary with Windows Event Log Monitoring. Retrieved September 6, 2018.", "url": "https://www.iad.gov/iad/library/reports/spotting-the-adversary-with-windows-event-log-monitoring.cfm"}], "modified": "2019-07-17T23:22:27.914Z", "source_ref": "course-of-action--86598de0-b347-4928-9eb0-0acbfc21908c", "relationship_type": "mitigates", "target_ref": "attack-pattern--c3bce4f4-9795-46c6-976e-8676300bbc39"}, {"created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5", "description": "Filter network traffic to look for unusual or non-standard protocols.", "type": "relationship", "id": "relationship--40865e9d-cfaf-4375-a1c2-ea47fe9e9bda", "object_marking_refs": ["marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"], "created": "2019-07-17T18:20:50.647Z", "modified": "2019-07-17T18:20:50.647Z", "source_ref": "course-of-action--20f6a9df-37c4-4e20-9e47-025983b1b39d", "relationship_type": "mitigates", "target_ref": "attack-pattern--f72eb8a8-cd4c-461d-a814-3f862befbf00"}, {"created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5", "description": "\nConsider disabling or restricting NTLM.", "type": "relationship", "created": "2019-07-17T15:45:37.582Z", "object_marking_refs": ["marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"], "id": "relationship--fe849763-78b9-4b8a-9219-2781ac7b00e8", "external_references": [{"source_name": "Microsoft Disable NTLM Nov 2012", "description": "Microsoft. (2012, November 29). Using security policies to restrict NTLM traffic. Retrieved December 4, 2017.", "url": "https://technet.microsoft.com/library/jj865668.aspx"}], "modified": "2019-07-26T19:54:07.449Z", "source_ref": "course-of-action--2f316f6c-ae42-44fe-adf8-150989e0f6d3", "relationship_type": "mitigates", "target_ref": "attack-pattern--0a3ead4e-6d47-4ccb-854c-a6a4f9d96b22"}, {"created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5", "description": "\nOn Windows 8.1 and Windows Server 2012 R2, enable Protected Process Light for LSA.", "type": "relationship", "created": "2019-07-17T15:45:37.529Z", "object_marking_refs": ["marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"], "id": "relationship--a6f27258-cf6a-4d75-a3f0-5de085d528d2", "external_references": [{"source_name": "Microsoft LSA", "description": "Microsoft. (2013, July 31). Configuring Additional LSA Protection. Retrieved February 13, 2015.", "url": "https://technet.microsoft.com/en-us/library/dn408187.aspx"}], "modified": "2019-07-26T19:54:07.445Z", "source_ref": "course-of-action--72dade3e-1cba-4182-b3b3-a77ca52f02a1", "relationship_type": "mitigates", "target_ref": "attack-pattern--0a3ead4e-6d47-4ccb-854c-a6a4f9d96b22"}, {"created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5", "description": "\nManage the access control list for \u201cReplicating Directory Changes\u201d and other permissions associated with domain controller replication.", "type": "relationship", "created": "2019-07-17T15:45:37.521Z", "object_marking_refs": ["marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"], "id": "relationship--fc31837d-530f-45e5-b9f8-bf6268c3ef03", "external_references": [{"source_name": "AdSecurity DCSync Sept 2015", "description": "Metcalf, S. (2015, September 25). Mimikatz DCSync Usage, Exploitation, and Detection. Retrieved December 4, 2017.", "url": "https://adsecurity.org/?p=1729"}, {"source_name": "Microsoft Replication ACL", "description": "Microsoft. (n.d.). How to grant the \"Replicating Directory Changes\" permission for the Microsoft Metadirectory Services ADMA service account. Retrieved December 4, 2017.", "url": "https://support.microsoft.com/help/303972/how-to-grant-the-replicating-directory-changes-permission-for-the-micr"}], "modified": "2019-07-26T19:54:07.433Z", "source_ref": "course-of-action--e3388c78-2a8d-47c2-8422-c1398b324462", "relationship_type": "mitigates", "target_ref": "attack-pattern--0a3ead4e-6d47-4ccb-854c-a6a4f9d96b22"}, {"created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5", "description": "Limit credential overlap across accounts and systems by training users and administrators not to use the same password for multiple accounts.", "type": "relationship", "created": "2019-07-17T15:45:37.493Z", "object_marking_refs": ["marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"], "id": "relationship--7e8ca453-aee5-48c1-a891-f44a742a95ed", "modified": "2019-07-26T19:54:07.419Z", "source_ref": "course-of-action--2a4f6c11-a4a7-4cb9-b0ef-6ae1bb3a718a", "relationship_type": "mitigates", "target_ref": "attack-pattern--0a3ead4e-6d47-4ccb-854c-a6a4f9d96b22"}, {"created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5", "description": "Configure internal and external firewalls to block traffic using common ports that associate to network protocols that may be unnecessary for that particular network segment.", "type": "relationship", "id": "relationship--205b99bf-ce60-4bb5-8916-ac9d97ce4d05", "object_marking_refs": ["marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"], "created": "2019-07-16T20:51:40.453Z", "modified": "2019-07-16T20:51:40.453Z", "source_ref": "course-of-action--86598de0-b347-4928-9eb0-0acbfc21908c", "relationship_type": "mitigates", "target_ref": "attack-pattern--f879d51c-5476-431c-aedf-f14d207e4d1e"}, {"created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5", "description": "Check for common UAC bypass weaknesses on Windows systems to be aware of the risk posture and address issues where appropriate.", "type": "relationship", "id": "relationship--9ae39090-1b20-4a81-8c03-841cd46d0f0b", "object_marking_refs": ["marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"], "created": "2019-07-16T20:28:55.404Z", "modified": "2019-07-16T20:28:55.404Z", "source_ref": "course-of-action--cc2399fd-3cd3-4319-8d0a-fbd6420cdaf8", "relationship_type": "mitigates", "target_ref": "attack-pattern--ca1a3f50-5ebd-41f8-8320-2c7d6a6e88be"}, {"created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5", "description": "\nConsider limiting access to the BITS interface to specific users or groups.", "type": "relationship", "id": "relationship--279fa1bc-e514-4125-ab7e-51fb1da8a3f2", "object_marking_refs": ["marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"], "created": "2019-07-16T20:02:53.325Z", "modified": "2019-07-16T20:02:53.325Z", "source_ref": "course-of-action--93e7968a-9074-4eac-8ae9-9f5200ec3317", "relationship_type": "mitigates", "target_ref": "attack-pattern--c8e87b83-edbb-48d4-9295-4974897525b7"}, {"created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5", "description": "An adversary must already have administrator level access on the local system to make full use of this technique; be sure to restrict users and accounts to the least privileges they require.  ", "type": "relationship", "created": "2019-07-16T17:24:49.784Z", "object_marking_refs": ["marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"], "id": "relationship--3c5f6c2a-7940-4cdc-8b25-811e33d9b96a", "modified": "2019-07-16T17:30:44.159Z", "source_ref": "course-of-action--93e7968a-9074-4eac-8ae9-9f5200ec3317", "relationship_type": "mitigates", "target_ref": "attack-pattern--dcaa092b-7de9-4a21-977f-7fcb77e89c48"}, {"created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5", "description": "Applications and appliances that utilize default username and password should be changed immediately after the installation, and before deployment to a production environment. When possible, applications that use SSH keys should be updated periodically and properly secured. Ensure that local administrator accounts have complex, unique passwords across all systems on the network.", "type": "relationship", "created": "2019-06-21T16:21:55.304Z", "object_marking_refs": ["marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"], "id": "relationship--4f24d075-4d6c-49d2-a213-306e4af2083d", "external_references": [{"source_name": "US-CERT Alert TA13-175A Risks of Default Passwords on the Internet", "description": "undefined. (n.d.). Risks of Default Passwords on the Internet. Retrieved April 12, 2019.", "url": "https://www.us-cert.gov/ncas/alerts/TA13-175A"}], "modified": "2019-06-21T18:44:26.748Z", "source_ref": "course-of-action--90c218c3-fbf8-4830-98a7-e8cfb7eaa485", "relationship_type": "mitigates", "target_ref": "attack-pattern--b17a1a56-e99c-403c-8948-561df0cffe81"}, {"created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5", "description": "Audit domain and local accounts as well as their permission levels routinely to look for situations that could allow an adversary to gain wide access by obtaining credentials of a privileged account. These audits should also include if default accounts have been enabled, or if new local accounts are created that have not be authorized. Do not put user or admin domain accounts in the local administrator groups across systems unless they are tightly controlled and use of accounts is segmented, as this is often equivalent to having a local administrator account with the same password on all systems. Follow best practices for design and administration of an enterprise network to limit privileged account use across administrative tiers. Limit credential overlap across systems to prevent access if account credentials are obtained.", "type": "relationship", "created": "2019-06-21T16:21:55.301Z", "object_marking_refs": ["marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"], "id": "relationship--89887815-acfc-42f9-9172-81437cf9ff69", "external_references": [{"source_name": "TechNet Credential Theft", "description": "Microsoft. (2016, April 15). Attractive Accounts for Credential Theft. Retrieved June 3, 2016.", "url": "https://technet.microsoft.com/en-us/library/dn535501.aspx"}, {"source_name": "TechNet Least Privilege", "description": "Microsoft. (2016, April 16). Implementing Least-Privilege Administrative Models. Retrieved June 3, 2016.", "url": "https://technet.microsoft.com/en-us/library/dn487450.aspx"}, {"source_name": "Microsoft Securing Privileged Access", "description": "Plett, C., Poggemeyer, L. (12, October 26). Securing Privileged Access Reference Material. Retrieved April 25, 2017.", "url": "https://docs.microsoft.com/en-us/windows-server/identity/securing-privileged-access/securing-privileged-access-reference-material#a-nameesaebmaesae-administrative-forest-design-approach"}], "modified": "2019-06-21T18:44:26.721Z", "source_ref": "course-of-action--9bb9e696-bff8-4ae1-9454-961fc7d91d5f", "relationship_type": "mitigates", "target_ref": "attack-pattern--b17a1a56-e99c-403c-8948-561df0cffe81"}, {"created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5", "description": "Network intrusion detection and prevention systems that use network signatures to identify traffic for specific adversary malware can be used to mitigate activity at the network level.", "type": "relationship", "id": "relationship--19f35c88-92c4-4e98-b024-be9f6731bdb5", "object_marking_refs": ["marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"], "created": "2019-06-21T15:16:29.301Z", "modified": "2019-06-21T15:16:29.301Z", "source_ref": "course-of-action--12241367-a8b7-49b4-b86e-2236901ba50c", "relationship_type": "mitigates", "target_ref": "attack-pattern--355be19c-ffc9-46d5-8d50-d6a036c675b6"}, {"created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5", "description": "Network intrusion detection and prevention systems that use network signatures to identify traffic for specific adversary malware can be used to mitigate activity at the network level. Signatures are often for unique indicators within protocols and may be based on the specific protocol used by a particular adversary or tool, and will likely be different across various malware families and versions. Adversaries will likely change tool C2 signatures over time or construct protocols in such a way as to avoid detection by common defensive tools.", "type": "relationship", "created": "2019-06-21T15:00:51.735Z", "object_marking_refs": ["marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"], "id": "relationship--41931cc0-5bbb-490a-8195-18e4f83bd0bc", "external_references": [{"source_name": "University of Birmingham C2", "description": "Gardiner, J.,  Cova, M., Nagaraja, S. (2014, February). Command & Control Understanding, Denying and Detecting. Retrieved April 20, 2016.", "url": "https://arxiv.org/ftp/arxiv/papers/1408/1408.1136.pdf"}], "modified": "2019-07-18T16:28:55.394Z", "source_ref": "course-of-action--12241367-a8b7-49b4-b86e-2236901ba50c", "relationship_type": "mitigates", "target_ref": "attack-pattern--99709758-2b96-48f2-a68a-ad7fbd828091"}, {"created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5", "description": "Limit the accounts that may use remote services. Limit the permissions for accounts that are at higher risk of compromise; for example, configure SSH so users can only run specific programs.", "type": "relationship", "id": "relationship--795ca238-c8cf-4735-98cc-593f1cc59b16", "object_marking_refs": ["marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"], "created": "2019-07-18T17:50:43.801Z", "modified": "2019-07-18T17:50:43.801Z", "source_ref": "course-of-action--93e7968a-9074-4eac-8ae9-9f5200ec3317", "relationship_type": "mitigates", "target_ref": "attack-pattern--54a649ff-439a-41a4-9856-8d144a2551ba"}, {"created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5", "description": "Limit remote user permissions if remote access is necessary.", "type": "relationship", "id": "relationship--bea04550-f39b-4840-82f2-5da61457f696", "object_marking_refs": ["marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"], "created": "2019-07-18T17:46:12.319Z", "modified": "2019-07-18T17:46:12.319Z", "source_ref": "course-of-action--93e7968a-9074-4eac-8ae9-9f5200ec3317", "relationship_type": "mitigates", "target_ref": "attack-pattern--51dea151-0898-4a45-967c-3ebee0420484"}, {"created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5", "description": "Use remote desktop gateways.", "type": "relationship", "id": "relationship--227f3705-ab28-4b5f-87d7-12bcf14c47f7", "object_marking_refs": ["marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"], "created": "2019-07-18T17:46:12.289Z", "modified": "2019-07-18T17:46:12.289Z", "source_ref": "course-of-action--1dcaeb21-9348-42ea-950a-f842aaf1ae1f", "relationship_type": "mitigates", "target_ref": "attack-pattern--51dea151-0898-4a45-967c-3ebee0420484"}, {"created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5", "description": "###Linux\n\nUtilize Yama to mitigate ptrace based process injection by restricting the use of ptrace to privileged users only. Other mitigation controls involve the deployment of security kernel modules that provide advanced access control and process restrictions such as SELinux, grsecurity, and AppAmour.", "type": "relationship", "id": "relationship--d3a267b8-2eba-4d97-8b10-0544e36e5fee", "object_marking_refs": ["marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"], "created": "2019-07-18T17:27:05.291Z", "modified": "2019-07-18T17:27:05.291Z", "source_ref": "course-of-action--9bb9e696-bff8-4ae1-9454-961fc7d91d5f", "relationship_type": "mitigates", "target_ref": "attack-pattern--43e7dc91-05b2-474c-b9ac-2ed4fe101f4d"}, {"created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5", "description": "Some endpoint security solutions can be configured to block some types of process injection based on common sequences of behavior that occur during the injection process.", "type": "relationship", "id": "relationship--bcdd57cf-632f-4fc5-a8e8-d3137cb832e8", "object_marking_refs": ["marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"], "created": "2019-07-18T17:27:05.228Z", "modified": "2019-07-18T17:27:05.228Z", "source_ref": "course-of-action--90f39ee1-d5a3-4aaa-9f28-3b42815b0d46", "relationship_type": "mitigates", "target_ref": "attack-pattern--43e7dc91-05b2-474c-b9ac-2ed4fe101f4d"}, {"created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5", "description": "Set PowerShell execution policy to execute only signed scripts. ", "type": "relationship", "id": "relationship--79568b8a-09c2-40fa-acd9-c7d369059b6a", "object_marking_refs": ["marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"], "created": "2019-07-18T17:15:10.820Z", "modified": "2019-07-18T17:15:10.820Z", "source_ref": "course-of-action--590777b3-b475-4c7c-aaf8-f4a73b140312", "relationship_type": "mitigates", "target_ref": "attack-pattern--f4882e23-8aa7-4b12-b28a-b349c12ee9e0"}, {"created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5", "description": "When PowerShell is necessary, restrict PowerShell execution policy to administrators. Be aware that there are methods of bypassing the PowerShell execution policy, depending on environment configuration. ", "type": "relationship", "id": "relationship--b188b994-7965-4c34-81d6-307f218ba80e", "object_marking_refs": ["marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"], "created": "2019-07-18T17:15:10.792Z", "modified": "2019-07-18T17:15:10.792Z", "source_ref": "course-of-action--9bb9e696-bff8-4ae1-9454-961fc7d91d5f", "relationship_type": "mitigates", "target_ref": "attack-pattern--f4882e23-8aa7-4b12-b28a-b349c12ee9e0"}, {"created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5", "description": "Apply patch KB2871997 to Windows 7 and higher systems to limit the default access of accounts in the local administrator group. ", "type": "relationship", "id": "relationship--48fc9c14-0ec3-460a-bb95-fe9a1566397e", "object_marking_refs": ["marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"], "created": "2019-07-18T16:56:40.280Z", "modified": "2019-07-18T16:56:40.280Z", "source_ref": "course-of-action--e5d930e9-775a-40ad-9bdb-b941d8dfe86b", "relationship_type": "mitigates", "target_ref": "attack-pattern--c23b740b-a42b-47a1-aec2-9d48ddd547ff"}, {"created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5", "description": "Do not allow a domain user to be in the local administrator group on multiple systems.", "type": "relationship", "id": "relationship--ea374714-5df4-4858-83cb-5966a8d4d531", "object_marking_refs": ["marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"], "created": "2019-07-18T16:56:40.253Z", "modified": "2019-07-18T16:56:40.253Z", "source_ref": "course-of-action--93e7968a-9074-4eac-8ae9-9f5200ec3317", "relationship_type": "mitigates", "target_ref": "attack-pattern--c23b740b-a42b-47a1-aec2-9d48ddd547ff"}, {"created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5", "description": "Limit privileges of user accounts and remediate Privilege Escalation vectors so only  authorized administrators can create new services.", "type": "relationship", "id": "relationship--24f37698-b4a1-49fb-8de3-5e4529e99c41", "object_marking_refs": ["marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"], "created": "2019-07-18T16:43:26.127Z", "modified": "2019-07-18T16:43:26.127Z", "source_ref": "course-of-action--93e7968a-9074-4eac-8ae9-9f5200ec3317", "relationship_type": "mitigates", "target_ref": "attack-pattern--478aa214-2ca7-4ec0-9978-18798e514790"}, {"created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5", "description": "Ensure proper network segmentation is followed to protect critical servers and devices.", "type": "relationship", "id": "relationship--80f94d40-0861-4403-b206-1c864a136788", "object_marking_refs": ["marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"], "created": "2019-07-18T16:38:51.138Z", "modified": "2019-07-18T16:38:51.138Z", "source_ref": "course-of-action--86598de0-b347-4928-9eb0-0acbfc21908c", "relationship_type": "mitigates", "target_ref": "attack-pattern--e3a12395-188d-4051-9a16-ea8e14d07b88"}, {"created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5", "description": "Since browser pivoting requires a high integrity process to launch from, restricting user permissions and addressing Privilege Escalation and [Bypass User Account Control](https://attack.mitre.org/techniques/T1088) opportunities can limit the exposure to this technique.", "type": "relationship", "id": "relationship--a9f79f14-d160-4be5-8bbe-ad0b52770b9f", "object_marking_refs": ["marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"], "created": "2019-07-18T15:36:27.535Z", "modified": "2019-07-18T15:36:27.535Z", "source_ref": "course-of-action--93e7968a-9074-4eac-8ae9-9f5200ec3317", "relationship_type": "mitigates", "target_ref": "attack-pattern--544b0346-29ad-41e1-a808-501bb4193f47"}, {"created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5", "description": "By default, only administrators are allowed to connect remotely using WMI. Restrict other users who are allowed to connect, or disallow all users to connect remotely to WMI.", "type": "relationship", "id": "relationship--48e6b5fc-9d82-4cdf-84aa-bc23647e1234", "object_marking_refs": ["marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"], "created": "2019-07-17T20:04:40.541Z", "modified": "2019-07-17T20:04:40.541Z", "source_ref": "course-of-action--93e7968a-9074-4eac-8ae9-9f5200ec3317", "relationship_type": "mitigates", "target_ref": "attack-pattern--01a5a209-b94c-450b-b7f9-946497d91055"}, {"created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5", "description": "If the service is necessary, lock down critical enclaves with separate WinRM accounts and permissions.", "type": "relationship", "created": "2019-07-17T19:46:10.263Z", "object_marking_refs": ["marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"], "id": "relationship--908f43b2-be14-470d-b6ec-9bd0211752ee", "modified": "2019-07-17T23:22:27.924Z", "source_ref": "course-of-action--9bb9e696-bff8-4ae1-9454-961fc7d91d5f", "relationship_type": "mitigates", "target_ref": "attack-pattern--c3bce4f4-9795-46c6-976e-8676300bbc39"}, {"created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5", "description": "Also ensure that high permission level service binaries cannot be replaced or modified by users with a lower permission level.", "type": "relationship", "id": "relationship--0c4d2678-b4e3-4f0a-b3a2-f0f6d218bfd4", "object_marking_refs": ["marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"], "created": "2019-07-18T19:12:52.384Z", "modified": "2019-07-18T19:12:52.384Z", "source_ref": "course-of-action--987988f0-cf86-4680-a875-2f6456ab2448", "relationship_type": "mitigates", "target_ref": "attack-pattern--f44731de-ea9f-406d-9b83-30ecbb9b4392"}, {"created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5", "modified": "2019-06-28T14:59:17.854Z", "type": "relationship", "created": "2019-04-17T14:45:59.674Z", "object_marking_refs": ["marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"], "id": "relationship--935681a5-d027-4c13-8565-54cd8505bf61", "external_references": [{"source_name": "FireEye FIN6 Apr 2019", "description": "McKeague, B. et al. (2019, April 5). Pick-Six: Intercepting a FIN6 Intrusion, an Actor Recently Tied to Ryuk and LockerGoga Ransomware. Retrieved April 17, 2019.", "url": "https://www.fireeye.com/blog/threat-research/2019/04/pick-six-intercepting-a-fin6-intrusion.html"}], "source_ref": "intrusion-set--2a7914cf-dff3-428d-ab0f-1014d1c28aeb", "relationship_type": "uses", "target_ref": "tool--aafea02e-ece5-4bb2-91a6-3bf8c7f38a39"}, {"created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5", "modified": "2019-04-25T11:39:52.290Z", "type": "relationship", "created": "2018-10-17T00:14:20.652Z", "object_marking_refs": ["marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"], "id": "relationship--95bbada2-6096-475e-b8c5-7b79351b03a0", "external_references": [{"source_name": "FireEye APT19", "description": "Ahl, I. (2017, June 06). Privileges and Credentials: Phished at the Request of Counsel. Retrieved May 17, 2018.", "url": "https://www.fireeye.com/blog/threat-research/2017/06/phished-at-the-request-of-counsel.html"}], "source_ref": "intrusion-set--fe8796a4-2a02-41a0-9d27-7aa1e995feb6", "relationship_type": "uses", "target_ref": "tool--aafea02e-ece5-4bb2-91a6-3bf8c7f38a39"}, {"created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5", "modified": "2019-04-22T19:23:13.514Z", "type": "relationship", "created": "2018-10-17T00:14:20.652Z", "object_marking_refs": ["marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"], "id": "relationship--12547d20-24ca-4145-98b3-dc0849f78ef1", "external_references": [{"source_name": "Unit 42 DarkHydrus July 2018", "description": "Falcone, R., et al. (2018, July 27). New Threat Actor Group DarkHydrus Targets Middle East Government. Retrieved August 2, 2018.", "url": "https://researchcenter.paloaltonetworks.com/2018/07/unit42-new-threat-actor-group-darkhydrus-targets-middle-east-government/"}, {"source_name": "Unit 42 Playbook Dec 2017", "description": "Unit 42. (2017, December 15). Unit 42 Playbook Viewer. Retrieved December 20, 2017.", "url": "https://pan-unit42.github.io/playbook_viewer/"}], "source_ref": "intrusion-set--6b9ebeb5-20bf-48b0-afb7-988d769a2f01", "relationship_type": "uses", "target_ref": "tool--aafea02e-ece5-4bb2-91a6-3bf8c7f38a39"}, {"created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5", "modified": "2019-07-24T14:08:16.448Z", "type": "relationship", "id": "relationship--3f5c880e-da8c-4ad4-9197-17a18f50dd12", "object_marking_refs": ["marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"], "created": "2018-04-18T17:59:24.739Z", "source_ref": "course-of-action--cb825b86-3f3b-4686-ba99-44878f5d3173", "relationship_type": "mitigates", "target_ref": "attack-pattern--c8e87b83-edbb-48d4-9295-4974897525b7"}, {"created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5", "description": "[Cobalt Strike](https://attack.mitre.org/software/S0154) can download a hosted \"beacon\" payload using [BITSAdmin](https://attack.mitre.org/software/S0190).", "type": "relationship", "created": "2018-04-18T17:59:24.739Z", "object_marking_refs": ["marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"], "id": "relationship--3c2ccc2c-813a-400f-b7ee-53f1ff120d3d", "external_references": [{"source_name": "CobaltStrike Scripted Web Delivery", "description": "Strategic Cyber, LLC. (n.d.). Scripted Web Delivery. Retrieved January 23, 2018.", "url": "https://www.cobaltstrike.com/help-scripted-web-delivery"}], "modified": "2019-06-06T19:04:39.502Z", "source_ref": "tool--aafea02e-ece5-4bb2-91a6-3bf8c7f38a39", "relationship_type": "uses", "target_ref": "attack-pattern--c8e87b83-edbb-48d4-9295-4974897525b7"}, {"created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5", "modified": "2019-04-25T12:24:57.562Z", "type": "relationship", "created": "2018-04-18T17:59:24.739Z", "object_marking_refs": ["marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"], "id": "relationship--29fc21b0-4946-4c75-a28e-f8dad46897af", "external_references": [{"source_name": "Proofpoint Leviathan Oct 2017", "description": "Axel F, Pierre T. (2017, October 16). Leviathan: Espionage actor spearphishes maritime and defense targets. Retrieved February 15, 2018.", "url": "https://www.proofpoint.com/us/threat-insight/post/leviathan-espionage-actor-spearphishes-maritime-and-defense-targets"}, {"source_name": "FireEye Periscope March 2018", "description": "FireEye. (2018, March 16). Suspected Chinese Cyber Espionage Group (TEMP.Periscope) Targeting U.S. Engineering and Maritime Industries. Retrieved April 11, 2018.", "url": "https://www.fireeye.com/blog/threat-research/2018/03/suspected-chinese-espionage-group-targeting-maritime-and-engineering-industries.html"}], "source_ref": "intrusion-set--7113eaa5-ba79-4fb3-b68a-398ee9cd698e", "relationship_type": "uses", "target_ref": "tool--aafea02e-ece5-4bb2-91a6-3bf8c7f38a39"}, {"created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5", "modified": "2019-05-03T16:42:19.239Z", "type": "relationship", "created": "2018-01-16T18:59:16.545Z", "object_marking_refs": ["marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"], "id": "relationship--6dbb3a1e-5fb4-4494-950c-570616302ece", "external_references": [{"source_name": "ClearSky Wilted Tulip July 2017", "description": "ClearSky Cyber Security and Trend Micro. (2017, July). Operation Wilted Tulip: Exposing a cyber espionage apparatus. Retrieved August 21, 2017.", "url": "http://www.clearskysec.com/wp-content/uploads/2017/07/Operation_Wilted_Tulip.pdf"}], "source_ref": "intrusion-set--dcd81c6e-ebf7-4a16-93e0-9a97fa49c88a", "relationship_type": "uses", "target_ref": "tool--aafea02e-ece5-4bb2-91a6-3bf8c7f38a39"}, {"created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5", "description": "[Cobalt Strike](https://attack.mitre.org/software/S0154) can set its \"beacon\" payload to reach out to the C2 server on an arbitrary and random interval. In addition it will break large data sets into smaller chunks for exfiltration.", "type": "relationship", "created": "2017-12-14T16:46:06.044Z", "object_marking_refs": ["marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"], "id": "relationship--033d168d-8348-47ad-af48-d297dc0d1dbb", "external_references": [{"source_name": "cobaltstrike manual", "description": "Strategic Cyber LLC. (2017, March 14). Cobalt Strike Manual. Retrieved May 24, 2017.", "url": "https://cobaltstrike.com/downloads/csmanual38.pdf"}], "modified": "2019-06-06T19:04:39.186Z", "source_ref": "tool--aafea02e-ece5-4bb2-91a6-3bf8c7f38a39", "relationship_type": "uses", "target_ref": "attack-pattern--4eeaf8a9-c86b-4954-a663-9555fb406466"}, {"created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5", "description": "[Cobalt Strike](https://attack.mitre.org/software/S0154) uses a custom command and control protocol that is encapsulated in HTTP, HTTPS, or DNS. In addition, it conducts peer-to-peer communication over Windows named pipes encapsulated in the SMB protocol. All protocols use their standard assigned ports.", "type": "relationship", "created": "2017-12-14T16:46:06.044Z", "object_marking_refs": ["marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"], "id": "relationship--5909e6e9-c620-4278-9bdc-113f09e5799b", "external_references": [{"source_name": "cobaltstrike manual", "description": "Strategic Cyber LLC. (2017, March 14). Cobalt Strike Manual. Retrieved May 24, 2017.", "url": "https://cobaltstrike.com/downloads/csmanual38.pdf"}], "modified": "2019-06-06T19:04:39.424Z", "source_ref": "tool--aafea02e-ece5-4bb2-91a6-3bf8c7f38a39", "relationship_type": "uses", "target_ref": "attack-pattern--355be19c-ffc9-46d5-8d50-d6a036c675b6"}, {"created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5", "description": "[Cobalt Strike](https://attack.mitre.org/software/S0154) can steal access tokens from exiting processes and make tokens from known credentials.", "type": "relationship", "created": "2017-12-14T16:46:06.044Z", "object_marking_refs": ["marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"], "id": "relationship--6863078f-fe93-4b84-ad7f-dffe494d9265", "external_references": [{"source_name": "cobaltstrike manual", "description": "Strategic Cyber LLC. (2017, March 14). Cobalt Strike Manual. Retrieved May 24, 2017.", "url": "https://cobaltstrike.com/downloads/csmanual38.pdf"}], "modified": "2019-06-06T19:04:39.472Z", "source_ref": "tool--aafea02e-ece5-4bb2-91a6-3bf8c7f38a39", "relationship_type": "uses", "target_ref": "attack-pattern--dcaa092b-7de9-4a21-977f-7fcb77e89c48"}, {"created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5", "description": "[Cobalt Strike](https://attack.mitre.org/software/S0154)'s \"beacon\" payload is capable of running shell commands without <code>cmd.exe</code> and PowerShell commands without <code>powershell.exe</code>", "type": "relationship", "created": "2017-12-14T16:46:06.044Z", "object_marking_refs": ["marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"], "id": "relationship--5b9fbec2-0e72-44ef-94a5-a9f702469c93", "external_references": [{"source_name": "cobaltstrike manual", "description": "Strategic Cyber LLC. (2017, March 14). Cobalt Strike Manual. Retrieved May 24, 2017.", "url": "https://cobaltstrike.com/downloads/csmanual38.pdf"}], "modified": "2019-06-06T19:04:39.209Z", "source_ref": "tool--aafea02e-ece5-4bb2-91a6-3bf8c7f38a39", "relationship_type": "uses", "target_ref": "attack-pattern--391d824f-0ef1-47a0-b0ee-c59a75e27670"}, {"created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5", "description": "[Cobalt Strike](https://attack.mitre.org/software/S0154) can inject a variety of payloads into processes dynamically chosen by the adversary.", "type": "relationship", "created": "2017-12-14T16:46:06.044Z", "object_marking_refs": ["marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"], "id": "relationship--aa243e70-fba4-4f8a-8b5e-1ac826eac593", "external_references": [{"source_name": "cobaltstrike manual", "description": "Strategic Cyber LLC. (2017, March 14). Cobalt Strike Manual. Retrieved May 24, 2017.", "url": "https://cobaltstrike.com/downloads/csmanual38.pdf"}], "modified": "2019-06-06T19:04:39.419Z", "source_ref": "tool--aafea02e-ece5-4bb2-91a6-3bf8c7f38a39", "relationship_type": "uses", "target_ref": "attack-pattern--43e7dc91-05b2-474c-b9ac-2ed4fe101f4d"}, {"created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5", "description": "[Cobalt Strike](https://attack.mitre.org/software/S0154) can execute a payload on a remote host with PowerShell. This technique does not write any data to disk.", "type": "relationship", "created": "2017-12-14T16:46:06.044Z", "object_marking_refs": ["marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"], "id": "relationship--1b51b49a-1f3a-4b5d-aea3-989e9ccb72ad", "external_references": [{"source_name": "cobaltstrike manual", "description": "Strategic Cyber LLC. (2017, March 14). Cobalt Strike Manual. Retrieved May 24, 2017.", "url": "https://cobaltstrike.com/downloads/csmanual38.pdf"}], "modified": "2019-06-06T19:04:39.286Z", "source_ref": "tool--aafea02e-ece5-4bb2-91a6-3bf8c7f38a39", "relationship_type": "uses", "target_ref": "attack-pattern--f4882e23-8aa7-4b12-b28a-b349c12ee9e0"}, {"created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5", "description": "[Cobalt Strike](https://attack.mitre.org/software/S0154) can use known credentials to run commands and spawn processes as another user.", "type": "relationship", "created": "2017-12-14T16:46:06.044Z", "object_marking_refs": ["marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"], "id": "relationship--26af1f3f-806e-45bd-860a-2eead8af7d3e", "external_references": [{"source_name": "cobaltstrike manual", "description": "Strategic Cyber LLC. (2017, March 14). Cobalt Strike Manual. Retrieved May 24, 2017.", "url": "https://cobaltstrike.com/downloads/csmanual38.pdf"}, {"source_name": "CobaltStrike Daddy May 2017", "description": "Mudge, R. (2017, May 23). Cobalt Strike 3.8 \u2013 Who\u2019s Your Daddy?. Retrieved June 4, 2019.", "url": "https://blog.cobaltstrike.com/2017/05/23/cobalt-strike-3-8-whos-your-daddy/"}], "modified": "2019-06-06T19:04:39.335Z", "source_ref": "tool--aafea02e-ece5-4bb2-91a6-3bf8c7f38a39", "relationship_type": "uses", "target_ref": "attack-pattern--b17a1a56-e99c-403c-8948-561df0cffe81"}, {"created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5", "description": "[Cobalt Strike](https://attack.mitre.org/software/S0154) can use <code>WinRM</code> to execute a payload on a remote host.", "type": "relationship", "created": "2017-12-14T16:46:06.044Z", "object_marking_refs": ["marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"], "id": "relationship--d328f1e2-c98f-473e-aea5-063e1ee70744", "external_references": [{"source_name": "cobaltstrike manual", "description": "Strategic Cyber LLC. (2017, March 14). Cobalt Strike Manual. Retrieved May 24, 2017.", "url": "https://cobaltstrike.com/downloads/csmanual38.pdf"}], "modified": "2019-06-06T19:04:39.340Z", "source_ref": "tool--aafea02e-ece5-4bb2-91a6-3bf8c7f38a39", "relationship_type": "uses", "target_ref": "attack-pattern--c3bce4f4-9795-46c6-976e-8676300bbc39"}, {"created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5", "description": "[Cobalt Strike](https://attack.mitre.org/software/S0154) will timestomp any files or payloads placed on a target machine to help them blend in.", "type": "relationship", "created": "2017-12-14T16:46:06.044Z", "object_marking_refs": ["marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"], "id": "relationship--e025dccd-ead3-44d8-af26-f2c3b27667f5", "external_references": [{"source_name": "cobaltstrike manual", "description": "Strategic Cyber LLC. (2017, March 14). Cobalt Strike Manual. Retrieved May 24, 2017.", "url": "https://cobaltstrike.com/downloads/csmanual38.pdf"}], "modified": "2019-06-06T19:04:39.232Z", "source_ref": "tool--aafea02e-ece5-4bb2-91a6-3bf8c7f38a39", "relationship_type": "uses", "target_ref": "attack-pattern--128c55d3-aeba-469f-bd3e-c8996ab4112a"}, {"created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5", "description": "[Cobalt Strike](https://attack.mitre.org/software/S0154) can use WMI to deliver a payload to a remote host.", "type": "relationship", "created": "2017-12-14T16:46:06.044Z", "object_marking_refs": ["marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"], "id": "relationship--b9e624b0-47d1-4463-970b-fbb6ddcd7171", "external_references": [{"source_name": "cobaltstrike manual", "description": "Strategic Cyber LLC. (2017, March 14). Cobalt Strike Manual. Retrieved May 24, 2017.", "url": "https://cobaltstrike.com/downloads/csmanual38.pdf"}], "modified": "2019-06-06T19:04:39.341Z", "source_ref": "tool--aafea02e-ece5-4bb2-91a6-3bf8c7f38a39", "relationship_type": "uses", "target_ref": "attack-pattern--01a5a209-b94c-450b-b7f9-946497d91055"}, {"created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5", "description": "[Cobalt Strike](https://attack.mitre.org/software/S0154) can be configured to have commands relayed over a peer-to-peer network of infected hosts. This can be used to limit the number of egress points, or provide access to a host without direct internet access.", "type": "relationship", "created": "2017-12-14T16:46:06.044Z", "object_marking_refs": ["marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"], "id": "relationship--d13aaa09-5465-4439-b100-444242601a98", "external_references": [{"source_name": "cobaltstrike manual", "description": "Strategic Cyber LLC. (2017, March 14). Cobalt Strike Manual. Retrieved May 24, 2017.", "url": "https://cobaltstrike.com/downloads/csmanual38.pdf"}], "modified": "2019-06-06T19:04:39.422Z", "source_ref": "tool--aafea02e-ece5-4bb2-91a6-3bf8c7f38a39", "relationship_type": "uses", "target_ref": "attack-pattern--731f4f55-b6d0-41d1-a7a9-072a66389aea"}, {"external_references": [{"url": "https://attack.mitre.org/techniques/T1197", "source_name": "mitre-attack", "external_id": "T1197"}, {"url": "https://technet.microsoft.com/library/dd939934.aspx", "source_name": "Microsoft Issues with BITS July 2011", "description": "Microsoft. (2011, July 19). Issues with BITS. Retrieved January 12, 2018."}, {"url": "https://msdn.microsoft.com/library/windows/desktop/bb968799.aspx", "source_name": "Microsoft BITS", "description": "Microsoft. (n.d.). Background Intelligent Transfer Service. Retrieved January 12, 2018."}, {"url": "https://msdn.microsoft.com/library/aa362813.aspx", "source_name": "Microsoft BITSAdmin", "description": "Microsoft. (n.d.). BITSAdmin Tool. Retrieved January 12, 2018."}, {"url": "https://www.secureworks.com/blog/malware-lingers-with-bits", "source_name": "CTU BITS Malware June 2016", "description": "Counter Threat Unit Research Team. (2016, June 6). Malware Lingers with BITS. Retrieved January 12, 2018."}, {"url": "https://arstechnica.com/information-technology/2007/05/malware-piggybacks-on-windows-background-intelligent-transfer-service/", "source_name": "Mondok Windows PiggyBack BITS May 2007", "description": "Mondok, M. (2007, May 11). Malware piggybacks on Windows\u2019 Background Intelligent Transfer Service. Retrieved January 12, 2018."}, {"url": "https://www.symantec.com/connect/blogs/malware-update-windows-update", "source_name": "Symantec BITS May 2007", "description": "Florio, E. (2007, May 9). Malware Update with Windows Update. Retrieved January 12, 2018."}, {"url": "https://msdn.microsoft.com/library/windows/desktop/ms680573.aspx", "source_name": "Microsoft COM", "description": "Microsoft. (n.d.). Component Object Model (COM). Retrieved November 22, 2017."}, {"url": "https://researchcenter.paloaltonetworks.com/2017/11/unit42-uboatrat-navigates-east-asia/", "source_name": "PaloAlto UBoatRAT Nov 2017", "description": "Hayashi, K. (2017, November 28). UBoatRAT Navigates East Asia. Retrieved January 12, 2018."}], "object_marking_refs": ["marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"], "modified": "2018-12-13T20:07:42.839Z", "created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5", "kill_chain_phases": [{"phase_name": "defense-evasion", "kill_chain_name": "mitre-attack"}, {"phase_name": "persistence", "kill_chain_name": "mitre-attack"}], "id": "attack-pattern--c8e87b83-edbb-48d4-9295-4974897525b7", "name": "BITS Jobs", "created": "2018-04-18T17:59:24.739Z", "type": "attack-pattern", "description": "Windows Background Intelligent Transfer Service (BITS) is a low-bandwidth, asynchronous file transfer mechanism exposed through Component Object Model (COM). (Citation: Microsoft COM) (Citation: Microsoft BITS) BITS is commonly used by updaters, messengers, and other applications preferred to operate in the background (using available idle bandwidth) without interrupting other networked applications. File transfer tasks are implemented as BITS jobs, which contain a queue of one or more file operations.\n\nThe interface to create and manage BITS jobs is accessible through [PowerShell](https://attack.mitre.org/techniques/T1086)  (Citation: Microsoft BITS) and the [BITSAdmin](https://attack.mitre.org/software/S0190) tool. (Citation: Microsoft BITSAdmin)\n\nAdversaries may abuse BITS to download, execute, and even clean up after running malicious code. BITS tasks are self-contained in the BITS job database, without new files or registry modifications, and often permitted by host firewalls. (Citation: CTU BITS Malware June 2016) (Citation: Mondok Windows PiggyBack BITS May 2007) (Citation: Symantec BITS May 2007) BITS enabled execution may also allow Persistence by creating long-standing jobs (the default maximum lifetime is 90 days and extendable) or invoking an arbitrary program when a job completes or errors (including after system reboots). (Citation: PaloAlto UBoatRAT Nov 2017) (Citation: CTU BITS Malware June 2016)\n\nBITS upload functionalities can also be used to perform [Exfiltration Over Alternative Protocol](https://attack.mitre.org/techniques/T1048). (Citation: CTU BITS Malware June 2016)", "x_mitre_contributors": ["Ricardo Dias", "Red Canary"], "x_mitre_data_sources": ["API monitoring", "Packet capture", "Windows event logs"], "x_mitre_detection": "BITS runs as a service and its status can be checked with the Sc query utility (<code>sc query bits</code>). (Citation: Microsoft Issues with BITS July 2011) Active BITS tasks can be enumerated using the [BITSAdmin](https://attack.mitre.org/software/S0190) tool (<code>bitsadmin /list /allusers /verbose</code>). (Citation: Microsoft BITS)\n\nMonitor usage of the [BITSAdmin](https://attack.mitre.org/software/S0190) tool (especially the \u2018Transfer\u2019, 'Create', 'AddFile', 'SetNotifyFlags', 'SetNotifyCmdLine', 'SetMinRetryDelay', 'SetCustomHeaders', and 'Resume' command options)  (Citation: Microsoft BITS)Admin and the Windows Event log for BITS activity. Also consider investigating more detailed information about jobs by parsing the BITS job database. (Citation: CTU BITS Malware June 2016)\n\nMonitor and analyze network activity generated by BITS. BITS jobs use HTTP(S) and SMB for remote connections and are tethered to the creating user and will only function when that user is logged on (this rule applies even if a user attaches the job to a service account). (Citation: Microsoft BITS)", "x_mitre_platforms": ["Windows"], "x_mitre_defense_bypassed": ["Firewall", "Host forensic analysis"], "x_mitre_version": "1.0", "x_mitre_permissions_required": ["User", "Administrator", "SYSTEM"]}, {"external_references": [{"url": "https://attack.mitre.org/techniques/T1175", "source_name": "mitre-attack", "external_id": "T1175"}, {"url": "https://enigma0x3.net/2017/11/16/lateral-movement-using-outlooks-createobject-method-and-dotnettojscript/", "source_name": "Enigma Outlook DCOM Lateral Movement Nov 2017", "description": "Nelson, M. (2017, November 16). Lateral Movement using Outlook's CreateObject Method and DotNetToJScript. Retrieved November 21, 2017."}, {"url": "https://enigma0x3.net/2017/01/05/lateral-movement-using-the-mmc20-application-com-object/", "source_name": "Enigma MMC20 COM Jan 2017", "description": "Nelson, M. (2017, January 5). Lateral Movement using the MMC20 Application COM Object. Retrieved November 21, 2017."}, {"url": "https://enigma0x3.net/2017/01/23/lateral-movement-via-dcom-round-2/", "source_name": "Enigma DCOM Lateral Movement Jan 2017", "description": "Nelson, M. (2017, January 23). Lateral Movement via DCOM: Round 2. Retrieved November 21, 2017."}, {"url": "https://enigma0x3.net/2017/09/11/lateral-movement-using-excel-application-and-dcom/", "source_name": "Enigma Excel DCOM Sept 2017", "description": "Nelson, M. (2017, September 11). Lateral Movement using Excel.Application and DCOM. Retrieved November 21, 2017."}, {"url": "https://www.cybereason.com/blog/leveraging-excel-dde-for-lateral-movement-via-dcom", "source_name": "Cyberreason DCOM DDE Lateral Movement Nov 2017", "description": "Tsukerman, P. (2017, November 8). Leveraging Excel DDE for lateral movement via DCOM. Retrieved November 21, 2017."}, {"url": "https://msdn.microsoft.com/en-us/library/windows/desktop/ms687317(v=vs.85).aspx", "source_name": "Microsoft Process Wide Com Keys", "description": "Microsoft. (n.d.). Setting Process-Wide Security Through the Registry. Retrieved November 21, 2017."}, {"url": "https://msdn.microsoft.com/en-us/library/windows/desktop/ms694331(v=vs.85).aspx", "source_name": "Microsoft System Wide Com Keys", "description": "Microsoft. (n.d.). Registry Values for System-Wide Security. Retrieved November 21, 2017."}, {"url": "https://msdn.microsoft.com/library/windows/desktop/ms680573.aspx", "source_name": "Microsoft COM", "description": "Microsoft. (n.d.). Component Object Model (COM). Retrieved November 22, 2017."}, {"url": "https://docs.microsoft.com/en-us/windows/desktop/com/dcom-security-enhancements-in-windows-xp-service-pack-2-and-windows-server-2003-service-pack-1", "source_name": "Microsoft COM ACL", "description": "Microsoft. (n.d.). DCOM Security Enhancements in Windows XP Service Pack 2 and Windows Server 2003 Service Pack 1. Retrieved November 22, 2017."}, {"url": "https://googleprojectzero.blogspot.com/2018/04/windows-exploitation-tricks-exploiting.html", "source_name": "ProjectZero File Write EoP Apr 2018", "description": "Forshaw, J. (2018, April 18). Windows Exploitation Tricks: Exploiting Arbitrary File Writes for Local Elevation of Privilege. Retrieved May 3, 2018."}], "object_marking_refs": ["marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"], "modified": "2018-10-17T00:14:20.652Z", "created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5", "kill_chain_phases": [{"phase_name": "lateral-movement", "kill_chain_name": "mitre-attack"}], "id": "attack-pattern--772bc7a8-a157-42cc-8728-d648e25c7fe7", "name": "Distributed Component Object Model", "created": "2018-01-16T16:13:52.465Z", "type": "attack-pattern", "description": "Windows Distributed Component Object Model (DCOM) is transparent middleware that extends the functionality of Component Object Model (COM) (Citation: Microsoft COM) beyond a local computer using remote procedure call (RPC) technology. COM is a component of the Windows application programming interface (API) that enables interaction between software objects. Through COM, a client object can call methods of server objects, which are typically Dynamic Link Libraries (DLL) or executables (EXE).\n\nPermissions to interact with local and remote server COM objects are specified by access control lists (ACL) in the Registry. (Citation: Microsoft COM ACL) (Citation: Microsoft Process Wide Com Keys) (Citation: Microsoft System Wide Com Keys) By default, only Administrators may remotely activate and launch COM objects through DCOM.\n\nAdversaries may use DCOM for lateral movement. Through DCOM, adversaries operating in the context of an appropriately privileged user can remotely obtain arbitrary and even direct shellcode execution through Office applications (Citation: Enigma Outlook DCOM Lateral Movement Nov 2017) as well as other Windows objects that contain insecure methods. (Citation: Enigma MMC20 COM Jan 2017) (Citation: Enigma DCOM Lateral Movement Jan 2017) DCOM can also execute macros in existing documents (Citation: Enigma Excel DCOM Sept 2017) and may also invoke [Dynamic Data Exchange](https://attack.mitre.org/techniques/T1173) (DDE) execution directly through a COM created instance of a Microsoft Office application (Citation: Cyberreason DCOM DDE Lateral Movement Nov 2017), bypassing the need for a malicious document.\n\nDCOM may also expose functionalities that can be leveraged during other areas of the adversary chain of activity such as Privilege Escalation and Persistence. (Citation: ProjectZero File Write EoP Apr 2018)", "x_mitre_data_sources": ["API monitoring", "Authentication logs", "DLL monitoring", "Packet capture", "Process monitoring", "Windows Registry", "Windows event logs"], "x_mitre_detection": "Monitor for COM objects loading DLLs and other modules not typically associated with the application. (Citation: Enigma Outlook DCOM Lateral Movement Nov 2017)\n\nMonitor for spawning of processes associated with COM objects, especially those invoked by a user different than the one currently logged on.\n\nMonitor for influx of Distributed Computing Environment/Remote Procedure Call (DCE/RPC) traffic.", "x_mitre_platforms": ["Windows"], "x_mitre_version": "1.0", "x_mitre_permissions_required": ["Administrator", "SYSTEM"]}, {"external_references": [{"url": "https://attack.mitre.org/techniques/T1113", "source_name": "mitre-attack", "external_id": "T1113"}, {"url": "https://blog.malwarebytes.com/threat-analysis/2017/01/new-mac-backdoor-using-antiquated-code/", "source_name": "Antiquated Mac Malware", "description": "Thomas Reed. (2017, January 18). New Mac backdoor using antiquated code. Retrieved July 5, 2017."}], "object_marking_refs": ["marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"], "modified": "2018-10-17T00:14:20.652Z", "created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5", "kill_chain_phases": [{"phase_name": "collection", "kill_chain_name": "mitre-attack"}], "id": "attack-pattern--0259baeb-9f63-4c69-bf10-eb038c390688", "name": "Screen Capture", "created": "2017-05-31T21:31:25.060Z", "type": "attack-pattern", "description": "Adversaries may attempt to take screen captures of the desktop to gather information over the course of an operation. Screen capturing functionality may be included as a feature of a remote access tool used in post-compromise operations.\n\n### Mac\n\nOn OSX, the native command <code>screencapture</code> is used to capture screenshots.\n\n### Linux\n\nOn Linux, there is the native command <code>xwd</code>. (Citation: Antiquated Mac Malware)", "x_mitre_data_sources": ["API monitoring", "Process monitoring", "File monitoring"], "x_mitre_detection": "Monitoring for screen capture behavior will depend on the method used to obtain data from the operating system and write output files. Detection methods could include collecting information from unusual processes using API calls used to obtain image data, and monitoring for image files written to disk. The sensor data may need to be correlated with other events to identify malicious activity, depending on the legitimacy of this behavior within a given network environment.", "x_mitre_platforms": ["Linux", "macOS", "Windows"], "x_mitre_version": "1.0"}, {"external_references": [{"url": "https://attack.mitre.org/techniques/T1106", "source_name": "mitre-attack", "external_id": "T1106"}, {"url": "http://msdn.microsoft.com/en-us/library/ms682425", "source_name": "Microsoft CreateProcess", "description": "Microsoft. (n.d.). CreateProcess function. Retrieved December 5, 2014."}, {"url": "https://skanthak.homepage.t-online.de/verifier.html", "source_name": "Kanthak Verifier", "description": "Kanthak, S. (2017). Application Verifier Provider. Retrieved February 13, 2017."}], "object_marking_refs": ["marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"], "modified": "2018-10-17T00:14:20.652Z", "created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5", "kill_chain_phases": [{"phase_name": "execution", "kill_chain_name": "mitre-attack"}], "id": "attack-pattern--391d824f-0ef1-47a0-b0ee-c59a75e27670", "name": "Execution through API", "created": "2017-05-31T21:31:17.472Z", "type": "attack-pattern", "description": "Adversary tools may directly use the Windows application programming interface (API) to execute binaries. Functions such as the Windows API CreateProcess will allow programs and scripts to start other processes with proper path and argument parameters. (Citation: Microsoft CreateProcess)\n\nAdditional Windows API calls that can be used to execute binaries include: (Citation: Kanthak Verifier)\n\n* CreateProcessA() and CreateProcessW(),\n* CreateProcessAsUserA() and CreateProcessAsUserW(),\n* CreateProcessInternalA() and CreateProcessInternalW(),\n* CreateProcessWithLogonW(), CreateProcessWithTokenW(),\n* LoadLibraryA() and LoadLibraryW(),\n* LoadLibraryExA() and LoadLibraryExW(),\n* LoadModule(),\n* LoadPackagedLibrary(),\n* WinExec(),\n* ShellExecuteA() and ShellExecuteW(),\n* ShellExecuteExA() and ShellExecuteExW()", "x_mitre_data_sources": ["API monitoring", "Process monitoring"], "x_mitre_contributors": ["Stefan Kanthak"], "x_mitre_detection": "Monitoring API calls may generate a significant amount of data and may not be directly useful for defense unless collected under specific circumstances, since benign use of Windows API functions such as CreateProcess are common and difficult to distinguish from malicious behavior. Correlation of other events with behavior surrounding API function calls using API monitoring will provide additional context to an event that may assist in determining if it is due to malicious behavior. Correlation of activity by process lineage by process ID may be sufficient.", "x_mitre_platforms": ["Windows"], "x_mitre_version": "1.0", "x_mitre_remote_support": false, "x_mitre_permissions_required": ["User", "Administrator", "SYSTEM"]}, {"external_references": [{"url": "https://attack.mitre.org/techniques/T1134", "source_name": "mitre-attack", "external_id": "T1134"}, {"url": "https://technet.microsoft.com/en-us/library/bb490994.aspx", "source_name": "Microsoft runas", "description": "Microsoft TechNet. (n.d.). Runas. Retrieved April 21, 2017."}, {"url": "https://www.offensive-security.com/metasploit-unleashed/fun-incognito/", "source_name": "Metasploit access token", "description": "Offensive Security. (n.d.). What is Incognito. Retrieved April 21, 2017."}, {"url": "https://msdn.microsoft.com/en-us/library/windows/desktop/aa378184(v=vs.85).aspx", "source_name": "Microsoft LogonUser", "description": "Microsoft TechNet. (n.d.). Retrieved April 25, 2017."}, {"url": "https://msdn.microsoft.com/en-us/library/windows/desktop/aa446617(v=vs.85).aspx", "source_name": "Microsoft DuplicateTokenEx", "description": "Microsoft TechNet. (n.d.). Retrieved April 25, 2017."}, {"url": "https://msdn.microsoft.com/en-us/library/windows/desktop/aa378612(v=vs.85).aspx", "source_name": "Microsoft ImpersonateLoggedOnUser", "description": "Microsoft TechNet. (n.d.). Retrieved April 25, 2017."}, {"url": "https://pentestlab.blog/2017/04/03/token-manipulation/", "source_name": "Pentestlab Token Manipulation", "description": "netbiosX. (2017, April 3). Token Manipulation. Retrieved April 21, 2017."}, {"url": "https://blog.cobaltstrike.com/2015/12/16/windows-access-tokens-and-alternate-credentials/", "source_name": "Cobalt Strike Access Token", "description": "Mudge, R. (n.d.). Windows Access Tokens and Alternate Credentials. Retrieved April 21, 2017."}, {"url": "https://technet.microsoft.com/en-us/windows-server-docs/identity/ad-ds/manage/component-updates/command-line-process-auditing", "source_name": "Microsoft Command-line Logging", "description": "Mathers, B. (2017, March 7). Command line process auditing. Retrieved April 21, 2017."}, {"url": "https://www.blackhat.com/docs/eu-17/materials/eu-17-Atkinson-A-Process-Is-No-One-Hunting-For-Token-Manipulation.pdf", "source_name": "BlackHat Atkinson Winchester Token Manipulation", "description": "Atkinson, J., Winchester, R. (2017, December 7). A Process is No One: Hunting for Token Manipulation. Retrieved December 21, 2017."}], "object_marking_refs": ["marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"], "modified": "2018-10-31T13:45:13.024Z", "created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5", "kill_chain_phases": [{"phase_name": "defense-evasion", "kill_chain_name": "mitre-attack"}, {"phase_name": "privilege-escalation", "kill_chain_name": "mitre-attack"}], "id": "attack-pattern--dcaa092b-7de9-4a21-977f-7fcb77e89c48", "name": "Access Token Manipulation", "created": "2017-12-14T16:46:06.044Z", "type": "attack-pattern", "description": "Windows uses access tokens to determine the ownership of a running process. A user can manipulate access tokens to make a running process appear as though it belongs to someone other than the user that started the process. When this occurs, the process also takes on the security context associated with the new token. For example, Microsoft promotes the use of access tokens as a security best practice. Administrators should log in as a standard user but run their tools with administrator privileges using the built-in access token manipulation command <code>runas</code>. (Citation: Microsoft runas)\n  \nAdversaries may use access tokens to operate under a different user or system security context to perform actions and evade detection. An adversary can use built-in Windows API functions to copy access tokens from existing processes; this is known as token stealing. An adversary must already be in a privileged user context (i.e. administrator) to steal a token. However, adversaries commonly use token stealing to elevate their security context from the administrator level to the SYSTEM level. An adversary can use a token to authenticate to a remote system as the account for that token if the account has appropriate permissions on the remote system. (Citation: Pentestlab Token Manipulation)\n\nAccess tokens can be leveraged by adversaries through three methods: (Citation: BlackHat Atkinson Winchester Token Manipulation)\n\n**Token Impersonation/Theft** - An adversary creates a new access token that duplicates an existing token using <code>DuplicateToken(Ex)</code>. The token can then be used with <code>ImpersonateLoggedOnUser</code> to allow the calling thread to impersonate a logged on user's security context, or with <code>SetThreadToken</code> to assign the impersonated token to a thread. This is useful for when the target user has a non-network logon session on the system.\n\n**Create Process with a Token** - An adversary creates a new access token with <code>DuplicateToken(Ex)</code> and uses it with <code>CreateProcessWithTokenW</code> to create a new process running under the security context of the impersonated user. This is useful for creating a new process under the security context of a different user.\n\n**Make and Impersonate Token** - An adversary has a username and password but the user is not logged onto the system. The adversary can then create a logon session for the user using the <code>LogonUser</code> function. The function will return a copy of the new session's access token and the adversary can use <code>SetThreadToken</code> to assign the token to a thread.\n\nAny standard user can use the <code>runas</code> command, and the Windows API functions, to create impersonation tokens; it does not require access to an administrator account.\n\nMetasploit\u2019s Meterpreter payload allows arbitrary token manipulation and uses token impersonation to escalate privileges. (Citation: Metasploit access token)  The Cobalt Strike beacon payload allows arbitrary token impersonation and can also create tokens. (Citation: Cobalt Strike Access Token)", "x_mitre_contributors": ["Tom Ueltschi @c_APT_ure", "Travis Smith, Tripwire", "Robby Winchester, @robwinchester3", "Jared Atkinson, @jaredcatkinson"], "x_mitre_permissions_required": ["User", "Administrator"], "x_mitre_data_sources": ["API monitoring", "Access tokens", "Process monitoring", "Process command-line parameters"], "x_mitre_detection": "If an adversary is using a standard command-line shell, analysts can detect token manipulation by auditing command-line activity. Specifically, analysts should look for use of the <code>runas</code> command. Detailed command-line logging is not enabled by default in Windows. (Citation: Microsoft Command-line Logging)\n\nIf an adversary is using a payload that calls the Windows token APIs directly, analysts can detect token manipulation only through careful analysis of user network activity, examination of running processes, and correlation with other endpoint and network behavior. \n\nThere are many Windows API calls a payload can take advantage of to manipulate access tokens (e.g., <code>LogonUser</code> (Citation: Microsoft LogonUser), <code>DuplicateTokenEx</code> (Citation: Microsoft DuplicateTokenEx), and <code>ImpersonateLoggedOnUser</code> (Citation: Microsoft ImpersonateLoggedOnUser)). Please see the referenced Windows API pages for more information.\n\nQuery systems for process and thread token information and look for inconsistencies such as user owns processes impersonating the local SYSTEM account. (Citation: BlackHat Atkinson Winchester Token Manipulation)", "x_mitre_platforms": ["Windows"], "x_mitre_version": "1.0", "x_mitre_effective_permissions": ["SYSTEM"]}, {"external_references": [{"url": "https://attack.mitre.org/techniques/T1185", "source_name": "mitre-attack", "external_id": "T1185"}, {"url": "https://cobaltstrike.com/downloads/csmanual38.pdf", "source_name": "cobaltstrike manual", "description": "Strategic Cyber LLC. (2017, March 14). Cobalt Strike Manual. Retrieved May 24, 2017."}, {"url": "https://en.wikipedia.org/wiki/Man-in-the-browser", "source_name": "Wikipedia Man in the Browser", "description": "Wikipedia. (2017, October 28). Man-in-the-browser. Retrieved January 10, 2018."}, {"url": "https://www.cobaltstrike.com/help-browser-pivoting", "source_name": "Cobalt Strike Browser Pivot", "description": "Mudge, R. (n.d.). Browser Pivoting. Retrieved January 10, 2018."}, {"url": "https://www.icebrg.io/blog/malicious-chrome-extensions-enable-criminals-to-impact-over-half-a-million-users-and-global-businesses", "source_name": "ICEBRG Chrome Extensions", "description": "De Tore, M., Warner, J. (2018, January 15). MALICIOUS CHROME EXTENSIONS ENABLE CRIMINALS TO IMPACT OVER HALF A MILLION USERS AND GLOBAL BUSINESSES. Retrieved January 17, 2018."}], "object_marking_refs": ["marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"], "modified": "2018-10-31T13:45:13.024Z", "created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5", "kill_chain_phases": [{"phase_name": "collection", "kill_chain_name": "mitre-attack"}], "id": "attack-pattern--544b0346-29ad-41e1-a808-501bb4193f47", "name": "Man in the Browser", "created": "2018-01-16T16:13:52.465Z", "type": "attack-pattern", "description": "Adversaries can take advantage of security vulnerabilities and inherent functionality in browser software to change content, modify behavior, and intercept information as part of various man in the browser techniques. (Citation: Wikipedia Man in the Browser)\n\nA specific example is when an adversary injects software into a browser that allows an them to inherit cookies, HTTP sessions, and SSL client certificates of a user and use the browser as a way to pivot into an authenticated intranet. (Citation: Cobalt Strike Browser Pivot) (Citation: ICEBRG Chrome Extensions)\n\nBrowser pivoting requires the SeDebugPrivilege and a high-integrity process to execute. Browser traffic is pivoted from the adversary's browser through the user's browser by setting up an HTTP proxy which will redirect any HTTP and HTTPS traffic. This does not alter the user's traffic in any way. The proxy connection is severed as soon as the browser is closed. Whichever browser process the proxy is injected into, the adversary assumes the security context of that process. Browsers typically create a new process for each tab that is opened and permissions and certificates are separated accordingly. With these permissions, an adversary could browse to any resource on an intranet that is accessible through the browser and which the browser has sufficient permissions, such as Sharepoint or webmail. Browser pivoting also eliminates the security provided by 2-factor authentication. (Citation: cobaltstrike manual)", "x_mitre_contributors": ["Justin Warner, ICEBRG"], "x_mitre_data_sources": ["Authentication logs", "Packet capture", "Process monitoring", "API monitoring"], "x_mitre_detection": "This is a difficult technique to detect because adversary traffic would be masked by normal user traffic. No new processes are created and no additional software touches disk. Authentication logs can be used to audit logins to specific web applications, but determining malicious logins versus benign logins may be difficult if activity matches typical user behavior. Monitor for process injection against browser applications", "x_mitre_platforms": ["Windows"], "x_mitre_version": "1.0", "x_mitre_permissions_required": ["Administrator", "SYSTEM"]}, {"external_references": [{"url": "https://attack.mitre.org/techniques/T1135", "source_name": "mitre-attack", "external_id": "T1135"}, {"url": "https://en.wikipedia.org/wiki/Shared_resource", "source_name": "Wikipedia Shared Resource", "description": "Wikipedia. (2017, April 15). Shared resource. Retrieved June 30, 2017."}, {"url": "https://technet.microsoft.com/library/cc770880.aspx", "source_name": "TechNet Shared Folder", "description": "Microsoft. (n.d.). Share a Folder or Drive. Retrieved June 30, 2017."}], "object_marking_refs": ["marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"], "modified": "2018-10-31T13:45:13.024Z", "created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5", "kill_chain_phases": [{"phase_name": "discovery", "kill_chain_name": "mitre-attack"}], "id": "attack-pattern--3489cfc5-640f-4bb3-a103-9137b97de79f", "name": "Network Share Discovery", "created": "2017-12-14T16:46:06.044Z", "type": "attack-pattern", "description": "Networks often contain shared network drives and folders that enable users to access file directories on various systems across a network. \n\n### Windows\n\nFile sharing over a Windows network occurs over the SMB protocol. (Citation: Wikipedia Shared Resource) (Citation: TechNet Shared Folder)\n\n[Net](https://attack.mitre.org/software/S0039) can be used to query a remote system for available shared drives using the <code>net view \\\\remotesystem</code> command. It can also be used to query shared drives on the local system using <code>net share</code>.\n\nAdversaries may look for folders and drives shared on remote systems as a means of identifying sources of information to gather as a precursor for Collection and to identify potential systems of interest for Lateral Movement.\n\n### Mac\n\nOn Mac, locally mounted shares can be viewed with the <code>df -aH</code> command.", "x_mitre_data_sources": ["Process monitoring", "Process command-line parameters", "Network protocol analysis", "Process use of network"], "x_mitre_detection": "System and network discovery techniques normally occur throughout an operation as an adversary learns the environment. Data and events should not be viewed in isolation, but as part of a chain of behavior that could lead to other activities, such as Lateral Movement, based on the information obtained.\n\nNormal, benign system and network events related to legitimate remote system discovery may be uncommon, depending on the environment and how they are used. Monitor processes and command-line arguments for actions that could be taken to gather system and network information. Remote access tools with built-in features may interact directly with the Windows API to gather information. Information may also be acquired through Windows system management tools such as [Windows Management Instrumentation](https://attack.mitre.org/techniques/T1047) and [PowerShell](https://attack.mitre.org/techniques/T1086).", "x_mitre_platforms": ["macOS", "Windows"], "x_mitre_version": "1.0", "x_mitre_permissions_required": ["User"]}, {"external_references": [{"url": "https://attack.mitre.org/techniques/T1099", "source_name": "mitre-attack", "external_id": "T1099"}, {"url": "http://windowsir.blogspot.com/2013/07/howto-determinedetect-use-of-anti.html", "source_name": "WindowsIR Anti-Forensic Techniques", "description": "Carvey, H. (2013, July 23). HowTo: Determine/Detect the use of Anti-Forensics Techniques. Retrieved June 3, 2016."}], "object_marking_refs": ["marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"], "modified": "2018-10-17T00:14:20.652Z", "created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5", "kill_chain_phases": [{"phase_name": "defense-evasion", "kill_chain_name": "mitre-attack"}], "id": "attack-pattern--128c55d3-aeba-469f-bd3e-c8996ab4112a", "name": "Timestomp", "created": "2017-05-31T21:31:12.675Z", "type": "attack-pattern", "description": "Timestomping is a technique that modifies the timestamps of a file (the modify, access, create, and change times), often to mimic files that are in the same folder. This is done, for example, on files that have been modified or created by the adversary so that they do not appear conspicuous to forensic investigators or file analysis tools. Timestomping may be used along with file name [Masquerading](https://attack.mitre.org/techniques/T1036) to hide malware and tools. (Citation: WindowsIR Anti-Forensic Techniques)", "x_mitre_data_sources": ["File monitoring", "Process monitoring", "Process command-line parameters"], "x_mitre_permissions_required": ["User", "Administrator", "SYSTEM"], "x_mitre_detection": "Forensic techniques exist to detect aspects of files that have had their timestamps modified. (Citation: WindowsIR Anti-Forensic Techniques) It may be possible to detect timestomping using file modification monitoring that collects information on file handle opens and can compare timestamp values.", "x_mitre_platforms": ["Linux", "Windows"], "x_mitre_version": "1.0", "x_mitre_defense_bypassed": ["Host forensic analysis"]}, {"external_references": [{"url": "https://attack.mitre.org/techniques/T1094", "source_name": "mitre-attack", "external_id": "T1094"}, {"url": "https://arxiv.org/ftp/arxiv/papers/1408/1408.1136.pdf", "source_name": "University of Birmingham C2", "description": "Gardiner, J.,  Cova, M., Nagaraja, S. (2014, February). Command & Control Understanding, Denying and Detecting. Retrieved April 20, 2016."}], "object_marking_refs": ["marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"], "modified": "2018-10-17T00:14:20.652Z", "created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5", "kill_chain_phases": [{"phase_name": "command-and-control", "kill_chain_name": "mitre-attack"}], "id": "attack-pattern--f72eb8a8-cd4c-461d-a814-3f862befbf00", "name": "Custom Command and Control Protocol", "created": "2017-05-31T21:31:10.314Z", "type": "attack-pattern", "description": "Adversaries may communicate using a custom command and control protocol instead of encapsulating commands/data in an existing [Standard Application Layer Protocol](https://attack.mitre.org/techniques/T1071). Implementations include mimicking well-known protocols or developing custom protocols (including raw sockets) on top of fundamental protocols provided by TCP/IP/another standard network stack.", "x_mitre_detection": "Analyze network traffic for ICMP messages or other protocols that contain abnormal data or are not normally seen within or exiting the network.\n\nAnalyze network data for uncommon data flows (e.g., a client sending significantly more data than it receives from a server). Processes utilizing the network that do not normally have network communication or have never been seen before are suspicious. Analyze packet contents to detect communications that do not follow the expected protocol behavior for the port that is being used. (Citation: University of Birmingham C2)\n\nMonitor and investigate API calls to functions associated with enabling and/or utilizing alternative communication channels.", "x_mitre_contributors": ["Ryan Becwar"], "x_mitre_data_sources": ["Packet capture", "Netflow/Enclave netflow", "Process use of network", "Process monitoring", "Host network interface", "Network intrusion detection system", "Network protocol analysis"], "x_mitre_network_requirements": true, "x_mitre_platforms": ["Linux", "macOS", "Windows"], "x_mitre_version": "1.0"}, {"external_references": [{"url": "https://attack.mitre.org/techniques/T1093", "source_name": "mitre-attack", "external_id": "T1093"}, {"url": "http://www.autosectools.com/process-hollowing.pdf", "source_name": "Leitch Hollowing", "description": "Leitch, J. (n.d.). Process Hollowing. Retrieved November 12, 2014."}, {"url": "https://www.endgame.com/blog/technical-blog/ten-process-injection-techniques-technical-survey-common-and-trending-process", "source_name": "Endgame Process Injection July 2017", "description": "Hosseini, A. (2017, July 18). Ten Process Injection Techniques: A Technical Survey Of Common And Trending Process Injection Techniques. Retrieved December 7, 2017."}], "object_marking_refs": ["marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"], "modified": "2018-10-17T00:14:20.652Z", "created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5", "kill_chain_phases": [{"phase_name": "defense-evasion", "kill_chain_name": "mitre-attack"}], "id": "attack-pattern--1c338d0f-a65e-4073-a5c1-c06878849f21", "name": "Process Hollowing", "created": "2017-05-31T21:31:09.815Z", "type": "attack-pattern", "description": "Process hollowing occurs when a process is created in a suspended state then its memory is unmapped and replaced with malicious code. Similar to [Process Injection](https://attack.mitre.org/techniques/T1055), execution of the malicious code is masked under a legitimate process and may evade defenses and detection analysis. (Citation: Leitch Hollowing) (Citation: Endgame Process Injection July 2017)", "x_mitre_permissions_required": ["User"], "x_mitre_data_sources": ["Process monitoring", "API monitoring"], "x_mitre_detection": "Monitoring API calls may generate a significant amount of data and may not be directly useful for defense unless collected under specific circumstances for known bad sequences of calls, since benign use of API functions may be common and difficult to distinguish from malicious behavior. API calls that unmap process memory, such as ZwUnmapViewOfSection or NtUnmapViewOfSection, and those that can be used to modify memory within another process, such as WriteProcessMemory, may be used for this technique. (Citation: Endgame Process Injection July 2017)\n\nAnalyze process behavior to determine if a process is performing actions it usually does not, such as opening network connections, reading files, or other suspicious actions that could relate to post-compromise behavior.", "x_mitre_platforms": ["Windows"], "x_mitre_version": "1.0", "x_mitre_defense_bypassed": ["Process whitelisting", "Whitelisting by file name or path", "Signature-based detection", "Anti-virus"]}, {"external_references": [{"url": "https://attack.mitre.org/techniques/T1090", "source_name": "mitre-attack", "external_id": "T1090"}, {"url": "https://arxiv.org/ftp/arxiv/papers/1408/1408.1136.pdf", "source_name": "University of Birmingham C2", "description": "Gardiner, J.,  Cova, M., Nagaraja, S. (2014, February). Command & Control Understanding, Denying and Detecting. Retrieved April 20, 2016."}, {"url": "http://blog.trendmicro.com/trendlabs-security-intelligence/in-depth-look-apt-attack-tools-of-the-trade/", "source_name": "Trend Micro APT Attack Tools", "description": "Wilhoit, K. (2013, March 4). In-Depth Look: APT Attack Tools of the Trade. Retrieved December 2, 2015."}], "object_marking_refs": ["marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"], "modified": "2018-12-05T17:37:12.426Z", "created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5", "kill_chain_phases": [{"phase_name": "command-and-control", "kill_chain_name": "mitre-attack"}], "id": "attack-pattern--731f4f55-b6d0-41d1-a7a9-072a66389aea", "name": "Connection Proxy", "created": "2017-05-31T21:31:08.479Z", "type": "attack-pattern", "description": "A connection proxy is used to direct network traffic between systems or act as an intermediary for network communications. Many tools exist that enable traffic redirection through proxies or port redirection, including [HTRAN](https://attack.mitre.org/software/S0040), ZXProxy, and ZXPortMap. (Citation: Trend Micro APT Attack Tools)\n\nThe definition of a proxy can also be expanded out to encompass trust relationships between networks in peer-to-peer, mesh, or trusted connections between networks consisting of hosts or systems that regularly communicate with each other.\n\nThe network may be within a single organization or across organizations with trust relationships. Adversaries could use these types of relationships to manage command and control communications, to reduce the number of simultaneous outbound network connections, to provide resiliency in the face of connection loss, or to ride over existing trusted communications paths between victims to avoid suspicion.", "x_mitre_detection": "Processes utilizing the network that do not normally have network communication or have never been seen before are suspicious. Network activities disassociated from user-driven actions from processes that normally require user direction are suspicious.\n\nAnalyze network data for uncommon data flows (e.g., a client sending significantly more data than it receives from a server or between clients that should not or often do not communicate with one another). Processes utilizing the network that do not normally have network communication or have never been seen before are suspicious. Analyze packet contents to detect communications that do not follow the expected protocol behavior for the port that is being used. (Citation: University of Birmingham C2)", "x_mitre_contributors": ["Walker Johnson"], "x_mitre_data_sources": ["Process use of network", "Process monitoring", "Netflow/Enclave netflow", "Packet capture"], "x_mitre_network_requirements": true, "x_mitre_platforms": ["Linux", "macOS", "Windows"], "x_mitre_version": "1.0"}, {"external_references": [{"url": "https://attack.mitre.org/techniques/T1088", "source_name": "mitre-attack", "external_id": "T1088"}, {"url": "http://www.pretentiousname.com/misc/win7_uac_whitelist2.html", "source_name": "Davidson Windows", "description": "Davidson, L. (n.d.). Windows 7 UAC whitelist. Retrieved November 12, 2014."}, {"url": "https://technet.microsoft.com/en-us/itpro/windows/keep-secure/how-user-account-control-works", "source_name": "TechNet How UAC Works", "description": "Lich, B. (2016, May 31). How User Account Control Works. Retrieved June 3, 2016."}, {"url": "http://pen-testing.sans.org/blog/pen-testing/2013/08/08/psexec-uac-bypass", "source_name": "SANS UAC Bypass", "description": "Medin, T. (2013, August 8). PsExec UAC Bypass. Retrieved June 3, 2016."}, {"url": "https://technet.microsoft.com/en-US/magazine/2009.07.uac.aspx", "source_name": "TechNet Inside UAC", "description": "Russinovich, M. (2009, July). User Account Control: Inside Windows 7 User Account Control. Retrieved July 26, 2016."}, {"url": "https://msdn.microsoft.com/en-us/library/ms679687.aspx", "source_name": "MSDN COM Elevation", "description": "Microsoft. (n.d.). The COM Elevation Moniker. Retrieved July 26, 2016."}, {"url": "https://github.com/hfiref0x/UACME", "source_name": "Github UACMe", "description": "UACME Project. (2016, June 16). UACMe. Retrieved July 26, 2016."}, {"url": "https://enigma0x3.net/2016/08/15/fileless-uac-bypass-using-eventvwr-exe-and-registry-hijacking/", "source_name": "enigma0x3 Fileless UAC Bypass", "description": "Nelson, M. (2016, August 15). \"Fileless\" UAC Bypass using eventvwr.exe and Registry Hijacking. Retrieved December 27, 2016."}, {"url": "https://blog.fortinet.com/2016/12/16/malicious-macro-bypasses-uac-to-elevate-privilege-for-fareit-malware", "source_name": "Fortinet Fareit", "description": "Salvio, J., Joven, R. (2016, December 16). Malicious Macro Bypasses UAC to Elevate Privilege for Fareit Malware. Retrieved December 27, 2016."}, {"url": "https://enigma0x3.net/2017/03/14/bypassing-uac-using-app-paths/", "source_name": "enigma0x3 sdclt app paths", "description": "Nelson, M. (2017, March 14). Bypassing UAC using App Paths. Retrieved May 25, 2017."}, {"url": "https://enigma0x3.net/2017/03/17/fileless-uac-bypass-using-sdclt-exe/", "source_name": "enigma0x3 sdclt bypass", "description": "Nelson, M. (2017, March 17). \"Fileless\" UAC Bypass Using sdclt.exe. Retrieved May 25, 2017."}], "object_marking_refs": ["marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"], "modified": "2018-10-17T00:14:20.652Z", "created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5", "kill_chain_phases": [{"phase_name": "defense-evasion", "kill_chain_name": "mitre-attack"}, {"phase_name": "privilege-escalation", "kill_chain_name": "mitre-attack"}], "id": "attack-pattern--ca1a3f50-5ebd-41f8-8320-2c7d6a6e88be", "name": "Bypass User Account Control", "created": "2017-05-31T21:31:07.462Z", "type": "attack-pattern", "description": "Windows User Account Control (UAC) allows a program to elevate its privileges to perform a task under administrator-level permissions by prompting the user for confirmation. The impact to the user ranges from denying the operation under high enforcement to allowing the user to perform the action if they are in the local administrators group and click through the prompt or allowing them to enter an administrator password to complete the action. (Citation: TechNet How UAC Works)\n\nIf the UAC protection level of a computer is set to anything but the highest level, certain Windows programs are allowed to elevate privileges or execute some elevated COM objects without prompting the user through the UAC notification box. (Citation: TechNet Inside UAC) (Citation: MSDN COM Elevation) An example of this is use of rundll32.exe to load a specifically crafted DLL which loads an auto-elevated COM object and performs a file operation in a protected directory which would typically require elevated access. Malicious software may also be injected into a trusted process to gain elevated privileges without prompting a user. (Citation: Davidson Windows) Adversaries can use these techniques to elevate privileges to administrator if the target process is unprotected.\n\nMany methods have been discovered to bypass UAC. The Github readme page for UACMe contains an extensive list of methods (Citation: Github UACMe) that have been discovered and implemented within UACMe, but may not be a comprehensive list of bypasses. Additional bypass methods are regularly discovered and some used in the wild, such as:\n\n* <code>eventvwr.exe</code> can auto-elevate and execute a specified binary or script. (Citation: enigma0x3 Fileless UAC Bypass) (Citation: Fortinet Fareit)\n\nAnother bypass is possible through some Lateral Movement techniques if credentials for an account with administrator privileges are known, since UAC is a single system security mechanism, and the privilege or integrity of a process running on one system will be unknown on lateral systems and default to high integrity. (Citation: SANS UAC Bypass)", "x_mitre_contributors": ["Stefan Kanthak", "Casey Smith"], "x_mitre_data_sources": ["System calls", "Process monitoring", "Authentication logs", "Process command-line parameters"], "x_mitre_detection": "There are many ways to perform UAC bypasses when a user is in the local administrator group on a system, so it may be difficult to target detection on all variations. Efforts should likely be placed on mitigation and collecting enough information on process launches and actions that could be performed before and after a UAC bypass is performed. Monitor process API calls for behavior that may be indicative of [Process Injection](https://attack.mitre.org/techniques/T1055) and unusual loaded DLLs through [DLL Search Order Hijacking](https://attack.mitre.org/techniques/T1038), which indicate attempts to gain access to higher privileged processes.\n\nSome UAC bypass methods rely on modifying specific, user-accessible Registry settings. For example:\n\n* The <code>eventvwr.exe</code> bypass uses the <code>[HKEY_CURRENT_USER]\\Software\\Classes\\mscfile\\shell\\open\\command</code> Registry key. (Citation: enigma0x3 Fileless UAC Bypass)\n* The <code>sdclt.exe</code> bypass uses the <code>[HKEY_CURRENT_USER]\\Software\\Microsoft\\Windows\\CurrentVersion\\App Paths\\control.exe</code> and <code>[HKEY_CURRENT_USER]\\Software\\Classes\\exefile\\shell\\runas\\command\\isolatedCommand</code> Registry keys. (Citation: enigma0x3 sdclt app paths) (Citation: enigma0x3 sdclt bypass)\n\nAnalysts should monitor these Registry settings for unauthorized changes.", "x_mitre_platforms": ["Windows"], "x_mitre_defense_bypassed": ["Windows User Account Control"], "x_mitre_version": "1.0", "x_mitre_effective_permissions": ["Administrator"], "x_mitre_permissions_required": ["User", "Administrator"]}, {"external_references": [{"url": "https://attack.mitre.org/techniques/T1086", "source_name": "mitre-attack", "external_id": "T1086"}, {"url": "https://technet.microsoft.com/en-us/scriptcenter/dd742419.aspx", "source_name": "TechNet PowerShell", "description": "Microsoft. (n.d.). Windows PowerShell Scripting. Retrieved April 28, 2016."}, {"url": "https://github.com/mattifestation/PowerSploit", "source_name": "Powersploit", "description": "PowerSploit. (n.d.). Retrieved December 4, 2014."}, {"url": "https://github.com/jaredhaight/PSAttack", "source_name": "Github PSAttack", "description": "Haight, J. (2016, April 21). PS>Attack. Retrieved June 1, 2016."}, {"url": "http://www.sixdub.net/?p=367", "source_name": "Sixdub PowerPick Jan 2016", "description": "Warner, J.. (2015, January 6). Inexorable PowerShell \u2013 A Red Teamer\u2019s Tale of Overcoming Simple AppLocker Policies. Retrieved December 8, 2018."}, {"url": "https://silentbreaksecurity.com/powershell-jobs-without-powershell-exe/", "source_name": "SilentBreak Offensive PS Dec 2015", "description": "Christensen, L.. (2015, December 28). The Evolution of Offensive PowerShell Invocation. Retrieved December 8, 2018."}, {"url": "https://blogs.msdn.microsoft.com/kebab/2014/04/28/executing-powershell-scripts-from-c/", "source_name": "Microsoft PSfromCsharp APR 2014", "description": "Babinec, K. (2014, April 28). Executing PowerShell scripts from C#. Retrieved April 22, 2019."}, {"url": "http://www.malwarearchaeology.com/s/Windows-PowerShell-Logging-Cheat-Sheet-ver-June-2016-v2.pdf", "source_name": "Malware Archaeology PowerShell Cheat Sheet", "description": "Malware Archaeology. (2016, June). WINDOWS POWERSHELL LOGGING CHEAT SHEET - Win 7/Win 2008 or later. Retrieved June 24, 2016."}, {"url": "https://www.fireeye.com/blog/threat-research/2016/02/greater_visibilityt.html", "source_name": "FireEye PowerShell Logging 2016", "description": "Dunwoody, M. (2016, February 11). GREATER VISIBILITY THROUGH POWERSHELL LOGGING. Retrieved February 16, 2016."}], "object_marking_refs": ["marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"], "modified": "2019-04-25T03:09:01.808Z", "created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5", "kill_chain_phases": [{"phase_name": "execution", "kill_chain_name": "mitre-attack"}], "id": "attack-pattern--f4882e23-8aa7-4b12-b28a-b349c12ee9e0", "name": "PowerShell", "created": "2017-05-31T21:31:06.512Z", "type": "attack-pattern", "description": "PowerShell is a powerful interactive command-line interface and scripting environment included in the Windows operating system. (Citation: TechNet PowerShell) Adversaries can use PowerShell to perform a number of actions, including discovery of information and execution of code. Examples include the Start-Process cmdlet which can be used to run an executable and the Invoke-Command cmdlet which runs a command locally or on a remote computer. \n\nPowerShell may also be used to download and run executables from the Internet, which can be executed from disk or in memory without touching disk.\n\nAdministrator permissions are required to use PowerShell to connect to remote systems.\n\nA number of PowerShell-based offensive testing tools are available, including [Empire](https://attack.mitre.org/software/S0363),  PowerSploit, (Citation: Powersploit) and PSAttack. (Citation: Github PSAttack)\n\nPowerShell commands/scripts can also be executed without directly invoking the powershell.exe binary through interfaces to PowerShell's underlying System.Management.Automation assembly exposed through the .NET framework and Windows Common Language Interface (CLI). (Citation: Sixdub PowerPick Jan 2016)(Citation: SilentBreak Offensive PS Dec 2015) (Citation: Microsoft PSfromCsharp APR 2014)", "x_mitre_contributors": ["Praetorian"], "x_mitre_data_sources": ["PowerShell logs", "Loaded DLLs", "DLL monitoring", "Windows Registry", "File monitoring", "Process monitoring", "Process command-line parameters"], "x_mitre_detection": "If proper execution policy is set, adversaries will likely be able to define their own execution policy if they obtain administrator or system access, either through the Registry or at the command line. This change in policy on a system may be a way to detect malicious use of PowerShell. If PowerShell is not used in an environment, then simply looking for PowerShell execution may detect malicious activity.\n\nMonitor for loading and/or execution of artifacts associated with PowerShell specific assemblies, such as System.Management.Automation.dll (especially to unusual process names/locations). (Citation: Sixdub PowerPick Jan 2016)(Citation: SilentBreak Offensive PS Dec 2015)\n\nIt is also beneficial to turn on PowerShell logging to gain increased fidelity in what occurs during execution (which is applied to .NET invocations). (Citation: Malware Archaeology PowerShell Cheat Sheet) PowerShell 5.0 introduced enhanced logging capabilities, and some of those features have since been added to PowerShell 4.0. Earlier versions of PowerShell do not have many logging features. (Citation: FireEye PowerShell Logging 2016) An organization can gather PowerShell execution details in a data analytic platform to supplement it with other data.", "x_mitre_platforms": ["Windows"], "x_mitre_version": "1.1", "x_mitre_remote_support": true, "x_mitre_permissions_required": ["User", "Administrator"]}, {"external_references": [{"url": "https://attack.mitre.org/techniques/T1078", "source_name": "mitre-attack", "external_id": "T1078"}, {"external_id": "CAPEC-560", "source_name": "capec", "url": "https://capec.mitre.org/data/definitions/560.html"}, {"url": "https://docs.microsoft.com/en-us/windows/security/identity-protection/access-control/local-accounts", "source_name": "Microsoft Local Accounts Feb 2019", "description": "Microsoft. (2018, December 9). Local Accounts. Retrieved February 11, 2019."}, {"url": "https://github.com/rapid7/metasploit-framework/tree/master/modules/exploits/linux/ssh", "source_name": "Metasploit SSH Module", "description": "undefined. (n.d.). Retrieved April 12, 2019."}, {"url": "https://technet.microsoft.com/en-us/library/dn535501.aspx", "source_name": "TechNet Credential Theft", "description": "Microsoft. (2016, April 15). Attractive Accounts for Credential Theft. Retrieved June 3, 2016."}, {"url": "https://technet.microsoft.com/en-us/library/dn487457.aspx", "source_name": "TechNet Audit Policy", "description": "Microsoft. (2016, April 15). Audit Policy Recommendations. Retrieved June 3, 2016."}], "object_marking_refs": ["marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"], "type": "attack-pattern", "modified": "2019-04-16T20:36:46.182Z", "created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5", "kill_chain_phases": [{"phase_name": "defense-evasion", "kill_chain_name": "mitre-attack"}, {"phase_name": "persistence", "kill_chain_name": "mitre-attack"}, {"phase_name": "privilege-escalation", "kill_chain_name": "mitre-attack"}, {"phase_name": "initial-access", "kill_chain_name": "mitre-attack"}], "id": "attack-pattern--b17a1a56-e99c-403c-8948-561df0cffe81", "name": "Valid Accounts", "created": "2017-05-31T21:31:00.645Z", "description": "Adversaries may steal the credentials of a specific user or service account using Credential Access techniques or capture credentials earlier in their reconnaissance process through social engineering for means of gaining Initial Access. \n\nAccounts that an adversary may use can fall into three categories: default, local, and domain accounts. Default accounts are those that are built-into an OS such as Guest or Administrator account on Windows systems or default factory/provider set accounts on other types of systems, software, or devices. Local accounts are those configured by an organization for use by users, remote support, services, or for administration on a single system or service. (Citation: Microsoft Local Accounts Feb 2019) Domain accounts are those managed by Active Directory Domain Services where access and permissions are configured across systems and services that are part of that domain. Domain accounts can cover users, administrators, and services.\n\nCompromised credentials may be used to bypass access controls placed on various resources on systems within the network and may even be used for persistent access to remote systems and externally available services, such as VPNs, Outlook Web Access and remote desktop. Compromised credentials may also grant an adversary increased privilege to specific systems or access to restricted areas of the network. Adversaries may choose not to use malware or tools in conjunction with the legitimate access those credentials provide to make it harder to detect their presence.\n\nDefault accounts are also not limited to Guest and Administrator on client machines, they also include accounts that are preset for equipment such as network devices and computer applications whether they are internal, open source, or COTS. Appliances that come preset with a username and password combination pose a serious threat to organizations that do not change it post installation, as they are easy targets for an adversary. Similarly, adversaries may also utilize publicly disclosed private keys, or stolen private keys, to legitimately connect to remote environments via [Remote Services](https://attack.mitre.org/techniques/T1021) (Citation: Metasploit SSH Module)\n\nThe overlap of account access, credentials, and permissions across a network of systems is of concern because the adversary may be able to pivot across accounts and systems to reach a high level of access (i.e., domain or enterprise administrator) to bypass access controls set within the enterprise. (Citation: TechNet Credential Theft)", "x_mitre_contributors": ["Mark Wee", "Praetorian"], "x_mitre_data_sources": ["Authentication logs", "Process monitoring"], "x_mitre_detection": "Configure robust, consistent account activity audit policies across the enterprise and with externally accessible services. (Citation: TechNet Audit Policy) Look for suspicious account behavior across systems that share accounts, either user, admin, or service accounts. Examples: one account logged into multiple systems simultaneously; multiple accounts logged into the same machine simultaneously; accounts logged in at odd times or outside of business hours. Activity may be from interactive login sessions or process ownership from accounts being used to execute binaries on a remote system as a particular account. Correlate other security systems with login information (e.g., a user has an active login session but has not entered the building or does not have VPN access).\n\nPerform regular audits of domain and local system accounts to detect accounts that may have been created by an adversary for persistence. Checks on these accounts could also include whether default accounts such as Guest have been activated. These audits should also include checks on any appliances and applications for default credentials or SSH keys, and if any are discovered, they should be updated immediately. ", "x_mitre_platforms": ["Linux", "macOS", "Windows"], "x_mitre_version": "1.1", "x_mitre_defense_bypassed": ["Firewall", "Host intrusion prevention systems", "Network intrusion detection system", "Process whitelisting", "System access controls", "Anti-virus"], "x_mitre_effective_permissions": ["User", "Administrator"], "x_mitre_permissions_required": ["User", "Administrator"]}, {"external_references": [{"url": "https://attack.mitre.org/techniques/T1077", "source_name": "mitre-attack", "external_id": "T1077"}, {"url": "https://capec.mitre.org/data/definitions/561.html", "source_name": "capec", "external_id": "CAPEC-561"}, {"url": "http://support.microsoft.com/kb/314984", "source_name": "Microsoft Admin Shares", "description": "Microsoft. (n.d.). How to create and delete hidden or administrative shares on client computers. Retrieved November 20, 2014."}, {"url": "http://blogs.technet.com/b/jepayne/archive/2015/11/27/tracking-lateral-movement-part-one-special-groups-and-specific-service-accounts.aspx", "source_name": "Lateral Movement Payne", "description": "Payne, J. (2015, November 26). Tracking Lateral Movement Part One - Special Groups and Specific Service Accounts. Retrieved February 1, 2016."}, {"url": "http://blogs.technet.com/b/jepayne/archive/2015/11/24/monitoring-what-matters-windows-event-forwarding-for-everyone-even-if-you-already-have-a-siem.aspx", "source_name": "Windows Event Forwarding Payne", "description": "Payne, J. (2015, November 23). Monitoring what matters - Windows Event Forwarding for everyone (even if you already have a SIEM.). Retrieved February 1, 2016."}, {"url": "https://en.wikipedia.org/wiki/Server_Message_Block", "source_name": "Wikipedia SMB", "description": "Wikipedia. (2016, June 12). Server Message Block. Retrieved June 12, 2016."}, {"url": "https://technet.microsoft.com/en-us/library/cc787851.aspx", "source_name": "TechNet RPC", "description": "Microsoft. (2003, March 28). What Is RPC?. Retrieved June 12, 2016."}, {"url": "https://technet.microsoft.com/bb490717.aspx", "source_name": "Technet Net Use", "description": "Microsoft. (n.d.). Net Use. Retrieved November 25, 2016."}], "object_marking_refs": ["marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"], "modified": "2018-10-17T00:14:20.652Z", "created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5", "kill_chain_phases": [{"phase_name": "lateral-movement", "kill_chain_name": "mitre-attack"}], "id": "attack-pattern--ffe742ed-9100-4686-9e00-c331da544787", "name": "Windows Admin Shares", "created": "2017-05-31T21:31:00.200Z", "type": "attack-pattern", "description": "Windows systems have hidden network shares that are accessible only to administrators and provide the ability for remote file copy and other administrative functions. Example network shares include <code>C$</code>, <code>ADMIN$</code>, and <code>IPC$</code>. \n\nAdversaries may use this technique in conjunction with administrator-level [Valid Accounts](https://attack.mitre.org/techniques/T1078) to remotely access a networked system over server message block (SMB) (Citation: Wikipedia SMB) to interact with systems using remote procedure calls (RPCs), (Citation: TechNet RPC) transfer files, and run transferred binaries through remote Execution. Example execution techniques that rely on authenticated sessions over SMB/RPC are [Scheduled Task](https://attack.mitre.org/techniques/T1053), [Service Execution](https://attack.mitre.org/techniques/T1035), and [Windows Management Instrumentation](https://attack.mitre.org/techniques/T1047). Adversaries can also use NTLM hashes to access administrator shares on systems with [Pass the Hash](https://attack.mitre.org/techniques/T1075) and certain configuration and patch levels. (Citation: Microsoft Admin Shares)\n\nThe [Net](https://attack.mitre.org/software/S0039) utility can be used to connect to Windows admin shares on remote systems using <code>net use</code> commands with valid credentials. (Citation: Technet Net Use)", "x_mitre_data_sources": ["Process use of network", "Authentication logs", "Process monitoring", "Process command-line parameters"], "x_mitre_system_requirements": ["File and printer sharing over SMB enabled.\nHost/network firewalls not blocking SMB ports between source and destination.\nUse of domain account in administrator group on remote system or default system admin account."], "x_mitre_detection": "Ensure that proper logging of accounts used to log into systems is turned on and centrally collected. Windows logging is able to collect success/failure for accounts that may be used to move laterally and can be collected using tools such as Windows Event Forwarding. (Citation: Lateral Movement Payne) (Citation: Windows Event Forwarding Payne) Monitor remote login events and associated SMB activity for file transfers and remote process execution. Monitor the actions of remote users who connect to administrative shares. Monitor for use of tools and commands to connect to remote shares, such as [Net](https://attack.mitre.org/software/S0039), on the command-line interface and Discovery techniques that could be used to find remotely accessible systems.", "x_mitre_platforms": ["Windows"], "x_mitre_version": "1.0", "x_mitre_permissions_required": ["Administrator"]}, {"external_references": [{"url": "https://attack.mitre.org/techniques/T1076", "source_name": "mitre-attack", "external_id": "T1076"}, {"url": "https://capec.mitre.org/data/definitions/555.html", "source_name": "capec", "external_id": "CAPEC-555"}, {"url": "http://blog.crowdstrike.com/adversary-tricks-crowdstrike-treats/", "source_name": "Alperovitch Malware", "description": "Alperovitch, D. (2014, October 31). Malware-Free Intrusions. Retrieved November 4, 2014."}, {"url": "https://technet.microsoft.com/en-us/windowsserver/ee236407.aspx", "source_name": "TechNet Remote Desktop Services", "description": "Microsoft. (n.d.). Remote Desktop Services. Retrieved June 1, 2016."}, {"url": "http://www.korznikov.com/2017/03/0-day-or-feature-privilege-escalation.html", "source_name": "RDP Hijacking Korznikov", "description": "Korznikov, A. (2017, March 17). Passwordless RDP Session Hijacking Feature All Windows versions. Retrieved December 11, 2017."}, {"url": "https://medium.com/@networksecurity/rdp-hijacking-how-to-hijack-rds-and-remoteapp-sessions-transparently-to-move-through-an-da2a1e73a5f6", "source_name": "RDP Hijacking Medium", "description": "Beaumont, K. (2017, March 19). RDP hijacking\u200a\u2014\u200ahow to hijack RDS and RemoteApp sessions transparently to move through an organisation. Retrieved December 11, 2017."}, {"url": "https://github.com/nccgroup/redsnarf", "source_name": "Kali Redsnarf", "description": "NCC Group PLC. (2016, November 1). Kali Redsnarf. Retrieved December 11, 2017."}], "object_marking_refs": ["marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"], "modified": "2018-10-17T00:14:20.652Z", "created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5", "kill_chain_phases": [{"phase_name": "lateral-movement", "kill_chain_name": "mitre-attack"}], "id": "attack-pattern--51dea151-0898-4a45-967c-3ebee0420484", "name": "Remote Desktop Protocol", "created": "2017-05-31T21:30:59.769Z", "type": "attack-pattern", "description": "Remote desktop is a common feature in operating systems. It allows a user to log into an interactive session with a system desktop graphical user interface on a remote system. Microsoft refers to its implementation of the Remote Desktop Protocol (RDP) as Remote Desktop Services (RDS). (Citation: TechNet Remote Desktop Services) There are other implementations and third-party tools that provide graphical access [Remote Services](https://attack.mitre.org/techniques/T1021) similar to RDS.\n\nAdversaries may connect to a remote system over RDP/RDS to expand access if the service is enabled and allows access to accounts with known credentials. Adversaries will likely use Credential Access techniques to acquire credentials to use with RDP. Adversaries may also use RDP in conjunction with the [Accessibility Features](https://attack.mitre.org/techniques/T1015) technique for Persistence. (Citation: Alperovitch Malware)\n\nAdversaries may also perform RDP session hijacking which involves stealing a legitimate user's remote session. Typically, a user is notified when someone else is trying to steal their session and prompted with a question. With System permissions and using Terminal Services Console, <code>c:\\windows\\system32\\tscon.exe [session number to be stolen]</code>, an adversary can hijack a session without the need for credentials or prompts to the user. (Citation: RDP Hijacking Korznikov) This can be done remotely or locally and with active or disconnected sessions. (Citation: RDP Hijacking Medium) It can also lead to [Remote System Discovery](https://attack.mitre.org/techniques/T1018) and Privilege Escalation by stealing a Domain Admin or higher privileged account session. All of this can be done by using native Windows commands, but it has also been added as a feature in RedSnarf. (Citation: Kali Redsnarf)", "x_mitre_contributors": ["Matthew Demaske, Adaptforward"], "x_mitre_permissions_required": ["Remote Desktop Users", "User"], "x_mitre_data_sources": ["Authentication logs", "Netflow/Enclave netflow", "Process monitoring"], "x_mitre_detection": "Use of RDP may be legitimate, depending on the network environment and how it is used. Other factors, such as access patterns and activity that occurs after a remote login, may indicate suspicious or malicious behavior with RDP. Monitor for user accounts logged into systems they would not normally access or access patterns to multiple systems over a relatively short period of time.\n\nAlso, set up process monitoring for <code>tscon.exe</code> usage and monitor service creation that uses <code>cmd.exe /k</code> or <code>cmd.exe /c</code> in its arguments to prevent RDP session hijacking.", "x_mitre_platforms": ["Windows"], "x_mitre_version": "1.0", "x_mitre_system_requirements": ["RDP service enabled, account in the Remote Desktop Users group."]}, {"external_references": [{"url": "https://attack.mitre.org/techniques/T1075", "source_name": "mitre-attack", "external_id": "T1075"}, {"url": "https://www.iad.gov/iad/library/reports/spotting-the-adversary-with-windows-event-log-monitoring.cfm", "source_name": "NSA Spotting", "description": "National Security Agency/Central Security Service Information Assurance Directorate. (2015, August 7). Spotting the Adversary with Windows Event Log Monitoring. Retrieved September 6, 2018."}], "object_marking_refs": ["marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"], "modified": "2018-10-17T00:14:20.652Z", "created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5", "kill_chain_phases": [{"phase_name": "lateral-movement", "kill_chain_name": "mitre-attack"}], "id": "attack-pattern--c23b740b-a42b-47a1-aec2-9d48ddd547ff", "name": "Pass the Hash", "created": "2017-05-31T21:30:59.339Z", "type": "attack-pattern", "description": "Pass the hash (PtH) is a method of authenticating as a user without having access to the user's cleartext password. This method bypasses standard authentication steps that require a cleartext password, moving directly into the portion of the authentication that uses the password hash. In this technique, valid password hashes for the account being used are captured using a Credential Access technique. Captured hashes are used with PtH to authenticate as that user. Once authenticated, PtH may be used to perform actions on local or remote systems. \n\nWindows 7 and higher with KB2871997 require valid domain user credentials or RID 500 administrator hashes. (Citation: NSA Spotting)", "x_mitre_system_requirements": ["Requires Microsoft Windows as target system"], "x_mitre_data_sources": ["Authentication logs"], "x_mitre_detection": "Audit all logon and credential use events and review for discrepancies. Unusual remote logins that correlate with other suspicious activity (such as writing and executing binaries) may indicate malicious activity. NTLM LogonType 3 authentications that are not associated to a domain login and are not anonymous logins are suspicious.", "x_mitre_platforms": ["Windows"], "x_mitre_version": "1.0", "x_mitre_contributors": ["Travis Smith, Tripwire"]}, {"external_references": [{"url": "https://attack.mitre.org/techniques/T1071", "source_name": "mitre-attack", "external_id": "T1071"}, {"url": "https://arxiv.org/ftp/arxiv/papers/1408/1408.1136.pdf", "source_name": "University of Birmingham C2", "description": "Gardiner, J.,  Cova, M., Nagaraja, S. (2014, February). Command & Control Understanding, Denying and Detecting. Retrieved April 20, 2016."}], "object_marking_refs": ["marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"], "modified": "2018-10-17T00:14:20.652Z", "created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5", "kill_chain_phases": [{"phase_name": "command-and-control", "kill_chain_name": "mitre-attack"}], "id": "attack-pattern--355be19c-ffc9-46d5-8d50-d6a036c675b6", "name": "Standard Application Layer Protocol", "created": "2017-05-31T21:30:56.776Z", "type": "attack-pattern", "description": "Adversaries may communicate using a common, standardized application layer protocol such as HTTP, HTTPS, SMTP, or DNS to avoid detection by blending in with existing traffic. Commands to the remote system, and often the results of those commands, will be embedded within the protocol traffic between the client and server.\n\nFor connections that occur internally within an enclave (such as those between a proxy or pivot node and other nodes), commonly used protocols are RPC, SSH, or RDP.", "x_mitre_detection": "Analyze network data for uncommon data flows (e.g., a client sending significantly more data than it receives from a server). Processes utilizing the network that do not normally have network communication or have never been seen before are suspicious. Analyze packet contents to detect application layer protocols that do not follow the expected protocol for the port that is being used. (Citation: University of Birmingham C2)", "x_mitre_data_sources": ["Packet capture", "Netflow/Enclave netflow", "Process use of network", "Malware reverse engineering", "Process monitoring"], "x_mitre_network_requirements": true, "x_mitre_platforms": ["Linux", "macOS", "Windows"], "x_mitre_version": "1.0"}, {"external_references": [{"url": "https://attack.mitre.org/techniques/T1068", "source_name": "mitre-attack", "external_id": "T1068"}, {"url": "https://capec.mitre.org/data/definitions/69.html", "source_name": "capec", "external_id": "CAPEC-69"}], "object_marking_refs": ["marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"], "modified": "2018-10-31T13:45:13.024Z", "created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5", "kill_chain_phases": [{"phase_name": "privilege-escalation", "kill_chain_name": "mitre-attack"}], "id": "attack-pattern--b21c3b2d-02e6-45b1-980b-e69051040839", "name": "Exploitation for Privilege Escalation", "created": "2017-05-31T21:30:55.066Z", "type": "attack-pattern", "description": "Exploitation of a software vulnerability occurs when an adversary takes advantage of a programming error in a program, service, or within the operating system software or kernel itself to execute adversary-controlled code. Security constructs such as permission levels will often hinder access to information and use of certain techniques, so adversaries will likely need to perform Privilege Escalation to include use of software exploitation to circumvent those restrictions.\n\nWhen initially gaining access to a system, an adversary may be operating within a lower privileged process which will prevent them from accessing certain resources on the system. Vulnerabilities may exist, usually in operating system components and software commonly running at higher permissions, that can be exploited to gain higher levels of access on the system. This could enable someone to move from unprivileged or user level permissions to SYSTEM or root permissions depending on the component that is vulnerable. This may be a necessary step for an adversary compromising a endpoint system that has been properly configured and limits other privilege escalation methods.", "x_mitre_system_requirements": ["In the case of privilege escalation, the adversary likely already has user permissions on the target system."], "x_mitre_permissions_required": ["User"], "x_mitre_data_sources": ["Windows Error Reporting", "Process monitoring", "Application logs"], "x_mitre_detection": "Detecting software exploitation may be difficult depending on the tools available. Software exploits may not always succeed or may cause the exploited process to become unstable or crash. Also look for behavior on the endpoint system that might indicate successful compromise, such as abnormal behavior of the processes. This could include suspicious files written to disk, evidence of [Process Injection](https://attack.mitre.org/techniques/T1055) for attempts to hide execution or evidence of Discovery.\n\nHigher privileges are often necessary to perform additional actions such as some methods of [Credential Dumping](https://attack.mitre.org/techniques/T1003). Look for additional activity that may indicate an adversary has gained higher privileges.", "x_mitre_platforms": ["Linux", "macOS", "Windows"], "x_mitre_version": "1.0", "x_mitre_effective_permissions": ["User"]}, {"external_references": [{"url": "https://attack.mitre.org/techniques/T1066", "source_name": "mitre-attack", "external_id": "T1066"}], "object_marking_refs": ["marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"], "modified": "2018-10-17T00:14:20.652Z", "created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5", "kill_chain_phases": [{"phase_name": "defense-evasion", "kill_chain_name": "mitre-attack"}], "id": "attack-pattern--00d0b012-8a03-410e-95de-5826bf542de6", "name": "Indicator Removal from Tools", "created": "2017-05-31T21:30:54.176Z", "type": "attack-pattern", "description": "If a malicious tool is detected and quarantined or otherwise curtailed, an adversary may be able to determine why the malicious tool was detected (the indicator), modify the tool by removing the indicator, and use the updated version that is no longer detected by the target's defensive systems or subsequent targets that may use similar systems.\n\nA good example of this is when malware is detected with a file signature and quarantined by anti-virus software. An adversary who can determine that the malware was quarantined because of its file signature may use [Software Packing](https://attack.mitre.org/techniques/T1045) or otherwise modify the file so it has a different signature, and then re-use the malware.", "x_mitre_data_sources": ["Process use of network", "Process monitoring", "Process command-line parameters", "Anti-virus", "Binary file metadata"], "x_mitre_detection": "The first detection of a malicious tool may trigger an anti-virus or other security tool alert. Similar events may also occur at the boundary through network IDS, email scanning appliance, etc. The initial detection should be treated as an indication of a potentially more invasive intrusion. The alerting system should be thoroughly investigated beyond that initial alert for activity that was not detected. Adversaries may continue with an operation, assuming that individual events like an anti-virus detect will not be investigated or that an analyst will not be able to conclusively link that event to other activity occurring on the network.", "x_mitre_platforms": ["Linux", "macOS", "Windows"], "x_mitre_version": "1.0", "x_mitre_defense_bypassed": ["Log analysis", "Host intrusion prevention systems", "Anti-virus"]}, {"external_references": [{"url": "https://attack.mitre.org/techniques/T1064", "source_name": "mitre-attack", "external_id": "T1064"}, {"url": "http://www.metasploit.com", "source_name": "Metasploit_Ref", "description": "Metasploit. (n.d.). Retrieved December 4, 2014."}, {"url": "https://www.veil-framework.com/framework/", "source_name": "Veil_Ref", "description": "Veil Framework. (n.d.). Retrieved December 4, 2014."}, {"url": "https://github.com/mattifestation/PowerSploit", "source_name": "Powersploit", "description": "PowerSploit. (n.d.). Retrieved December 4, 2014."}, {"url": "https://blog.crowdstrike.com/deep-thought-chinese-targeting-national-security-think-tanks/", "source_name": "Alperovitch 2014", "description": "Alperovitch, D. (2014, July 7). Deep in Thought: Chinese Targeting of National Security Think Tanks. Retrieved November 12, 2014."}, {"url": "https://www.uperesia.com/analyzing-malicious-office-documents", "source_name": "Uperesia Malicious Office Documents", "description": "Felix. (2016, September). Analyzing Malicious Office Documents. Retrieved April 11, 2018."}], "object_marking_refs": ["marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"], "modified": "2019-06-10T19:18:11.461Z", "created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5", "kill_chain_phases": [{"phase_name": "defense-evasion", "kill_chain_name": "mitre-attack"}, {"phase_name": "execution", "kill_chain_name": "mitre-attack"}], "id": "attack-pattern--7fd87010-3a00-4da3-b905-410525e8ec44", "name": "Scripting", "created": "2017-05-31T21:30:51.733Z", "type": "attack-pattern", "description": "Adversaries may use scripts to aid in operations and perform multiple actions that would otherwise be manual. Scripting is useful for speeding up operational tasks and reducing the time required to gain access to critical resources. Some scripting languages may be used to bypass process monitoring mechanisms by directly interacting with the operating system at an API level instead of calling other programs. Common scripting languages for Windows include VBScript and PowerShell but could also be in the form of command-line batch scripts.\n\nScripts can be embedded inside Office documents as macros that can be set to execute when files used in [Spearphishing Attachment](https://attack.mitre.org/techniques/T1193) and other types of spearphishing are opened. Malicious embedded macros are an alternative means of execution than software exploitation through [Exploitation for Client Execution](https://attack.mitre.org/techniques/T1203), where adversaries will rely on macros being allowed or that the user will accept to activate them.\n\nMany popular offensive frameworks exist which use forms of scripting for security testers and adversaries alike. Metasploit (Citation: Metasploit_Ref), Veil (Citation: Veil_Ref), and PowerSploit (Citation: Powersploit) are three examples that are popular among penetration testers for exploit and post-compromise operations and include many features for evading defenses. Some adversaries are known to use PowerShell. (Citation: Alperovitch 2014)", "x_mitre_defense_bypassed": ["Process whitelisting", "Data Execution Prevention", "Exploit Prevention"], "x_mitre_data_sources": ["Process monitoring", "File monitoring", "Process command-line parameters"], "x_mitre_detection": "Scripting may be common on admin, developer, or power user systems, depending on job function. If scripting is restricted for normal users, then any attempts to enable scripts running on a system would be considered suspicious. If scripts are not commonly used on a system, but enabled, scripts running out of cycle from patching or other administrator functions are suspicious. Scripts should be captured from the file system when possible to determine their actions and intent.\n\nScripts are likely to perform actions with various effects on a system that may generate events, depending on the types of monitoring used. Monitor processes and command-line arguments for script execution and subsequent behavior. Actions may be related to network and system information Discovery, Collection, or other scriptable post-compromise behaviors and could be used as indicators of detection leading back to the source script.\n\nAnalyze Office file attachments for potentially malicious macros. Execution of macros may create suspicious process trees depending on what the macro is designed to do. Office processes, such as winword.exe, spawning instances of cmd.exe, script application like wscript.exe or powershell.exe, or other suspicious processes may indicate malicious activity. (Citation: Uperesia Malicious Office Documents)", "x_mitre_platforms": ["Linux", "macOS", "Windows"], "x_mitre_version": "1.0", "x_mitre_permissions_required": ["User"]}, {"external_references": [{"url": "https://attack.mitre.org/techniques/T1059", "source_name": "mitre-attack", "external_id": "T1059"}, {"url": "https://en.wikipedia.org/wiki/Command-line_interface", "source_name": "Wikipedia Command-Line Interface", "description": "Wikipedia. (2016, June 26). Command-line interface. Retrieved June 27, 2016."}], "object_marking_refs": ["marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"], "modified": "2018-10-17T00:14:20.652Z", "created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5", "kill_chain_phases": [{"phase_name": "execution", "kill_chain_name": "mitre-attack"}], "id": "attack-pattern--7385dfaf-6886-4229-9ecd-6fd678040830", "name": "Command-Line Interface", "created": "2017-05-31T21:30:49.546Z", "type": "attack-pattern", "description": "Command-line interfaces provide a way of interacting with computer systems and is a common feature across many types of operating system platforms. (Citation: Wikipedia Command-Line Interface) One example command-line interface on Windows systems is [cmd](https://attack.mitre.org/software/S0106), which can be used to perform a number of tasks including execution of other software. Command-line interfaces can be interacted with locally or remotely via a remote desktop application, reverse shell session, etc. Commands that are executed run with the current permission level of the command-line interface process unless the command includes process invocation that changes permissions context for that execution (e.g. [Scheduled Task](https://attack.mitre.org/techniques/T1053)).\n\nAdversaries may use command-line interfaces to interact with systems and execute other software during the course of an operation.", "x_mitre_data_sources": ["Process monitoring", "Process command-line parameters"], "x_mitre_detection": "Command-line interface activities can be captured through proper logging of process execution with command-line arguments. This information can be useful in gaining additional insight to adversaries' actions through how they use native processes or custom tools.", "x_mitre_platforms": ["Linux", "macOS", "Windows"], "x_mitre_version": "1.0", "x_mitre_remote_support": false, "x_mitre_permissions_required": ["User", "Administrator", "SYSTEM"]}, {"external_references": [{"url": "https://attack.mitre.org/techniques/T1057", "source_name": "mitre-attack", "external_id": "T1057"}, {"url": "https://capec.mitre.org/data/definitions/573.html", "source_name": "capec", "external_id": "CAPEC-573"}], "object_marking_refs": ["marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"], "modified": "2018-10-17T00:14:20.652Z", "created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5", "kill_chain_phases": [{"phase_name": "discovery", "kill_chain_name": "mitre-attack"}], "id": "attack-pattern--8f4a33ec-8b1f-4b80-a2f6-642b2e479580", "name": "Process Discovery", "created": "2017-05-31T21:30:48.728Z", "type": "attack-pattern", "description": "Adversaries may attempt to get information about running processes on a system. Information obtained could be used to gain an understanding of common software running on systems within the network.\n\n### Windows\n\nAn example command that would obtain details on processes is \"tasklist\" using the [Tasklist](https://attack.mitre.org/software/S0057) utility.\n\n### Mac and Linux\n\nIn Mac and Linux, this is accomplished with the <code>ps</code> command.", "x_mitre_data_sources": ["Process monitoring", "Process command-line parameters"], "x_mitre_system_requirements": ["Administrator, SYSTEM may provide better process ownership details"], "x_mitre_detection": "System and network discovery techniques normally occur throughout an operation as an adversary learns the environment. Data and events should not be viewed in isolation, but as part of a chain of behavior that could lead to other activities, such as Lateral Movement, based on the information obtained.\n\nNormal, benign system and network events that look like process discovery may be uncommon, depending on the environment and how they are used. Monitor processes and command-line arguments for actions that could be taken to gather system and network information. Remote access tools with built-in features may interact directly with the Windows API to gather information. Information may also be acquired through Windows system management tools such as [Windows Management Instrumentation](https://attack.mitre.org/techniques/T1047) and [PowerShell](https://attack.mitre.org/techniques/T1086).", "x_mitre_platforms": ["Linux", "macOS", "Windows"], "x_mitre_version": "1.0", "x_mitre_permissions_required": ["User", "Administrator", "SYSTEM"]}, {"external_references": [{"url": "https://attack.mitre.org/techniques/T1056", "source_name": "mitre-attack", "external_id": "T1056"}, {"url": "https://capec.mitre.org/data/definitions/569.html", "source_name": "capec", "external_id": "CAPEC-569"}, {"url": "http://opensecuritytraining.info/Keylogging_files/The%20Adventures%20of%20a%20Keystroke.pdf", "source_name": "Adventures of a Keystroke", "description": "Tinaztepe,  E. (n.d.). The Adventures of a Keystroke:  An in-depth look into keyloggers on Windows. Retrieved April 27, 2016."}, {"url": "https://www.volexity.com/blog/2015/10/07/virtual-private-keylogging-cisco-web-vpns-leveraged-for-access-and-persistence/", "source_name": "Volexity Virtual Private Keylogging", "description": "Adair, S. (2015, October 7). Virtual Private Keylogging: Cisco Web VPNs Leveraged for Access and Persistence. Retrieved March 20, 2017."}, {"url": "http://blog.leetsys.com/2012/01/02/capturing-windows-7-credentials-at-logon-using-custom-credential-provider/", "source_name": "Wrightson 2012", "description": "Wrightson, T. (2012, January 2). CAPTURING WINDOWS 7 CREDENTIALS AT LOGON USING CUSTOM CREDENTIAL PROVIDER. Retrieved November 12, 2014."}], "object_marking_refs": ["marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"], "modified": "2018-10-17T00:14:20.652Z", "created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5", "kill_chain_phases": [{"phase_name": "collection", "kill_chain_name": "mitre-attack"}, {"phase_name": "credential-access", "kill_chain_name": "mitre-attack"}], "id": "attack-pattern--bb5a00de-e086-4859-a231-fa793f6797e2", "name": "Input Capture", "created": "2017-05-31T21:30:48.323Z", "type": "attack-pattern", "description": "Adversaries can use methods of capturing user input for obtaining credentials for [Valid Accounts](https://attack.mitre.org/techniques/T1078) and information Collection that include keylogging and user input field interception.\n\nKeylogging is the most prevalent type of input capture, with many different ways of intercepting keystrokes, (Citation: Adventures of a Keystroke) but other methods exist to target information for specific purposes, such as performing a UAC prompt or wrapping the Windows default credential provider. (Citation: Wrightson 2012)\n\nKeylogging is likely to be used to acquire credentials for new access opportunities when [Credential Dumping](https://attack.mitre.org/techniques/T1003) efforts are not effective, and may require an adversary to remain passive on a system for a period of time before an opportunity arises.\n\nAdversaries may also install code on externally facing portals, such as a VPN login page, to capture and transmit credentials of users who attempt to log into the service. This variation on input capture may be conducted post-compromise using legitimate administrative access as a backup measure to maintain network access through [External Remote Services](https://attack.mitre.org/techniques/T1133) and [Valid Accounts](https://attack.mitre.org/techniques/T1078) or as part of the initial compromise by exploitation of the externally facing web service. (Citation: Volexity Virtual Private Keylogging)", "x_mitre_contributors": ["John Lambert, Microsoft Threat Intelligence Center"], "x_mitre_data_sources": ["Windows Registry", "Kernel drivers", "Process monitoring", "API monitoring"], "x_mitre_detection": "Keyloggers may take many forms, possibly involving modification to the Registry and installation of a driver, setting a hook, or polling to intercept keystrokes. Commonly used API calls include SetWindowsHook, GetKeyState, and GetAsyncKeyState. (Citation: Adventures of a Keystroke) Monitor the Registry and file system for such changes and detect driver installs, as well as looking for common keylogging API calls. API calls alone are not an indicator of keylogging, but may provide behavioral data that is useful when combined with other information such as new files written to disk and unusual processes.\n\nMonitor the Registry for the addition of a Custom Credential Provider. (Citation: Wrightson 2012) Detection of compromised [Valid Accounts](https://attack.mitre.org/techniques/T1078) in use by adversaries may help to catch the result of user input interception if new techniques are used.", "x_mitre_platforms": ["Linux", "macOS", "Windows"], "x_mitre_version": "1.0", "x_mitre_permissions_required": ["Administrator", "SYSTEM"]}, {"external_references": [{"url": "https://attack.mitre.org/techniques/T1055", "source_name": "mitre-attack", "external_id": "T1055"}, {"url": "https://capec.mitre.org/data/definitions/242.html", "source_name": "capec", "external_id": "CAPEC-242"}, {"url": "https://github.com/mattifestation/PowerSploit", "source_name": "Powersploit", "description": "PowerSploit. (n.d.). Retrieved December 4, 2014."}, {"url": "https://www.endgame.com/blog/technical-blog/hunting-memory", "source_name": "Endgame HuntingNMemory June 2017", "description": "Desimone, J. (2017, June 13). Hunting in Memory. Retrieved December 7, 2017."}, {"url": "https://msdn.microsoft.com/library/windows/desktop/ms681951.aspx", "source_name": "Microsoft APC", "description": "Microsoft. (n.d.). Asynchronous Procedure Calls. Retrieved December 8, 2017."}, {"url": "https://blog.ensilo.com/atombombing-brand-new-code-injection-for-windows", "source_name": "ENSIL AtomBombing Oct 2016", "description": "Liberman, T. (2016, October 27). ATOMBOMBING: BRAND NEW CODE INJECTION FOR WINDOWS. Retrieved December 8, 2017."}, {"url": "https://msdn.microsoft.com/library/windows/desktop/ms649053.aspx", "source_name": "Microsoft Atom Table", "description": "Microsoft. (n.d.). About Atom Tables. Retrieved December 8, 2017."}, {"url": "https://docs.microsoft.com/sysinternals/downloads/sysmon", "source_name": "Microsoft Sysmon v6 May 2017", "description": "Russinovich, M. & Garnier, T. (2017, May 22). Sysmon v6.20. Retrieved December 13, 2017."}, {"url": "https://www.fireeye.com/blog/threat-research/2017/11/ursnif-variant-malicious-tls-callback-technique.html", "source_name": "FireEye TLS Nov 2017", "description": "Vaish, A. & Nemes, S. (2017, November 28). Newly Observed Ursnif Variant Employs Malicious TLS Callback Technique to Achieve Process Injection. Retrieved December 18, 2017."}, {"url": "https://www.datawire.io/code-injection-on-linux-and-macos/", "source_name": "Datawire Code Injection", "description": "Turner-Trauring, I. (2017, April 18). \u201cThis will only hurt for a moment\u201d: code injection on Linux and macOS with LD_PRELOAD. Retrieved December 20, 2017."}, {"url": "http://hick.org/code/skape/papers/needle.txt", "source_name": "Uninformed Needle", "description": "skape. (2003, January 19). Linux x86 run-time process manipulation. Retrieved December 20, 2017."}, {"url": "http://phrack.org/issues/51/8.html", "source_name": "Phrack halfdead 1997", "description": "halflife. (1997, September 1). Shared Library Redirection Techniques. Retrieved December 20, 2017."}, {"url": "http://vxer.org/lib/vrn00.html", "source_name": "VDSO hijack 2009", "description": "O'Neill, R. (2009, May). Modern Day ELF Runtime infection via GOT poisoning. Retrieved December 20, 2017."}, {"source_name": "ArtOfMemoryForensics", "description": "Ligh, M.H. et al.. (2014, July). The Art of Memory Forensics: Detecting Malware and Threats in Windows, Linux, and Mac Memory. Retrieved December 20, 2017."}, {"url": "https://www.gnu.org/software/acct/", "source_name": "GNU Acct", "description": "GNU. (2010, February 5). The GNU Accounting Utilities. Retrieved December 20, 2017."}, {"url": "https://access.redhat.com/documentation/red_hat_enterprise_linux/6/html/security_guide/chap-system_auditing", "source_name": "RHEL auditd", "description": "Jahoda, M. et al.. (2017, March 14). redhat Security Guide - Chapter 7 - System Auditing. Retrieved December 20, 2017."}, {"url": "http://www.chokepoint.net/2014/02/detecting-userland-preload-rootkits.html", "source_name": "Chokepoint preload rootkits", "description": "stderr. (2014, February 14). Detecting Userland Preload Rootkits. Retrieved December 20, 2017."}, {"url": "https://www.cyberbit.com/blog/endpoint-security/new-early-bird-code-injection-technique-discovered/", "source_name": "CyberBit Early Bird Apr 2018", "description": "Gavriel, H. & Erbesfeld, B. (2018, April 11). New \u2018Early Bird\u2019 Code Injection Technique Discovered. Retrieved May 24, 2018."}, {"url": "https://www.endgame.com/blog/technical-blog/ten-process-injection-techniques-technical-survey-common-and-trending-process", "source_name": "Endgame Process Injection July 2017", "description": "Hosseini, A. (2017, July 18). Ten Process Injection Techniques: A Technical Survey Of Common And Trending Process Injection Techniques. Retrieved December 7, 2017."}], "object_marking_refs": ["marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"], "modified": "2018-10-31T13:45:13.024Z", "created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5", "kill_chain_phases": [{"phase_name": "defense-evasion", "kill_chain_name": "mitre-attack"}, {"phase_name": "privilege-escalation", "kill_chain_name": "mitre-attack"}], "id": "attack-pattern--43e7dc91-05b2-474c-b9ac-2ed4fe101f4d", "name": "Process Injection", "created": "2017-05-31T21:30:47.843Z", "type": "attack-pattern", "description": "Process injection is a method of executing arbitrary code in the address space of a separate live process. Running code in the context of another process may allow access to the process's memory, system/network resources, and possibly elevated privileges. Execution via process injection may also evade detection from security products since the execution is masked under a legitimate process.\n\n### Windows\n\nThere are multiple approaches to injecting code into a live process. Windows implementations include: (Citation: Endgame Process Injection July 2017)\n\n* **Dynamic-link library (DLL) injection** involves writing the path to a malicious DLL inside a process then invoking execution by creating a remote thread.\n* **Portable executable injection** involves writing malicious code directly into the process (without a file on disk) then invoking execution with either additional code or by creating a remote thread. The displacement of the injected code introduces the additional requirement for functionality to remap memory references. Variations of this method such as reflective DLL injection (writing a self-mapping DLL into a process) and memory module (map DLL when writing into process) overcome the address relocation issue. (Citation: Endgame HuntingNMemory June 2017)\n* **Thread execution hijacking** involves injecting malicious code or the path to a DLL into a thread of a process. Similar to [Process Hollowing](https://attack.mitre.org/techniques/T1093), the thread must first be suspended.\n* **Asynchronous Procedure Call** (APC) injection involves attaching malicious code to the APC Queue (Citation: Microsoft APC) of a process's thread. Queued APC functions are executed when the thread enters an alterable state. A variation of APC injection, dubbed \"Early Bird injection\", involves creating a suspended process in which malicious code can be written and executed before the process' entry point (and potentially subsequent anti-malware hooks) via an APC. (Citation: CyberBit Early Bird Apr 2018)  AtomBombing  (Citation: ENSIL AtomBombing Oct 2016) is another variation that utilizes APCs to invoke malicious code previously written to the global atom table. (Citation: Microsoft Atom Table)\n* **Thread Local Storage** (TLS) callback injection involves manipulating pointers inside a portable executable (PE) to redirect a process to malicious code before reaching the code's legitimate entry point. (Citation: FireEye TLS Nov 2017)\n\n### Mac and Linux\n\nImplementations for Linux and OS X/macOS systems include: (Citation: Datawire Code Injection) (Citation: Uninformed Needle)\n\n* **LD_PRELOAD, LD_LIBRARY_PATH** (Linux), **DYLD_INSERT_LIBRARIES** (Mac OS X) environment variables, or the dlfcn application programming interface (API) can be used to dynamically load a library (shared object) in a process which can be used to intercept API calls from the running process. (Citation: Phrack halfdead 1997)\n* **Ptrace system calls** can be used to attach to a running process and modify it in runtime. (Citation: Uninformed Needle)\n* **/proc/[pid]/mem** provides access to the memory of the process and can be used to read/write arbitrary data to it. This technique is very rare due to its complexity. (Citation: Uninformed Needle)\n* **VDSO hijacking** performs runtime injection on ELF binaries by manipulating code stubs mapped in from the linux-vdso.so shared object. (Citation: VDSO hijack 2009)\n\nMalware commonly utilizes process injection to access system resources through which Persistence and other environment modifications can be made. More sophisticated samples may perform multiple process injections to segment modules and further evade detection, utilizing named pipes or other inter-process communication (IPC) mechanisms as a communication channel.", "x_mitre_contributors": ["Anastasios Pingios", "Christiaan Beek, @ChristiaanBeek", "Ryan Becwar"], "x_mitre_data_sources": ["API monitoring", "Windows Registry", "File monitoring", "DLL monitoring", "Process monitoring", "Named Pipes"], "x_mitre_detection": "Monitoring Windows API calls indicative of the various types of code injection may generate a significant amount of data and may not be directly useful for defense unless collected under specific circumstances for known bad sequences of calls, since benign use of API functions may be common and difficult to distinguish from malicious behavior. API calls such as CreateRemoteThread, SuspendThread/SetThreadContext/ResumeThread, QueueUserAPC/NtQueueApcThread, and those that can be used to modify memory within another process, such as WriteProcessMemory, may be used for this technique. (Citation: Endgame Process Injection July 2017)\n\nMonitoring for Linux specific calls such as the ptrace system call, the use of LD_PRELOAD environment variable, or dlfcn dynamic linking API calls, should not generate large amounts of data due to their specialized nature, and can be a very effective method to detect some of the common process injection methods. (Citation: ArtOfMemoryForensics)  (Citation: GNU Acct)  (Citation: RHEL auditd)  (Citation: Chokepoint preload rootkits)\n\nMonitor for named pipe creation and connection events (Event IDs 17 and 18) for possible indicators of infected processes with external modules. (Citation: Microsoft Sysmon v6 May 2017)\n\nMonitor processes and command-line arguments for actions that could be done before or after code injection has occurred and correlate the information with related event information. Code injection may also be performed using [PowerShell](https://attack.mitre.org/techniques/T1086) with tools such as PowerSploit, (Citation: Powersploit) so additional PowerShell monitoring may be required to cover known implementations of this behavior.", "x_mitre_platforms": ["Linux", "macOS", "Windows"], "x_mitre_defense_bypassed": ["Process whitelisting", "Anti-virus"], "x_mitre_version": "1.0", "x_mitre_effective_permissions": ["User", "Administrator", "SYSTEM", "root"], "x_mitre_permissions_required": ["User", "Administrator", "SYSTEM", "root"]}, {"external_references": [{"url": "https://attack.mitre.org/techniques/T1050", "source_name": "mitre-attack", "external_id": "T1050"}, {"url": "https://capec.mitre.org/data/definitions/550.html", "source_name": "capec", "external_id": "CAPEC-550"}, {"url": "https://technet.microsoft.com/en-us/library/cc772408.aspx", "source_name": "TechNet Services", "description": "Microsoft. (n.d.). Services. Retrieved June 7, 2016."}, {"url": "https://technet.microsoft.com/en-us/sysinternals/bb963902", "source_name": "TechNet Autoruns", "description": "Russinovich, M. (2016, January 4). Autoruns for Windows v13.51. Retrieved June 6, 2016."}, {"url": "https://docs.microsoft.com/windows/security/threat-protection/auditing/event-4697", "source_name": "Microsoft 4697 APR 2017", "description": "Miroshnikov, A. & Hall, J. (2017, April 18). 4697(S): A service was installed in the system. Retrieved August 7, 2018."}, {"url": "https://docs.microsoft.com/windows/security/threat-protection/use-windows-event-forwarding-to-assist-in-intrusion-detection", "source_name": "Microsoft Windows Event Forwarding FEB 2018", "description": "Hardy, T. & Hall, J. (2018, February 15). Use Windows Event Forwarding to help with intrusion detection. Retrieved August 7, 2018."}], "object_marking_refs": ["marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"], "modified": "2018-10-17T00:14:20.652Z", "created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5", "kill_chain_phases": [{"phase_name": "persistence", "kill_chain_name": "mitre-attack"}, {"phase_name": "privilege-escalation", "kill_chain_name": "mitre-attack"}], "id": "attack-pattern--478aa214-2ca7-4ec0-9978-18798e514790", "name": "New Service", "created": "2017-05-31T21:30:45.613Z", "type": "attack-pattern", "description": "When operating systems boot up, they can start programs or applications called services that perform background system functions. (Citation: TechNet Services) A service's configuration information, including the file path to the service's executable, is stored in the Windows Registry. \n\nAdversaries may install a new service that can be configured to execute at startup by using utilities to interact with services or by directly modifying the Registry. The service name may be disguised by using a name from a related operating system or benign software with [Masquerading](https://attack.mitre.org/techniques/T1036). Services may be created with administrator privileges but are executed under SYSTEM privileges, so an adversary may also use a service to escalate privileges from administrator to SYSTEM. Adversaries may also directly start services through [Service Execution](https://attack.mitre.org/techniques/T1035).", "x_mitre_contributors": ["Pedro Harrison"], "x_mitre_data_sources": ["Windows Registry", "Process monitoring", "Process command-line parameters", "Windows event logs"], "x_mitre_detection": "Monitor service creation through changes in the Registry and common utilities using command-line invocation. Creation of new services may generate an alterable event (ex: Event ID 4697 and/or 7045 (Citation: Microsoft 4697 APR 2017) (Citation: Microsoft Windows Event Forwarding FEB 2018)). New, benign services may be created during installation of new software. Data and events should not be viewed in isolation, but as part of a chain of behavior that could lead to other activities, such as network connections made for Command and Control, learning details about the environment through Discovery, and Lateral Movement.\n\nTools such as Sysinternals Autoruns may also be used to detect system changes that could be attempts at persistence. (Citation: TechNet Autoruns) Look for changes to services that do not correlate with known software, patch cycles, etc. Suspicious program execution through services may show up as outlier processes that have not been seen before when compared against historical data.\n\nMonitor processes and command-line arguments for actions that could create services. Remote access tools with built-in features may interact directly with the Windows API to perform these functions outside of typical system utilities. Services may also be created through Windows system management tools such as [Windows Management Instrumentation](https://attack.mitre.org/techniques/T1047) and [PowerShell](https://attack.mitre.org/techniques/T1086), so additional logging may need to be configured to gather the appropriate data.", "x_mitre_platforms": ["Windows"], "x_mitre_version": "1.0", "x_mitre_effective_permissions": ["SYSTEM"], "x_mitre_permissions_required": ["Administrator", "SYSTEM"]}, {"external_references": [{"url": "https://attack.mitre.org/techniques/T1047", "source_name": "mitre-attack", "external_id": "T1047"}, {"url": "https://msdn.microsoft.com/en-us/library/aa394582.aspx", "source_name": "MSDN WMI", "description": "Microsoft. (n.d.). Windows Management Instrumentation. Retrieved April 27, 2016."}, {"url": "https://www.fireeye.com/content/dam/fireeye-www/global/en/current-threats/pdfs/wp-windows-management-instrumentation.pdf", "source_name": "FireEye WMI 2015", "description": "Ballenthin, W., et al. (2015). Windows Management Instrumentation (WMI) Offense, Defense, and Forensics. Retrieved March 30, 2016."}, {"url": "https://en.wikipedia.org/wiki/Server_Message_Block", "source_name": "Wikipedia SMB", "description": "Wikipedia. (2016, June 12). Server Message Block. Retrieved June 12, 2016."}, {"url": "https://technet.microsoft.com/en-us/library/cc787851.aspx", "source_name": "TechNet RPC", "description": "Microsoft. (2003, March 28). What Is RPC?. Retrieved June 12, 2016."}], "object_marking_refs": ["marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"], "modified": "2018-10-17T00:14:20.652Z", "created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5", "kill_chain_phases": [{"phase_name": "execution", "kill_chain_name": "mitre-attack"}], "id": "attack-pattern--01a5a209-b94c-450b-b7f9-946497d91055", "name": "Windows Management Instrumentation", "created": "2017-05-31T21:30:44.329Z", "type": "attack-pattern", "description": "Windows Management Instrumentation (WMI) is a Windows administration feature that provides a uniform environment for local and remote access to Windows system components. It relies on the WMI service for local and remote access and the server message block (SMB) (Citation: Wikipedia SMB) and Remote Procedure Call Service (RPCS) (Citation: TechNet RPC) for remote access. RPCS operates over port 135. (Citation: MSDN WMI)\n\nAn adversary can use WMI to interact with local and remote systems and use it as a means to perform many tactic functions, such as gathering information for Discovery and remote Execution of files as part of Lateral Movement. (Citation: FireEye WMI 2015)", "x_mitre_data_sources": ["Authentication logs", "Netflow/Enclave netflow", "Process monitoring", "Process command-line parameters"], "x_mitre_system_requirements": ["WMI service, winmgmt, running.\nHost/network firewalls allowing SMB and WMI ports from source to destination.\nSMB authentication."], "x_mitre_detection": "Monitor network traffic for WMI connections; the use of WMI in environments that do not typically use WMI may be suspect. Perform process monitoring to capture command-line arguments of \"wmic\" and detect commands that are used to perform remote behavior. (Citation: FireEye WMI 2015)", "x_mitre_platforms": ["Windows"], "x_mitre_version": "1.0", "x_mitre_remote_support": true, "x_mitre_permissions_required": ["User", "Administrator"]}, {"external_references": [{"url": "https://attack.mitre.org/techniques/T1046", "source_name": "mitre-attack", "external_id": "T1046"}], "object_marking_refs": ["marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"], "modified": "2018-10-17T00:14:20.652Z", "created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5", "kill_chain_phases": [{"phase_name": "discovery", "kill_chain_name": "mitre-attack"}], "id": "attack-pattern--e3a12395-188d-4051-9a16-ea8e14d07b88", "name": "Network Service Scanning", "created": "2017-05-31T21:30:43.915Z", "type": "attack-pattern", "description": "Adversaries may attempt to get a listing of services running on remote hosts, including those that may be vulnerable to remote software exploitation. Methods to acquire this information include port scans and vulnerability scans using tools that are brought onto a system.", "x_mitre_data_sources": ["Netflow/Enclave netflow", "Network protocol analysis", "Packet capture", "Process command-line parameters", "Process use of network"], "x_mitre_detection": "System and network discovery techniques normally occur throughout an operation as an adversary learns the environment. Data and events should not be viewed in isolation, but as part of a chain of behavior that could lead to other activities, such as Lateral Movement, based on the information obtained.\n\nNormal, benign system and network events from legitimate remote service scanning may be uncommon, depending on the environment and how they are used. Legitimate open port and vulnerability scanning may be conducted within the environment and will need to be deconflicted with any detection capabilities developed. Network intrusion detection systems can also be used to identify scanning activity. Monitor for process use of the networks and inspect intra-network flows to detect port scans.", "x_mitre_platforms": ["Linux", "Windows", "macOS"], "x_mitre_version": "1.0", "x_mitre_permissions_required": ["Administrator", "SYSTEM", "User"]}, {"external_references": [{"url": "https://attack.mitre.org/techniques/T1043", "source_name": "mitre-attack", "external_id": "T1043"}, {"url": "https://arxiv.org/ftp/arxiv/papers/1408/1408.1136.pdf", "source_name": "University of Birmingham C2", "description": "Gardiner, J.,  Cova, M., Nagaraja, S. (2014, February). Command & Control Understanding, Denying and Detecting. Retrieved April 20, 2016."}], "object_marking_refs": ["marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"], "modified": "2018-10-17T00:14:20.652Z", "created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5", "kill_chain_phases": [{"phase_name": "command-and-control", "kill_chain_name": "mitre-attack"}], "id": "attack-pattern--f879d51c-5476-431c-aedf-f14d207e4d1e", "name": "Commonly Used Port", "created": "2017-05-31T21:30:42.657Z", "type": "attack-pattern", "description": "Adversaries may communicate over a commonly used port to bypass firewalls or network detection systems and to blend with normal network activity to avoid more detailed inspection. They may use commonly open ports such as\n\n* TCP:80 (HTTP)\n* TCP:443 (HTTPS)\n* TCP:25 (SMTP)\n* TCP/UDP:53 (DNS)\n\nThey may use the protocol associated with the port or a completely different protocol. \n\nFor connections that occur internally within an enclave (such as those between a proxy or pivot node and other nodes), examples of common ports are \n\n* TCP/UDP:135 (RPC)\n* TCP/UDP:22 (SSH)\n* TCP/UDP:3389 (RDP)", "x_mitre_detection": "Analyze network data for uncommon data flows (e.g., a client sending significantly more data than it receives from a server). Processes utilizing the network that do not normally have network communication or have never been seen before are suspicious. Analyze packet contents to detect communications that do not follow the expected protocol behavior for the port that is being used. (Citation: University of Birmingham C2)", "x_mitre_data_sources": ["Packet capture", "Netflow/Enclave netflow", "Process use of network", "Process monitoring"], "x_mitre_network_requirements": true, "x_mitre_platforms": ["Linux", "macOS", "Windows"], "x_mitre_version": "1.0"}, {"external_references": [{"url": "https://attack.mitre.org/techniques/T1035", "source_name": "mitre-attack", "external_id": "T1035"}], "object_marking_refs": ["marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"], "modified": "2018-10-17T00:14:20.652Z", "created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5", "kill_chain_phases": [{"phase_name": "execution", "kill_chain_name": "mitre-attack"}], "id": "attack-pattern--f44731de-ea9f-406d-9b83-30ecbb9b4392", "name": "Service Execution", "created": "2017-05-31T21:30:36.550Z", "type": "attack-pattern", "description": "Adversaries may execute a binary, command, or script via a method that interacts with Windows services, such as the Service Control Manager. This can be done by either creating a new service or modifying an existing service. This technique is the execution used in conjunction with [New Service](https://attack.mitre.org/techniques/T1050) and [Modify Existing Service](https://attack.mitre.org/techniques/T1031) during service persistence or privilege escalation.", "x_mitre_data_sources": ["Windows Registry", "Process monitoring", "Process command-line parameters"], "x_mitre_detection": "Changes to service Registry entries and command-line invocation of tools capable of modifying services that do not correlate with known software, patch cycles, etc., may be suspicious. If a service is used only to execute a binary or script and not to persist, then it will likely be changed back to its original form shortly after the service is restarted so the service is not left broken, as is the case with the common administrator tool [PsExec](https://attack.mitre.org/software/S0029).", "x_mitre_platforms": ["Windows"], "x_mitre_version": "1.0", "x_mitre_remote_support": true, "x_mitre_permissions_required": ["Administrator", "SYSTEM"]}, {"external_references": [{"url": "https://attack.mitre.org/techniques/T1029", "source_name": "mitre-attack", "external_id": "T1029"}], "object_marking_refs": ["marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"], "modified": "2018-10-17T00:14:20.652Z", "created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5", "kill_chain_phases": [{"phase_name": "exfiltration", "kill_chain_name": "mitre-attack"}], "id": "attack-pattern--4eeaf8a9-c86b-4954-a663-9555fb406466", "name": "Scheduled Transfer", "created": "2017-05-31T21:30:34.139Z", "type": "attack-pattern", "description": "Data exfiltration may be performed only at certain times of day or at certain intervals. This could be done to blend traffic patterns with normal activity or availability.\n\nWhen scheduled exfiltration is used, other exfiltration techniques likely apply as well to transfer the information out of the network, such as Exfiltration Over Command and Control Channel and Exfiltration Over Alternative Protocol.", "x_mitre_detection": "Monitor process file access patterns and network behavior. Unrecognized processes or scripts that appear to be traversing file systems and sending network traffic may be suspicious. Network connections to the same destination that occur at the same time of day for multiple days are suspicious.", "x_mitre_data_sources": ["Netflow/Enclave netflow", "Process use of network", "Process monitoring"], "x_mitre_network_requirements": true, "x_mitre_platforms": ["Linux", "macOS", "Windows"], "x_mitre_version": "1.0"}, {"external_references": [{"url": "https://attack.mitre.org/techniques/T1028", "source_name": "mitre-attack", "external_id": "T1028"}, {"url": "http://msdn.microsoft.com/en-us/library/aa384426", "source_name": "Microsoft WinRM", "description": "Microsoft. (n.d.). Windows Remote Management. Retrieved November 12, 2014."}, {"url": "https://www.slideshare.net/kieranjacobsen/lateral-movement-with-power-shell-2", "source_name": "Jacobsen 2014", "description": "Jacobsen, K. (2014, May 16). Lateral Movement with PowerShell&#91;slides&#93;. Retrieved November 12, 2014."}], "object_marking_refs": ["marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"], "modified": "2018-10-17T00:14:20.652Z", "created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5", "kill_chain_phases": [{"phase_name": "execution", "kill_chain_name": "mitre-attack"}, {"phase_name": "lateral-movement", "kill_chain_name": "mitre-attack"}], "id": "attack-pattern--c3bce4f4-9795-46c6-976e-8676300bbc39", "name": "Windows Remote Management", "created": "2017-05-31T21:30:33.723Z", "type": "attack-pattern", "description": "Windows Remote Management (WinRM) is the name of both a Windows service and a protocol that allows a user to interact with a remote system (e.g., run an executable, modify the Registry, modify services). (Citation: Microsoft WinRM) It may be called with the <code>winrm</code> command or by any number of programs such as PowerShell. (Citation: Jacobsen 2014)", "x_mitre_system_requirements": ["WinRM listener turned on and configured on remote system"], "x_mitre_data_sources": ["File monitoring", "Authentication logs", "Netflow/Enclave netflow", "Process monitoring", "Process command-line parameters"], "x_mitre_detection": "Monitor use of WinRM within an environment by tracking service execution. If it is not normally used or is disabled, then this may be an indicator of suspicious behavior. Monitor processes created and actions taken by the WinRM process or a WinRM invoked script to correlate it with other related events.", "x_mitre_platforms": ["Windows"], "x_mitre_version": "1.0", "x_mitre_remote_support": true, "x_mitre_permissions_required": ["User", "Administrator"]}, {"external_references": [{"url": "https://attack.mitre.org/techniques/T1026", "source_name": "mitre-attack", "external_id": "T1026"}, {"url": "https://arxiv.org/ftp/arxiv/papers/1408/1408.1136.pdf", "source_name": "University of Birmingham C2", "description": "Gardiner, J.,  Cova, M., Nagaraja, S. (2014, February). Command & Control Understanding, Denying and Detecting. Retrieved April 20, 2016."}], "object_marking_refs": ["marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"], "modified": "2018-10-17T00:14:20.652Z", "created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5", "kill_chain_phases": [{"phase_name": "command-and-control", "kill_chain_name": "mitre-attack"}], "id": "attack-pattern--99709758-2b96-48f2-a68a-ad7fbd828091", "name": "Multiband Communication", "created": "2017-05-31T21:30:32.259Z", "type": "attack-pattern", "description": "Some adversaries may split communications between different protocols. There could be one protocol for inbound command and control and another for outbound data, allowing it to bypass certain firewall restrictions. The split could also be random to simply avoid data threshold alerts on any one communication.", "x_mitre_detection": "Analyze network data for uncommon data flows (e.g., a client sending significantly more data than it receives from a server). Processes utilizing the network that do not normally have network communication or have never been seen before are suspicious. Analyze packet contents to detect communications that do not follow the expected protocol behavior for the port that is being used. (Citation: University of Birmingham C2) Correlating alerts between multiple communication channels can further help identify command-and-control behavior.", "x_mitre_data_sources": ["Packet capture", "Netflow/Enclave netflow", "Process use of network", "Malware reverse engineering", "Process monitoring"], "x_mitre_network_requirements": true, "x_mitre_platforms": ["Linux", "macOS", "Windows"], "x_mitre_version": "1.0"}, {"external_references": [{"url": "https://attack.mitre.org/techniques/T1021", "source_name": "mitre-attack", "external_id": "T1021"}, {"url": "https://capec.mitre.org/data/definitions/555.html", "source_name": "capec", "external_id": "CAPEC-555"}], "object_marking_refs": ["marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"], "modified": "2018-10-17T00:14:20.652Z", "created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5", "kill_chain_phases": [{"phase_name": "lateral-movement", "kill_chain_name": "mitre-attack"}], "id": "attack-pattern--54a649ff-439a-41a4-9856-8d144a2551ba", "name": "Remote Services", "created": "2017-05-31T21:30:29.858Z", "type": "attack-pattern", "description": "An adversary may use [Valid Accounts](https://attack.mitre.org/techniques/T1078) to log into a service specifically designed to accept remote connections, such as telnet, SSH, and VNC. The adversary may then perform actions as the logged-on user.", "x_mitre_system_requirements": ["Active remote service accepting connections and valid credentials"], "x_mitre_data_sources": ["Authentication logs"], "x_mitre_detection": "Correlate use of login activity related to remote services with unusual behavior or other malicious or suspicious activity. Adversaries will likely need to learn about an environment and the relationships between systems through Discovery techniques prior to attempting Lateral Movement.", "x_mitre_platforms": ["Linux", "macOS", "Windows"], "x_mitre_version": "1.0"}, {"external_references": [{"url": "https://attack.mitre.org/techniques/T1018", "source_name": "mitre-attack", "external_id": "T1018"}], "object_marking_refs": ["marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"], "modified": "2019-04-18T17:28:03.428Z", "created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5", "kill_chain_phases": [{"phase_name": "discovery", "kill_chain_name": "mitre-attack"}], "id": "attack-pattern--e358d692-23c0-4a31-9eb6-ecc13a8d7735", "name": "Remote System Discovery", "created": "2017-05-31T21:30:28.187Z", "type": "attack-pattern", "description": "Adversaries will likely attempt to get a listing of other systems by IP address, hostname, or other logical identifier on a network that may be used for Lateral Movement from the current system. Functionality could exist within remote access tools to enable this, but utilities available on the operating system could also be used. Adversaries may also use local host files in order to discover the hostname to IP address mappings of remote systems. \n\n### Windows\n\nExamples of tools and commands that acquire this information include \"ping\" or \"net view\" using [Net](https://attack.mitre.org/software/S0039). The contents of the <code>C:\\Windows\\System32\\Drivers\\etc\\hosts</code> file can be viewed to gain insight into the existing hostname to IP mappings on the system.\n\n### Mac\n\nSpecific to Mac, the <code>bonjour</code> protocol to discover additional Mac-based systems within the same broadcast domain. Utilities such as \"ping\" and others can be used to gather information about remote systems. The contents of the <code>/etc/hosts</code> file can be viewed to gain insight into existing hostname to IP mappings on the system.\n\n### Linux\n\nUtilities such as \"ping\" and others can be used to gather information about remote systems. The contents of the <code>/etc/hosts</code> file can be viewed to gain insight into existing hostname to IP mappings on the system.", "x_mitre_contributors": ["RedHuntLabs (@redhuntlabs)"], "x_mitre_data_sources": ["Network protocol analysis", "Process monitoring", "Process use of network", "Process command-line parameters"], "x_mitre_detection": "System and network discovery techniques normally occur throughout an operation as an adversary learns the environment. Data and events should not be viewed in isolation, but as part of a chain of behavior that could lead to other activities, such as Lateral Movement, based on the information obtained.\n\nNormal, benign system and network events related to legitimate remote system discovery may be uncommon, depending on the environment and how they are used. Monitor processes and command-line arguments for actions that could be taken to gather system and network information. Remote access tools with built-in features may interact directly with the Windows API to gather information. Information may also be acquired through Windows system management tools such as [Windows Management Instrumentation](https://attack.mitre.org/techniques/T1047) and [PowerShell](https://attack.mitre.org/techniques/T1086). ", "x_mitre_platforms": ["Linux", "macOS", "Windows"], "x_mitre_version": "1.1", "x_mitre_permissions_required": ["User", "Administrator", "SYSTEM"]}, {"external_references": [{"url": "https://attack.mitre.org/techniques/T1005", "source_name": "mitre-attack", "external_id": "T1005"}], "object_marking_refs": ["marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"], "modified": "2018-10-17T00:14:20.652Z", "created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5", "kill_chain_phases": [{"phase_name": "collection", "kill_chain_name": "mitre-attack"}], "id": "attack-pattern--3c4a2599-71ee-4405-ba1e-0e28414b4bc5", "name": "Data from Local System", "created": "2017-05-31T21:30:20.537Z", "type": "attack-pattern", "description": "Sensitive data can be collected from local system sources, such as the file system or databases of information residing on the system prior to Exfiltration.\n\nAdversaries will often search the file system on computers they have compromised to find files of interest. They may do this using a [Command-Line Interface](https://attack.mitre.org/techniques/T1059), such as [cmd](https://attack.mitre.org/software/S0106), which has functionality to interact with the file system to gather information. Some adversaries may also use [Automated Collection](https://attack.mitre.org/techniques/T1119) on the local system.", "x_mitre_system_requirements": ["Privileges to access certain files and directories"], "x_mitre_data_sources": ["File monitoring", "Process monitoring", "Process command-line parameters"], "x_mitre_detection": "Monitor processes and command-line arguments for actions that could be taken to collect files from a system. Remote access tools with built-in features may interact directly with the Windows API to gather data. Data may also be acquired through Windows system management tools such as [Windows Management Instrumentation](https://attack.mitre.org/techniques/T1047) and [PowerShell](https://attack.mitre.org/techniques/T1086).", "x_mitre_platforms": ["Linux", "macOS", "Windows"], "x_mitre_version": "1.0"}, {"external_references": [{"url": "https://attack.mitre.org/techniques/T1003", "source_name": "mitre-attack", "external_id": "T1003"}, {"external_id": "CAPEC-567", "source_name": "capec", "url": "https://capec.mitre.org/data/definitions/567.html"}, {"url": "https://github.com/Neohapsis/creddump7", "source_name": "GitHub Creddump7", "description": "Flathers, R. (2018, February 19). creddump7. Retrieved April 11, 2018."}, {"url": "https://en.wikipedia.org/wiki/Active_Directory", "source_name": "Wikipedia Active Directory", "description": "Wikipedia. (2018, March 10). Active Directory. Retrieved April 11, 2018."}, {"url": "https://msdn.microsoft.com/library/cc422924.aspx", "source_name": "Microsoft GPP Key", "description": "Microsoft. (n.d.). 2.2.1.1.4 Password Encryption. Retrieved April 11, 2018."}, {"url": "http://blogs.technet.com/b/srd/archive/2014/05/13/ms14-025-an-update-for-group-policy-preferences.aspx", "source_name": "SRD GPP", "description": "Security Research and Defense. (2014, May 13). MS14-025: An Update for Group Policy Preferences. Retrieved January 28, 2015."}, {"url": "https://obscuresecurity.blogspot.co.uk/2012/05/gpp-password-retrieval-with-powershell.html", "source_name": "Obscuresecurity Get-GPPPassword", "description": "Campbell, C. (2012, May 24). GPP Password Retrieval with PowerShell. Retrieved April 11, 2018."}, {"url": "https://blogs.technet.microsoft.com/askpfeplat/2016/04/18/the-importance-of-kb2871997-and-kb2928120-for-credential-protection/", "source_name": "TechNet Blogs Credential Protection", "description": "Wilson, B. (2016, April 18). The Importance of KB2871997 and KB2928120 for Credential Protection. Retrieved April 11, 2018."}, {"url": "https://docs.microsoft.com/en-us/previous-versions/windows/it-pro/windows-vista/cc749211(v=ws.10)", "source_name": "Microsoft CredSSP", "description": "Microsoft. (2008, July 25). Credential Security Service Provider and SSO for Terminal Services Logon. Retrieved April 11, 2018."}, {"url": "https://msdn.microsoft.com/library/cc228086.aspx", "source_name": "Microsoft DRSR Dec 2017", "description": "Microsoft. (2017, December 1). MS-DRSR Directory Replication Service (DRS) Remote Protocol. Retrieved December 4, 2017."}, {"url": "https://msdn.microsoft.com/library/dd207691.aspx", "source_name": "Microsoft GetNCCChanges", "description": "Microsoft. (n.d.). IDL_DRSGetNCChanges (Opnum 3). Retrieved December 4, 2017."}, {"url": "https://wiki.samba.org/index.php/DRSUAPI", "source_name": "Samba DRSUAPI", "description": "SambaWiki. (n.d.). DRSUAPI. Retrieved December 4, 2017."}, {"url": "https://source.winehq.org/WineAPI/samlib.html", "source_name": "Wine API samlib.dll", "description": "Wine API. (n.d.). samlib.dll. Retrieved December 4, 2017."}, {"url": "https://adsecurity.org/?p=1729", "source_name": "ADSecurity Mimikatz DCSync", "description": "Metcalf, S. (2015, September 25). Mimikatz DCSync Usage, Exploitation, and Detection. Retrieved August 7, 2017."}, {"url": "http://www.harmj0y.net/blog/redteaming/mimikatz-and-dcsync-and-extrasids-oh-my/", "source_name": "Harmj0y Mimikatz and DCSync", "description": "Schroeder, W. (2015, September 22). Mimikatz and DCSync and ExtraSids, Oh My. Retrieved August 7, 2017."}, {"url": "https://blog.stealthbits.com/manipulating-user-passwords-with-mimikatz-SetNTLM-ChangeNTLM", "source_name": "InsiderThreat ChangeNTLM July 2017", "description": "Warren, J. (2017, July 11). Manipulating User Passwords with Mimikatz. Retrieved December 4, 2017."}, {"url": "https://github.com/gentilkiwi/mimikatz/wiki/module-~-lsadump", "source_name": "GitHub Mimikatz lsadump Module", "description": "Deply, B., Le Toux, V. (2016, June 5). module ~ lsadump. Retrieved August 7, 2017."}, {"url": "https://msdn.microsoft.com/library/cc237008.aspx", "source_name": "Microsoft NRPC Dec 2017", "description": "Microsoft. (2017, December 1). MS-NRPC - Netlogon Remote Protocol. Retrieved December 6, 2017."}, {"url": "https://github.com/mattifestation/PowerSploit", "source_name": "Powersploit", "description": "PowerSploit. (n.d.). Retrieved December 4, 2014."}, {"url": "http://www.harmj0y.net/blog/redteaming/mimikatz-and-dcsync-and-extrasids-oh-my/", "source_name": "Harmj0y DCSync Sept 2015", "description": "Schroeder, W. (2015, September 22). Mimikatz and DCSync and ExtraSids, Oh My. Retrieved December 4, 2017."}, {"url": "https://msdn.microsoft.com/library/cc245496.aspx", "source_name": "Microsoft SAMR", "description": "Microsoft. (n.d.). MS-SAMR Security Account Manager (SAM) Remote Protocol (Client-to-Server) - Transport. Retrieved December 4, 2017."}, {"url": "https://adsecurity.org/?p=1729", "source_name": "AdSecurity DCSync Sept 2015", "description": "Metcalf, S. (2015, September 25). Mimikatz DCSync Usage, Exploitation, and Detection. Retrieved December 4, 2017."}], "object_marking_refs": ["marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"], "modified": "2019-02-05T23:16:08.052Z", "created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5", "kill_chain_phases": [{"phase_name": "credential-access", "kill_chain_name": "mitre-attack"}], "id": "attack-pattern--0a3ead4e-6d47-4ccb-854c-a6a4f9d96b22", "name": "Credential Dumping", "created": "2017-05-31T21:30:19.735Z", "type": "attack-pattern", "description": "Credential dumping is the process of obtaining account login and password information, normally in the form of a hash or a clear text password, from the operating system and software. Credentials can then be used to perform\u00a0Lateral Movement\u00a0and access restricted information.\n\nSeveral of the tools mentioned in this technique may be used by both adversaries and professional security testers. Additional custom tools likely exist as well.\n\n### Windows\n\n#### SAM (Security Accounts Manager)\n\nThe SAM is a database file that contains local accounts for the host, typically those found with the \u2018net user\u2019 command. To enumerate the SAM database, system level access is required.\n\u00a0\nA number of tools can be used to retrieve the SAM file through in-memory techniques:\n\n* pwdumpx.exe \n* [gsecdump](https://attack.mitre.org/software/S0008)\n* [Mimikatz](https://attack.mitre.org/software/S0002)\n* secretsdump.py\n\nAlternatively, the SAM can be extracted from the Registry with [Reg](https://attack.mitre.org/software/S0075):\n\n* <code>reg save HKLM\\sam sam</code>\n* <code>reg save HKLM\\system system</code>\n\nCreddump7 can then be used to process the SAM database locally to retrieve hashes. (Citation: GitHub Creddump7)\n\nNotes:\nRid 500 account is the local, in-built administrator.\nRid 501 is the guest account.\nUser accounts start with a RID of 1,000+.\n\n#### Cached Credentials\n\nThe DCC2 (Domain Cached Credentials version 2) hash, used by Windows Vista and newer caches credentials when the domain controller is unavailable. The number of default cached credentials varies, and this number can be altered per system. This hash does not allow pass-the-hash style attacks.\n\u00a0\nA number of tools can be used to retrieve the SAM file through in-memory techniques.\n\n* pwdumpx.exe \n* [gsecdump](https://attack.mitre.org/software/S0008)\n* [Mimikatz](https://attack.mitre.org/software/S0002)\n\nAlternatively, reg.exe can be used to extract from the Registry and Creddump7 used to gather the credentials.\n\nNotes:\nCached credentials for Windows Vista are derived using PBKDF2.\n\n#### Local Security Authority (LSA) Secrets\n\nWith SYSTEM access to a host, the LSA secrets often allows trivial access from a local account to domain-based account credentials. The Registry is used to store the LSA secrets.\n\u00a0\nWhen services are run under the context of local or domain users, their passwords are stored in the Registry. If auto-logon is enabled, this information will be stored in the Registry as well.\n\u00a0\nA number of tools can be used to retrieve the SAM file through in-memory techniques.\n\n* pwdumpx.exe \n* [gsecdump](https://attack.mitre.org/software/S0008)\n* [Mimikatz](https://attack.mitre.org/software/S0002)\n* secretsdump.py\n\nAlternatively, reg.exe can be used to extract from the Registry and Creddump7 used to gather the credentials.\n\nNotes:\nThe passwords extracted by his mechanism are\u00a0UTF-16\u00a0encoded, which means that they are returned in\u00a0plaintext.\nWindows 10 adds protections for LSA Secrets described in Mitigation.\n\n#### NTDS from Domain Controller\n\nActive Directory stores information about members of the domain including devices and users to verify credentials and define access rights. The Active Directory domain database is stored in the NTDS.dit file. By default the NTDS file will be located in %SystemRoot%\\NTDS\\Ntds.dit of a domain controller. (Citation: Wikipedia Active Directory)\n \nThe following tools and techniques can be used to enumerate the NTDS file and the contents of the entire Active Directory hashes.\n\n* Volume Shadow Copy\n* secretsdump.py\n* Using the in-built Windows tool, ntdsutil.exe\n* Invoke-NinjaCopy\n\n#### Group Policy Preference (GPP) Files\n\nGroup Policy Preferences (GPP) are tools that allowed administrators to create domain policies with embedded credentials. These policies, amongst other things, allow administrators to set local accounts.\n\nThese group policies are stored in SYSVOL on a domain controller, this means that any domain user can view the SYSVOL share and decrypt the password (the AES private key was leaked on-line. (Citation: Microsoft GPP Key) (Citation: SRD GPP)\n\nThe following tools and scripts can be used to gather and decrypt the password file from Group Policy Preference XML files:\n\n* Metasploit\u2019s post exploitation module: \"post/windows/gather/credentials/gpp\"\n* Get-GPPPassword (Citation: Obscuresecurity Get-GPPPassword)\n* gpprefdecrypt.py\n\nNotes:\nOn the SYSVOL share, the following can be used to enumerate potential XML files.\ndir /s * .xml\n\n#### Service Principal Names (SPNs)\n\nSee [Kerberoasting](https://attack.mitre.org/techniques/T1208).\n\n#### Plaintext Credentials\n\nAfter a user logs on to a system, a variety of credentials are generated and stored in the\u00a0Local Security Authority Subsystem Service\u00a0(LSASS) process in memory. These credentials can be harvested by a administrative user or SYSTEM.\n\nSSPI (Security Support Provider Interface) functions as a common interface to several Security Support Providers (SSPs):\u00a0A Security Support Provider is a\u00a0dynamic-link library\u00a0(DLL) that makes one or more security packages available to applications.\n\nThe following SSPs can be used to access credentials:\n\nMsv: Interactive logons, batch logons, and service logons are done through the MSV authentication package.\nWdigest: The Digest Authentication protocol is designed for use with Hypertext Transfer Protocol (HTTP) and Simple Authentication Security Layer (SASL) exchanges. (Citation: TechNet Blogs Credential Protection)\nKerberos: Preferred for mutual client-server domain authentication in Windows 2000 and later.\nCredSSP: \u00a0Provides SSO and\u00a0Network Level Authentication\u00a0for\u00a0Remote Desktop Services. (Citation: Microsoft CredSSP)\n\u00a0\nThe following tools can be used to enumerate credentials:\n\n* [Windows Credential Editor](https://attack.mitre.org/software/S0005)\n* [Mimikatz](https://attack.mitre.org/software/S0002)\n\nAs well as in-memory techniques, the LSASS process memory can be dumped from the target host and analyzed on a local system.\n\nFor example, on the target host use procdump:\n\n* <code>procdump -ma lsass.exe lsass_dump</code>\n\nLocally, mimikatz can be run:\n\n* <code>sekurlsa::Minidump\u00a0lsassdump.dmp</code>\n* <code>sekurlsa::logonPasswords</code>\n\n#### DCSync\n\nDCSync is a variation on credential dumping which can be used to acquire sensitive information from a domain controller. Rather than executing recognizable malicious code, the action works by abusing the domain controller's  application programming interface (API) (Citation: Microsoft DRSR Dec 2017) (Citation: Microsoft GetNCCChanges) (Citation: Samba DRSUAPI) (Citation: Wine API samlib.dll) to simulate the replication process from a remote domain controller. Any members of the Administrators, Domain Admins, Enterprise Admin groups or computer accounts on the domain controller are able to run DCSync to pull password data (Citation: ADSecurity Mimikatz DCSync) from Active Directory, which may include current and historical hashes of potentially useful accounts such as KRBTGT and Administrators. The hashes can then in turn be used to create a Golden Ticket for use in [Pass the Ticket](https://attack.mitre.org/techniques/T1097) (Citation: Harmj0y Mimikatz and DCSync) or change an account's password as noted in [Account Manipulation](https://attack.mitre.org/techniques/T1098). (Citation: InsiderThreat ChangeNTLM July 2017) DCSync functionality has been included in the \"lsadump\" module in Mimikatz. (Citation: GitHub Mimikatz lsadump Module) Lsadump also includes NetSync, which performs DCSync over a legacy replication protocol. (Citation: Microsoft NRPC Dec 2017)\n\n### Linux\n\n#### Proc filesystem\n\nThe /proc filesystem on Linux contains a great deal of information regarding the state of the running operating system. Processes running with root privileges can use this facility to scrape live memory of other running programs. If any of these programs store passwords in clear text or password hashes in memory, these values can then be harvested for either usage or brute force attacks, respectively. This functionality has been implemented in the [MimiPenguin](https://attack.mitre.org/software/S0179), an open source tool inspired by [Mimikatz](https://attack.mitre.org/software/S0002). The tool dumps process memory, then harvests passwords and hashes by looking for text strings and regex patterns for how given applications such as Gnome Keyring, sshd, and Apache use memory to store such authentication artifacts.", "x_mitre_contributors": ["Vincent Le Toux", "Ed Williams, Trustwave, SpiderLabs"], "x_mitre_data_sources": ["API monitoring", "Process monitoring", "PowerShell logs", "Process command-line parameters"], "x_mitre_detection": "### Windows\nCommon credential dumpers such as [Mimikatz](https://attack.mitre.org/software/S0002) access the LSA Subsystem Service (LSASS) process by opening the process, locating the LSA secrets key, and decrypting the sections in memory where credential details are stored. Credential dumpers may also use methods for reflective [Process Injection](https://attack.mitre.org/techniques/T1055) to reduce potential indicators of malicious activity.\n\nHash dumpers open the Security Accounts Manager (SAM) on the local file system (%SystemRoot%/system32/config/SAM) or create a dump of the Registry SAM key to access stored account password hashes. Some hash dumpers will open the local file system as a device and parse to the SAM table to avoid file access defenses. Others will make an in-memory copy of the SAM table before reading hashes. Detection of compromised [Valid Accounts](https://attack.mitre.org/techniques/T1078) in-use by adversaries may help as well. \n\nOn Windows 8.1 and Windows Server 2012 R2, monitor Windows Logs for LSASS.exe creation to verify that LSASS started as a protected process.\n\nMonitor processes and command-line arguments for program execution that may be indicative of credential dumping. Remote access tools may contain built-in features or incorporate existing tools like [Mimikatz](https://attack.mitre.org/software/S0002). [PowerShell](https://attack.mitre.org/techniques/T1086) scripts also exist that contain credential dumping functionality, such as PowerSploit's Invoke-Mimikatz module, (Citation: Powersploit) which may require additional logging features to be configured in the operating system to collect necessary information for analysis.\n\nMonitor domain controller logs for replication requests and other unscheduled activity possibly associated with DCSync. (Citation: Microsoft DRSR Dec 2017) (Citation: Microsoft GetNCCChanges) (Citation: Samba DRSUAPI) Note: Domain controllers may not log replication requests originating from the default domain controller account. (Citation: Harmj0y DCSync Sept 2015). Also monitor for network protocols  (Citation: Microsoft DRSR Dec 2017) (Citation: Microsoft NRPC Dec 2017) and other replication requests (Citation: Microsoft SAMR) from IPs not associated with known domain controllers. (Citation: AdSecurity DCSync Sept 2015)\n\n### Linux\nTo obtain the passwords and hashes stored in memory, processes must open a maps file in the /proc filesystem for the process being analyzed. This file is stored under the path <code>/proc/<pid>/maps</code>, where the <code><pid></code> directory is the unique pid of the program being interrogated for such authentication data. The AuditD monitoring tool, which ships stock in many Linux distributions, can be used to watch for hostile processes opening this file in the proc file system, alerting on the pid, process name, and arguments of such programs.", "x_mitre_platforms": ["Windows", "Linux", "macOS"], "x_mitre_version": "1.0", "x_mitre_permissions_required": ["Administrator", "SYSTEM", "root"]}, {"created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5", "description": "[Cobalt Strike](https://attack.mitre.org/software/S0154) is a commercial, full-featured, penetration testing tool which bills itself as \u201cadversary simulation software designed to execute targeted attacks and emulate the post-exploitation actions of advanced threat actors\u201d. Cobalt Strike\u2019s interactive post-exploit capabilities cover the full range of ATT&CK tactics, all executed within a single, integrated system. (Citation: cobaltstrike manual)\n\nIn addition to its own capabilities, [Cobalt Strike](https://attack.mitre.org/software/S0154) leverages the capabilities of other well-known tools such as Metasploit and [Mimikatz](https://attack.mitre.org/software/S0002). (Citation: cobaltstrike manual)", "id": "tool--aafea02e-ece5-4bb2-91a6-3bf8c7f38a39", "external_references": [{"external_id": "S0154", "source_name": "mitre-attack", "url": "https://attack.mitre.org/software/S0154"}, {"source_name": "cobaltstrike manual", "description": "Strategic Cyber LLC. (2017, March 14). Cobalt Strike Manual. Retrieved May 24, 2017.", "url": "https://cobaltstrike.com/downloads/csmanual38.pdf"}], "modified": "2019-06-06T19:04:39.061Z", "type": "tool", "created": "2017-12-14T16:46:06.044Z", "object_marking_refs": ["marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"], "name": "Cobalt Strike", "labels": ["tool"], "x_mitre_version": "1.2", "x_mitre_platforms": ["Windows"], "x_mitre_aliases": ["Cobalt Strike"], "x_mitre_contributors": ["Josh Abraham"]}]}