{"objects": [{"name": "CobaltStrike Malleable OneDrive Browsing Traffic Profile", "description": "Detects Malleable OneDrive Profile", "created": "2019-11-12T00:00:00.000Z", "valid_from": "2019-11-12T00:00:00Z", "indicator_types": ["malicious-activity"], "pattern_type": "sigma", "pattern": "title: CobaltStrike Malleable OneDrive Browsing Traffic Profile\nid: c9b33401-cc6a-4cf6-83bb-57ddcb2407fc\nstatus: experimental\ndescription: Detects Malleable OneDrive Profile\nreferences:\n    - https://github.com/rsmudge/Malleable-C2-Profiles/blob/master/normal/onedrive_getonly.profile\nauthor: Markus Neis\ndate: 2019/11/12\ntags:\n    - attack.t1102\nlogsource:\n    category: proxy\ndetection:\n    selection:\n      cs-method: 'GET'\n      c-uri: '*?manifest=wac'\n      cs-host: 'onedrive.live.com'\n    filter:\n      c-uri: 'http*://onedrive.live.com/*'\n    condition: selection and not filter\nfalsepositives:\n    - Unknown\nlevel: high\n", "object_marking_refs": ["marking-definition--0a872d70-1d05-45dd-a25f-031af547a102"], "created_by_ref": "identity--082ca4f0-d825-45b6-aa42-ab9afd1e5503", "type": "indicator", "spec_version": "2.1", "id": "indicator--965f6649-a3f1-4379-8277-4ff4eef622b7", "modified": "2020-04-02T07:58:53.299Z"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--2bc41dda-e402-4dcd-a151-b5405bc4025b", "created": "2020-04-02T07:58:53.314Z", "modified": "2020-04-02T07:58:53.314Z", "source_ref": "indicator--965f6649-a3f1-4379-8277-4ff4eef622b7", "relationship_type": "indicates", "target_ref": "attack-pattern--830c9528-df21-472c-8c14-a036bf17d665"}, {"name": "Raw Paste Service Access", "description": "Detects direct access to raw pastes in different paste services often used by malware in their second stages to download malicious code in encrypted or encoded form", "created": "2019-12-05T00:00:00.000Z", "valid_from": "2019-12-05T00:00:00Z", "indicator_types": ["malicious-activity"], "pattern_type": "sigma", "pattern": "title: Raw Paste Service Access\nid: 5468045b-4fcc-4d1a-973c-c9c9578edacb\nstatus: experimental\ndescription: Detects direct access to raw pastes in different paste services often used by malware in their second stages to download malicious code in encrypted or encoded form\nreferences:\n    - https://www.virustotal.com/gui/domain/paste.ee/relations\nauthor: Florian Roth\ndate: 2019/12/05\ntags:\n  - attack.t1102\n  - attack.defense_evasion\nlogsource:\n    category: proxy\ndetection:\n    selection:\n        c-uri|contains: \n          - '.paste.ee/r/'\n          - '.pastebin.com/raw/'\n          - '.hastebin.com/raw/'\n          - '.ghostbin.co/paste/*/raw/'\n    condition: selection\nfields:\n    - ClientIP\n    - c-uri\n    - c-useragent\nfalsepositives:\n    - User activity (e.g. developer that shared and copied code snippets and used the raw link instead of just copy & paste)\nlevel: high\n", "object_marking_refs": ["marking-definition--0a872d70-1d05-45dd-a25f-031af547a102"], "created_by_ref": "identity--082ca4f0-d825-45b6-aa42-ab9afd1e5503", "type": "indicator", "spec_version": "2.1", "id": "indicator--47b74b44-2826-4b09-8759-e9223d83c58a", "modified": "2020-04-02T07:58:53.332Z"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--03271644-f1ce-4186-b250-d19050e64fad", "created": "2020-04-02T07:58:53.345Z", "modified": "2020-04-02T07:58:53.345Z", "source_ref": "indicator--47b74b44-2826-4b09-8759-e9223d83c58a", "relationship_type": "indicates", "target_ref": "attack-pattern--830c9528-df21-472c-8c14-a036bf17d665"}, {"name": "CobaltStrike Malleable (OCSP) Profile", "description": "Detects Malleable (OCSP) Profile with Typo (OSCP) in URL", "created": "2019-11-12T00:00:00.000Z", "valid_from": "2019-11-12T00:00:00Z", "indicator_types": ["malicious-activity"], "pattern_type": "sigma", "pattern": "title: CobaltStrike Malleable (OCSP) Profile\nid: 37325383-740a-403d-b1a2-b2b4ab7992e7\nstatus: experimental\ndescription: Detects Malleable (OCSP) Profile with Typo (OSCP) in URL\nreferences:\n    - https://github.com/rsmudge/Malleable-C2-Profiles/blob/master/normal/ocsp.profile\nauthor: Markus Neis\ndate: 2019/11/12\ntags:\n    - attack.t1102\nlogsource:\n    category: proxy\ndetection:\n    selection:\n      c-uri: '*/oscp/*'\n      cs-host: 'ocsp.verisign.com'\n\n    condition: selection\nfalsepositives:\n    - Unknown\nlevel: high\n", "object_marking_refs": ["marking-definition--0a872d70-1d05-45dd-a25f-031af547a102"], "created_by_ref": "identity--082ca4f0-d825-45b6-aa42-ab9afd1e5503", "type": "indicator", "spec_version": "2.1", "id": "indicator--121b6a8c-ff67-4ad8-bb41-432a5ae8a020", "modified": "2020-04-02T07:58:53.365Z"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--9cce10fa-0ef4-44a6-88b1-e96372b3a727", "created": "2020-04-02T07:58:53.380Z", "modified": "2020-04-02T07:58:53.380Z", "source_ref": "indicator--121b6a8c-ff67-4ad8-bb41-432a5ae8a020", "relationship_type": "indicates", "target_ref": "attack-pattern--830c9528-df21-472c-8c14-a036bf17d665"}, {"name": "CobaltStrike Malleable Amazon Browsing Traffic Profile", "description": "Detects Malleable Amazon Profile", "created": "2019-11-12T00:00:00.000Z", "valid_from": "2019-11-12T00:00:00Z", "indicator_types": ["malicious-activity"], "pattern_type": "sigma", "pattern": "title: CobaltStrike Malleable Amazon Browsing Traffic Profile\nid: 953b895e-5cc9-454b-b183-7f3db555452e\nstatus: experimental\ndescription: Detects Malleable Amazon Profile\nreferences:\n  - https://github.com/rsmudge/Malleable-C2-Profiles/blob/master/normal/amazon.profile\n  - https://www.hybrid-analysis.com/sample/ee5eca8648e45e2fea9dac0d920ef1a1792d8690c41ee7f20343de1927cc88b9?environmentId=100\nauthor: Markus Neis\ndate: 2019/11/12\ntags:\n  - attack.t1102\nlogsource:\n  category: proxy\ndetection:\n  selection1:\n    c-useragent: \"Mozilla/5.0 (Windows NT 6.1; WOW64; Trident/7.0; rv:11.0) like Gecko\"\n    cs-method: 'GET'\n    c-uri: '/s/ref=nb_sb_noss_1/167-3294888-0262949/field-keywords=books'\n    cs-host: 'www.amazon.com'\n    cs-cookie: '*=csm-hit=s-24KU11BB82RZSYGJ3BDK|1419899012996'\n  selection2:\n    c-useragent: \"Mozilla/5.0 (Windows NT 6.1; WOW64; Trident/7.0; rv:11.0) like Gecko\"\n    cs-method: 'POST'\n    c-uri: '/N4215/adj/amzn.us.sr.aps'\n    cs-host: 'www.amazon.com'\n  condition: selection1 or selection2\nfalsepositives:\n  - Unknown\nlevel: high\n", "object_marking_refs": ["marking-definition--0a872d70-1d05-45dd-a25f-031af547a102"], "created_by_ref": "identity--082ca4f0-d825-45b6-aa42-ab9afd1e5503", "type": "indicator", "spec_version": "2.1", "id": "indicator--cfbb8391-b9c9-40df-9eef-18c4eae2dd94", "modified": "2020-04-02T07:58:53.386Z"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--3dda5f69-dc0a-4b5a-89fa-c5253f037a00", "created": "2020-04-02T07:58:53.401Z", "modified": "2020-04-02T07:58:53.401Z", "source_ref": "indicator--cfbb8391-b9c9-40df-9eef-18c4eae2dd94", "relationship_type": "indicates", "target_ref": "attack-pattern--830c9528-df21-472c-8c14-a036bf17d665"}, {"name": "Oracle WebLogic Exploit", "description": "Detects access to a webshell dropped into a keystore folder on the WebLogic server", "created": "2018-07-22T00:00:00.000Z", "modified": "2020-03-14T00:00:00.000Z", "valid_from": "2018-07-22T00:00:00Z", "indicator_types": ["malicious-activity"], "pattern_type": "sigma", "pattern": "title: Oracle WebLogic Exploit\nid: 37e8369b-43bb-4bf8-83b6-6dd43bda2000\ndescription: Detects access to a webshell dropped into a keystore folder on the WebLogic server\nauthor: Florian Roth\ndate: 2018/07/22\nmodified: 2020/03/14\nstatus: experimental\nreferences:\n    - https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2018-2894\n    - https://twitter.com/pyn3rd/status/1020620932967223296\n    - https://github.com/LandGrey/CVE-2018-2894\nlogsource:\n    category: webserver\ndetection:\n    selection:\n        c-uri: \n            - '*/config/keystore/*.js*'\n    condition: selection\nfields:\n    - c-ip\n    - c-dns\nfalsepositives:\n    - Unknown\ntags:\n    - attack.t1100\n    - attack.t1190\n    - attack.initial_access\n    - attack.persistence\n    - attack.privilege_escalation\n    - cve.2018-2894\nlevel: critical\n\n", "object_marking_refs": ["marking-definition--0a872d70-1d05-45dd-a25f-031af547a102"], "created_by_ref": "identity--082ca4f0-d825-45b6-aa42-ab9afd1e5503", "type": "indicator", "spec_version": "2.1", "id": "indicator--adac9733-4249-4d7d-ade8-27718d66fd5a"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--00279b3f-d9e5-4f71-a4a9-294e4c75f1d1", "created": "2020-04-02T07:58:53.520Z", "modified": "2020-04-02T07:58:53.520Z", "source_ref": "indicator--adac9733-4249-4d7d-ade8-27718d66fd5a", "relationship_type": "indicates", "target_ref": "attack-pattern--c16e5409-ee53-4d79-afdc-4099dc9292df"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--46212ca7-7931-410a-8dc9-0d65d89c07af", "created": "2020-04-02T07:58:53.532Z", "modified": "2020-04-02T07:58:53.532Z", "source_ref": "indicator--adac9733-4249-4d7d-ade8-27718d66fd5a", "relationship_type": "indicates", "target_ref": "attack-pattern--3f886f2a-874f-4333-b794-aa6075009b1c"}, {"name": "CVE-2020-0688 Exchange Exploitation via Web Log", "description": "Detects the exploitation of Microsoft Exchange vulnerability as described in CVE-2020-0688", "created": "2020-02-29T00:00:00.000Z", "valid_from": "2020-02-29T00:00:00Z", "indicator_types": ["malicious-activity"], "pattern_type": "sigma", "pattern": "title: CVE-2020-0688 Exchange Exploitation via Web Log\nid: fce2c2e2-0fb5-41ab-a14c-5391e1fd70a5\nstatus: experimental\ndescription: Detects the exploitation of Microsoft Exchange vulnerability as described in CVE-2020-0688 \nreferences:\n    - https://www.trustedsec.com/blog/detecting-cve-20200688-remote-code-execution-vulnerability-on-microsoft-exchange-server/\nauthor: Florian Roth\ndate: 2020/02/29\nlogsource:\n    category: webserver\ndetection:\n    selection1:\n        cs-method: 'GET'\n        c-uri|contains:\n            - '/ecp/'\n            - '/owa/'\n    selection2: \n        c-uri|contains: '__VIEWSTATE=' \n    condition: selection1 and selection2\nfields:\n    - c-ip\n    - c-dns\nfalsepositives:\n    - Unknown\ntags:\n    - attack.initial_access\n    - attack.t1190\nlevel: critical\n\n", "object_marking_refs": ["marking-definition--0a872d70-1d05-45dd-a25f-031af547a102"], "created_by_ref": "identity--082ca4f0-d825-45b6-aa42-ab9afd1e5503", "type": "indicator", "spec_version": "2.1", "id": "indicator--7642cc30-0176-436f-93bb-7aeca096a8fa", "modified": "2020-04-02T07:58:53.542Z"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--5b82b7f1-6bb8-4b05-8184-37fb1d6cf5bd", "created": "2020-04-02T07:58:53.554Z", "modified": "2020-04-02T07:58:53.554Z", "source_ref": "indicator--7642cc30-0176-436f-93bb-7aeca096a8fa", "relationship_type": "indicates", "target_ref": "attack-pattern--3f886f2a-874f-4333-b794-aa6075009b1c"}, {"name": "CVE-2020-0688 Exploitation Attempt", "description": "Detects CVE-2020-0688 Exploitation attempts", "created": "2020-02-27T00:00:00.000Z", "valid_from": "2020-02-27T00:00:00Z", "indicator_types": ["malicious-activity"], "pattern_type": "sigma", "pattern": "title: CVE-2020-0688 Exploitation Attempt\nid: 7c64e577-d72e-4c3d-9d75-8de6d1f9146a\nstatus: experimental\ndescription: Detects CVE-2020-0688 Exploitation attempts\nreferences:\n  - https://github.com/Ridter/cve-2020-0688\nauthor: NVISO\ndate: 2020/02/27\ntags:\n  - attack.t1210\nlogsource:\n  category: webserver\ndetection:\n  selection:\n    c-uri|contains|all:\n      - \"/ecp/default.aspx\"\n      - \"__VIEWSTATEGENERATOR=\"\n      - \"__VIEWSTATE=\"\n  condition: selection\nfalsepositives:\n  - Unknown\nlevel: high\n", "object_marking_refs": ["marking-definition--0a872d70-1d05-45dd-a25f-031af547a102"], "created_by_ref": "identity--082ca4f0-d825-45b6-aa42-ab9afd1e5503", "type": "indicator", "spec_version": "2.1", "id": "indicator--7dc51020-cbe0-4eba-a321-98e25803f347", "modified": "2020-04-02T07:58:53.557Z"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--8a7f477c-738f-40bf-81cd-735f56bae094", "created": "2020-04-02T07:58:53.567Z", "modified": "2020-04-02T07:58:53.567Z", "source_ref": "indicator--7dc51020-cbe0-4eba-a321-98e25803f347", "relationship_type": "indicates", "target_ref": "attack-pattern--9db0cf3a-a3c9-4012-8268-123b9db6fd82"}, {"name": "Possible DNS Tunneling", "description": "Normally, DNS logs contain a limited amount of different dns queries for a single domain. This rule detects a high amount of queries for a single domain, which can be an indicator that DNS is used to transfer data.", "created": "2019-04-07T00:00:00.000Z", "valid_from": "2019-04-07T00:00:00Z", "indicator_types": ["malicious-activity"], "pattern_type": "sigma", "pattern": "title: Possible DNS Tunneling\nid: 1ec4b281-aa65-46a2-bdae-5fd830ed914e\nstatus: experimental\ndescription: Normally, DNS logs contain a limited amount of different dns queries for a single domain. This rule detects a high amount of queries for a single domain,\n    which can be an indicator that DNS is used to transfer data.\nreferences:\n    - https://zeltser.com/c2-dns-tunneling/\n    - https://patrick-bareiss.com/detect-c2-traffic-over-dns-using-sigma/\nauthor: Patrick Bareiss\ndate: 2019/04/07\nlogsource:\n    category: dns\ndetection:\n    selection:\n        parent_domain: '*'\n    condition: selection | count(dns_query) by parent_domain > 1000\nfalsepositives:\n    - Valid software, which uses dns for transferring data\nlevel: high\ntags:\n    - attack.t1048\n    - attack.exfiltration\n", "object_marking_refs": ["marking-definition--0a872d70-1d05-45dd-a25f-031af547a102"], "created_by_ref": "identity--082ca4f0-d825-45b6-aa42-ab9afd1e5503", "type": "indicator", "spec_version": "2.1", "id": "indicator--88e74b21-05ac-4341-8936-176d76d1b59c", "modified": "2020-04-02T07:58:53.574Z"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--21d4e3f2-cf0f-4a59-bda4-df2926c5f838", "created": "2020-04-02T07:58:53.587Z", "modified": "2020-04-02T07:58:53.587Z", "source_ref": "indicator--88e74b21-05ac-4341-8936-176d76d1b59c", "relationship_type": "indicates", "target_ref": "attack-pattern--a19e86f8-1c0a-4fea-8407-23b73d615776"}, {"name": "High NULL Records Requests Rate", "description": "Extremely high rate of NULL record type DNS requests from host per short period of time. Possible result of iodine tool execution", "created": "2019-10-24T00:00:00.000Z", "valid_from": "2019-10-24T00:00:00Z", "indicator_types": ["malicious-activity"], "pattern_type": "sigma", "pattern": "title: High NULL Records Requests Rate\nid: 44ae5117-9c44-40cf-9c7c-7edad385ca70\ndescription: Extremely high rate of NULL record type DNS requests from host per short period of time. Possible result of iodine tool execution\nstatus: experimental\nauthor: Daniil Yugoslavskiy, oscd.community\ndate: 2019/10/24\ntags:\n    - attack.exfiltration\n    - attack.t1048\nlogsource:\n    category: dns\ndetection:\n    selection:    \n        record_type: \"NULL\"\n    timeframe: 1m\n    condition: selection | count() by src_ip > 50\nfalsepositives:\n    - Legitimate high DNS NULL requests rate to domain name which should be added to whitelist\nlevel: medium\n", "object_marking_refs": ["marking-definition--0a872d70-1d05-45dd-a25f-031af547a102"], "created_by_ref": "identity--082ca4f0-d825-45b6-aa42-ab9afd1e5503", "type": "indicator", "spec_version": "2.1", "id": "indicator--3000f492-e9f8-4c0d-a217-b593f3bf47a4", "modified": "2020-04-02T07:58:53.590Z"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--dba169ae-4db2-4ed9-8e84-00d15d69e110", "created": "2020-04-02T07:58:53.602Z", "modified": "2020-04-02T07:58:53.602Z", "source_ref": "indicator--3000f492-e9f8-4c0d-a217-b593f3bf47a4", "relationship_type": "indicates", "target_ref": "attack-pattern--a19e86f8-1c0a-4fea-8407-23b73d615776"}, {"name": "Kerberos Network Traffic RC4 Ticket Encryption", "description": "Detects kerberos TGS request using RC4 encryption which may be indicative of kerberoasting", "created": "2020-02-12T00:00:00.000Z", "valid_from": "2020-02-12T00:00:00Z", "indicator_types": ["malicious-activity"], "pattern_type": "sigma", "pattern": "title: Kerberos Network Traffic RC4 Ticket Encryption\nid: 503fe26e-b5f2-4944-a126-eab405cc06e5\nstatus: experimental\ndate: 2020/02/12\ndescription: Detects kerberos TGS request using RC4 encryption which may be indicative of kerberoasting\nreferences:\n    - https://adsecurity.org/?p=3458\ntags:\n    - attack.credential_access\n    - attack.t1208\nlogsource:\n    product: zeek\n    service: kerberos\ndetection:\n    selection:\n        request_type: 'TGS'\n        cipher: 'rc4-hmac'\n    computer_acct:\n        service: '$*'\n    condition: selection and not computer_acct\nfalsepositives:\n    - normal enterprise SPN requests activity\nlevel: medium\n", "object_marking_refs": ["marking-definition--0a872d70-1d05-45dd-a25f-031af547a102"], "created_by_ref": "identity--082ca4f0-d825-45b6-aa42-ab9afd1e5503", "type": "indicator", "spec_version": "2.1", "id": "indicator--0b2529e2-e131-4041-9cf7-096f4b7dd5bf", "modified": "2020-04-02T07:58:53.608Z"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--a3314f03-dfe6-49aa-b2c0-12584849f028", "created": "2020-04-02T07:58:53.621Z", "modified": "2020-04-02T07:58:53.621Z", "source_ref": "indicator--0b2529e2-e131-4041-9cf7-096f4b7dd5bf", "relationship_type": "indicates", "target_ref": "attack-pattern--b39d03cb-7b98-41c4-a878-c40c1a913dc0"}, {"name": "DNS TXT Answer with Possible Execution Strings", "description": "Detects strings used in command execution in DNS TXT Answer", "created": "2018-08-08T00:00:00.000Z", "valid_from": "2018-08-08T00:00:00Z", "indicator_types": ["malicious-activity"], "pattern_type": "sigma", "pattern": "title: DNS TXT Answer with Possible Execution Strings\nid: 8ae51330-899c-4641-8125-e39f2e07da72\nstatus: experimental\ndescription: Detects strings used in command execution in DNS TXT Answer\nreferences:\n    - https://twitter.com/stvemillertime/status/1024707932447854592\n    - https://github.com/samratashok/nishang/blob/master/Backdoors/DNS_TXT_Pwnage.ps1\ntags:\n    - attack.t1071\nauthor: Markus Neis\ndate: 2018/08/08\nlogsource:\n    category: dns\ndetection:\n    selection:\n            record_type: 'TXT'\n            answer:\n                - '*IEX*'\n                - '*Invoke-Expression*'\n                - '*cmd.exe*'\n    condition: selection\nfalsepositives:\n    - Unknown\nlevel: high\n", "object_marking_refs": ["marking-definition--0a872d70-1d05-45dd-a25f-031af547a102"], "created_by_ref": "identity--082ca4f0-d825-45b6-aa42-ab9afd1e5503", "type": "indicator", "spec_version": "2.1", "id": "indicator--e807a61b-160d-400a-aac7-d8fe4b39e920", "modified": "2020-04-02T07:58:53.625Z"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--1ecc4188-b358-42d4-9857-818d54c591a2", "created": "2020-04-02T07:58:53.634Z", "modified": "2020-04-02T07:58:53.634Z", "source_ref": "indicator--e807a61b-160d-400a-aac7-d8fe4b39e920", "relationship_type": "indicates", "target_ref": "attack-pattern--355be19c-ffc9-46d5-8d50-d6a036c675b6"}, {"name": "Cisco Sniffing", "description": "Show when a monitor or a span/rspan is setup or modified", "created": "2019-08-11T00:00:00.000Z", "valid_from": "2019-08-11T00:00:00Z", "indicator_types": ["malicious-activity"], "pattern_type": "sigma", "pattern": "title: Cisco Sniffing\nid: b9e1f193-d236-4451-aaae-2f3d2102120d\nstatus: experimental\ndescription: Show when a monitor or a span/rspan is setup or modified\nreferences:\n    - https://attack.mitre.org/techniques/T1040\nauthor: Austin Clark\ndate: 2019/08/11\ntags:\n    - attack.credential_access\n    - attack.discovery\n    - attack.t1040\nlogsource:\n    product: cisco\n    service: aaa\n    category: accounting\nfields:\n    - CmdSet\ndetection:\n    keywords:\n        - 'monitor capture point'\n        - 'set span'\n        - 'set rspan'\n    condition: keywords\nfalsepositives:\n    - Admins may setup new or modify old spans, or use a monitor for troubleshooting.\nlevel: medium\n", "object_marking_refs": ["marking-definition--0a872d70-1d05-45dd-a25f-031af547a102"], "created_by_ref": "identity--082ca4f0-d825-45b6-aa42-ab9afd1e5503", "type": "indicator", "spec_version": "2.1", "id": "indicator--a55e4e04-2a66-4bbb-900e-3f0a5a22ca46", "modified": "2020-04-02T07:58:53.637Z"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--ccd137ab-8ec1-42e1-97a8-c4b18a9f9cf9", "created": "2020-04-02T07:58:53.649Z", "modified": "2020-04-02T07:58:53.649Z", "source_ref": "indicator--a55e4e04-2a66-4bbb-900e-3f0a5a22ca46", "relationship_type": "indicates", "target_ref": "attack-pattern--3257eb21-f9a7-4430-8de1-d8b6e288f529"}, {"name": "Cisco Denial of Service", "description": "Detect a system being shutdown or put into different boot mode", "created": "2019-08-15T00:00:00.000Z", "valid_from": "2019-08-15T00:00:00Z", "indicator_types": ["malicious-activity"], "pattern_type": "sigma", "pattern": "title: Cisco Denial of Service\nid: d94a35f0-7a29-45f6-90a0-80df6159967c\nstatus: experimental\ndescription: Detect a system being shutdown or put into different boot mode\nreferences:\n    - https://attack.mitre.org/techniques/T1499/\n    - https://attack.mitre.org/techniques/T1495/\nauthor: Austin Clark\ndate: 2019/08/15\ntags:\n    - attack.impact\n    - attack.t1499\n    - attack.t1495\nlogsource:\n    product: cisco\n    service: aaa\n    category: accounting\nfields:\n    - CmdSet\ndetection:\n    keywords:\n        - 'shutdown'\n        - 'config-register 0x2100'\n        - 'config-register 0x2142'\n    condition: keywords\nfalsepositives:\n    - Legitimate administrators may run these commands, though rarely.\nlevel: medium\n", "object_marking_refs": ["marking-definition--0a872d70-1d05-45dd-a25f-031af547a102"], "created_by_ref": "identity--082ca4f0-d825-45b6-aa42-ab9afd1e5503", "type": "indicator", "spec_version": "2.1", "id": "indicator--7e2c6dac-cbe6-4723-af4a-732d5aaefab0", "modified": "2020-04-02T07:58:53.652Z"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--08474dcc-024f-4263-b930-a36f0d56237d", "created": "2020-04-02T07:58:53.664Z", "modified": "2020-04-02T07:58:53.664Z", "source_ref": "indicator--7e2c6dac-cbe6-4723-af4a-732d5aaefab0", "relationship_type": "indicates", "target_ref": "attack-pattern--c675646d-e204-4aa8-978d-e3d6d65885c4"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--93e6e44b-f889-45b0-aba2-a26ccc3ec5bf", "created": "2020-04-02T07:58:53.674Z", "modified": "2020-04-02T07:58:53.674Z", "source_ref": "indicator--7e2c6dac-cbe6-4723-af4a-732d5aaefab0", "relationship_type": "indicates", "target_ref": "attack-pattern--f5bb433e-bdf6-4781-84bc-35e97e43be89"}, {"name": "Cisco Show Commands Input", "description": "See what commands are being input into the device by other people, full credentials can be in the history", "created": "2019-08-11T00:00:00.000Z", "valid_from": "2019-08-11T00:00:00Z", "indicator_types": ["malicious-activity"], "pattern_type": "sigma", "pattern": "title: Cisco Show Commands Input\nid: b094d9fb-b1ad-4650-9f1a-fb7be9f1d34b\nstatus: experimental\ndescription: See what commands are being input into the device by other people, full credentials can be in the history\nreferences:\n    - https://attack.mitre.org/techniques/T1056/\n    - https://attack.mitre.org/techniques/T1139/\nauthor: Austin Clark\ndate: 2019/08/11\ntags:\n    - attack.collection\n    - attack.credential_access\n    - attack.t1139\n    - attack.t1056\nlogsource:\n    product: cisco\n    service: aaa\n    category: accounting\nfields:\n    - CmdSet\ndetection:\n    keywords:\n        - 'show history'\n        - 'show history all'\n        - 'show logging'\n    condition: keywords\nfalsepositives:\n    - Not commonly run by administrators, especially if remote logging is configured.\nlevel: medium\n", "object_marking_refs": ["marking-definition--0a872d70-1d05-45dd-a25f-031af547a102"], "created_by_ref": "identity--082ca4f0-d825-45b6-aa42-ab9afd1e5503", "type": "indicator", "spec_version": "2.1", "id": "indicator--74c76b59-e6a3-4ac6-9740-718924c7cd97", "modified": "2020-04-02T07:58:53.680Z"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--76a06d3d-4308-4606-89cd-ce6493ed40de", "created": "2020-04-02T07:58:53.694Z", "modified": "2020-04-02T07:58:53.694Z", "source_ref": "indicator--74c76b59-e6a3-4ac6-9740-718924c7cd97", "relationship_type": "indicates", "target_ref": "attack-pattern--44dca04b-808d-46ca-b25f-d85236d4b9f8"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--383c580f-c42b-48c1-aed9-51dd24226cb8", "created": "2020-04-02T07:58:53.705Z", "modified": "2020-04-02T07:58:53.705Z", "source_ref": "indicator--74c76b59-e6a3-4ac6-9740-718924c7cd97", "relationship_type": "indicates", "target_ref": "attack-pattern--bb5a00de-e086-4859-a231-fa793f6797e2"}, {"name": "Cisco Modify Configuration", "description": "Modifications to a config that will serve an adversary's impacts or persistence", "created": "2019-08-12T00:00:00.000Z", "valid_from": "2019-08-12T00:00:00Z", "indicator_types": ["malicious-activity"], "pattern_type": "sigma", "pattern": "title: Cisco Modify Configuration\nid: 671ffc77-50a7-464f-9e3d-9ea2b493b26b\nstatus: experimental\ndescription: Modifications to a config that will serve an adversary's impacts or persistence\nreferences:\n    - https://attack.mitre.org/techniques/T1100/\n    - https://attack.mitre.org/techniques/T1168/\n    - https://attack.mitre.org/techniques/T1493/\nauthor: Austin Clark\ndate: 2019/08/12\ntags:\n    - attack.persistence\n    - attack.privilege_escalation\n    - attack.impact\n    - attack.t1493\n    - attack.t1100\n    - attack.t1168\n    - attack.t1490\nlogsource:\n    product: cisco\n    service: aaa\n    category: accounting\nfields:\n    - CmdSet\ndetection:\n    keywords:\n        - 'ip http server'\n        - 'ip https server'\n        - 'kron policy-list'\n        - 'kron occurrence'\n        - 'policy-list'\n        - 'access-list'\n        - 'ip access-group'\n        - 'archive maximum'\n    condition: keywords\nfalsepositives:\n    - Legitimate administrators may run these commands.\nlevel: medium\n", "object_marking_refs": ["marking-definition--0a872d70-1d05-45dd-a25f-031af547a102"], "created_by_ref": "identity--082ca4f0-d825-45b6-aa42-ab9afd1e5503", "type": "indicator", "spec_version": "2.1", "id": "indicator--3ae8a858-d40e-4624-9451-e8969c0e833e", "modified": "2020-04-02T07:58:53.710Z"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--fd1c45e0-2289-4faf-952d-48bcdd801b4b", "created": "2020-04-02T07:58:53.720Z", "modified": "2020-04-02T07:58:53.720Z", "source_ref": "indicator--3ae8a858-d40e-4624-9451-e8969c0e833e", "relationship_type": "indicates", "target_ref": "attack-pattern--cc1e737c-236c-4e3b-83ba-32039a626ef8"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--39028379-c219-4746-91b3-37294c6e480e", "created": "2020-04-02T07:58:53.733Z", "modified": "2020-04-02T07:58:53.733Z", "source_ref": "indicator--3ae8a858-d40e-4624-9451-e8969c0e833e", "relationship_type": "indicates", "target_ref": "attack-pattern--c16e5409-ee53-4d79-afdc-4099dc9292df"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--cad9e5f7-d2de-4ae2-8517-450718b59045", "created": "2020-04-02T07:58:53.743Z", "modified": "2020-04-02T07:58:53.743Z", "source_ref": "indicator--3ae8a858-d40e-4624-9451-e8969c0e833e", "relationship_type": "indicates", "target_ref": "attack-pattern--c0a384a4-9a25-40e1-97b6-458388474bc8"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--d6b201dc-c933-47d2-a8b9-c24fc31e636f", "created": "2020-04-02T07:58:53.753Z", "modified": "2020-04-02T07:58:53.753Z", "source_ref": "indicator--3ae8a858-d40e-4624-9451-e8969c0e833e", "relationship_type": "indicates", "target_ref": "attack-pattern--f5d8eed6-48a9-4cdf-a3d7-d1ffa99c3d2a"}, {"name": "Cisco Disabling Logging", "description": "Turn off logging locally or remote", "created": "2019-08-11T00:00:00.000Z", "valid_from": "2019-08-11T00:00:00Z", "indicator_types": ["malicious-activity"], "pattern_type": "sigma", "pattern": "title: Cisco Disabling Logging\nid: 9e8f6035-88bf-4a63-96b6-b17c0508257e\nstatus: experimental\ndescription: Turn off logging locally or remote\nreferences:\n    - https://attack.mitre.org/techniques/T1089\nauthor: Austin Clark\ndate: 2019/08/11\ntags:\n    - attack.defense_evasion\n    - attack.t1089\nlogsource:\n    product: cisco\n    service: aaa\n    category: accounting\nfields:\n    - src\n    - CmdSet\n    - User\n    - Privilege_Level\n    - Remote_Address\ndetection:\n    keywords:\n        - 'no logging'\n        - 'no aaa new-model'\n    condition: keywords\nfalsepositives:\n    - Unknown\nlevel: high\n", "object_marking_refs": ["marking-definition--0a872d70-1d05-45dd-a25f-031af547a102"], "created_by_ref": "identity--082ca4f0-d825-45b6-aa42-ab9afd1e5503", "type": "indicator", "spec_version": "2.1", "id": "indicator--5c1f3c71-44da-4164-8eb5-af5884220efa", "modified": "2020-04-02T07:58:53.756Z"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--09d1af1a-5f0c-4da4-9d20-4ad30023fb91", "created": "2020-04-02T07:58:53.768Z", "modified": "2020-04-02T07:58:53.768Z", "source_ref": "indicator--5c1f3c71-44da-4164-8eb5-af5884220efa", "relationship_type": "indicates", "target_ref": "attack-pattern--2e0dd10b-676d-4964-acd0-8a404c92b044"}, {"name": "Cisco Clear Logs", "description": "Clear command history in network OS which is used for defense evasion.", "created": "2019-08-12T00:00:00.000Z", "valid_from": "2019-08-12T00:00:00Z", "indicator_types": ["malicious-activity"], "pattern_type": "sigma", "pattern": "title: Cisco Clear Logs\nid: ceb407f6-8277-439b-951f-e4210e3ed956\nstatus: experimental\ndescription: Clear command history in network OS which is used for defense evasion.\nreferences:\n    - https://attack.mitre.org/techniques/T1146/\n    - https://attack.mitre.org/techniques/T1070/\nauthor: Austin Clark\ndate: 2019/08/12\ntags:\n    - attack.defense_evasion\n    - attack.t1146\n    - attack.t1070\nlogsource:\n    product: cisco\n    service: aaa\n    category: accounting\nfields:\n    - src\n    - CmdSet\n    - User\n    - Privilege_Level\n    - Remote_Address\ndetection:\n    keywords:\n        - 'clear logging'\n        - 'clear archive'\n    condition: keywords\nfalsepositives:\n    - Legitimate administrators may run these commands.\nlevel: high\n", "object_marking_refs": ["marking-definition--0a872d70-1d05-45dd-a25f-031af547a102"], "created_by_ref": "identity--082ca4f0-d825-45b6-aa42-ab9afd1e5503", "type": "indicator", "spec_version": "2.1", "id": "indicator--c54acb71-3ca1-4a20-bd70-8b7649966825", "modified": "2020-04-02T07:58:53.772Z"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--8b1b4f50-f130-4fbc-8011-6f6d384a4507", "created": "2020-04-02T07:58:53.785Z", "modified": "2020-04-02T07:58:53.785Z", "source_ref": "indicator--c54acb71-3ca1-4a20-bd70-8b7649966825", "relationship_type": "indicates", "target_ref": "attack-pattern--d3046a90-580c-4004-8208-66915bc29830"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--10db5094-ed14-40ca-a5df-e16a98030526", "created": "2020-04-02T07:58:53.797Z", "modified": "2020-04-02T07:58:53.797Z", "source_ref": "indicator--c54acb71-3ca1-4a20-bd70-8b7649966825", "relationship_type": "indicates", "target_ref": "attack-pattern--799ace7f-e227-4411-baa0-8868704f2a69"}, {"name": "Cisco Discovery", "description": "Find information about network devices that are not stored in config files.", "created": "2019-08-12T00:00:00.000Z", "valid_from": "2019-08-12T00:00:00Z", "indicator_types": ["malicious-activity"], "pattern_type": "sigma", "pattern": "title: Cisco Discovery\nid: 9705a6a1-6db6-4a16-a987-15b7151e299b\nstatus: experimental\ndescription: Find information about network devices that are not stored in config files.\nreferences:\n    - https://attack.mitre.org/tactics/TA0007/\nauthor: Austin Clark\ndate: 2019/08/12\ntags:\n    - attack.discovery\n    - attack.t1083\n    - attack.t1201\n    - attack.t1057\n    - attack.t1018\n    - attack.t1082\n    - attack.t1016\n    - attack.t1049\n    - attack.t1033\n    - attack.t1124\nlogsource:\n    product: cisco\n    service: aaa\n    category: accounting\nfields:\n    - src\n    - CmdSet\n    - User\n    - Privilege_Level\n    - Remote_Address\ndetection:\n    keywords:\n        - 'dir'\n        - 'show processes'\n        - 'show arp'\n        - 'show cdp'\n        - 'show version'\n        - 'show ip route'\n        - 'show ip interface'\n        - 'show ip sockets'\n        - 'show users'\n        - 'show ssh'\n        - 'show clock'\n    condition: keywords\nfalsepositives:\n    - Commonly used by administrators for troubleshooting\nlevel: low\n", "object_marking_refs": ["marking-definition--0a872d70-1d05-45dd-a25f-031af547a102"], "created_by_ref": "identity--082ca4f0-d825-45b6-aa42-ab9afd1e5503", "type": "indicator", "spec_version": "2.1", "id": "indicator--d66ee649-1d17-4e9d-a946-5cbc073d0f46", "modified": "2020-04-02T07:58:53.803Z"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--e94b415e-93c3-4471-a941-7c06be61b853", "created": "2020-04-02T07:58:53.816Z", "modified": "2020-04-02T07:58:53.816Z", "source_ref": "indicator--d66ee649-1d17-4e9d-a946-5cbc073d0f46", "relationship_type": "indicates", "target_ref": "attack-pattern--7bc57495-ea59-4380-be31-a64af124ef18"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--4fc2438e-f880-45e0-be3c-19cb9b4ce39e", "created": "2020-04-02T07:58:53.827Z", "modified": "2020-04-02T07:58:53.827Z", "source_ref": "indicator--d66ee649-1d17-4e9d-a946-5cbc073d0f46", "relationship_type": "indicates", "target_ref": "attack-pattern--b6075259-dba3-44e9-87c7-e954f37ec0d5"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--2b01a80b-beea-4ac1-9a6a-74a43df903c2", "created": "2020-04-02T07:58:53.839Z", "modified": "2020-04-02T07:58:53.839Z", "source_ref": "indicator--d66ee649-1d17-4e9d-a946-5cbc073d0f46", "relationship_type": "indicates", "target_ref": "attack-pattern--8f4a33ec-8b1f-4b80-a2f6-642b2e479580"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--73a88387-58d3-4bfe-81b4-0f8f9f674c08", "created": "2020-04-02T07:58:53.852Z", "modified": "2020-04-02T07:58:53.852Z", "source_ref": "indicator--d66ee649-1d17-4e9d-a946-5cbc073d0f46", "relationship_type": "indicates", "target_ref": "attack-pattern--e358d692-23c0-4a31-9eb6-ecc13a8d7735"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--1560eb1d-64f8-4406-88eb-b41a86a8bdec", "created": "2020-04-02T07:58:53.862Z", "modified": "2020-04-02T07:58:53.862Z", "source_ref": "indicator--d66ee649-1d17-4e9d-a946-5cbc073d0f46", "relationship_type": "indicates", "target_ref": "attack-pattern--354a7f88-63fb-41b5-a801-ce3b377b36f1"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--d1f15c00-2235-495b-a161-5e18997493e7", "created": "2020-04-02T07:58:53.875Z", "modified": "2020-04-02T07:58:53.875Z", "source_ref": "indicator--d66ee649-1d17-4e9d-a946-5cbc073d0f46", "relationship_type": "indicates", "target_ref": "attack-pattern--707399d6-ab3e-4963-9315-d9d3818cd6a0"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--2c02254c-95af-4f86-9526-955412f81858", "created": "2020-04-02T07:58:53.886Z", "modified": "2020-04-02T07:58:53.886Z", "source_ref": "indicator--d66ee649-1d17-4e9d-a946-5cbc073d0f46", "relationship_type": "indicates", "target_ref": "attack-pattern--7e150503-88e7-4861-866b-ff1ac82c4475"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--39144e9b-1c7d-426c-8620-86a247c7405d", "created": "2020-04-02T07:58:53.897Z", "modified": "2020-04-02T07:58:53.897Z", "source_ref": "indicator--d66ee649-1d17-4e9d-a946-5cbc073d0f46", "relationship_type": "indicates", "target_ref": "attack-pattern--03d7999c-1f4c-42cc-8373-e7690d318104"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--2b7adea7-ff0b-4df9-b65f-cb71f14e91dd", "created": "2020-04-02T07:58:53.909Z", "modified": "2020-04-02T07:58:53.909Z", "source_ref": "indicator--d66ee649-1d17-4e9d-a946-5cbc073d0f46", "relationship_type": "indicates", "target_ref": "attack-pattern--f3c544dc-673c-4ef3-accb-53229f1ae077"}, {"name": "Cisco Crypto Commands", "description": "Show when private keys are being exported from the device, or when new certificates are installed.", "created": "2019-08-12T00:00:00.000Z", "valid_from": "2019-08-12T00:00:00Z", "indicator_types": ["malicious-activity"], "pattern_type": "sigma", "pattern": "title: Cisco Crypto Commands\nid: 1f978c6a-4415-47fb-aca5-736a44d7ca3d\nstatus: experimental\ndescription: Show when private keys are being exported from the device, or when new certificates are installed.\nreferences:\n    - https://attack.mitre.org/techniques/T1145/\n    - https://attack.mitre.org/techniques/T1130/\nauthor: Austin Clark\ndate: 2019/08/12\ntags:\n    - attack.credential_access\n    - attack.defense_evasion\n    - attack.t1130\n    - attack.t1145\nlogsource:\n    product: cisco\n    service: aaa\n    category: accounting\nfields:\n    - src\n    - CmdSet\n    - User\n    - Privilege_Level\n    - Remote_Address\ndetection:\n    keywords:\n        - 'crypto pki export'\n        - 'crypto pki import'\n        - 'crypto pki trustpoint'\n    condition: keywords\nfalsepositives:\n    - Not commonly run by administrators.  Also whitelist your known good certificates.\nlevel: high\n", "object_marking_refs": ["marking-definition--0a872d70-1d05-45dd-a25f-031af547a102"], "created_by_ref": "identity--082ca4f0-d825-45b6-aa42-ab9afd1e5503", "type": "indicator", "spec_version": "2.1", "id": "indicator--2fb7d086-da27-402b-997e-ed5e99e8fddd", "modified": "2020-04-02T07:58:53.914Z"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--d1430eee-47b9-4125-a5dc-0a27052022b6", "created": "2020-04-02T07:58:53.928Z", "modified": "2020-04-02T07:58:53.928Z", "source_ref": "indicator--2fb7d086-da27-402b-997e-ed5e99e8fddd", "relationship_type": "indicates", "target_ref": "attack-pattern--d519cfd5-f3a8-43a9-a846-ed0bb40672b1"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--04301fbe-8e2d-41d0-a8c0-c9cf728dfcce", "created": "2020-04-02T07:58:53.940Z", "modified": "2020-04-02T07:58:53.940Z", "source_ref": "indicator--2fb7d086-da27-402b-997e-ed5e99e8fddd", "relationship_type": "indicates", "target_ref": "attack-pattern--56ff457d-5e39-492b-974c-dfd2b8603ffe"}, {"name": "Cisco Show Commands Input", "description": "See what files are being deleted from flash file systems", "created": "2019-08-12T00:00:00.000Z", "valid_from": "2019-08-12T00:00:00Z", "indicator_types": ["malicious-activity"], "pattern_type": "sigma", "pattern": "title: Cisco Show Commands Input\nid: 71d65515-c436-43c0-841b-236b1f32c21e\nstatus: experimental\ndescription: See what files are being deleted from flash file systems\nreferences:\n    - https://attack.mitre.org/techniques/T1107/\n    - https://attack.mitre.org/techniques/T1488/\n    - https://attack.mitre.org/techniques/T1487/\nauthor: Austin Clark\ndate: 2019/08/12\ntags:\n    - attack.defense_evasion\n    - attack.impact\n    - attack.t1107\n    - attack.t1488\n    - attack.t1487\nlogsource:\n    product: cisco\n    service: aaa\n    category: accounting\nfields:\n    - CmdSet\ndetection:\n    keywords:\n        - 'erase'\n        - 'delete'\n        - 'format'\n    condition: keywords\nfalsepositives:\n    - Will be used sometimes by admins to clean up local flash space.\nlevel: medium\n", "object_marking_refs": ["marking-definition--0a872d70-1d05-45dd-a25f-031af547a102"], "created_by_ref": "identity--082ca4f0-d825-45b6-aa42-ab9afd1e5503", "type": "indicator", "spec_version": "2.1", "id": "indicator--207e927c-608a-48dc-a9ca-13ccda08f078", "modified": "2020-04-02T07:58:53.944Z"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--eff8f906-01d3-460a-b4be-b0f5f5174d81", "created": "2020-04-02T07:58:53.955Z", "modified": "2020-04-02T07:58:53.955Z", "source_ref": "indicator--207e927c-608a-48dc-a9ca-13ccda08f078", "relationship_type": "indicates", "target_ref": "attack-pattern--56fca983-1cf1-4fd1-bda0-5e170a37ab59"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--87f3b3e8-cbc1-4f87-9f06-95675b816118", "created": "2020-04-02T07:58:53.967Z", "modified": "2020-04-02T07:58:53.967Z", "source_ref": "indicator--207e927c-608a-48dc-a9ca-13ccda08f078", "relationship_type": "indicates", "target_ref": "attack-pattern--b82f7d37-b826-4ec9-9391-8e121c78aed7"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--ad14d9c8-18f1-4848-9602-7526f4de7e50", "created": "2020-04-02T07:58:53.978Z", "modified": "2020-04-02T07:58:53.978Z", "source_ref": "indicator--207e927c-608a-48dc-a9ca-13ccda08f078", "relationship_type": "indicates", "target_ref": "attack-pattern--2e114e45-2c50-404c-804a-3af9564d240e"}, {"name": "Cisco Stage Data", "description": "Various protocols maybe used to put data on the device for exfil or infil", "created": "2019-08-12T00:00:00.000Z", "valid_from": "2019-08-12T00:00:00Z", "indicator_types": ["malicious-activity"], "pattern_type": "sigma", "pattern": "title: Cisco Stage Data\nid: 5e51acb2-bcbe-435b-99c6-0e3cd5e2aa59\nstatus: experimental\ndescription: Various protocols maybe used to put data on the device for exfil or infil\nreferences:\n    - https://attack.mitre.org/techniques/T1074/\n    - https://attack.mitre.org/techniques/T1105/\n    - https://attack.mitre.org/techniques/T1498/\n    - https://attack.mitre.org/techniques/T1002/\nauthor: Austin Clark\ndate: 2019/08/12\ntags:\n    - attack.collection\n    - attack.lateral_movement\n    - attack.command_and_control\n    - attack.exfiltration\n    - attack.impact\n    - attack.t1074\n    - attack.t1105\n    - attack.t1492\n    - attack.t1002\nlogsource:\n    product: cisco\n    service: aaa\n    category: accounting\nfields:\n    - CmdSet\ndetection:\n    keywords:\n        - 'tftp'\n        - 'rcp'\n        - 'puts'\n        - 'copy'\n        - 'configure replace'\n        - 'archive tar'\n    condition: keywords\nfalsepositives:\n    - Generally used to copy configs or IOS images.\nlevel: low\n", "object_marking_refs": ["marking-definition--0a872d70-1d05-45dd-a25f-031af547a102"], "created_by_ref": "identity--082ca4f0-d825-45b6-aa42-ab9afd1e5503", "type": "indicator", "spec_version": "2.1", "id": "indicator--d7dda677-ece6-48f0-99a7-54ee14d40053", "modified": "2020-04-02T07:58:53.984Z"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--baf5c3e1-424c-4b82-a0f1-f24c27ba7918", "created": "2020-04-02T07:58:53.994Z", "modified": "2020-04-02T07:58:53.994Z", "source_ref": "indicator--d7dda677-ece6-48f0-99a7-54ee14d40053", "relationship_type": "indicates", "target_ref": "attack-pattern--7dd95ff6-712e-4056-9626-312ea4ab4c5e"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--b27aae64-7282-4c01-b0e3-9bf93fc8566e", "created": "2020-04-02T07:58:54.005Z", "modified": "2020-04-02T07:58:54.005Z", "source_ref": "indicator--d7dda677-ece6-48f0-99a7-54ee14d40053", "relationship_type": "indicates", "target_ref": "attack-pattern--e6919abc-99f9-4c6c-95a5-14761e7b2add"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--1fa6e880-b97c-4389-bff9-5611a4b3b74d", "created": "2020-04-02T07:58:54.013Z", "modified": "2020-04-02T07:58:54.013Z", "source_ref": "indicator--d7dda677-ece6-48f0-99a7-54ee14d40053", "relationship_type": "indicates", "target_ref": "attack-pattern--0bf78622-e8d2-41da-a857-731472d61a92"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--312cc0b5-78d3-48c0-b352-1d23b8a1aeaa", "created": "2020-04-02T07:58:54.021Z", "modified": "2020-04-02T07:58:54.021Z", "source_ref": "indicator--d7dda677-ece6-48f0-99a7-54ee14d40053", "relationship_type": "indicates", "target_ref": "attack-pattern--b9f5dbe2-4c55-4fc5-af2e-d42c1d182ec4"}, {"name": "Cisco Collect Data", "description": "Collect pertinent data from the configuration files", "created": "2019-08-11T00:00:00.000Z", "valid_from": "2019-08-11T00:00:00Z", "indicator_types": ["malicious-activity"], "pattern_type": "sigma", "pattern": "title: Cisco Collect Data\nid: cd072b25-a418-4f98-8ebc-5093fb38fe1a\nstatus: experimental\ndescription: Collect pertinent data from the configuration files\nreferences:\n    - https://attack.mitre.org/techniques/T1087/\n    - https://attack.mitre.org/techniques/T1003/\n    - https://attack.mitre.org/techniques/T1081/\n    - https://attack.mitre.org/techniques/T1005/\nauthor: Austin Clark\ndate: 2019/08/11\ntags:\n    - attack.discovery\n    - attack.credential_access\n    - attack.collection\n    - attack.t1087\n    - attack.t1003\n    - attack.t1081\n    - attack.t1005\nlogsource:\n    product: cisco\n    service: aaa\n    category: accounting\nfields:\n    - src\n    - CmdSet\n    - User\n    - Privilege_Level\n    - Remote_Address\ndetection:\n    keywords:\n        - 'show running-config'\n        - 'show startup-config'\n        - 'show archive config'\n        - 'more'\n    condition: keywords\nfalsepositives:\n    - Commonly run by administrators.\nlevel: low\n", "object_marking_refs": ["marking-definition--0a872d70-1d05-45dd-a25f-031af547a102"], "created_by_ref": "identity--082ca4f0-d825-45b6-aa42-ab9afd1e5503", "type": "indicator", "spec_version": "2.1", "id": "indicator--ebebfdd7-7705-40f1-9d61-42c264e193f2", "modified": "2020-04-02T07:58:54.026Z"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--9d7b1d9d-f6a5-4de5-97e3-6bb2426a53a1", "created": "2020-04-02T07:58:54.036Z", "modified": "2020-04-02T07:58:54.036Z", "source_ref": "indicator--ebebfdd7-7705-40f1-9d61-42c264e193f2", "relationship_type": "indicates", "target_ref": "attack-pattern--72b74d71-8169-42aa-92e0-e7b04b9f5a08"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--2eaca454-4a77-4ef8-ab0d-06e8bb2889e6", "created": "2020-04-02T07:58:54.046Z", "modified": "2020-04-02T07:58:54.046Z", "source_ref": "indicator--ebebfdd7-7705-40f1-9d61-42c264e193f2", "relationship_type": "indicates", "target_ref": "attack-pattern--0a3ead4e-6d47-4ccb-854c-a6a4f9d96b22"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--83e53ba4-7730-4392-aac9-86a6922bd08f", "created": "2020-04-02T07:58:54.054Z", "modified": "2020-04-02T07:58:54.054Z", "source_ref": "indicator--ebebfdd7-7705-40f1-9d61-42c264e193f2", "relationship_type": "indicates", "target_ref": "attack-pattern--ba8e391f-14b5-496f-81f2-2d5ecd646c1c"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--09964b3c-e90f-49f6-884a-57a183ca6e86", "created": "2020-04-02T07:58:54.062Z", "modified": "2020-04-02T07:58:54.062Z", "source_ref": "indicator--ebebfdd7-7705-40f1-9d61-42c264e193f2", "relationship_type": "indicates", "target_ref": "attack-pattern--3c4a2599-71ee-4405-ba1e-0e28414b4bc5"}, {"name": "Cisco Local Accounts", "description": "Find local accounts being created or modified as well as remote authentication configurations", "created": "2019-08-12T00:00:00.000Z", "valid_from": "2019-08-12T00:00:00Z", "indicator_types": ["malicious-activity"], "pattern_type": "sigma", "pattern": "title: Cisco Local Accounts\nid: 6d844f0f-1c18-41af-8f19-33e7654edfc3\nstatus: experimental\ndescription: Find local accounts being created or modified as well as remote authentication configurations\nreferences:\n    - https://attack.mitre.org/techniques/T1098/\n    - https://attack.mitre.org/techniques/T1136/\nauthor: Austin Clark\ndate: 2019/08/12\ntags:\n    - attack.persistence\n    - attack.t1136\n    - attack.t1098\nlogsource:\n    product: cisco\n    service: aaa\n    category: accounting\nfields:\n    - CmdSet\ndetection:\n    keywords:\n        - 'username'\n        - 'aaa'\n    condition: keywords\nfalsepositives:\n    - When remote authentication is in place, this should not change often.\nlevel: high\n", "object_marking_refs": ["marking-definition--0a872d70-1d05-45dd-a25f-031af547a102"], "created_by_ref": "identity--082ca4f0-d825-45b6-aa42-ab9afd1e5503", "type": "indicator", "spec_version": "2.1", "id": "indicator--b45b8257-d66f-4899-8570-d11f835165f8", "modified": "2020-04-02T07:58:54.066Z"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--476b74cd-5ca1-4453-a812-818add7febfa", "created": "2020-04-02T07:58:54.076Z", "modified": "2020-04-02T07:58:54.076Z", "source_ref": "indicator--b45b8257-d66f-4899-8570-d11f835165f8", "relationship_type": "indicates", "target_ref": "attack-pattern--e01be9c5-e763-4caf-aeb7-000b416aef67"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--2d9fa957-09eb-46bb-b965-cdf6d10ac720", "created": "2020-04-02T07:58:54.086Z", "modified": "2020-04-02T07:58:54.086Z", "source_ref": "indicator--b45b8257-d66f-4899-8570-d11f835165f8", "relationship_type": "indicates", "target_ref": "attack-pattern--a10641f4-87b4-45a3-a906-92a149cb2c27"}, {"name": "High TXT Records Requests Rate", "description": "Extremely high rate of TXT record type DNS requests from host per short period of time. Possible result of Do-exfiltration tool execution", "created": "2019-10-24T00:00:00.000Z", "valid_from": "2019-10-24T00:00:00Z", "indicator_types": ["malicious-activity"], "pattern_type": "sigma", "pattern": "title: High TXT Records Requests Rate\nid: f0a8cedc-1d22-4453-9c44-8d9f4ebd5d35\ndescription: Extremely high rate of TXT record type DNS requests from host per short period of time. Possible result of Do-exfiltration tool execution\nstatus: experimental\nauthor: Daniil Yugoslavskiy, oscd.community\ndate: 2019/10/24\ntags:\n    - attack.exfiltration\n    - attack.t1048\nlogsource:\n    category: dns\ndetection:\n    selection:\n        record_type: \"TXT\"\n    timeframe: 1m\n    condition: selection | count() by src_ip > 50\nfalsepositives:\n    - Legitimate high DNS TXT requests rate to domain name which should be added to whitelist\nlevel: medium\n", "object_marking_refs": ["marking-definition--0a872d70-1d05-45dd-a25f-031af547a102"], "created_by_ref": "identity--082ca4f0-d825-45b6-aa42-ab9afd1e5503", "type": "indicator", "spec_version": "2.1", "id": "indicator--72cbd7db-d296-4d33-a342-255eb66169f1", "modified": "2020-04-02T07:58:54.088Z"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--fc34e698-a638-4880-9e73-4c6d8b7cf04e", "created": "2020-04-02T07:58:54.098Z", "modified": "2020-04-02T07:58:54.098Z", "source_ref": "indicator--72cbd7db-d296-4d33-a342-255eb66169f1", "relationship_type": "indicates", "target_ref": "attack-pattern--a19e86f8-1c0a-4fea-8407-23b73d615776"}, {"name": "Equation Group C2 Communication", "description": "Detects communication to C2 servers mentioned in the operational notes of the ShadowBroker leak of EquationGroup C2 tools", "created": "2017-04-15T00:00:00.000Z", "valid_from": "2017-04-15T00:00:00Z", "indicator_types": ["malicious-activity"], "pattern_type": "sigma", "pattern": "title: Equation Group C2 Communication\nid: 881834a4-6659-4773-821e-1c151789d873\ndescription: Detects communication to C2 servers mentioned in the operational notes of the ShadowBroker leak of EquationGroup C2 tools\nreferences:\n    - https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\n    - https://medium.com/@msuiche/the-nsa-compromised-swift-network-50ec3000b195\ntags:\n    - attack.command_and_control\n    - attack.g0020\nauthor: Florian Roth\ndate: 2017/04/15\nlogsource:\n    category: firewall\ndetection:\n    outgoing:\n        dst_ip:\n            - '69.42.98.86'\n            - '89.185.234.145'\n    incoming:\n        src_ip:\n            - '69.42.98.86'\n            - '89.185.234.145'\n    condition: 1 of them\nfalsepositives:\n    - Unknown\nlevel: high\n", "object_marking_refs": ["marking-definition--0a872d70-1d05-45dd-a25f-031af547a102"], "created_by_ref": "identity--082ca4f0-d825-45b6-aa42-ab9afd1e5503", "type": "indicator", "spec_version": "2.1", "id": "indicator--a86c1d5c-691a-4c4b-a87f-e9841d63e115", "modified": "2020-04-02T07:58:54.101Z"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--3d5fd379-b194-4f0e-88c8-3adcf9a927fe", "created": "2020-04-02T07:58:54.113Z", "modified": "2020-04-02T07:58:54.113Z", "source_ref": "indicator--a86c1d5c-691a-4c4b-a87f-e9841d63e115", "relationship_type": "indicates", "target_ref": "intrusion-set--96e239be-ad99-49eb-b127-3007b8c1bec9"}, {"name": "High DNS Bytes Out", "description": "High DNS queries bytes amount from host per short period of time", "created": "2019-10-24T00:00:00.000Z", "valid_from": "2019-10-24T00:00:00Z", "indicator_types": ["malicious-activity"], "pattern_type": "sigma", "pattern": "action: global\ntitle: High DNS Bytes Out\nid: 0f6c1bf5-70a5-4963-aef9-aab1eefb50bd\ndescription: High DNS queries bytes amount from host per short period of time\nstatus: experimental\nauthor: Daniil Yugoslavskiy, oscd.community\ndate: 2019/10/24\ntags:\n    - attack.exfiltration\n    - attack.t1048\nfalsepositives:\n    - Legitimate high DNS bytes out rate to domain name which should be added to whitelist\nlevel: medium\n", "object_marking_refs": ["marking-definition--0a872d70-1d05-45dd-a25f-031af547a102"], "created_by_ref": "identity--082ca4f0-d825-45b6-aa42-ab9afd1e5503", "type": "indicator", "spec_version": "2.1", "id": "indicator--30174d1a-27f5-4e19-bb1b-eee5bcb0462a", "modified": "2020-04-02T07:58:54.119Z"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--71bf9253-152b-44cf-ac8f-201771e8eb4f", "created": "2020-04-02T07:58:54.129Z", "modified": "2020-04-02T07:58:54.129Z", "source_ref": "indicator--30174d1a-27f5-4e19-bb1b-eee5bcb0462a", "relationship_type": "indicates", "target_ref": "attack-pattern--a19e86f8-1c0a-4fea-8407-23b73d615776"}, {"name": "High DNS Requests Rate", "description": "High DNS requests amount from host per short period of time", "created": "2019-10-24T00:00:00.000Z", "valid_from": "2019-10-24T00:00:00Z", "indicator_types": ["malicious-activity"], "pattern_type": "sigma", "pattern": "action: global\ntitle: High DNS Requests Rate\nid: b4163085-4001-46a3-a79a-55d8bbbc7a3a\ndescription: High DNS requests amount from host per short period of time\nstatus: experimental\nauthor: Daniil Yugoslavskiy, oscd.community\ndate: 2019/10/24\ntags:\n    - attack.exfiltration\n    - attack.t1048\nfalsepositives:\n    - Legitimate high DNS requests rate to domain name which should be added to whitelist\nlevel: medium\n", "object_marking_refs": ["marking-definition--0a872d70-1d05-45dd-a25f-031af547a102"], "created_by_ref": "identity--082ca4f0-d825-45b6-aa42-ab9afd1e5503", "type": "indicator", "spec_version": "2.1", "id": "indicator--f2f33ec0-a4b8-46ab-a90d-51234df7410c", "modified": "2020-04-02T07:58:54.137Z"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--e3210d56-ea75-44d7-9449-b4f4f10e87c1", "created": "2020-04-02T07:58:54.149Z", "modified": "2020-04-02T07:58:54.149Z", "source_ref": "indicator--f2f33ec0-a4b8-46ab-a90d-51234df7410c", "relationship_type": "indicates", "target_ref": "attack-pattern--a19e86f8-1c0a-4fea-8407-23b73d615776"}, {"name": "Cleartext Protocol Usage", "description": "Ensure that all account usernames and authentication credentials are transmitted across networks using encrypted channels. Ensure that an encryption is used for all sensitive information in transit. Ensure that an encrypted channels is used  for all administrative account access.", "created": "2019-03-26T00:00:00.000Z", "valid_from": "2019-03-26T00:00:00Z", "indicator_types": ["malicious-activity"], "pattern_type": "sigma", "pattern": "action: global\ntitle: Cleartext Protocol Usage\nid: 7e4bfe58-4a47-4709-828d-d86c78b7cc1f\ndescription: Ensure that all account usernames and authentication credentials are transmitted across networks using encrypted channels. Ensure that an encryption\n    is used for all sensitive information in transit. Ensure that an encrypted channels is used  for all administrative account access.\nreferences:\n    - https://www.cisecurity.org/controls/cis-controls-list/\n    - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf\n    - https://nvlpubs.nist.gov/nistpubs/CSWP/NIST.CSWP.04162018.pdf\nauthor: Alexandr Yampolskyi, SOC Prime\nstatus: stable\ndate: 2019/03/26\nfalsepositives:\n    - unknown\nlevel: low\ntags:\n    - CSC4\n    - CSC4.5\n    - CSC14\n    - CSC14.4\n    - CSC16\n    - CSC16.5\n    - NIST CSF 1.1 PR.AT-2\n    - NIST CSF 1.1 PR.MA-2\n    - NIST CSF 1.1 PR.PT-3\n    - NIST CSF 1.1 PR.AC-1\n    - NIST CSF 1.1 PR.AC-4\n    - NIST CSF 1.1 PR.AC-5\n    - NIST CSF 1.1 PR.AC-6\n    - NIST CSF 1.1 PR.AC-7\n    - NIST CSF 1.1 PR.DS-1\n    - NIST CSF 1.1 PR.DS-2\n    - NIST CSF 1.1 PR.PT-3\n    - NIST CSF 1.1 PR.PT-3\n    - ISO 27002-2013 A.9.2.1\n    - ISO 27002-2013 A.9.2.2\n    - ISO 27002-2013 A.9.2.3\n    - ISO 27002-2013 A.9.2.4\n    - ISO 27002-2013 A.9.2.5\n    - ISO 27002-2013 A.9.2.6\n    - ISO 27002-2013 A.9.3.1\n    - ISO 27002-2013 A.9.4.1\n    - ISO 27002-2013 A.9.4.2\n    - ISO 27002-2013 A.9.4.3\n    - ISO 27002-2013 A.9.4.4\n    - ISO 27002-2013 A.8.3.1\n    - ISO 27002-2013 A.9.1.1\n    - ISO 27002-2013 A.10.1.1\n    - PCI DSS 3.2 2.1\n    - PCI DSS 3.2 8.1\n    - PCI DSS 3.2 8.2\n    - PCI DSS 3.2 8.3\n    - PCI DSS 3.2 8.7\n    - PCI DSS 3.2 8.8\n    - PCI DSS 3.2 1.3\n    - PCI DSS 3.2 1.4\n    - PCI DSS 3.2 4.3\n    - PCI DSS 3.2 7.1\n    - PCI DSS 3.2 7.2\n    - PCI DSS 3.2 7.3\n", "object_marking_refs": ["marking-definition--0a872d70-1d05-45dd-a25f-031af547a102"], "created_by_ref": "identity--082ca4f0-d825-45b6-aa42-ab9afd1e5503", "type": "indicator", "spec_version": "2.1", "id": "indicator--200be8d2-69a7-4616-a8ed-2003664d16b4", "modified": "2020-04-02T07:58:54.162Z"}, {"name": "Group Modification Logging", "description": "Configure systems to issue a log entry and alert when an account is added to or removed from any group assigned administrative privileges. Sigma detects Event ID 4728 indicates a \u2018Member is added to a Security Group\u2019. Event ID 4729 indicates a \u2018Member is removed from a Security enabled-group\u2019. Event ID 4730 indicates a\u2018Security Group is deleted\u2019. The case is not applicable for Unix OS. Supported OS - Windows 2008 R2 and 7, Windows 2012 R2 and 8.1, Windows 2016 and 10 Windows Server 2019, Windows Server 2000, Windows 2003 and XP.", "created": "2019-03-26T00:00:00.000Z", "valid_from": "2019-03-26T00:00:00Z", "indicator_types": ["malicious-activity"], "pattern_type": "sigma", "pattern": "title: Group Modification Logging\nid: 9cf01b6c-e723-4841-a868-6d7f8245ca6e\ndescription: \"Configure systems to issue a log entry and alert when an account is added to or removed from any group assigned administrative privileges. Sigma detects\\\n    \\ Event ID 4728 indicates a \\u2018Member is added to a Security Group\\u2019. Event ID 4729 indicates a \\u2018Member is removed from a Security enabled-group\\u2019\\\n    . Event ID 4730 indicates a\\u2018Security Group is deleted\\u2019. The case is not applicable for Unix OS. Supported OS - Windows 2008 R2 and 7, Windows 2012 R2\\\n    \\ and 8.1, Windows 2016 and 10 Windows Server 2019, Windows Server 2000, Windows 2003 and XP.\"\nauthor: Alexandr Yampolskyi, SOC Prime\nstatus: stable\nreferences:\n    - https://www.cisecurity.org/controls/cis-controls-list/\n    - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf\n    - https://nvlpubs.nist.gov/nistpubs/CSWP/NIST.CSWP.04162018.pdf\n    - https://www.ultimatewindowssecurity.com/securitylog/encyclopedia/event.aspx?eventID=4728\n    - https://www.ultimatewindowssecurity.com/securitylog/encyclopedia/event.aspx?eventID=4729\n    - https://www.ultimatewindowssecurity.com/securitylog/encyclopedia/event.aspx?eventID=4730\n    - https://www.ultimatewindowssecurity.com/securitylog/encyclopedia/event.aspx?eventID=633\n    - https://www.ultimatewindowssecurity.com/securitylog/encyclopedia/event.aspx?eventID=632\n    - https://www.ultimatewindowssecurity.com/securitylog/encyclopedia/event.aspx?eventID=634\ndate: 2019/03/26\nlogsource:\n    product: windows\n    service: security\ndetection:\n    selection:\n        EventID:\n            - 4728\n            - 4729\n            - 4730\n            - 633\n            - 632\n            - 634\n    condition: selection\nfalsepositives:\n    - unknown\nlevel: low\ntags:\n    - CSC4\n    - CSC4.8\n    - NIST CSF 1.1 PR.AC-4\n    - NIST CSF 1.1 PR.AT-2\n    - NIST CSF 1.1 PR.MA-2\n    - NIST CSF 1.1 PR.PT-3\n    - ISO 27002-2013 A.9.1.1\n    - ISO 27002-2013 A.9.2.2\n    - ISO 27002-2013 A.9.2.3\n    - ISO 27002-2013 A.9.2.4\n    - ISO 27002-2013 A.9.2.5\n    - ISO 27002-2013 A.9.2.6\n    - ISO 27002-2013 A.9.3.1\n    - ISO 27002-2013 A.9.4.1\n    - ISO 27002-2013 A.9.4.2\n    - ISO 27002-2013 A.9.4.3\n    - ISO 27002-2013 A.9.4.4\n    - PCI DSS 3.2 2.1\n    - PCI DSS 3.2 7.1\n    - PCI DSS 3.2 7.2\n    - PCI DSS 3.2 7.3\n    - PCI DSS 3.2 8.1\n    - PCI DSS 3.2 8.2\n    - PCI DSS 3.2 8.3\n    - PCI DSS 3.2 8.7\n", "object_marking_refs": ["marking-definition--0a872d70-1d05-45dd-a25f-031af547a102"], "created_by_ref": "identity--082ca4f0-d825-45b6-aa42-ab9afd1e5503", "type": "indicator", "spec_version": "2.1", "id": "indicator--52ef700e-f687-4220-b2f6-6d6aaafbdc56", "modified": "2020-04-02T07:58:54.175Z"}, {"name": "Host Without Firewall", "description": "Host Without Firewall. Alert means not complied. Sigma for Qualys vulnerability scanner. Scan type - Vulnerability Management.", "created": "2019-03-19T00:00:00.000Z", "valid_from": "2019-03-19T00:00:00Z", "indicator_types": ["malicious-activity"], "pattern_type": "sigma", "pattern": "title: Host Without Firewall\nid: 6b2066c8-3dc7-4db7-9db0-6cc1d7b0dde9\ndescription: Host Without Firewall. Alert means not complied. Sigma for Qualys vulnerability scanner. Scan type - Vulnerability Management.\nauthor: Alexandr Yampolskyi, SOC Prime\nreferences:\n    - https://www.cisecurity.org/controls/cis-controls-list/\n    - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf\n    - https://nvlpubs.nist.gov/nistpubs/CSWP/NIST.CSWP.04162018.pdf\ndate: 2019/03/19\nstatus: stable\nlevel: low\nlogsource:\n    product: Qualys\ndetection:\n    selection:\n        event.category: Security Policy\n        host.scan.vuln_name: Firewall Product Not Detected*\n    condition: selection\ntags:\n    - CSC9\n    - CSC9.4\n    - NIST CSF 1.1 PR.AC-5\n    - NIST CSF 1.1 PR.AC-6\n    - NIST CSF 1.1 PR.AC-7\n    - NIST CSF 1.1 DE.AE-1\n    - ISO 27002-2013 A.9.1.2\n    - ISO 27002-2013 A.13.2.1\n    - ISO 27002-2013 A.13.2.2\n    - ISO 27002-2013 A.14.1.2\n    - PCI DSS 3.2 1.4\n", "object_marking_refs": ["marking-definition--0a872d70-1d05-45dd-a25f-031af547a102"], "created_by_ref": "identity--082ca4f0-d825-45b6-aa42-ab9afd1e5503", "type": "indicator", "spec_version": "2.1", "id": "indicator--50504f15-94b6-4a0f-bec4-58a419025f02", "modified": "2020-04-02T07:58:54.180Z"}, {"name": "Locked Workstation", "description": "Automatically lock workstation sessions after a standard period of inactivity. The case is not applicable for Unix OS. Supported OS - Windows 2008 R2 and 7, Windows 2012 R2 and 8.1, Windows 2016 and 10 Windows Server 2019.", "created": "2019-03-26T00:00:00.000Z", "valid_from": "2019-03-26T00:00:00Z", "indicator_types": ["malicious-activity"], "pattern_type": "sigma", "pattern": "title: Locked Workstation\nid: 411742ad-89b0-49cb-a7b0-3971b5c1e0a4\ndescription: Automatically lock workstation sessions after a standard period of inactivity. The case is not applicable for Unix OS. Supported OS - Windows 2008 R2\n    and 7, Windows 2012 R2 and 8.1, Windows 2016 and 10 Windows Server 2019.\nauthor: Alexandr Yampolskyi, SOC Prime\nstatus: stable\nreferences:\n    - https://www.cisecurity.org/controls/cis-controls-list/\n    - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf\n    - https://nvlpubs.nist.gov/nistpubs/CSWP/NIST.CSWP.04162018.pdf\n    - https://www.ultimatewindowssecurity.com/securitylog/encyclopedia/event.aspx?eventID=4800\ndate: 2019/03/26\nlogsource:\n    product: windows\n    service: security\ndetection:\n    selection:\n        EventID:\n            - 4800\n    condition: selection\nfalsepositives:\n    - unknown\nlevel: low\ntags:\n    - CSC16\n    - CSC16.11\n    - ISO27002-2013 A.9.1.1\n    - ISO27002-2013 A.9.2.1\n    - ISO27002-2013 A.9.2.2\n    - ISO27002-2013 A.9.2.3\n    - ISO27002-2013 A.9.2.4\n    - ISO27002-2013 A.9.2.5\n    - ISO27002-2013 A.9.2.6\n    - ISO27002-2013 A.9.3.1\n    - ISO27002-2013 A.9.4.1\n    - ISO27002-2013 A.9.4.3\n    - ISO27002-2013 A.11.2.8\n    - PCI DSS 3.1 7.1\n    - PCI DSS 3.1 7.2\n    - PCI DSS 3.1 7.3\n    - PCI DSS 3.1 8.7\n    - PCI DSS 3.1 8.8\n    - NIST CSF 1.1 PR.AC-1\n    - NIST CSF 1.1 PR.AC-4\n    - NIST CSF 1.1 PR.AC-6\n    - NIST CSF 1.1 PR.AC-7\n    - NIST CSF 1.1 PR.PT-3\n", "object_marking_refs": ["marking-definition--0a872d70-1d05-45dd-a25f-031af547a102"], "created_by_ref": "identity--082ca4f0-d825-45b6-aa42-ab9afd1e5503", "type": "indicator", "spec_version": "2.1", "id": "indicator--56d06d3e-c45a-4b05-ae44-1dc6387e33c7", "modified": "2020-04-02T07:58:54.186Z"}, {"name": "Default Credentials Usage", "description": "Before deploying any new asset, change all default passwords to have values consistent with administrative level accounts. Sigma detects default credentials usage. Sigma for Qualys vulnerability scanner. Scan type - Vulnerability Management.", "created": "2019-03-26T00:00:00.000Z", "valid_from": "2019-03-26T00:00:00Z", "indicator_types": ["malicious-activity"], "pattern_type": "sigma", "pattern": "title: Default Credentials Usage\nid: 1a395cbc-a84a-463a-9086-ed8a70e573c7\ndescription: Before deploying any new asset, change all default passwords to have values consistent with administrative level accounts. Sigma detects default credentials\n    usage. Sigma for Qualys vulnerability scanner. Scan type - Vulnerability Management.\nauthor: Alexandr Yampolskyi, SOC Prime\nstatus: stable\nreferences:\n    - https://www.cisecurity.org/controls/cis-controls-list/\n    - https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf\n    - https://nvlpubs.nist.gov/nistpubs/CSWP/NIST.CSWP.04162018.pdf\n    - https://community.qualys.com/docs/DOC-6406-reporting-toolbox-focused-search-lists\ndate: 2019/03/26\nlogsource:\n    product: qualys\ndetection:\n    selection:\n        host.scan.vuln:\n            - 10693\n            - 11507\n            - 11633\n            - 11804\n            - 11821\n            - 11847\n            - 11867\n            - 11931\n            - 11935\n            - 11950\n            - 12541\n            - 12558\n            - 12559\n            - 12560\n            - 12562\n            - 12563\n            - 12565\n            - 12587\n            - 12590\n            - 12599\n            - 12702\n            - 12705\n            - 12706\n            - 12907\n            - 12928\n            - 12929\n            - 13053\n            - 13178\n            - 13200\n            - 13218\n            - 13241\n            - 13253\n            - 13274\n            - 13296\n            - 13301\n            - 13327\n            - 13373\n            - 13374\n            - 13409\n            - 13530\n            - 13532\n            - 20065\n            - 20073\n            - 20081\n            - 27202\n            - 27358\n            - 38702\n            - 38719\n            - 42045\n            - 42417\n            - 43029\n            - 43220\n            - 43221\n            - 43222\n            - 43223\n            - 43225\n            - 43246\n            - 43431\n            - 43484\n            - 86857\n            - 87098\n            - 87106\n    condition: selection\nfalsepositives:\n    - unknown\nlevel: medium\ntags:\n    - CSC4\n    - CSC4.2\n    - NIST CSF 1.1 PR.AC-4\n    - NIST CSF 1.1 PR.AT-2\n    - NIST CSF 1.1 PR.MA-2\n    - NIST CSF 1.1 PR.PT-3\n    - ISO 27002-2013 A.9.1.1\n    - ISO 27002-2013 A.9.2.2\n    - ISO 27002-2013 A.9.2.3\n    - ISO 27002-2013 A.9.2.4\n    - ISO 27002-2013 A.9.2.5\n    - ISO 27002-2013 A.9.2.6\n    - ISO 27002-2013 A.9.3.1\n    - ISO 27002-2013 A.9.4.1\n    - ISO 27002-2013 A.9.4.2\n    - ISO 27002-2013 A.9.4.3\n    - ISO 27002-2013 A.9.4.4\n    - PCI DSS 3.2 2.1\n    - PCI DSS 3.2 7.1\n    - PCI DSS 3.2 7.2\n    - PCI DSS 3.2 7.3\n    - PCI DSS 3.2 8.1\n    - PCI DSS 3.2 8.2\n    - PCI DSS 3.2 8.3\n    - PCI DSS 3.2 8.7\n", "object_marking_refs": ["marking-definition--0a872d70-1d05-45dd-a25f-031af547a102"], "created_by_ref": "identity--082ca4f0-d825-45b6-aa42-ab9afd1e5503", "type": "indicator", "spec_version": "2.1", "id": "indicator--119a2584-121a-4d6c-9124-8fa2c97ab2f7", "modified": "2020-04-02T07:58:54.196Z"}, {"name": "Silence.Downloader V3", "description": "Detects Silence downloader. These commands are hardcoded into the binary.", "created": "2019-11-01T00:00:00.000Z", "modified": "2019-11-22T00:00:00.000Z", "valid_from": "2019-11-01T00:00:00Z", "indicator_types": ["malicious-activity"], "pattern_type": "sigma", "pattern": "title: Silence.Downloader V3\nid: 170901d1-de11-4de7-bccb-8fa13678d857\nstatus: experimental\ndescription: Detects Silence downloader. These commands are hardcoded into the binary.\nauthor: Alina Stepchenkova, Roman Rezvukhin, Group-IB, oscd.community\ndate: 2019/11/01\nmodified: 2019/11/22\ntags:\n    - attack.persistence\n    - attack.g0091\nlogsource:\n    category: process_creation\n    product: windows\ndetection:\n    selection_recon:\n        Image|endswith:\n            - '\\tasklist.exe'\n            - '\\qwinsta.exe'\n            - '\\ipconfig.exe'\n            - '\\hostname.exe'\n        CommandLine|contains: '>>'\n        CommandLine|endswith: 'temps.dat'\n    selection_persistence:\n        CommandLine|contains: '/C REG ADD \"HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Run\" /v \"WinNetworkSecurity\" /t REG_SZ /d'\n    condition: selection_recon | near selection_persistence # requires both\nfields:\n    - ComputerName\n    - User\n    - Image\n    - CommandLine\nfalsepositives:\n    - Unknown\nlevel: high\n", "object_marking_refs": ["marking-definition--0a872d70-1d05-45dd-a25f-031af547a102"], "created_by_ref": "identity--082ca4f0-d825-45b6-aa42-ab9afd1e5503", "type": "indicator", "spec_version": "2.1", "id": "indicator--ec49f6ca-fb3f-4892-820e-a81ff028aa45"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--a10b0f13-9aa5-408b-a61d-f59bf4270ec0", "created": "2020-04-02T07:58:54.211Z", "modified": "2020-04-02T07:58:54.211Z", "source_ref": "indicator--ec49f6ca-fb3f-4892-820e-a81ff028aa45", "relationship_type": "indicates", "target_ref": "intrusion-set--d13c8a7f-740b-4efa-a232-de7d6bb05321"}, {"name": "Silence.EDA Detection", "description": "Detects Silence empireDNSagent", "created": "2019-11-01T00:00:00.000Z", "modified": "2019-11-20T00:00:00.000Z", "valid_from": "2019-11-01T00:00:00Z", "indicator_types": ["malicious-activity"], "pattern_type": "sigma", "pattern": "title: Silence.EDA Detection\nid: 3ceb2083-a27f-449a-be33-14ec1b7cc973\nstatus: experimental\ndescription: Detects Silence empireDNSagent\nauthor: Alina Stepchenkova, Group-IB, oscd.community\ndate: 2019/11/01\nmodified: 2019/11/20\ntags:\n    - attack.g0091\n    - attack.s0363\nlogsource:\n    product: windows\n    service: powershell\ndetection:\n    empire:\n        ScriptBlockText|contains|all:           # better to randomise the order\n            - 'System.Diagnostics.Process'\n            - 'Stop-Computer'\n            - 'Restart-Computer'\n            - 'Exception in execution'\n            - '$cmdargs'\n            - 'Close-Dnscat2Tunnel'\n    dnscat:\n         ScriptBlockText|contains|all:          # better to randomise the order\n            - 'set type=$LookupType`nserver'\n            - '$Command | nslookup 2>&1 | Out-String'\n            - 'New-RandomDNSField'\n            - '[Convert]::ToString($SYNOptions, 16)'\n            - '$Session.Dead = $True'\n            - '$Session[\"Driver\"] -eq'\n    condition: empire and dnscat\nfalsepositives:\n    - Unknown\nlevel: critical\n", "object_marking_refs": ["marking-definition--0a872d70-1d05-45dd-a25f-031af547a102"], "created_by_ref": "identity--082ca4f0-d825-45b6-aa42-ab9afd1e5503", "type": "indicator", "spec_version": "2.1", "id": "indicator--fe206a5d-3932-484d-acc7-0c58138159c4"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--774cbe2f-f99b-4138-803e-463d0b8a2e61", "created": "2020-04-02T07:58:54.227Z", "modified": "2020-04-02T07:58:54.227Z", "source_ref": "indicator--fe206a5d-3932-484d-acc7-0c58138159c4", "relationship_type": "indicates", "target_ref": "intrusion-set--d13c8a7f-740b-4efa-a232-de7d6bb05321"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--721b5a9d-01e0-4365-aae7-e6e8df0296c7", "created": "2020-04-02T07:58:54.236Z", "modified": "2020-04-02T07:58:54.236Z", "source_ref": "indicator--fe206a5d-3932-484d-acc7-0c58138159c4", "relationship_type": "indicates", "target_ref": "tool--3433a9e8-1c47-4320-b9bf-ed449061d1c3"}, {"name": "Overwriting the File with Dev Zero or Null", "description": "Detects overwriting (effectively wiping/deleting) the file", "created": "2019-10-23T00:00:00.000Z", "valid_from": "2019-10-23T00:00:00Z", "indicator_types": ["malicious-activity"], "pattern_type": "sigma", "pattern": "title: Overwriting the File with Dev Zero or Null\nid: 37222991-11e9-4b6d-8bdf-60fbe48f753e\ndate: 2019/10/23\ndescription: Detects overwriting (effectively wiping/deleting) the file\nauthor: Jakob Weinzettl, oscd.community\ntags:\n    - attack.impact\n    - attack.t1485\nlogsource:\n    product: linux\n    service: auditd\ndetection:\n    selection:\n        type: 'EXECVE'\n        a0|contains: 'dd'   \n        a1|contains:\n            - 'if=/dev/null'    \n            - 'if=/dev/zero'    \n    condition: selection\nfalsepositives:\n    - Appending null bytes to files\n    - Legitimate overwrite of files\nlevel: low\nreferences:\n    - https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1485/T1485.yaml\n", "object_marking_refs": ["marking-definition--0a872d70-1d05-45dd-a25f-031af547a102"], "created_by_ref": "identity--082ca4f0-d825-45b6-aa42-ab9afd1e5503", "type": "indicator", "spec_version": "2.1", "id": "indicator--869e3c51-9c36-4b56-a7cd-10b798de6ac6", "modified": "2020-04-02T07:58:54.240Z"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--cf256108-f27c-4032-8b1f-af92f2753d02", "created": "2020-04-02T07:58:54.251Z", "modified": "2020-04-02T07:58:54.251Z", "source_ref": "indicator--869e3c51-9c36-4b56-a7cd-10b798de6ac6", "relationship_type": "indicates", "target_ref": "attack-pattern--d45a3d09-b3cf-48f4-9f0f-f521ee5cb05c"}, {"name": "Clear Command History", "description": "Clear command history in linux which is used for defense evasion.", "created": "2019-03-24T00:00:00.000Z", "valid_from": "2019-03-24T00:00:00Z", "indicator_types": ["malicious-activity"], "pattern_type": "sigma", "pattern": "title: Clear Command History\nid: fdc88d25-96fb-4b7c-9633-c0e417fdbd4e\nstatus: experimental\ndescription: Clear command history in linux which is used for defense evasion.\nreferences:\n    - https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1146/T1146.yaml\n    - https://attack.mitre.org/techniques/T1146/\n    - https://www.hackers-arise.com/single-post/2016/06/20/Covering-your-BASH-Shell-Tracks-AntiForensics\nauthor: Patrick Bareiss\ndate: 2019/03/24\nlogsource:\n    product: linux\ndetection:\n    keywords:\n        - 'rm *bash_history'\n        - 'echo \"\" > *bash_history'\n        - 'cat /dev/null > *bash_history' \n        - 'ln -sf /dev/null *bash_history'\n        - 'truncate -s0 *bash_history'\n        # - 'unset HISTFILE'  # prone to false positives\n        - 'export HISTFILESIZE=0'\n        - 'history -c'\n        - 'history -w'\n        - 'shred *bash_history'\n    condition: keywords\nfalsepositives:\n    - Unknown\nlevel: high\ntags:\n    - attack.defense_evasion\n    - attack.t1146\n", "object_marking_refs": ["marking-definition--0a872d70-1d05-45dd-a25f-031af547a102"], "created_by_ref": "identity--082ca4f0-d825-45b6-aa42-ab9afd1e5503", "type": "indicator", "spec_version": "2.1", "id": "indicator--52509521-bd85-4dac-852a-341dcba3f5db", "modified": "2020-04-02T07:58:54.258Z"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--1a5e7ec2-181e-4dad-9a49-b30fdde865b6", "created": "2020-04-02T07:58:54.270Z", "modified": "2020-04-02T07:58:54.270Z", "source_ref": "indicator--52509521-bd85-4dac-852a-341dcba3f5db", "relationship_type": "indicates", "target_ref": "attack-pattern--d3046a90-580c-4004-8208-66915bc29830"}, {"name": "Equation Group Indicators", "description": "Detects suspicious shell commands used in various Equation Group scripts and tools", "created": "2017-04-09T00:00:00.000Z", "valid_from": "2017-04-09T00:00:00Z", "indicator_types": ["malicious-activity"], "pattern_type": "sigma", "pattern": "title: Equation Group Indicators\nid: 41e5c73d-9983-4b69-bd03-e13b67e9623c\ndescription: Detects suspicious shell commands used in various Equation Group scripts and tools\nreferences:\n    - https://medium.com/@shadowbrokerss/dont-forget-your-base-867d304a94b1\ntags:\n    - attack.execution\n    - attack.g0020\n    - attack.t1059\nauthor: Florian Roth\ndate: 2017/04/09\nlogsource:\n    product: linux\ndetection:\n    keywords:\n        # evolvingstrategy, elgingamble, estesfox\n        - 'chown root*chmod 4777 '\n        - 'cp /bin/sh .;chown'\n        # tmpwatch\n        - 'chmod 4777 /tmp/.scsi/dev/bin/gsh'\n        - 'chown root:root /tmp/.scsi/dev/bin/'\n        # estesfox\n        - 'chown root:root x;'\n        # ratload\n        - '/bin/telnet locip locport < /dev/console | /bin/sh'\n        - '/tmp/ratload'\n        # ewok\n        - 'ewok -t '\n        # xspy\n        - 'xspy -display '\n        # elatedmonkey\n        - 'cat > /dev/tcp/127.0.0.1/80 <<END'\n        # ftshell\n        - 'rm -f /current/tmp/ftshell.latest'\n        # ghost\n        - 'ghost_* -v '\n        # morerats client\n        - ' --wipe > /dev/null'\n        # noclient\n        - 'ping -c 2 *; grep * /proc/net/arp >/tmp/gx'\n        - 'iptables * OUTPUT -p tcp -d 127.0.0.1 --tcp-flags RST RST -j DROP;'\n        # auditcleaner\n        - '> /var/log/audit/audit.log; rm -f .'\n        - 'cp /var/log/audit/audit.log .tmp'\n        # reverse shell\n        - 'sh >/dev/tcp/* <&1 2>&1'\n        # packrat\n        - 'ncat -vv -l -p * <'\n        - 'nc -vv -l -p * <'\n        # empty bowl\n        - '< /dev/console | uudecode && uncompress'\n        - 'sendmail -osendmail;chmod +x sendmail'\n        # echowrecker\n        - '/usr/bin/wget -O /tmp/a http* && chmod 755 /tmp/cron'\n        # dubmoat\n        - 'chmod 666 /var/run/utmp~'\n        # poptop\n        - 'chmod 700 nscd crond'\n        # abopscript\n        - 'cp /etc/shadow /tmp/.'\n        # ys\n        - '</dev/console |uudecode > /dev/null 2>&1 && uncompress'\n        # jacktelnet\n        - 'chmod 700 jp&&netstat -an|grep'\n        # others\n        - 'uudecode > /dev/null 2>&1 && uncompress -f * && chmod 755'\n        - 'chmod 700 crond'\n        - 'wget http*; chmod +x /tmp/sendmail'\n        - 'chmod 700 fp sendmail pt'\n        - 'chmod 755 /usr/vmsys/bin/pipe'\n        - 'chmod -R 755 /usr/vmsys'\n        - 'chmod 755 $opbin/*tunnel'\n        - 'chmod 700 sendmail'\n        - 'chmod 0700 sendmail'\n        - '/usr/bin/wget http*sendmail;chmod +x sendmail;'\n        - '&& telnet * 2>&1 </dev/console'\n    condition: keywords\nfalsepositives:\n    - Unknown\nlevel: high\n", "object_marking_refs": ["marking-definition--0a872d70-1d05-45dd-a25f-031af547a102"], "created_by_ref": "identity--082ca4f0-d825-45b6-aa42-ab9afd1e5503", "type": "indicator", "spec_version": "2.1", "id": "indicator--8cfcc487-2629-46f7-872f-fc2ec9938e30", "modified": "2020-04-02T07:58:54.281Z"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--524d289a-7dd8-4521-b3bb-0efd5ac4d34c", "created": "2020-04-02T07:58:54.292Z", "modified": "2020-04-02T07:58:54.292Z", "source_ref": "indicator--8cfcc487-2629-46f7-872f-fc2ec9938e30", "relationship_type": "indicates", "target_ref": "intrusion-set--96e239be-ad99-49eb-b127-3007b8c1bec9"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--7218fd0e-765f-407f-88ed-d0ffa02a6bfe", "created": "2020-04-02T07:58:54.300Z", "modified": "2020-04-02T07:58:54.300Z", "source_ref": "indicator--8cfcc487-2629-46f7-872f-fc2ec9938e30", "relationship_type": "indicates", "target_ref": "attack-pattern--7385dfaf-6886-4229-9ecd-6fd678040830"}, {"name": "Systemd Service Reload or Start", "description": "Detects a reload or a start of a service", "created": "2019-09-23T00:00:00.000Z", "valid_from": "2019-09-23T00:00:00Z", "indicator_types": ["malicious-activity"], "pattern_type": "sigma", "pattern": "title: Systemd Service Reload or Start\nid: 2625cc59-0634-40d0-821e-cb67382a3dd7\ndescription: Detects a reload or a start of a service\nstatus: experimental\ntags:\n    - attack.persistence\n    - attack.t1501\nauthor: Jakob Weinzettl, oscd.community\ndate: 2019/09/23\nlogsource:\n    product: linux\n    service: auditd\ndetection:\n    selection:\n        type: 'EXECVE'\n        a0|contains: 'systemctl'\n        a1|contains:\n            - 'daemon-reload'\n            - 'start'\n    condition: selection\nfalsepositives:\n    - Installation of legitimate service\n    - Legitimate reconfiguration of service\nlevel: low\nreferences:\n    - https://attack.mitre.org/techniques/T1501/\n    - https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1501/T1501.yaml\n", "object_marking_refs": ["marking-definition--0a872d70-1d05-45dd-a25f-031af547a102"], "created_by_ref": "identity--082ca4f0-d825-45b6-aa42-ab9afd1e5503", "type": "indicator", "spec_version": "2.1", "id": "indicator--e07351cc-86ae-46b9-ac14-1320d1bdff81", "modified": "2020-04-02T07:58:54.308Z"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--b915e43e-0471-4102-9de2-5d880a5ba08c", "created": "2020-04-02T07:58:54.320Z", "modified": "2020-04-02T07:58:54.320Z", "source_ref": "indicator--e07351cc-86ae-46b9-ac14-1320d1bdff81", "relationship_type": "indicates", "target_ref": "attack-pattern--0fff2797-19cb-41ea-a5f1-8a9303b8158e"}, {"name": "File or Folder Permissions Change", "description": "Detects", "created": "2019-09-23T00:00:00.000Z", "valid_from": "2019-09-23T00:00:00Z", "indicator_types": ["malicious-activity"], "pattern_type": "sigma", "pattern": "title: File or Folder Permissions Change\ndescription: Detects \nid: 74c01ace-0152-4094-8ae2-6fd776dd43e5\nstatus: experimental\ntags:\n    - attack.defense_evasion\n    - attack.t1222\nauthor: Jakob Weinzettl, oscd.community\ndate: 2019/09/23\nlogsource:\n    product: linux\n    service: auditd\ndetection:\n    selection:\n        type: 'EXECVE'\n        a0|contains:\n            - 'chmod'\n            - 'chown'\n    condition: selection\nfalsepositives:\n    - User interracting with files permissions (normal/daily behaviour)\nlevel: low\nreferences:\n    - https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1222/T1222.yaml\n", "object_marking_refs": ["marking-definition--0a872d70-1d05-45dd-a25f-031af547a102"], "created_by_ref": "identity--082ca4f0-d825-45b6-aa42-ab9afd1e5503", "type": "indicator", "spec_version": "2.1", "id": "indicator--ef9b6e2b-9581-4ef3-8695-a2c95b93e5d4", "modified": "2020-04-02T07:58:54.330Z"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--a3b48e50-dbd5-459b-90a4-f93011dd258a", "created": "2020-04-02T07:58:54.342Z", "modified": "2020-04-02T07:58:54.342Z", "source_ref": "indicator--ef9b6e2b-9581-4ef3-8695-a2c95b93e5d4", "relationship_type": "indicates", "target_ref": "attack-pattern--65917ae0-b854-4139-83fe-bf2441cf0196"}, {"name": "Masquerading as Linux Crond Process", "description": "Masquerading occurs when the name or location of an executable, legitimate or malicious, is manipulated or abused for the sake of evading defenses and observation. Several different variations of this technique have been observed.", "created": "2019-10-21T00:00:00.000Z", "valid_from": "2019-10-21T00:00:00Z", "indicator_types": ["malicious-activity"], "pattern_type": "sigma", "pattern": "title: Masquerading as Linux Crond Process\nid: 9d4548fa-bba0-4e88-bd66-5d5bf516cda0\nstatus: experimental\ndescription: Masquerading occurs when the name or location of an executable, legitimate or malicious, is manipulated or abused for the sake of evading defenses and\n    observation. Several different variations of this technique have been observed.\nauthor: Timur Zinniatullin, oscd.community\ndate: 2019/10/21\nreferences:\n    - https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1036/T1036.yaml\nlogsource:\n    product: linux\n    service: auditd\ndetection:\n    selection:\n        type: 'execve'\n        a0: 'cp'\n        a1: '-i'\n        a2: '/bin/sh'\n        a3: '*/crond'\n    condition: selection\nlevel: medium\ntags:\n    - attack.defense_evasion\n    - attack.t1036\n", "object_marking_refs": ["marking-definition--0a872d70-1d05-45dd-a25f-031af547a102"], "created_by_ref": "identity--082ca4f0-d825-45b6-aa42-ab9afd1e5503", "type": "indicator", "spec_version": "2.1", "id": "indicator--db0ee81f-3d48-4f57-8ae9-c1da6dacbc7f", "modified": "2020-04-02T07:58:54.366Z"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--7ef0ab94-71bb-4531-b0f5-a3a57317f383", "created": "2020-04-02T07:58:54.379Z", "modified": "2020-04-02T07:58:54.379Z", "source_ref": "indicator--db0ee81f-3d48-4f57-8ae9-c1da6dacbc7f", "relationship_type": "indicates", "target_ref": "attack-pattern--42e8de7b-37b2-4258-905a-6897815e58e0"}, {"name": "Edit of .bash_profile and .bashrc", "description": "Detects change of user environment. Adversaries can insert code into these files to gain persistence each time a user logs in or opens a new shell.", "created": "2019-05-12T00:00:00.000Z", "valid_from": "2019-05-12T00:00:00Z", "indicator_types": ["malicious-activity"], "pattern_type": "sigma", "pattern": "title: Edit of .bash_profile and .bashrc\nid: e74e15cc-c4b6-4c80-b7eb-dfe49feb7fe9\nstatus: experimental\ndescription: Detects change of user environment. Adversaries can insert code into these files to gain persistence each time a user logs in or opens a new shell.\nreferences:\n    - 'MITRE Attack technique T1156; .bash_profile and .bashrc. '\ndate: 2019/05/12\ntags:\n    - attack.s0003\n    - attack.t1156\n    - attack.persistence\nauthor: Peter Matkovski\nlogsource:\n    product: linux\n    service: auditd\ndetection:\n    selection:\n        type: 'PATH'\n        name:\n            - '/home/*/.bashrc'\n            - '/home/*/.bash_profile'\n            - '/home/*/.profile'\n            - '/etc/profile'\n            - '/etc/shells'\n            - '/etc/bashrc'\n            - '/etc/csh.cshrc'\n            - '/etc/csh.login'\n    condition: selection\nfalsepositives:\n    - Admin or User activity\nlevel: medium\n", "object_marking_refs": ["marking-definition--0a872d70-1d05-45dd-a25f-031af547a102"], "created_by_ref": "identity--082ca4f0-d825-45b6-aa42-ab9afd1e5503", "type": "indicator", "spec_version": "2.1", "id": "indicator--fe4e8664-cde5-48cf-a74d-e93964f64493", "modified": "2020-04-02T07:58:54.383Z"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--90fb4339-b6db-4550-86e4-e0e05f514f45", "created": "2020-04-02T07:58:54.393Z", "modified": "2020-04-02T07:58:54.393Z", "source_ref": "indicator--fe4e8664-cde5-48cf-a74d-e93964f64493", "relationship_type": "indicates", "target_ref": "malware--ad4f146f-e3ec-444a-ba71-24bffd7f0f8e"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--5801d40a-ad36-4ca2-8af8-1a759053c9cf", "created": "2020-04-02T07:58:54.403Z", "modified": "2020-04-02T07:58:54.403Z", "source_ref": "indicator--fe4e8664-cde5-48cf-a74d-e93964f64493", "relationship_type": "indicates", "target_ref": "attack-pattern--01df3350-ce05-4bdf-bdf8-0a919a66d4a8"}, {"name": "Auditing Configuration Changes on Linux Host", "description": "Detect changes in auditd configuration files", "created": "2019-10-25T00:00:00.000Z", "valid_from": "2019-10-25T00:00:00Z", "indicator_types": ["malicious-activity"], "pattern_type": "sigma", "pattern": "title: Auditing Configuration Changes on Linux Host\nid: 977ef627-4539-4875-adf4-ed8f780c4922\ndescription: Detect changes in auditd configuration files\n    # Example config for this one (place it at the top of audit.rules)\n    # -w /etc/audit/ -p wa -k etc_modify_auditconfig\n    # -w /etc/libaudit.conf -p wa -k etc_modify_libauditconfig\n    # -w /etc/audisp/ -p wa -k etc_modify_audispconfig\nreferences:\n    - https://github.com/Neo23x0/auditd/blob/master/audit.rules\n    - self experience\ntags:\n    - attack.defense_evasion\n    - attack.t1054\nauthor: Mikhail Larin, oscd.community\nstatus: experimental\ndate: 2019/10/25\nlogsource:\n    product: linux\n    service: auditd\ndetection:\n    selection:\n        type: PATH\n        name:\n            - /etc/audit/*\n            - /etc/libaudit.conf\n            - /etc/audisp/*\n    condition: selection\nfields:\n    - exe\n    - comm\n    - key\nfalsepositives:\n    - Legitimate administrative activity\nlevel: high\n", "object_marking_refs": ["marking-definition--0a872d70-1d05-45dd-a25f-031af547a102"], "created_by_ref": "identity--082ca4f0-d825-45b6-aa42-ab9afd1e5503", "type": "indicator", "spec_version": "2.1", "id": "indicator--21dacbd0-991c-40ca-9bd9-2b55ea228a69", "modified": "2020-04-02T07:58:54.408Z"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--fee025bb-8702-4cd5-8af8-11273987aad8", "created": "2020-04-02T07:58:54.422Z", "modified": "2020-04-02T07:58:54.422Z", "source_ref": "indicator--21dacbd0-991c-40ca-9bd9-2b55ea228a69", "relationship_type": "indicates", "target_ref": "attack-pattern--6a5848a8-6201-4a2c-8a6a-ca5af8c6f3df"}, {"name": "System Owner or User Discovery", "description": "Adversaries may use the information from System Owner/User Discovery during automated discovery to shape follow-on behaviors, including whether or not the adversary fully infects the target and/or attempts specific actions.", "created": "2019-10-21T00:00:00.000Z", "valid_from": "2019-10-21T00:00:00Z", "indicator_types": ["malicious-activity"], "pattern_type": "sigma", "pattern": "title: System Owner or User Discovery\nid: 9a0d8ca0-2385-4020-b6c6-cb6153ca56f3\nstatus: experimental\ndescription: Adversaries may use the information from System Owner/User Discovery during automated discovery to shape follow-on behaviors, including whether or not\n    the adversary fully infects the target and/or attempts specific actions.\nauthor: Timur Zinniatullin, oscd.community\ndate: 2019/10/21\nreferences:\n    - https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1033/T1033.yaml\nlogsource:\n    product: linux\n    service: auditd\ndetection:\n    selection:\n        type: 'EXECVE'\n        a0:\n            - 'users'\n            - 'w'\n            - 'who'\n    condition: selection\nfalsepositives:\n    - Admin activity\nlevel: low\ntags:\n    - attack.discovery\n    - attack.t1033\n", "object_marking_refs": ["marking-definition--0a872d70-1d05-45dd-a25f-031af547a102"], "created_by_ref": "identity--082ca4f0-d825-45b6-aa42-ab9afd1e5503", "type": "indicator", "spec_version": "2.1", "id": "indicator--394f33c1-e52d-49b9-be4c-eff5d894f094", "modified": "2020-04-02T07:58:54.427Z"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--04b7e022-d2c9-4f0a-870d-3f093cade784", "created": "2020-04-02T07:58:54.441Z", "modified": "2020-04-02T07:58:54.441Z", "source_ref": "indicator--394f33c1-e52d-49b9-be4c-eff5d894f094", "relationship_type": "indicates", "target_ref": "attack-pattern--03d7999c-1f4c-42cc-8373-e7690d318104"}, {"name": "Logging Configuration Changes on Linux Host", "description": "Detect changes of syslog daemons configuration files", "created": "2019-10-25T00:00:00.000Z", "valid_from": "2019-10-25T00:00:00Z", "indicator_types": ["malicious-activity"], "pattern_type": "sigma", "pattern": "title: Logging Configuration Changes on Linux Host\nid: c830f15d-6f6e-430f-8074-6f73d6807841\ndescription: Detect changes of syslog daemons configuration files\n    # Example config for this one (place it at the top of audit.rules)\n    # -w /etc/syslog.conf -p wa -k etc_modify_syslogconfig\n    # -w /etc/rsyslog.conf -p wa -k etc_modify_rsyslogconfig\n    # -w /etc/syslog-ng/syslog-ng.conf -p wa -k etc_modify_syslogngconfig\nreferences:\n    - self experience\ntags:\n    - attack.defense_evasion\n    - attack.t1054\nauthor: Mikhail Larin, oscd.community\nstatus: experimental\ndate: 2019/10/25\nlogsource:\n    product: linux\n    service: auditd\ndetection:\n    selection:\n        type: 'PATH'\n        name:\n            - /etc/syslog.conf\n            - /etc/rsyslog.conf\n            - /etc/syslog-ng/syslog-ng.conf\n    condition: selection\nfields:\n    - exe\n    - comm\n    - key\nfalsepositives:\n    - Legitimate administrative activity\nlevel: high\n", "object_marking_refs": ["marking-definition--0a872d70-1d05-45dd-a25f-031af547a102"], "created_by_ref": "identity--082ca4f0-d825-45b6-aa42-ab9afd1e5503", "type": "indicator", "spec_version": "2.1", "id": "indicator--da25121c-50cb-447a-8b8c-18501c847ed3", "modified": "2020-04-02T07:58:54.451Z"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--542f415a-84f1-4b46-ad2f-9fe4bf2e8bc3", "created": "2020-04-02T07:58:54.461Z", "modified": "2020-04-02T07:58:54.461Z", "source_ref": "indicator--da25121c-50cb-447a-8b8c-18501c847ed3", "relationship_type": "indicates", "target_ref": "attack-pattern--6a5848a8-6201-4a2c-8a6a-ca5af8c6f3df"}, {"name": "Modification of ld.so.preload", "description": "Identifies modification of ld.so.preload for shared object injection. This technique is used by attackers to load arbitrary code into processes.", "created": "2019-10-24T00:00:00.000Z", "modified": "2019-11-11T00:00:00.000Z", "valid_from": "2019-10-24T00:00:00Z", "indicator_types": ["malicious-activity"], "pattern_type": "sigma", "pattern": "title: Modification of ld.so.preload\nid: 4b3cb710-5e83-4715-8c45-8b2b5b3e5751\ndescription: Identifies modification of ld.so.preload for shared object injection. This technique is used by attackers to load arbitrary code into processes.\nstatus: experimental\nauthor: E.M. Anhaus (orignally from Atomic Blue Detections, Tony Lambert), oscd.community\ndate: 2019/10/24\nmodified: 2019/11/11\nreferences:\n    - https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1055/T1055.yaml\n    - https://eqllib.readthedocs.io/en/latest/analytics/fd9b987a-1101-4ed3-bda6-a70300eaf57e.html\ntags:\n    - attack.defense_evasion\n    - attack.t1055\nlogsource:\n    product: linux\n    service: auditd\ndetection:\n    selection:\n        type: 'PATH'\n        name: '/etc/ld.so.preload'\n    condition: selection\nfalsepositives:\n    - Unknown\nlevel: high\n", "object_marking_refs": ["marking-definition--0a872d70-1d05-45dd-a25f-031af547a102"], "created_by_ref": "identity--082ca4f0-d825-45b6-aa42-ab9afd1e5503", "type": "indicator", "spec_version": "2.1", "id": "indicator--329490a4-6806-40e4-b890-61fc644caaed"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--664d381e-bbcd-41ea-9ab2-e9a4510e3e75", "created": "2020-04-02T07:58:54.476Z", "modified": "2020-04-02T07:58:54.476Z", "source_ref": "indicator--329490a4-6806-40e4-b890-61fc644caaed", "relationship_type": "indicates", "target_ref": "attack-pattern--43e7dc91-05b2-474c-b9ac-2ed4fe101f4d"}, {"name": "Webshell Remote Command Execution", "description": "Detects posible command execution by web application/web shell", "created": "2019-10-12T00:00:00.000Z", "modified": "2019-11-04T00:00:00.000Z", "valid_from": "2019-10-12T00:00:00Z", "indicator_types": ["malicious-activity"], "pattern_type": "sigma", "pattern": "title: Webshell Remote Command Execution\nid: c0d3734d-330f-4a03-aae2-65dacc6a8222\nstatus: experimental\ndescription: Detects posible command execution by web application/web shell\ntags:\n    - attack.persistence\n    - attack.t1100\nreferences:\n    - personal experience\nauthor: Ilyas Ochkov, Beyu Denis, oscd.community\ndate: 2019/10/12\nmodified: 2019/11/04\nlogsource:\n    product: linux\n    service: auditd\ndetection:\n    selection:\n        type: 'SYSCALL'\n        SYSCALL: 'execve'\n        key: 'detect_execve_www'\n    condition: selection\nfalsepositives:\n    - Admin activity\n    - Crazy web applications\nlevel: critical\n", "object_marking_refs": ["marking-definition--0a872d70-1d05-45dd-a25f-031af547a102"], "created_by_ref": "identity--082ca4f0-d825-45b6-aa42-ab9afd1e5503", "type": "indicator", "spec_version": "2.1", "id": "indicator--a300ae0b-c0a1-4e76-8f4e-b7484495d2a2"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--a8b4dcd3-3cb1-4cd4-8069-6658b8fa851f", "created": "2020-04-02T07:58:54.499Z", "modified": "2020-04-02T07:58:54.499Z", "source_ref": "indicator--a300ae0b-c0a1-4e76-8f4e-b7484495d2a2", "relationship_type": "indicates", "target_ref": "attack-pattern--c16e5409-ee53-4d79-afdc-4099dc9292df"}, {"name": "Data Compressed", "description": "An adversary may compress data (e.g., sensitive documents) that is collected prior to exfiltration in order to make it portable and minimize the amount of data sent over the network", "created": "2019-10-21T00:00:00.000Z", "modified": "2019-11-04T00:00:00.000Z", "valid_from": "2019-10-21T00:00:00Z", "indicator_types": ["malicious-activity"], "pattern_type": "sigma", "pattern": "title: Data Compressed\nid: a3b5e3e9-1b49-4119-8b8e-0344a01f21ee\nstatus: experimental\ndescription: An adversary may compress data (e.g., sensitive documents) that is collected prior to exfiltration in order to make it portable and minimize the amount\n    of data sent over the network\nauthor: Timur Zinniatullin, oscd.community\ndate: 2019/10/21\nmodified: 2019/11/04\nreferences:\n    - https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1002/T1002.yaml\nlogsource:\n    product: linux\n    service: auditd\ndetection:\n    selection1:\n        type: 'execve'\n        a0: 'zip'\n    selection2:\n        type: 'execve'\n        a0: 'gzip'\n        a1: '-f'\n    selection3:\n        type: 'execve'\n        a0: 'tar'\n        a1|contains: '-c'\n    condition: 1 of them\nfalsepositives:\n    - Legitimate use of archiving tools by legitimate user\nlevel: low\ntags:\n    - attack.exfiltration\n    - attack.t1002\n", "object_marking_refs": ["marking-definition--0a872d70-1d05-45dd-a25f-031af547a102"], "created_by_ref": "identity--082ca4f0-d825-45b6-aa42-ab9afd1e5503", "type": "indicator", "spec_version": "2.1", "id": "indicator--08f0023e-2b31-4011-a20e-7a242e0ab6d9"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--26fe462d-d071-436e-ba42-3135852bb5fb", "created": "2020-04-02T07:58:54.517Z", "modified": "2020-04-02T07:58:54.517Z", "source_ref": "indicator--08f0023e-2b31-4011-a20e-7a242e0ab6d9", "relationship_type": "indicates", "target_ref": "attack-pattern--b9f5dbe2-4c55-4fc5-af2e-d42c1d182ec4"}, {"name": "Network Sniffing", "description": "Network sniffing refers to using the network interface on a system to monitor or capture information sent over a wired or wireless connection. An adversary may place a network interface into promiscuous mode to passively access data in transit over the network, or use span ports to capture a larger amount of data.", "created": "2019-10-21T00:00:00.000Z", "modified": "2019-11-04T00:00:00.000Z", "valid_from": "2019-10-21T00:00:00Z", "indicator_types": ["malicious-activity"], "pattern_type": "sigma", "pattern": "title: Network Sniffing\nid: f4d3748a-65d1-4806-bd23-e25728081d01\nstatus: experimental\ndescription: Network sniffing refers to using the network interface on a system to monitor or capture information sent over a wired or wireless connection. An adversary\n    may place a network interface into promiscuous mode to passively access data in transit over the network, or use span ports to capture a larger amount of data.\nauthor: Timur Zinniatullin, oscd.community\ndate: 2019/10/21\nmodified: 2019/11/04\nreferences:\n    - https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1040/T1040.yaml\nlogsource:\n    product: linux\n    service: auditd\ndetection:\n    selection1:\n        type: 'execve'\n        a0: 'tcpdump'\n        a1: '-c'\n        a3|contains: '-i'\n    selection2:\n        type: 'execve'\n        a0: 'tshark'\n        a1: '-c'\n        a3: '-i'\n    condition: selection1 or selection2\nfalsepositives:\n    - Legitimate administrator or user uses network sniffing tool for legitimate reason\nlevel: low\ntags:\n    - attack.credential_access\n    - attack.discovery\n    - attack.t1040\n", "object_marking_refs": ["marking-definition--0a872d70-1d05-45dd-a25f-031af547a102"], "created_by_ref": "identity--082ca4f0-d825-45b6-aa42-ab9afd1e5503", "type": "indicator", "spec_version": "2.1", "id": "indicator--8ee5fa7c-bc1f-432d-bc57-e4d74c9d64bd"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--a01653a7-8ee7-4155-9cf4-08829958c0dc", "created": "2020-04-02T07:58:54.536Z", "modified": "2020-04-02T07:58:54.536Z", "source_ref": "indicator--8ee5fa7c-bc1f-432d-bc57-e4d74c9d64bd", "relationship_type": "indicates", "target_ref": "attack-pattern--3257eb21-f9a7-4430-8de1-d8b6e288f529"}, {"name": "Sudo Privilege Escalation CVE-2019-14287", "description": "Detects users trying to exploit sudo vulnerability reported in CVE-2019-14287", "created": "2019-10-15T00:00:00.000Z", "modified": "2019-10-20T00:00:00.000Z", "valid_from": "2019-10-15T00:00:00Z", "indicator_types": ["malicious-activity"], "pattern_type": "sigma", "pattern": "action: global\ntitle: Sudo Privilege Escalation CVE-2019-14287\nid: f74107df-b6c6-4e80-bf00-4170b658162b\nstatus: experimental\ndescription: Detects users trying to exploit sudo vulnerability reported in CVE-2019-14287\nreferences:\n    - https://www.openwall.com/lists/oss-security/2019/10/14/1\n    - https://access.redhat.com/security/cve/cve-2019-14287\n    - https://twitter.com/matthieugarin/status/1183970598210412546\nauthor: Florian Roth\ndate: 2019/10/15\nmodified: 2019/10/20\ntags:\n    - attack.privilege_escalation\n    - attack.t1068\n    - attack.t1169\nlogsource:\n    product: linux\nfalsepositives:\n    - Unlikely\nlevel: critical\n", "object_marking_refs": ["marking-definition--0a872d70-1d05-45dd-a25f-031af547a102"], "created_by_ref": "identity--082ca4f0-d825-45b6-aa42-ab9afd1e5503", "type": "indicator", "spec_version": "2.1", "id": "indicator--eea2e4b2-6df4-4472-919c-058c6edfbca3"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--c1ab02ea-7511-49a5-9a32-32f48cb7ea1f", "created": "2020-04-02T07:58:54.552Z", "modified": "2020-04-02T07:58:54.552Z", "source_ref": "indicator--eea2e4b2-6df4-4472-919c-058c6edfbca3", "relationship_type": "indicates", "target_ref": "attack-pattern--b21c3b2d-02e6-45b1-980b-e69051040839"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--052f50bd-3c74-4096-8e80-764ad475eda8", "created": "2020-04-02T07:58:54.563Z", "modified": "2020-04-02T07:58:54.563Z", "source_ref": "indicator--eea2e4b2-6df4-4472-919c-058c6edfbca3", "relationship_type": "indicates", "target_ref": "attack-pattern--9e80ddfb-ce32-4961-a778-ca6a10cfae72"}, {"name": "Remove Immutable File Attribute", "description": "Detects removing immutable file attribute", "created": "2019-09-23T00:00:00.000Z", "valid_from": "2019-09-23T00:00:00Z", "indicator_types": ["malicious-activity"], "pattern_type": "sigma", "pattern": "title: Remove Immutable File Attribute\nid: a5b977d6-8a81-4475-91b9-49dbfcd941f7\ndescription: Detects removing immutable file attribute\nstatus: experimental\ntags:\n    - attack.defense_evasion\n    - attack.t1222\nauthor: Jakob Weinzettl, oscd.community\ndate: 2019/09/23\nlogsource:\n    product: linux\n    service: auditd\ndetection:\n    selection:\n        type: 'EXECVE'\n        a0|contains: 'chattr'\n        a1|contains: '-i'\n    condition: selection\nfalsepositives:\n    - Administrator interacting with immutable files (for instance backups)\nlevel: medium\nreferences:\n    - https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1222/T1222.yaml\n", "object_marking_refs": ["marking-definition--0a872d70-1d05-45dd-a25f-031af547a102"], "created_by_ref": "identity--082ca4f0-d825-45b6-aa42-ab9afd1e5503", "type": "indicator", "spec_version": "2.1", "id": "indicator--0cc07400-8f6d-432c-a0bd-637b4e645af5", "modified": "2020-04-02T07:58:54.570Z"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--3fa4a501-37d8-4ceb-bb40-5439f8387332", "created": "2020-04-02T07:58:54.580Z", "modified": "2020-04-02T07:58:54.580Z", "source_ref": "indicator--0cc07400-8f6d-432c-a0bd-637b4e645af5", "relationship_type": "indicates", "target_ref": "attack-pattern--65917ae0-b854-4139-83fe-bf2441cf0196"}, {"name": "Privilege Escalation Preparation", "description": "Detects suspicious shell commands indicating the information gathering phase as preparation for the Privilege Escalation.", "created": "2019-04-05T00:00:00.000Z", "valid_from": "2019-04-05T00:00:00Z", "indicator_types": ["malicious-activity"], "pattern_type": "sigma", "pattern": "title: Privilege Escalation Preparation\nid: 444ade84-c362-4260-b1f3-e45e20e1a905\nstatus: experimental\ndescription: Detects suspicious shell commands indicating the information gathering phase as preparation for the Privilege Escalation.\nreferences:\n    - https://blog.g0tmi1k.com/2011/08/basic-linux-privilege-escalation/\n    - https://patrick-bareiss.com/detect-privilege-escalation-preparation-in-linux-with-sigma/\nauthor: Patrick Bareiss\ndate: 2019/04/05\ntags:\n    - attack.privilege_escalation\n    - attack.t1068\nlevel: medium\nlogsource:\n    product: linux\ndetection:\n    keywords:\n        # distribution type and kernel version\n        - 'cat /etc/issue'\n        - 'cat /etc/*-release'\n        - 'cat /proc/version'\n        - 'uname -a'\n        - 'uname -mrs'\n        - 'rpm -q kernel'\n        - 'dmesg | grep Linux'\n        - 'ls /boot | grep vmlinuz-'\n        # environment variables\n        - 'cat /etc/profile'\n        - 'cat /etc/bashrc'\n        - 'cat ~/.bash_profile'\n        - 'cat ~/.bashrc'\n        - 'cat ~/.bash_logout'\n        # applications and services as root\n        - 'ps -aux | grep root'\n        - 'ps -ef | grep root'\n        # scheduled tasks\n        - 'crontab -l'\n        - 'cat /etc/cron*'\n        - 'cat /etc/cron.allow'\n        - 'cat /etc/cron.deny'\n        - 'cat /etc/crontab'\n        # search for plain text user/passwords\n        - 'grep -i user *'\n        - 'grep -i pass *'\n        # networking\n        - 'ifconfig'\n        - 'cat /etc/network/interfaces'\n        - 'cat /etc/sysconfig/network'\n        - 'cat /etc/resolv.conf'\n        - 'cat /etc/networks'\n        - 'iptables -L'\n        - 'lsof -i'\n        - 'netstat -antup'\n        - 'netstat -antpx'\n        - 'netstat -tulpn'\n        - 'arp -e'\n        - 'route'\n        # sensitive files\n        - 'cat /etc/passwd'\n        - 'cat /etc/group'\n        - 'cat /etc/shadow'\n        # sticky bits\n        - 'find / -perm -u=s'\n        - 'find / -perm -g=s'\n        - 'find / -perm -4000'\n        - 'find / -perm -2000'\n    timeframe: 30m\n    condition: keywords | count() by host > 6\nfalsepositives:\n    - Troubleshooting on Linux Machines\n", "object_marking_refs": ["marking-definition--0a872d70-1d05-45dd-a25f-031af547a102"], "created_by_ref": "identity--082ca4f0-d825-45b6-aa42-ab9afd1e5503", "type": "indicator", "spec_version": "2.1", "id": "indicator--20939742-d435-4ceb-b12d-af40b717b7db", "modified": "2020-04-02T07:58:54.587Z"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--a81da1a0-858c-46c0-bef7-f0fff0a77ce7", "created": "2020-04-02T07:58:54.602Z", "modified": "2020-04-02T07:58:54.602Z", "source_ref": "indicator--20939742-d435-4ceb-b12d-af40b717b7db", "relationship_type": "indicates", "target_ref": "attack-pattern--b21c3b2d-02e6-45b1-980b-e69051040839"}, {"name": "AWS EC2 Download Userdata", "description": "Detects bulk downloading of User Data associated with AWS EC2 instances. Instance User Data may include installation scripts and hard-coded secrets for deployment.", "created": "2020-02-11T00:00:00.000Z", "valid_from": "2020-02-11T00:00:00Z", "indicator_types": ["malicious-activity"], "pattern_type": "sigma", "pattern": "title: AWS EC2 Download Userdata\nid: 26ff4080-194e-47e7-9889-ef7602efed0c\nstatus: experimental\nauthor: faloker\ndate: 2020/02/11\ndescription: Detects bulk downloading of User Data associated with AWS EC2 instances. Instance User Data may include installation scripts and hard-coded secrets for deployment.\nreferences:\n    - https://github.com/RhinoSecurityLabs/pacu/blob/master/modules/ec2__download_userdata/main.py#L24\nlogsource:\n    service: cloudtrail\ndetection:\n    selection_source:\n        - eventSource: ec2.amazonaws.com\n    selection_requesttype:\n        - requestParameters.attribute: userData\n    selection_eventname:\n        - eventName: DescribeInstanceAttribute\n    timeframe: 30m\n    condition: all of them | count() > 10\nlevel: medium\nfalsepositives:\n    - Assets management software like device42\ntags:\n    - attack.t1020\n", "object_marking_refs": ["marking-definition--0a872d70-1d05-45dd-a25f-031af547a102"], "created_by_ref": "identity--082ca4f0-d825-45b6-aa42-ab9afd1e5503", "type": "indicator", "spec_version": "2.1", "id": "indicator--e8939e31-fc15-4ac4-a03f-bd8455776d0f", "modified": "2020-04-02T07:58:54.614Z"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--147ed494-899e-4242-8a34-28a3fea9f53e", "created": "2020-04-02T07:58:54.627Z", "modified": "2020-04-02T07:58:54.627Z", "source_ref": "indicator--e8939e31-fc15-4ac4-a03f-bd8455776d0f", "relationship_type": "indicates", "target_ref": "attack-pattern--774a3188-6ba9-4dc4-879d-d54ee48a5ce9"}, {"name": "Restore Public AWS RDS Instance", "description": "Detects the recovery of a new public database instance from a snapshot. It may be a part of data exfiltration.", "created": "2020-02-12T00:00:00.000Z", "valid_from": "2020-02-12T00:00:00Z", "indicator_types": ["malicious-activity"], "pattern_type": "sigma", "pattern": "title: Restore Public AWS RDS Instance\nid: c3f265c7-ff03-4056-8ab2-d486227b4599\nstatus: experimental\nauthor: faloker\ndate: 2020/02/12\ndescription: Detects the recovery of a new public database instance from a snapshot. It may be a part of data exfiltration.\nreferences:\n    - https://github.com/RhinoSecurityLabs/pacu/blob/master/modules/rds__explore_snapshots/main.py#L10\nlogsource:\n    service: cloudtrail\ndetection:\n    selection_source:\n        - eventSource: rds.amazonaws.com\n    selection_ispublic:\n        - responseElements.publiclyAccessible: \"true\"\n    selection_eventname:\n        - eventName: RestoreDBInstanceFromDBSnapshot\n    condition: all of them\nlevel: high\nfalsepositives:\n    - unknown\ntags:\n    - attack.t1020\n", "object_marking_refs": ["marking-definition--0a872d70-1d05-45dd-a25f-031af547a102"], "created_by_ref": "identity--082ca4f0-d825-45b6-aa42-ab9afd1e5503", "type": "indicator", "spec_version": "2.1", "id": "indicator--3c994957-fe0f-419c-accf-bcb1e685d19a", "modified": "2020-04-02T07:58:54.631Z"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--20ea89bc-2d52-479e-912f-cc1f88eb8dbd", "created": "2020-04-02T07:58:54.647Z", "modified": "2020-04-02T07:58:54.647Z", "source_ref": "indicator--3c994957-fe0f-419c-accf-bcb1e685d19a", "relationship_type": "indicates", "target_ref": "attack-pattern--774a3188-6ba9-4dc4-879d-d54ee48a5ce9"}, {"name": "AWS CloudTrail Important Change", "description": "Detects disabling, deleting and updating of a Trail", "created": "2020-01-21T00:00:00.000Z", "valid_from": "2020-01-21T00:00:00Z", "indicator_types": ["malicious-activity"], "pattern_type": "sigma", "pattern": "title: AWS CloudTrail Important Change\nid: 4db60cc0-36fb-42b7-9b58-a5b53019fb74\nstatus: experimental\nauthor: vitaliy0x1\ndate: 2020/01/21\ndescription: Detects disabling, deleting and updating of a Trail\nreferences:\n  - https://docs.aws.amazon.com/awscloudtrail/latest/userguide/best-practices-security.html\nlogsource:\n  service: cloudtrail\ndetection:\n  selection_source:\n    - eventSource: cloudtrail.amazonaws.com\n  events:\n    - eventName:\n        - StopLogging\n        - UpdateTrail\n        - DeleteTrail\n  condition: selection_source AND events\nlevel: medium\nfalsepositives:\n    - Valid change in a Trail\ntags:\n  - attack.t1089\n", "object_marking_refs": ["marking-definition--0a872d70-1d05-45dd-a25f-031af547a102"], "created_by_ref": "identity--082ca4f0-d825-45b6-aa42-ab9afd1e5503", "type": "indicator", "spec_version": "2.1", "id": "indicator--e6a70cfe-47f7-429e-b997-a2991c283947", "modified": "2020-04-02T07:58:54.650Z"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--12252371-d546-4ed1-b412-04dc6743ccc9", "created": "2020-04-02T07:58:54.661Z", "modified": "2020-04-02T07:58:54.661Z", "source_ref": "indicator--e6a70cfe-47f7-429e-b997-a2991c283947", "relationship_type": "indicates", "target_ref": "attack-pattern--2e0dd10b-676d-4964-acd0-8a404c92b044"}, {"name": "AWS GuardDuty Important Change", "description": "Detects updates of the GuardDuty list of trusted IPs, perhaps to disable security alerts against malicious IPs.", "created": "2020-02-11T00:00:00.000Z", "valid_from": "2020-02-11T00:00:00Z", "indicator_types": ["malicious-activity"], "pattern_type": "sigma", "pattern": "title: AWS GuardDuty Important Change\nid: 6e61ee20-ce00-4f8d-8aee-bedd8216f7e3\nstatus: experimental\nauthor: faloker\ndate: 2020/02/11\ndescription: Detects updates of the GuardDuty list of trusted IPs, perhaps to disable security alerts against malicious IPs.\nreferences:\n    - https://github.com/RhinoSecurityLabs/pacu/blob/master/modules/guardduty__whitelist_ip/main.py#L9\nlogsource:\n    service: cloudtrail\ndetection:\n    selection_source:\n        - eventSource: guardduty.amazonaws.com\n    selection_eventName:\n        - eventName: CreateIPSet\n    condition: all of them\nlevel: high\nfalsepositives:\n    - Valid change in the GuardDuty (e.g. to ignore internal scanners)\ntags:\n    - attack.t1089\n", "object_marking_refs": ["marking-definition--0a872d70-1d05-45dd-a25f-031af547a102"], "created_by_ref": "identity--082ca4f0-d825-45b6-aa42-ab9afd1e5503", "type": "indicator", "spec_version": "2.1", "id": "indicator--ca18b59a-4f99-4c86-847b-a5651c26df1e", "modified": "2020-04-02T07:58:54.666Z"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--360e5ba3-7e0c-4d9d-a57d-ee7c72c09c7e", "created": "2020-04-02T07:58:54.680Z", "modified": "2020-04-02T07:58:54.680Z", "source_ref": "indicator--ca18b59a-4f99-4c86-847b-a5651c26df1e", "relationship_type": "indicates", "target_ref": "attack-pattern--2e0dd10b-676d-4964-acd0-8a404c92b044"}, {"name": "AWS EC2 Startup Shell Script Change", "description": "Detects changes to the EC2 instance startup script. The shell script will be executed as root/SYSTEM everytime the specific instances are booted up.", "created": "2020-02-12T00:00:00.000Z", "valid_from": "2020-02-12T00:00:00Z", "indicator_types": ["malicious-activity"], "pattern_type": "sigma", "pattern": "title: AWS EC2 Startup Shell Script Change\nid: 1ab3c5ed-5baf-417b-bb6b-78ca33f6c3df\nstatus: experimental\nauthor: faloker\ndate: 2020/02/12\ndescription: Detects changes to the EC2 instance startup script. The shell script will be executed as root/SYSTEM everytime the specific instances are booted up.\nreferences:\n    - https://github.com/RhinoSecurityLabs/pacu/blob/master/modules/ec2__startup_shell_script/main.py#L9\nlogsource:\n    service: cloudtrail\ndetection:\n    selection_source:\n        - eventSource: ec2.amazonaws.com\n    selection_userdata:\n        - requestParameters.userData: \"*\"\n    selection_eventname:\n        - eventName: ModifyInstanceAttribute\n    condition: all of them\nlevel: high\nfalsepositives:\n    - Valid changes to the startup script\ntags:\n    - attack.t1064\n", "object_marking_refs": ["marking-definition--0a872d70-1d05-45dd-a25f-031af547a102"], "created_by_ref": "identity--082ca4f0-d825-45b6-aa42-ab9afd1e5503", "type": "indicator", "spec_version": "2.1", "id": "indicator--5d42a262-71a8-4369-aaf4-4183af2a8c05", "modified": "2020-04-02T07:58:54.689Z"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--ddd4de0a-e6c3-4aaf-8588-6613b5e7d34a", "created": "2020-04-02T07:58:54.701Z", "modified": "2020-04-02T07:58:54.701Z", "source_ref": "indicator--5d42a262-71a8-4369-aaf4-4183af2a8c05", "relationship_type": "indicates", "target_ref": "attack-pattern--7fd87010-3a00-4da3-b905-410525e8ec44"}, {"name": "AWS Root Credentials", "description": "Detects AWS root account usage", "created": "2020-01-21T00:00:00.000Z", "valid_from": "2020-01-21T00:00:00Z", "indicator_types": ["malicious-activity"], "pattern_type": "sigma", "pattern": "title: AWS Root Credentials\nid: 8ad1600d-e9dc-4251-b0ee-a65268f29add\nstatus: experimental\nauthor: vitaliy0x1\ndate: 2020/01/21\ndescription: Detects AWS root account usage\nreferences:\n  - https://docs.aws.amazon.com/IAM/latest/UserGuide/id_root-user.html\nlogsource:\n  service: cloudtrail\ndetection:\n  selection_usertype:\n    - userIdentity.type: Root\n  selection_eventtype:\n    - eventType: AwsServiceEvent\n  condition: selection_usertype AND NOT selection_eventtype\nlevel: medium\nfalsepositives:\n    - AWS Tasks That Require AWS Account Root User Credentials https://docs.aws.amazon.com/general/latest/gr/aws_tasks-that-require-root.html\ntags:\n  - attack.t1078\n", "object_marking_refs": ["marking-definition--0a872d70-1d05-45dd-a25f-031af547a102"], "created_by_ref": "identity--082ca4f0-d825-45b6-aa42-ab9afd1e5503", "type": "indicator", "spec_version": "2.1", "id": "indicator--694c3475-2400-4bea-ab49-3d5c8ac404a4", "modified": "2020-04-02T07:58:54.705Z"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--ac87730f-ed7c-492d-9315-6faf5837ee08", "created": "2020-04-02T07:58:54.718Z", "modified": "2020-04-02T07:58:54.718Z", "source_ref": "indicator--694c3475-2400-4bea-ab49-3d5c8ac404a4", "relationship_type": "indicates", "target_ref": "attack-pattern--b17a1a56-e99c-403c-8948-561df0cffe81"}, {"name": "AWS IAM Backdoor Users Keys", "description": "Detects AWS API key creation for a user by another user. Backdoored users can be used to obtain persistence in the AWS environment. Also with this alert, you can detect a flow of AWS keys in your org.", "created": "2020-02-12T00:00:00.000Z", "valid_from": "2020-02-12T00:00:00Z", "indicator_types": ["malicious-activity"], "pattern_type": "sigma", "pattern": "title: AWS IAM Backdoor Users Keys\nid: 0a5177f4-6ca9-44c2-aacf-d3f3d8b6e4d2\nstatus: experimental\nauthor: faloker\ndate: 2020/02/12\ndescription: Detects AWS API key creation for a user by another user. Backdoored users can be used to obtain persistence in the AWS environment. Also with this alert, you can detect a flow of AWS keys in your org.\nreferences:\n    - https://github.com/RhinoSecurityLabs/pacu/blob/master/modules/iam__backdoor_users_keys/main.py#L6\nlogsource:\n    service: cloudtrail\ndetection:\n    selection_source:\n        - eventSource: iam.amazonaws.com\n    selection_eventname:\n        - eventName: CreateAccessKey\n    filter:\n        userIdentity.arn|contains: responseElements.accessKey.userName\n    condition: all of selection* and not filter\nfields:\n    - userIdentity.arn\n    - responseElements.accessKey.userName\n    - errorCode\n    - errorMessage\nlevel: medium\nfalsepositives:\n    - Adding user keys to their own accounts (the filter cannot cover all possible variants of user naming)\n    - AWS API keys legitimate exchange workflows\ntags:\n    - attack.t1098\n", "object_marking_refs": ["marking-definition--0a872d70-1d05-45dd-a25f-031af547a102"], "created_by_ref": "identity--082ca4f0-d825-45b6-aa42-ab9afd1e5503", "type": "indicator", "spec_version": "2.1", "id": "indicator--8fc10aff-8db3-4f98-b48e-aecbb3f6cebe", "modified": "2020-04-02T07:58:54.723Z"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--a74bc921-fcf5-4dbc-b7d1-89284ec2026c", "created": "2020-04-02T07:58:54.738Z", "modified": "2020-04-02T07:58:54.738Z", "source_ref": "indicator--8fc10aff-8db3-4f98-b48e-aecbb3f6cebe", "relationship_type": "indicates", "target_ref": "attack-pattern--a10641f4-87b4-45a3-a906-92a149cb2c27"}, {"name": "AWS RDS Master Password Change", "description": "Detects the change of database master password. It may be a part of data exfiltration.", "created": "2020-02-12T00:00:00.000Z", "valid_from": "2020-02-12T00:00:00Z", "indicator_types": ["malicious-activity"], "pattern_type": "sigma", "pattern": "title: AWS RDS Master Password Change\nid: 8a63cdd4-6207-414a-85bc-7e032bd3c1a2\nstatus: experimental\nauthor: faloker\ndate: 2020/02/12\ndescription: Detects the change of database master password. It may be a part of data exfiltration.\nreferences:\n    - https://github.com/RhinoSecurityLabs/pacu/blob/master/modules/rds__explore_snapshots/main.py#L10\nlogsource:\n    service: cloudtrail\ndetection:\n    selection_source:\n        - eventSource: rds.amazonaws.com\n    selection_modified_values:\n        - responseElements.pendingModifiedValues.masterUserPassword: \"*\"\n    selection_eventname:\n        - eventName: ModifyDBInstance\n    condition: all of them\nlevel: medium\nfalsepositives:\n    - Benign changes to a db instance\ntags:\n    - attack.t1020\n", "object_marking_refs": ["marking-definition--0a872d70-1d05-45dd-a25f-031af547a102"], "created_by_ref": "identity--082ca4f0-d825-45b6-aa42-ab9afd1e5503", "type": "indicator", "spec_version": "2.1", "id": "indicator--38492c7c-7a47-4257-b975-cbd94823f4b2", "modified": "2020-04-02T07:58:54.742Z"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--a40d18cb-80fe-4e81-b04c-5e1f929d35d5", "created": "2020-04-02T07:58:54.754Z", "modified": "2020-04-02T07:58:54.754Z", "source_ref": "indicator--38492c7c-7a47-4257-b975-cbd94823f4b2", "relationship_type": "indicates", "target_ref": "attack-pattern--774a3188-6ba9-4dc4-879d-d54ee48a5ce9"}, {"name": "AWS Config Disabling Channel/Recorder", "description": "Detects AWS Config Service disabling", "created": "2020-01-21T00:00:00.000Z", "valid_from": "2020-01-21T00:00:00Z", "indicator_types": ["malicious-activity"], "pattern_type": "sigma", "pattern": "title: AWS Config Disabling Channel/Recorder\nid: 07330162-dba1-4746-8121-a9647d49d297\nstatus: experimental\nauthor: vitaliy0x1\ndate: 2020/01/21\ndescription: Detects AWS Config Service disabling\nlogsource:\n  service: cloudtrail\ndetection:\n  selection_source:\n    - eventSource: config.amazonaws.com\n  events:\n    - eventName:\n        - DeleteDeliveryChannel\n        - StopConfigurationRecorder\n  condition: selection_source AND events\nlevel: high\nfalsepositives:\n    - Valid change in AWS Config Service\ntags:\n  - attack.t1089\n", "object_marking_refs": ["marking-definition--0a872d70-1d05-45dd-a25f-031af547a102"], "created_by_ref": "identity--082ca4f0-d825-45b6-aa42-ab9afd1e5503", "type": "indicator", "spec_version": "2.1", "id": "indicator--95d2172d-a394-4e7e-992b-8c7f568f0842", "modified": "2020-04-02T07:58:54.757Z"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--f83d2ccf-5df1-41bb-93f6-8ed59d0116f1", "created": "2020-04-02T07:58:54.771Z", "modified": "2020-04-02T07:58:54.771Z", "source_ref": "indicator--95d2172d-a394-4e7e-992b-8c7f568f0842", "relationship_type": "indicates", "target_ref": "attack-pattern--2e0dd10b-676d-4964-acd0-8a404c92b044"}, {"name": "Brute Force", "description": "Detects many authentication failures from one source to one destination which is may indicate Brute Force activity", "created": "2019-10-25T00:00:00.000Z", "valid_from": "2019-10-25T00:00:00Z", "indicator_types": ["malicious-activity"], "pattern_type": "sigma", "pattern": "title: Brute Force\nid: 53c7cca0-2901-493a-95db-d00d6fcf0a37\ndescription: Detects many authentication failures from one source to one destination which is may indicate Brute Force activity\ntags:\n    - attack.t1110\nauthor: Aleksandr Akhremchik, oscd.community\ndate: 2019/10/25\nstatus: experimental\nlogsource:\n    category: authentication\ndetection:\n    selection:\n         action: failure\n    timeframe: 600s\n    condition: selection | count(category) by dst_ip > 30\nfields:\n    - src_ip\n    - dst_ip\n    - user\nfalsepositives:\n    - Inventarization\n    - Penetration testing\n    - Vulnerability scanner\n    - Legitimate application\nlevel: medium\n", "object_marking_refs": ["marking-definition--0a872d70-1d05-45dd-a25f-031af547a102"], "created_by_ref": "identity--082ca4f0-d825-45b6-aa42-ab9afd1e5503", "type": "indicator", "spec_version": "2.1", "id": "indicator--4b0a6792-9c2d-43be-9648-cdde9f9242d1", "modified": "2020-04-02T07:58:54.774Z"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--4ed7b50d-793e-4390-ac56-868b602d7a6c", "created": "2020-04-02T07:58:54.788Z", "modified": "2020-04-02T07:58:54.788Z", "source_ref": "indicator--4b0a6792-9c2d-43be-9648-cdde9f9242d1", "relationship_type": "indicates", "target_ref": "attack-pattern--a93494bb-4b80-4ea1-8695-3236a49916fd"}, {"name": "PsExec Tool Execution", "description": "Detects PsExec service installation and execution events (service and Sysmon)", "created": "2017-06-12T00:00:00.000Z", "valid_from": "2017-06-12T00:00:00Z", "indicator_types": ["malicious-activity"], "pattern_type": "sigma", "pattern": "action: global\ntitle: PsExec Tool Execution\nid: 42c575ea-e41e-41f1-b248-8093c3e82a28\nstatus: experimental\ndescription: Detects PsExec service installation and execution events (service and Sysmon)\nauthor: Thomas Patzke\ndate: 2017/06/12\nreferences:\n    - https://www.jpcert.or.jp/english/pub/sr/ir_research.html\n    - https://jpcertcc.github.io/ToolAnalysisResultSheet\ntags:\n    - attack.execution\n    - attack.t1035\n    - attack.s0029\ndetection:\n    condition: 1 of them\nfields:\n    - EventID\n    - CommandLine\n    - ParentCommandLine\n    - ServiceName\n    - ServiceFileName\nfalsepositives:\n    - unknown\nlevel: low\n", "object_marking_refs": ["marking-definition--0a872d70-1d05-45dd-a25f-031af547a102"], "created_by_ref": "identity--082ca4f0-d825-45b6-aa42-ab9afd1e5503", "type": "indicator", "spec_version": "2.1", "id": "indicator--90f56848-3ee6-4da3-bcf6-aeba0727cb2c", "modified": "2020-04-02T07:58:54.808Z"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--d4e3dc0d-c678-4682-a4f3-bd56abfa7716", "created": "2020-04-02T07:58:54.822Z", "modified": "2020-04-02T07:58:54.822Z", "source_ref": "indicator--90f56848-3ee6-4da3-bcf6-aeba0727cb2c", "relationship_type": "indicates", "target_ref": "attack-pattern--f44731de-ea9f-406d-9b83-30ecbb9b4392"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--cfca9fe3-92aa-48ed-9f67-9638606dc99f", "created": "2020-04-02T07:58:54.836Z", "modified": "2020-04-02T07:58:54.836Z", "source_ref": "indicator--90f56848-3ee6-4da3-bcf6-aeba0727cb2c", "relationship_type": "indicates", "target_ref": "tool--ff6caf67-ea1f-4895-b80e-4bb0fc31c6db"}, {"name": "Windows Defender Exclusion Set", "description": "Detects scenarios where an windows defender exclusion was added in registry where an entity would want to bypass antivirus scanning from windows defender", "created": "2019-10-26T00:00:00.000Z", "valid_from": "2019-10-26T00:00:00Z", "indicator_types": ["malicious-activity"], "pattern_type": "sigma", "pattern": "title: Windows Defender Exclusion Set\nid: e9c8808f-4cfb-4ba9-97d4-e5f3beaa244d\ndescription: 'Detects scenarios where an windows defender exclusion was added in registry where an entity would want to bypass antivirus scanning from windows defender'\nreferences:\n    - https://www.bleepingcomputer.com/news/security/gootkit-malware-bypasses-windows-defender-by-setting-path-exclusions/\ntags:\n    - attack.defense_evasion\n    - attack.t1089\nauthor: \"@BarryShooshooga\"\ndate: 2019/10/26\nlogsource:\n    product: windows\n    service: security\n    definition: 'Requirements: Audit Policy : Security Settings/Local Policies/Audit Policy, Registry System Access Control (SACL): Auditing/User'\ndetection:\n    selection:\n        EventID: \n            - 4657\n            - 4656\n            - 4660\n            - 4663\n        ObjectName|contains: '\\Microsoft\\Windows Defender\\Exclusions\\'\n    condition: selection\nfalsepositives: \n    - Intended inclusions by administrator\nlevel: high\n", "object_marking_refs": ["marking-definition--0a872d70-1d05-45dd-a25f-031af547a102"], "created_by_ref": "identity--082ca4f0-d825-45b6-aa42-ab9afd1e5503", "type": "indicator", "spec_version": "2.1", "id": "indicator--48473cce-c12b-433a-b29a-0f2dff8df4f7", "modified": "2020-04-02T07:58:54.842Z"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--72c97796-7b2a-4260-98f3-1f10329822e5", "created": "2020-04-02T07:58:54.855Z", "modified": "2020-04-02T07:58:54.855Z", "source_ref": "indicator--48473cce-c12b-433a-b29a-0f2dff8df4f7", "relationship_type": "indicates", "target_ref": "attack-pattern--2e0dd10b-676d-4964-acd0-8a404c92b044"}, {"name": "Rare Scheduled Task Creations", "description": "This rule detects rare scheduled task creations. Typically software gets installed on multiple systems and not only on a few. The aggregation and count function selects tasks with rare names.", "created": "2017-03-17T00:00:00.000Z", "valid_from": "2017-03-17T00:00:00Z", "indicator_types": ["malicious-activity"], "pattern_type": "sigma", "pattern": "title: Rare Scheduled Task Creations\nid: b20f6158-9438-41be-83da-a5a16ac90c2b\nstatus: experimental\ndescription: This rule detects rare scheduled task creations. Typically software gets installed on multiple systems and not only on a few. The aggregation and count\n    function selects tasks with rare names.\ntags:\n    - attack.persistence\n    - attack.t1053\n    - attack.s0111\nauthor: Florian Roth\ndate: 2017/03/17\nlogsource:\n    product: windows\n    service: taskscheduler\ndetection:\n    selection:\n        EventID: 106\n    timeframe: 7d\n    condition: selection | count() by TaskName < 5\nfalsepositives:\n    - Software installation\nlevel: low\n", "object_marking_refs": ["marking-definition--0a872d70-1d05-45dd-a25f-031af547a102"], "created_by_ref": "identity--082ca4f0-d825-45b6-aa42-ab9afd1e5503", "type": "indicator", "spec_version": "2.1", "id": "indicator--8cd365d1-51b4-4c80-8438-1cbbe8b2f559", "modified": "2020-04-02T07:58:54.858Z"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--f5cb9794-fbb1-438b-b5d1-af7b80c7609f", "created": "2020-04-02T07:58:54.873Z", "modified": "2020-04-02T07:58:54.873Z", "source_ref": "indicator--8cd365d1-51b4-4c80-8438-1cbbe8b2f559", "relationship_type": "indicates", "target_ref": "attack-pattern--35dd844a-b219-4e2b-a6bb-efa9a75995a9"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--a0750598-e9db-47ee-8e25-956c691b3b63", "created": "2020-04-02T07:58:54.889Z", "modified": "2020-04-02T07:58:54.889Z", "source_ref": "indicator--8cd365d1-51b4-4c80-8438-1cbbe8b2f559", "relationship_type": "indicates", "target_ref": "tool--c9703cd3-141c-43a0-a926-380082be5d04"}, {"name": "WMI Persistence", "description": "Detects suspicious WMI event filter and command line event consumer based on event id 5861 and 5859 (Windows 10, 2012 and higher)", "created": "2017-08-22T00:00:00.000Z", "valid_from": "2017-08-22T00:00:00Z", "indicator_types": ["malicious-activity"], "pattern_type": "sigma", "pattern": "title: WMI Persistence\nid: 0b7889b4-5577-4521-a60a-3376ee7f9f7b\nstatus: experimental\ndescription: Detects suspicious WMI event filter and command line event consumer based on event id 5861 and 5859 (Windows 10, 2012 and higher)\nauthor: Florian Roth\ndate: 2017/08/22\nreferences:\n    - https://twitter.com/mattifestation/status/899646620148539397\n    - https://www.eideon.com/2018-03-02-THL03-WMIBackdoors/\ntags:\n    - attack.execution\n    - attack.persistence\n    - attack.t1047\nlogsource:\n    product: windows\n    service: wmi\ndetection:\n    selection:\n        EventID: 5861\n    keywords:\n        Message:\n            - '*ActiveScriptEventConsumer*'\n            - '*CommandLineEventConsumer*'\n            - '*CommandLineTemplate*'\n        # - 'Binding EventFilter'  # too many false positive with HP Health Driver\n    selection2:\n        EventID: 5859\n    condition: selection and 1 of keywords or selection2\nfalsepositives:\n    - Unknown (data set is too small; further testing needed)\nlevel: medium\n", "object_marking_refs": ["marking-definition--0a872d70-1d05-45dd-a25f-031af547a102"], "created_by_ref": "identity--082ca4f0-d825-45b6-aa42-ab9afd1e5503", "type": "indicator", "spec_version": "2.1", "id": "indicator--9cb7935e-6888-4e0b-a256-59a088020b8f", "modified": "2020-04-02T07:58:54.893Z"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--827dc927-a166-4135-918c-e100285bd91e", "created": "2020-04-02T07:58:54.909Z", "modified": "2020-04-02T07:58:54.909Z", "source_ref": "indicator--9cb7935e-6888-4e0b-a256-59a088020b8f", "relationship_type": "indicates", "target_ref": "attack-pattern--01a5a209-b94c-450b-b7f9-946497d91055"}, {"name": "Antivirus Web Shell Detection", "description": "Detects a highly relevant Antivirus alert that reports a web shell", "created": "2018-09-09T00:00:00.000Z", "modified": "2019-10-04T00:00:00.000Z", "valid_from": "2018-09-09T00:00:00Z", "indicator_types": ["malicious-activity"], "pattern_type": "sigma", "pattern": "title: Antivirus Web Shell Detection\nid: fdf135a2-9241-4f96-a114-bb404948f736\ndescription: Detects a highly relevant Antivirus alert that reports a web shell\ndate: 2018/09/09\nmodified: 2019/10/04\nauthor: Florian Roth\nreferences:\n    - https://www.nextron-systems.com/2018/09/08/antivirus-event-analysis-cheat-sheet-v1-4/\ntags:\n    - attack.persistence\n    - attack.t1100\nlogsource:\n    product: antivirus\ndetection:\n    selection:\n        Signature: \n            - \"PHP/Backdoor*\"\n            - \"JSP/Backdoor*\"\n            - \"ASP/Backdoor*\"\n            - \"Backdoor.PHP*\"\n            - \"Backdoor.JSP*\"\n            - \"Backdoor.ASP*\"\n            - \"*Webshell*\"\n    condition: selection\nfields:\n    - FileName\n    - User\nfalsepositives:\n    - Unlikely\nlevel: critical\n", "object_marking_refs": ["marking-definition--0a872d70-1d05-45dd-a25f-031af547a102"], "created_by_ref": "identity--082ca4f0-d825-45b6-aa42-ab9afd1e5503", "type": "indicator", "spec_version": "2.1", "id": "indicator--6f8a98b5-5441-43a3-8449-fad8241c7def"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--6c7fce2a-5b97-4780-9e10-d110a511924c", "created": "2020-04-02T07:58:54.933Z", "modified": "2020-04-02T07:58:54.933Z", "source_ref": "indicator--6f8a98b5-5441-43a3-8449-fad8241c7def", "relationship_type": "indicates", "target_ref": "attack-pattern--c16e5409-ee53-4d79-afdc-4099dc9292df"}, {"name": "Antivirus Exploitation Framework Detection", "description": "Detects a highly relevant Antivirus alert that reports an exploitation framework", "created": "2018-09-09T00:00:00.000Z", "modified": "2019-01-16T00:00:00.000Z", "valid_from": "2018-09-09T00:00:00Z", "indicator_types": ["malicious-activity"], "pattern_type": "sigma", "pattern": "title: Antivirus Exploitation Framework Detection\nid: 238527ad-3c2c-4e4f-a1f6-92fd63adb864\ndescription: Detects a highly relevant Antivirus alert that reports an exploitation framework\ndate: 2018/09/09\nmodified: 2019/01/16\nauthor: Florian Roth\nreferences:\n    - https://www.nextron-systems.com/2018/09/08/antivirus-event-analysis-cheat-sheet-v1-4/\ntags:\n    - attack.execution\n    - attack.t1203\n    - attack.command_and_control\n    - attack.t1219\nlogsource:\n    product: antivirus\ndetection:\n    selection:\n        Signature: \n            - \"*MeteTool*\"\n            - \"*MPreter*\"\n            - \"*Meterpreter*\"\n            - \"*Metasploit*\"\n            - \"*PowerSploit*\"\n            - \"*CobaltSrike*\"\n            - \"*Swrort*\"\n            - \"*Rozena*\"\n            - \"*Backdoor.Cobalt*\"\n    condition: selection\nfields:\n    - FileName\n    - User\nfalsepositives:\n    - Unlikely\nlevel: critical\n", "object_marking_refs": ["marking-definition--0a872d70-1d05-45dd-a25f-031af547a102"], "created_by_ref": "identity--082ca4f0-d825-45b6-aa42-ab9afd1e5503", "type": "indicator", "spec_version": "2.1", "id": "indicator--978a2d97-1fc6-4884-b7b1-6688c543cf6c"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--1888d6ea-96ef-4cc6-8506-34f28e3766b6", "created": "2020-04-02T07:58:54.960Z", "modified": "2020-04-02T07:58:54.960Z", "source_ref": "indicator--978a2d97-1fc6-4884-b7b1-6688c543cf6c", "relationship_type": "indicates", "target_ref": "attack-pattern--be2dcee9-a7a7-4e38-afd6-21b31ecc3d63"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--34088e21-efe9-4945-a0b2-c136fe8d3a0c", "created": "2020-04-02T07:58:54.973Z", "modified": "2020-04-02T07:58:54.973Z", "source_ref": "indicator--978a2d97-1fc6-4884-b7b1-6688c543cf6c", "relationship_type": "indicates", "target_ref": "attack-pattern--4061e78c-1284-44b4-9116-73e4ac3912f7"}, {"name": "Antivirus Password Dumper Detection", "description": "Detects a highly relevant Antivirus alert that reports a password dumper", "created": "2018-09-09T00:00:00.000Z", "modified": "2019-10-04T00:00:00.000Z", "valid_from": "2018-09-09T00:00:00Z", "indicator_types": ["malicious-activity"], "pattern_type": "sigma", "pattern": "title: Antivirus Password Dumper Detection\nid: 78cc2dd2-7d20-4d32-93ff-057084c38b93\ndescription: Detects a highly relevant Antivirus alert that reports a password dumper\ndate: 2018/09/09\nmodified: 2019/10/04\nauthor: Florian Roth\nreferences:\n    - https://www.nextron-systems.com/2018/09/08/antivirus-event-analysis-cheat-sheet-v1-4/\ntags:\n    - attack.credential_access\n    - attack.t1003\nlogsource:\n    product: antivirus\ndetection:\n    selection:\n        Signature: \n            - \"*DumpCreds*\"\n            - \"*Mimikatz*\"\n            - \"*PWCrack*\"\n            - \"HTool/WCE\"\n            - \"*PSWtool*\"\n            - \"*PWDump*\"\n            - \"*SecurityTool*\"\n            - \"*PShlSpy*\"\n    condition: selection\nfields:\n    - FileName\n    - User\nfalsepositives:\n    - Unlikely\nlevel: critical\n", "object_marking_refs": ["marking-definition--0a872d70-1d05-45dd-a25f-031af547a102"], "created_by_ref": "identity--082ca4f0-d825-45b6-aa42-ab9afd1e5503", "type": "indicator", "spec_version": "2.1", "id": "indicator--997431e5-2dc7-4917-8a31-da4de4d07fe6"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--e96fc84a-338d-47f2-9589-fb48ab4516c2", "created": "2020-04-02T07:58:54.995Z", "modified": "2020-04-02T07:58:54.995Z", "source_ref": "indicator--997431e5-2dc7-4917-8a31-da4de4d07fe6", "relationship_type": "indicates", "target_ref": "attack-pattern--0a3ead4e-6d47-4ccb-854c-a6a4f9d96b22"}, {"name": "Ursnif", "description": "Detects new registry key created by Ursnif malware.", "created": "2019-02-13T00:00:00.000Z", "valid_from": "2019-02-13T00:00:00Z", "indicator_types": ["malicious-activity"], "pattern_type": "sigma", "pattern": "title: Ursnif\nid: 21f17060-b282-4249-ade0-589ea3591558\nstatus: experimental\ndescription: Detects new registry key created by Ursnif malware.\nreferences:\n    - https://blog.yoroi.company/research/ursnif-long-live-the-steganography/\n    - https://blog.trendmicro.com/trendlabs-security-intelligence/phishing-campaign-uses-hijacked-emails-to-deliver-ursnif-by-replying-to-ongoing-threads/\ntags:\n    - attack.execution\n    - attack.t1112\nauthor: megan201296\ndate: 2019/02/13\nlogsource:\n    product: windows\n    service: sysmon\ndetection:\n    selection:\n        EventID: 13\n        TargetObject: '*\\Software\\AppDataLow\\Software\\Microsoft\\\\*'\n    condition: selection\nfalsepositives:\n    - Unknown\nlevel: critical\n", "object_marking_refs": ["marking-definition--0a872d70-1d05-45dd-a25f-031af547a102"], "created_by_ref": "identity--082ca4f0-d825-45b6-aa42-ab9afd1e5503", "type": "indicator", "spec_version": "2.1", "id": "indicator--4c1b8f58-d0e3-4371-90f1-3f4d3566f591", "modified": "2020-04-02T07:58:54.998Z"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--76c4c004-462b-4a94-b6c0-27e45b11ab9e", "created": "2020-04-02T07:58:55.012Z", "modified": "2020-04-02T07:58:55.012Z", "source_ref": "indicator--4c1b8f58-d0e3-4371-90f1-3f4d3566f591", "relationship_type": "indicates", "target_ref": "attack-pattern--57340c81-c025-4189-8fa0-fc7ede51bae4"}, {"name": "PowerShell Downgrade Attack", "description": "Detects PowerShell downgrade attack by comparing the host versions with the actually used engine version 2.0", "created": "2017-03-22T00:00:00.000Z", "valid_from": "2017-03-22T00:00:00Z", "indicator_types": ["malicious-activity"], "pattern_type": "sigma", "pattern": "title: PowerShell Downgrade Attack\nid: 6331d09b-4785-4c13-980f-f96661356249\nstatus: experimental\ndescription: Detects PowerShell downgrade attack by comparing the host versions with the actually used engine version 2.0\nreferences:\n    - http://www.leeholmes.com/blog/2017/03/17/detecting-and-preventing-powershell-downgrade-attacks/\ntags:\n    - attack.defense_evasion\n    - attack.execution\n    - attack.t1086\nauthor: Florian Roth (rule), Lee Holmes (idea)\ndate: 2017/03/22\nlogsource:\n    product: windows\n    service: powershell-classic\ndetection:\n    selection:\n        EventID: 400\n        EngineVersion: '2.*'\n    filter:\n        HostVersion: '2.*'\n    condition: selection and not filter\nfalsepositives:\n    - Penetration Test\n    - Unknown\nlevel: medium\n", "object_marking_refs": ["marking-definition--0a872d70-1d05-45dd-a25f-031af547a102"], "created_by_ref": "identity--082ca4f0-d825-45b6-aa42-ab9afd1e5503", "type": "indicator", "spec_version": "2.1", "id": "indicator--4396ec9f-c50d-482f-a171-0877095d9ce8", "modified": "2020-04-02T07:58:55.017Z"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--cc505ae0-8a64-4af6-95b7-ff704377a774", "created": "2020-04-02T07:58:55.030Z", "modified": "2020-04-02T07:58:55.030Z", "source_ref": "indicator--4396ec9f-c50d-482f-a171-0877095d9ce8", "relationship_type": "indicates", "target_ref": "attack-pattern--f4882e23-8aa7-4b12-b28a-b349c12ee9e0"}, {"name": "Suspicious PowerShell Download", "description": "Detects suspicious PowerShell download command", "created": "2017-03-05T00:00:00.000Z", "modified": "2020-03-25T00:00:00.000Z", "valid_from": "2017-03-05T00:00:00Z", "indicator_types": ["malicious-activity"], "pattern_type": "sigma", "pattern": "title: Suspicious PowerShell Download\nid: 65531a81-a694-4e31-ae04-f8ba5bc33759\nstatus: experimental\ndescription: Detects suspicious PowerShell download command\ntags:\n    - attack.execution\n    - attack.t1086\nauthor: Florian Roth\ndate: 2017/03/05\nmodified: 2020/03/25\nlogsource:\n    product: windows\n    service: powershell\ndetection:\n    downloadfile:\n        Message|contains|all:\n            - 'System.Net.WebClient'\n            - '.DownloadFile('\n    downloadstring:\n        Message|contains|all:\n            - 'System.Net.WebClient'\n            - '.DownloadString('\n    condition: downloadfile or downloadstring\nfalsepositives:\n    - PowerShell scripts that download content from the Internet\nlevel: medium\n", "object_marking_refs": ["marking-definition--0a872d70-1d05-45dd-a25f-031af547a102"], "created_by_ref": "identity--082ca4f0-d825-45b6-aa42-ab9afd1e5503", "type": "indicator", "spec_version": "2.1", "id": "indicator--e5d3da53-4f15-41d8-b342-b2fb81539216"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--834c2591-463b-4b9c-b4bf-a7716b14dc93", "created": "2020-04-02T07:58:55.045Z", "modified": "2020-04-02T07:58:55.045Z", "source_ref": "indicator--e5d3da53-4f15-41d8-b342-b2fb81539216", "relationship_type": "indicates", "target_ref": "attack-pattern--f4882e23-8aa7-4b12-b28a-b349c12ee9e0"}, {"name": "Invoke-Obfuscation Obfuscated IEX Invocation", "description": "Detects all variations of obfuscated powershell IEX invocation code generated by Invoke-Obfuscation framework from the following code block \u2014 https://github.com/danielbohannon/Invoke-Obfuscation/blob/master/Out-ObfuscatedStringCommand.ps1#L873-L888", "created": "2019-11-08T00:00:00.000Z", "valid_from": "2019-11-08T00:00:00Z", "indicator_types": ["malicious-activity"], "pattern_type": "sigma", "pattern": "title: Invoke-Obfuscation Obfuscated IEX Invocation\nid: 1b9dc62e-6e9e-42a3-8990-94d7a10007f7\ndescription: \"Detects all variations of obfuscated powershell IEX invocation code generated by Invoke-Obfuscation framework from the following code block \\u2014 https://github.com/danielbohannon/Invoke-Obfuscation/blob/master/Out-ObfuscatedStringCommand.ps1#L873-L888\"\nstatus: experimental\nauthor: Daniel Bohannon (@Mandiant/@FireEye), oscd.community\ndate: 2019/11/08\ntags:\n    - attack.defense_evasion\n    - attack.t1027\nlogsource:\n    product: windows\n    service: powershell\ndetection:\n    selection_1:\n        EventID: 4104\n    selection_2:\n        - ScriptBlockText|re: '\\$PSHome\\[\\s*\\d{1,3}\\s*\\]\\s*\\+\\s*\\$PSHome\\['\n        - ScriptBlockText|re: '\\$ShellId\\[\\s*\\d{1,3}\\s*\\]\\s*\\+\\s*\\$ShellId\\['\n        - ScriptBlockText|re: '\\$env:Public\\[\\s*\\d{1,3}\\s*\\]\\s*\\+\\s*\\$env:Public\\['\n        - ScriptBlockText|re: '\\$env:ComSpec\\[(\\s*\\d{1,3}\\s*,){2}'\n        - ScriptBlockText|re: '\\*mdr\\*\\W\\s*\\)\\.Name'\n        - ScriptBlockText|re: '\\$VerbosePreference\\.ToString\\('\n        - ScriptBlockText|re: '\\String\\]\\s*\\$VerbosePreference'\n    selection_3:\n        EventID: 4103\n    selection_4:\n        - Payload|re: '\\$PSHome\\[\\s*\\d{1,3}\\s*\\]\\s*\\+\\s*\\$PSHome\\['\n        - Payload|re: '\\$ShellId\\[\\s*\\d{1,3}\\s*\\]\\s*\\+\\s*\\$ShellId\\['\n        - Payload|re: '\\$env:Public\\[\\s*\\d{1,3}\\s*\\]\\s*\\+\\s*\\$env:Public\\['\n        - Payload|re: '\\$env:ComSpec\\[(\\s*\\d{1,3}\\s*,){2}'\n        - Payload|re: '\\*mdr\\*\\W\\s*\\)\\.Name'\n        - Payload|re: '\\$VerbosePreference\\.ToString\\('\n        - Payload|re: '\\String\\]\\s*\\$VerbosePreference'\n    condition: ( selection_1 and selection_2 ) or ( selection_3 and selection_4 )\nfalsepositives:\n    - Unknown\nlevel: high\n", "object_marking_refs": ["marking-definition--0a872d70-1d05-45dd-a25f-031af547a102"], "created_by_ref": "identity--082ca4f0-d825-45b6-aa42-ab9afd1e5503", "type": "indicator", "spec_version": "2.1", "id": "indicator--b367502e-f3b0-44d4-96e7-7d866f6a07b7", "modified": "2020-04-02T07:58:55.052Z"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--26ed4356-ec33-4a5b-9d45-a42d2288b079", "created": "2020-04-02T07:58:55.065Z", "modified": "2020-04-02T07:58:55.065Z", "source_ref": "indicator--b367502e-f3b0-44d4-96e7-7d866f6a07b7", "relationship_type": "indicates", "target_ref": "attack-pattern--b3d682b6-98f2-4fb0-aa3b-b4df007ca70a"}, {"name": "Suspicious PowerShell Keywords", "description": "Detects keywords that could indicate the use of some PowerShell exploitation framework", "created": "2019-02-11T00:00:00.000Z", "valid_from": "2019-02-11T00:00:00Z", "indicator_types": ["malicious-activity"], "pattern_type": "sigma", "pattern": "title: Suspicious PowerShell Keywords\nid: 1f49f2ab-26bc-48b3-96cc-dcffbc93eadf\nstatus: experimental\ndescription: Detects keywords that could indicate the use of some PowerShell exploitation framework\ndate: 2019/02/11\nauthor: Florian Roth, Perez Diego (@darkquassar)\nreferences:\n    - https://posts.specterops.io/entering-a-covenant-net-command-and-control-e11038bcf462\n    - https://github.com/PowerShellMafia/PowerSploit/blob/master/CodeExecution/Invoke-ReflectivePEInjection.ps1\n    - https://github.com/hlldz/Invoke-Phant0m/blob/master/Invoke-Phant0m.ps1\ntags:\n    - attack.execution\n    - attack.t1086\nlogsource:\n    product: windows\n    service: powershell\n    definition: 'It is recommended to use the new \"Script Block Logging\" of PowerShell v5 https://adsecurity.org/?p=2277. Monitor for EventID 4104'\ndetection:\n    keywords:\n        Message:\n            - \"System.Reflection.Assembly.Load\"\n            - \"[System.Reflection.Assembly]::Load\"\n            - \"[Reflection.Assembly]::Load\"\n            - \"System.Reflection.AssemblyName\"\n            - \"Reflection.Emit.AssemblyBuilderAccess\"\n            - \"Runtime.InteropServices.DllImportAttribute\"\n            - \"SuspendThread\"\n    condition: keywords\nfalsepositives:\n    - Penetration tests\nlevel: high\n", "object_marking_refs": ["marking-definition--0a872d70-1d05-45dd-a25f-031af547a102"], "created_by_ref": "identity--082ca4f0-d825-45b6-aa42-ab9afd1e5503", "type": "indicator", "spec_version": "2.1", "id": "indicator--491c96ae-683d-43ad-a8f1-3712e0be410d", "modified": "2020-04-02T07:58:55.070Z"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--962b4ee2-5979-4650-8d99-39cf6861f4f0", "created": "2020-04-02T07:58:55.082Z", "modified": "2020-04-02T07:58:55.082Z", "source_ref": "indicator--491c96ae-683d-43ad-a8f1-3712e0be410d", "relationship_type": "indicates", "target_ref": "attack-pattern--f4882e23-8aa7-4b12-b28a-b349c12ee9e0"}, {"name": "Malicious PowerShell Commandlets", "description": "Detects Commandlet names from well-known PowerShell exploitation frameworks", "created": "2017-03-05T00:00:00.000Z", "modified": "2019-01-22T00:00:00.000Z", "valid_from": "2017-03-05T00:00:00Z", "indicator_types": ["malicious-activity"], "pattern_type": "sigma", "pattern": "title: Malicious PowerShell Commandlets\nid: 89819aa4-bbd6-46bc-88ec-c7f7fe30efa6\nstatus: experimental\ndescription: Detects Commandlet names from well-known PowerShell exploitation frameworks\nmodified: 2019/01/22\nreferences:\n    - https://adsecurity.org/?p=2921\ntags:\n    - attack.execution\n    - attack.t1086\nauthor: Sean Metcalf (source), Florian Roth (rule)\ndate: 2017/03/05\nlogsource:\n    product: windows\n    service: powershell\n    definition: 'It is recommended to use the new \"Script Block Logging\" of PowerShell v5 https://adsecurity.org/?p=2277'\ndetection:\n    keywords:\n        Message:\n            - \"*Invoke-DllInjection*\"\n            - \"*Invoke-Shellcode*\"\n            - \"*Invoke-WmiCommand*\"\n            - \"*Get-GPPPassword*\"\n            - \"*Get-Keystrokes*\"\n            - \"*Get-TimedScreenshot*\"\n            - \"*Get-VaultCredential*\"\n            - \"*Invoke-CredentialInjection*\"\n            - \"*Invoke-Mimikatz*\"\n            - \"*Invoke-NinjaCopy*\"\n            - \"*Invoke-TokenManipulation*\"\n            - \"*Out-Minidump*\"\n            - \"*VolumeShadowCopyTools*\"\n            - \"*Invoke-ReflectivePEInjection*\"\n            - \"*Invoke-UserHunter*\"\n            - \"*Find-GPOLocation*\"\n            - \"*Invoke-ACLScanner*\"\n            - \"*Invoke-DowngradeAccount*\"\n            - \"*Get-ServiceUnquoted*\"\n            - \"*Get-ServiceFilePermission*\"\n            - \"*Get-ServicePermission*\"\n            - \"*Invoke-ServiceAbuse*\"\n            - \"*Install-ServiceBinary*\"\n            - \"*Get-RegAutoLogon*\"\n            - \"*Get-VulnAutoRun*\"\n            - \"*Get-VulnSchTask*\"\n            - \"*Get-UnattendedInstallFile*\"\n            - \"*Get-ApplicationHost*\"\n            - \"*Get-RegAlwaysInstallElevated*\"\n            - \"*Get-Unconstrained*\"\n            - \"*Add-RegBackdoor*\"\n            - \"*Add-ScrnSaveBackdoor*\"\n            - \"*Gupt-Backdoor*\"\n            - \"*Invoke-ADSBackdoor*\"\n            - \"*Enabled-DuplicateToken*\"\n            - \"*Invoke-PsUaCme*\"\n            - \"*Remove-Update*\"\n            - \"*Check-VM*\"\n            - \"*Get-LSASecret*\"\n            - \"*Get-PassHashes*\"\n            - \"*Show-TargetScreen*\"\n            - \"*Port-Scan*\"\n            - \"*Invoke-PoshRatHttp*\"\n            - \"*Invoke-PowerShellTCP*\"\n            - \"*Invoke-PowerShellWMI*\"\n            - \"*Add-Exfiltration*\"\n            - \"*Add-Persistence*\"\n            - \"*Do-Exfiltration*\"\n            - \"*Start-CaptureServer*\"\n            - \"*Get-ChromeDump*\"\n            - \"*Get-ClipboardContents*\"\n            - \"*Get-FoxDump*\"\n            - \"*Get-IndexedItem*\"\n            - \"*Get-Screenshot*\"\n            - \"*Invoke-Inveigh*\"\n            - \"*Invoke-NetRipper*\"\n            - \"*Invoke-EgressCheck*\"\n            - \"*Invoke-PostExfil*\"\n            - \"*Invoke-PSInject*\"\n            - \"*Invoke-RunAs*\"\n            - \"*MailRaider*\"\n            - \"*New-HoneyHash*\"\n            - \"*Set-MacAttribute*\"\n            - \"*Invoke-DCSync*\"\n            - \"*Invoke-PowerDump*\"\n            - \"*Exploit-Jboss*\"\n            - \"*Invoke-ThunderStruck*\"\n            - \"*Invoke-VoiceTroll*\"\n            - \"*Set-Wallpaper*\"\n            - \"*Invoke-InveighRelay*\"\n            - \"*Invoke-PsExec*\"\n            - \"*Invoke-SSHCommand*\"\n            - \"*Get-SecurityPackages*\"\n            - \"*Install-SSP*\"\n            - \"*Invoke-BackdoorLNK*\"\n            - \"*PowerBreach*\"\n            - \"*Get-SiteListPassword*\"\n            - \"*Get-System*\"\n            - \"*Invoke-BypassUAC*\"\n            - \"*Invoke-Tater*\"\n            - \"*Invoke-WScriptBypassUAC*\"\n            - \"*PowerUp*\"\n            - \"*PowerView*\"\n            - \"*Get-RickAstley*\"\n            - \"*Find-Fruit*\"\n            - \"*HTTP-Login*\"\n            - \"*Find-TrustedDocuments*\"\n            - \"*Invoke-Paranoia*\"\n            - \"*Invoke-WinEnum*\"\n            - \"*Invoke-ARPScan*\"\n            - \"*Invoke-PortScan*\"\n            - \"*Invoke-ReverseDNSLookup*\"\n            - \"*Invoke-SMBScanner*\"\n            - \"*Invoke-Mimikittenz*\"\n            - \"*Invoke-AllChecks*\"\n    false_positives:\n        - Get-SystemDriveInfo  # http://bheltborg.dk/Windows/WinSxS/amd64_microsoft-windows-maintenancediagnostic_31bf3856ad364e35_10.0.10240.16384_none_91ef7543a4514b5e/CL_Utility.ps1\n    condition: keywords and not false_positives\nfalsepositives:\n    - Penetration testing\nlevel: high\n", "object_marking_refs": ["marking-definition--0a872d70-1d05-45dd-a25f-031af547a102"], "created_by_ref": "identity--082ca4f0-d825-45b6-aa42-ab9afd1e5503", "type": "indicator", "spec_version": "2.1", "id": "indicator--5f1b040f-744b-41cd-84c1-eefcf1ec8cdb"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--adad803f-96fd-4d7e-a265-2ef084ed0cef", "created": "2020-04-02T07:58:55.109Z", "modified": "2020-04-02T07:58:55.109Z", "source_ref": "indicator--5f1b040f-744b-41cd-84c1-eefcf1ec8cdb", "relationship_type": "indicates", "target_ref": "attack-pattern--f4882e23-8aa7-4b12-b28a-b349c12ee9e0"}, {"name": "NTFS Alternate Data Stream", "description": "Detects writing data into NTFS alternate data streams from powershell. Needs Script Block Logging.", "created": "2018-07-24T00:00:00.000Z", "valid_from": "2018-07-24T00:00:00Z", "indicator_types": ["malicious-activity"], "pattern_type": "sigma", "pattern": "title: NTFS Alternate Data Stream\nid: 8c521530-5169-495d-a199-0a3a881ad24e\nstatus: experimental\ndescription: Detects writing data into NTFS alternate data streams from powershell. Needs Script Block Logging.\nreferences:\n    - http://www.powertheshell.com/ntfsstreams/\ntags:\n    - attack.defense_evasion\n    - attack.t1096\nauthor: Sami Ruohonen\ndate: 2018/07/24\nlogsource:\n    product: windows\n    service: powershell\n    definition: 'It is recommended to use the new \"Script Block Logging\" of PowerShell v5 https://adsecurity.org/?p=2277'\ndetection:\n    keyword1:\n        - \"set-content\"\n    keyword2:\n        - \"-stream\"\n    condition: keyword1 and keyword2\nfalsepositives:\n    - unknown\nlevel: high\n", "object_marking_refs": ["marking-definition--0a872d70-1d05-45dd-a25f-031af547a102"], "created_by_ref": "identity--082ca4f0-d825-45b6-aa42-ab9afd1e5503", "type": "indicator", "spec_version": "2.1", "id": "indicator--f9aef371-6f54-4f5f-8378-9e64aa4a051c", "modified": "2020-04-02T07:58:55.114Z"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--4e46355c-946f-48cd-bb22-8620b76081d5", "created": "2020-04-02T07:58:55.127Z", "modified": "2020-04-02T07:58:55.127Z", "source_ref": "indicator--f9aef371-6f54-4f5f-8378-9e64aa4a051c", "relationship_type": "indicates", "target_ref": "attack-pattern--f2d44246-91f1-478a-b6c8-1227e0ca109d"}, {"name": "Remote PowerShell Session", "description": "Detects remote PowerShell sessions", "created": "2019-08-10T00:00:00.000Z", "modified": "2019-11-10T00:00:00.000Z", "valid_from": "2019-08-10T00:00:00Z", "indicator_types": ["malicious-activity"], "pattern_type": "sigma", "pattern": "title: Remote PowerShell Session\nid: 96b9f619-aa91-478f-bacb-c3e50f8df575\ndescription: Detects remote PowerShell sessions\nstatus: experimental\ndate: 2019/08/10\nmodified: 2019/11/10\nauthor: Roberto Rodriguez @Cyb3rWard0g\nreferences:\n    - https://github.com/Cyb3rWard0g/ThreatHunter-Playbook/tree/master/playbooks/windows/02_execution/T1086_powershell/powershell_remote_session.md\ntags:\n    - attack.execution\n    - attack.t1086\nlogsource:\n    product: windows\n    service: powershell\ndetection:\n    selection: \n        EventID:\n            - 4103\n            - 400\n        HostName: 'ServerRemoteHost'\n        HostApplication|contains: 'wsmprovhost.exe'\n    condition: selection\nfalsepositives:\n    - Legitimate use remote PowerShell sessions\nlevel: high\n", "object_marking_refs": ["marking-definition--0a872d70-1d05-45dd-a25f-031af547a102"], "created_by_ref": "identity--082ca4f0-d825-45b6-aa42-ab9afd1e5503", "type": "indicator", "spec_version": "2.1", "id": "indicator--59d387ae-5639-4245-aefe-9d1be788cf18"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--1bf2f9e8-45ba-4bdd-9484-1d31df245e4a", "created": "2020-04-02T07:58:55.144Z", "modified": "2020-04-02T07:58:55.144Z", "source_ref": "indicator--59d387ae-5639-4245-aefe-9d1be788cf18", "relationship_type": "indicates", "target_ref": "attack-pattern--f4882e23-8aa7-4b12-b28a-b349c12ee9e0"}, {"name": "PowerShell Credential Prompt", "description": "Detects PowerShell calling a credential prompt", "created": "2017-04-09T00:00:00.000Z", "valid_from": "2017-04-09T00:00:00Z", "indicator_types": ["malicious-activity"], "pattern_type": "sigma", "pattern": "title: PowerShell Credential Prompt\nid: ca8b77a9-d499-4095-b793-5d5f330d450e\nstatus: experimental\ndescription: Detects PowerShell calling a credential prompt\nreferences:\n    - https://twitter.com/JohnLaTwC/status/850381440629981184\n    - https://t.co/ezOTGy1a1G\ntags:\n    - attack.execution\n    - attack.credential_access\n    - attack.t1086\nauthor: John Lambert (idea), Florian Roth (rule)\ndate: 2017/04/09\nlogsource:\n    product: windows\n    service: powershell\n    definition: 'Script block logging must be enabled'\ndetection:\n    selection:\n        EventID: 4104\n    keyword:\n        Message:\n            - '*PromptForCredential*'\n    condition: all of them\nfalsepositives:\n    - Unknown\nlevel: high\n", "object_marking_refs": ["marking-definition--0a872d70-1d05-45dd-a25f-031af547a102"], "created_by_ref": "identity--082ca4f0-d825-45b6-aa42-ab9afd1e5503", "type": "indicator", "spec_version": "2.1", "id": "indicator--57eef61d-9ff0-4b00-9897-be40710502f6", "modified": "2020-04-02T07:58:55.148Z"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--ad0fad89-5074-4ae0-95b6-c50a758d5dea", "created": "2020-04-02T07:58:55.165Z", "modified": "2020-04-02T07:58:55.165Z", "source_ref": "indicator--57eef61d-9ff0-4b00-9897-be40710502f6", "relationship_type": "indicates", "target_ref": "attack-pattern--f4882e23-8aa7-4b12-b28a-b349c12ee9e0"}, {"name": "Malicious Nishang PowerShell Commandlets", "description": "Detects Commandlet names and arguments from the Nishang exploitation framework", "created": "2019-05-16T00:00:00.000Z", "valid_from": "2019-05-16T00:00:00Z", "indicator_types": ["malicious-activity"], "pattern_type": "sigma", "pattern": "title: Malicious Nishang PowerShell Commandlets\nid: f772cee9-b7c2-4cb2-8f07-49870adc02e0\nstatus: experimental\ndescription: Detects Commandlet names and arguments from the Nishang exploitation framework\ndate: 2019/05/16\nreferences:\n    - https://github.com/samratashok/nishang\ntags:\n    - attack.execution\n    - attack.t1086\nauthor: Alec Costello\nlogsource:\n    product: windows\n    service: powershell\n    definition: It is recommanded to use the new \"Script Block Logging\" of PowerShell v5 https://adsecurity.org/?p=2277\ndetection:\n    keywords:\n        - Add-ConstrainedDelegationBackdoor\n        - Set-DCShadowPermissions\n        - DNS_TXT_Pwnage\n        - Execute-OnTime\n        - HTTP-Backdoor\n        - Set-RemotePSRemoting\n        - Set-RemoteWMI\n        - Invoke-AmsiBypass\n        - Out-CHM\n        - Out-HTA\n        - Out-SCF\n        - Out-SCT\n        - Out-Shortcut\n        - Out-WebQuery\n        - Out-Word\n        - Enable-Duplication\n        - Remove-Update\n        - Download-Execute-PS\n        - Download_Execute\n        - Execute-Command-MSSQL\n        - Execute-DNSTXT-Code\n        - Out-RundllCommand\n        - Copy-VSS\n        - FireBuster\n        - FireListener\n        - Get-Information\n        - Get-PassHints\n        - Get-WLAN-Keys\n        - Get-Web-Credentials\n        - Invoke-CredentialsPhish\n        - Invoke-MimikatzWDigestDowngrade\n        - Invoke-SSIDExfil\n        - Invoke-SessionGopher\n        - Keylogger\n        - Invoke-Interceptor\n        - Create-MultipleSessions\n        - Invoke-NetworkRelay\n        - Run-EXEonRemote\n        - Invoke-Prasadhak\n        - Invoke-BruteForce\n        - Password-List\n        - Invoke-JSRatRegsvr\n        - Invoke-JSRatRundll\n        - Invoke-PoshRatHttps\n        - Invoke-PowerShellIcmp\n        - Invoke-PowerShellUdp\n        - Invoke-PSGcat\n        - Invoke-PsGcatAgent\n        - Remove-PoshRat\n        - Add-Persistance\n        - ExetoText\n        - Invoke-Decode\n        - Invoke-Encode\n        - Parse_Keys\n        - Remove-Persistence\n        - StringtoBase64\n        - TexttoExe\n        - Powerpreter\n        - Nishang\n        - EncodedData\n        - DataToEncode\n        - LoggedKeys\n        - OUT-DNSTXT\n        - Jitter\n        - ExfilOption\n        - Tamper\n        - DumpCerts\n        - DumpCreds\n        - Shellcode32\n        - Shellcode64\n        - NotAllNameSpaces\n        - exfill\n        - FakeDC\n        - Exploit\n    condition: keywords\nfalsepositives:\n    - Penetration testing\nlevel: high\n", "object_marking_refs": ["marking-definition--0a872d70-1d05-45dd-a25f-031af547a102"], "created_by_ref": "identity--082ca4f0-d825-45b6-aa42-ab9afd1e5503", "type": "indicator", "spec_version": "2.1", "id": "indicator--b5f8de10-d089-4e1d-bf72-db7dfc68b29e", "modified": "2020-04-02T07:58:55.175Z"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--c9abbb7e-ec54-459d-9359-aefceff780f1", "created": "2020-04-02T07:58:55.186Z", "modified": "2020-04-02T07:58:55.186Z", "source_ref": "indicator--b5f8de10-d089-4e1d-bf72-db7dfc68b29e", "relationship_type": "indicates", "target_ref": "attack-pattern--f4882e23-8aa7-4b12-b28a-b349c12ee9e0"}, {"name": "PowerShell Called from an Executable Version Mismatch", "description": "Detects PowerShell called from an executable by the version mismatch method", "created": "2017-03-05T00:00:00.000Z", "valid_from": "2017-03-05T00:00:00Z", "indicator_types": ["malicious-activity"], "pattern_type": "sigma", "pattern": "title: PowerShell Called from an Executable Version Mismatch\nid: c70e019b-1479-4b65-b0cc-cd0c6093a599\nstatus: experimental\ndescription: Detects PowerShell called from an executable by the version mismatch method\nreferences:\n    - https://adsecurity.org/?p=2921\ntags:\n    - attack.defense_evasion\n    - attack.execution\n    - attack.t1086\nauthor: Sean Metcalf (source), Florian Roth (rule)\ndate: 2017/03/05\nlogsource:\n    product: windows\n    service: powershell-classic\ndetection:\n    selection1:\n        EventID: 400\n        EngineVersion:\n            - '2.*'\n            - '4.*'\n            - '5.*'\n        HostVersion: '3.*'\n    condition: selection1\nfalsepositives:\n    - Penetration Tests\n    - Unknown\nlevel: high\n", "object_marking_refs": ["marking-definition--0a872d70-1d05-45dd-a25f-031af547a102"], "created_by_ref": "identity--082ca4f0-d825-45b6-aa42-ab9afd1e5503", "type": "indicator", "spec_version": "2.1", "id": "indicator--85de1b7e-1670-4c4b-bea3-f3478f07def7", "modified": "2020-04-02T07:58:55.190Z"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--ab28998a-7255-441b-9427-4b9d3fa72fb9", "created": "2020-04-02T07:58:55.201Z", "modified": "2020-04-02T07:58:55.201Z", "source_ref": "indicator--85de1b7e-1670-4c4b-bea3-f3478f07def7", "relationship_type": "indicates", "target_ref": "attack-pattern--f4882e23-8aa7-4b12-b28a-b349c12ee9e0"}, {"name": "Suspicious PowerShell Invocations - Generic", "description": "Detects suspicious PowerShell invocation command parameters", "created": "2017-03-12T00:00:00.000Z", "valid_from": "2017-03-12T00:00:00Z", "indicator_types": ["malicious-activity"], "pattern_type": "sigma", "pattern": "title: Suspicious PowerShell Invocations - Generic\nid: 3d304fda-78aa-43ed-975c-d740798a49c1\nstatus: experimental\ndescription: Detects suspicious PowerShell invocation command parameters\ntags:\n    - attack.execution\n    - attack.t1086\nauthor: Florian Roth (rule)\ndate: 2017/03/12\nlogsource:\n    product: windows\n    service: powershell\ndetection:\n    encoded:\n        - ' -enc '\n        - ' -EncodedCommand '\n    hidden:\n        - ' -w hidden '\n        - ' -window hidden '\n        - ' - windowstyle hidden '\n    noninteractive:\n        - ' -noni '\n        - ' -noninteractive '\n    condition: all of them\nfalsepositives:\n    - Penetration tests\n    - Very special / sneaky PowerShell scripts\nlevel: high\n", "object_marking_refs": ["marking-definition--0a872d70-1d05-45dd-a25f-031af547a102"], "created_by_ref": "identity--082ca4f0-d825-45b6-aa42-ab9afd1e5503", "type": "indicator", "spec_version": "2.1", "id": "indicator--9e74359a-3606-456c-93ac-1a9f612c7047", "modified": "2020-04-02T07:58:55.204Z"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--ceb023ce-a675-4f56-9a32-c8cb3c229025", "created": "2020-04-02T07:58:55.215Z", "modified": "2020-04-02T07:58:55.215Z", "source_ref": "indicator--9e74359a-3606-456c-93ac-1a9f612c7047", "relationship_type": "indicates", "target_ref": "attack-pattern--f4882e23-8aa7-4b12-b28a-b349c12ee9e0"}, {"name": "PowerShell ShellCode", "description": "Detects Base64 encoded Shellcode", "created": "2018-11-17T00:00:00.000Z", "valid_from": "2018-11-17T00:00:00Z", "indicator_types": ["malicious-activity"], "pattern_type": "sigma", "pattern": "title: PowerShell ShellCode\nid: 16b37b70-6fcf-4814-a092-c36bd3aafcbd\nstatus: experimental\ndescription: Detects Base64 encoded Shellcode\nreferences:\n    - https://twitter.com/cyb3rops/status/1063072865992523776\ntags:\n    - attack.privilege_escalation\n    - attack.execution\n    - attack.t1055\n    - attack.t1086\nauthor: David Ledbetter (shellcode), Florian Roth (rule)\ndate: 2018/11/17\nlogsource:\n    product: windows\n    service: powershell\n    description: 'Script block logging must be enabled'\ndetection:\n    selection:\n        EventID: 4104\n    keyword1: \n        - '*AAAAYInlM*'\n    keyword2: \n        - '*OiCAAAAYInlM*'\n        - '*OiJAAAAYInlM*'\n    condition: selection and keyword1 and keyword2\nfalsepositives:\n    - Unknown\nlevel: critical\n", "object_marking_refs": ["marking-definition--0a872d70-1d05-45dd-a25f-031af547a102"], "created_by_ref": "identity--082ca4f0-d825-45b6-aa42-ab9afd1e5503", "type": "indicator", "spec_version": "2.1", "id": "indicator--f09315fe-f9bf-4693-847f-ad38d096f240", "modified": "2020-04-02T07:58:55.219Z"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--5f2921f2-2ad7-46e6-b4bd-fac87d7de0b0", "created": "2020-04-02T07:58:55.230Z", "modified": "2020-04-02T07:58:55.230Z", "source_ref": "indicator--f09315fe-f9bf-4693-847f-ad38d096f240", "relationship_type": "indicates", "target_ref": "attack-pattern--43e7dc91-05b2-474c-b9ac-2ed4fe101f4d"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--335de269-a91c-4689-95f0-e593366481c3", "created": "2020-04-02T07:58:55.242Z", "modified": "2020-04-02T07:58:55.242Z", "source_ref": "indicator--f09315fe-f9bf-4693-847f-ad38d096f240", "relationship_type": "indicates", "target_ref": "attack-pattern--f4882e23-8aa7-4b12-b28a-b349c12ee9e0"}, {"name": "Malicious PowerShell Keywords", "description": "Detects keywords from well-known PowerShell exploitation frameworks", "created": "2017-03-05T00:00:00.000Z", "modified": "2019-01-22T00:00:00.000Z", "valid_from": "2017-03-05T00:00:00Z", "indicator_types": ["malicious-activity"], "pattern_type": "sigma", "pattern": "title: Malicious PowerShell Keywords\nid: f62176f3-8128-4faa-bf6c-83261322e5eb\nstatus: experimental\ndescription: Detects keywords from well-known PowerShell exploitation frameworks\nmodified: 2019/01/22\nreferences:\n    - https://adsecurity.org/?p=2921\ntags:\n    - attack.execution\n    - attack.t1086\nauthor: Sean Metcalf (source), Florian Roth (rule)\ndate: 2017/03/05\nlogsource:\n    product: windows\n    service: powershell\n    definition: 'It is recommended to use the new \"Script Block Logging\" of PowerShell v5 https://adsecurity.org/?p=2277'\ndetection:\n    keywords:\n        Message:\n            - \"*AdjustTokenPrivileges*\"\n            - \"*IMAGE_NT_OPTIONAL_HDR64_MAGIC*\"\n            - \"*Microsoft.Win32.UnsafeNativeMethods*\"\n            - \"*ReadProcessMemory.Invoke*\"\n            - \"*SE_PRIVILEGE_ENABLED*\"\n            - \"*LSA_UNICODE_STRING*\"\n            - \"*MiniDumpWriteDump*\"\n            - \"*PAGE_EXECUTE_READ*\"\n            - \"*SECURITY_DELEGATION*\"\n            - \"*TOKEN_ADJUST_PRIVILEGES*\"\n            - \"*TOKEN_ALL_ACCESS*\"\n            - \"*TOKEN_ASSIGN_PRIMARY*\"\n            - \"*TOKEN_DUPLICATE*\"\n            - \"*TOKEN_ELEVATION*\"\n            - \"*TOKEN_IMPERSONATE*\"\n            - \"*TOKEN_INFORMATION_CLASS*\"\n            - \"*TOKEN_PRIVILEGES*\"\n            - \"*TOKEN_QUERY*\"\n            - \"*Metasploit*\"\n            - \"*Mimikatz*\"\n    condition: keywords\nfalsepositives:\n    - Penetration tests\nlevel: high\n", "object_marking_refs": ["marking-definition--0a872d70-1d05-45dd-a25f-031af547a102"], "created_by_ref": "identity--082ca4f0-d825-45b6-aa42-ab9afd1e5503", "type": "indicator", "spec_version": "2.1", "id": "indicator--97609b12-750c-43fb-a9da-fc560b80bfb8"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--6e730976-3d3b-4268-b859-5eacd9d249c3", "created": "2020-04-02T07:58:55.260Z", "modified": "2020-04-02T07:58:55.260Z", "source_ref": "indicator--97609b12-750c-43fb-a9da-fc560b80bfb8", "relationship_type": "indicates", "target_ref": "attack-pattern--f4882e23-8aa7-4b12-b28a-b349c12ee9e0"}, {"name": "Dnscat Execution", "description": "Dnscat exfiltration tool execution", "created": "2019-10-24T00:00:00.000Z", "valid_from": "2019-10-24T00:00:00Z", "indicator_types": ["malicious-activity"], "pattern_type": "sigma", "pattern": "title: Dnscat Execution\nid: a6d67db4-6220-436d-8afc-f3842fe05d43\ndescription: Dnscat exfiltration tool execution\nstatus: experimental\nauthor: Daniil Yugoslavskiy, oscd.community\ndate: 2019/10/24\ntags:\n    - attack.exfiltration\n    - attack.t1048\nlogsource:\n    product: windows\n    service: powershell\ndetection:\n    selection:\n        EventID: 4104\n        ScriptBlockText|contains: \"Start-Dnscat2\"\n    condition: selection\nfalsepositives:\n    - Legitimate usage of PowerShell Dnscat2 \u2014 DNS Exfiltration tool (unlikely)\nlevel: critical\n", "object_marking_refs": ["marking-definition--0a872d70-1d05-45dd-a25f-031af547a102"], "created_by_ref": "identity--082ca4f0-d825-45b6-aa42-ab9afd1e5503", "type": "indicator", "spec_version": "2.1", "id": "indicator--61ede505-67ee-4f59-bf98-e5092072340d", "modified": "2020-04-02T07:58:55.263Z"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--28762b3d-5b45-43b0-9468-9a02e56337e1", "created": "2020-04-02T07:58:55.276Z", "modified": "2020-04-02T07:58:55.276Z", "source_ref": "indicator--61ede505-67ee-4f59-bf98-e5092072340d", "relationship_type": "indicates", "target_ref": "attack-pattern--a19e86f8-1c0a-4fea-8407-23b73d615776"}, {"name": "PowerShell PSAttack", "description": "Detects the use of PSAttack PowerShell hack tool", "created": "2017-03-05T00:00:00.000Z", "valid_from": "2017-03-05T00:00:00Z", "indicator_types": ["malicious-activity"], "pattern_type": "sigma", "pattern": "title: PowerShell PSAttack\nid: b7ec41a4-042c-4f31-a5db-d0fcde9fa5c5\nstatus: experimental\ndescription: Detects the use of PSAttack PowerShell hack tool\nreferences:\n    - https://adsecurity.org/?p=2921\ntags:\n    - attack.execution\n    - attack.t1086\nauthor: Sean Metcalf (source), Florian Roth (rule)\ndate: 2017/03/05\nlogsource:\n    product: windows\n    service: powershell\n    definition: 'It is recommended to use the new \"Script Block Logging\" of PowerShell v5 https://adsecurity.org/?p=2277'\ndetection:\n    selection:\n        EventID: 4103\n    keyword:\n        - 'PS ATTACK!!!'\n    condition: all of them\nfalsepositives:\n    - Pentesters\nlevel: high\n", "object_marking_refs": ["marking-definition--0a872d70-1d05-45dd-a25f-031af547a102"], "created_by_ref": "identity--082ca4f0-d825-45b6-aa42-ab9afd1e5503", "type": "indicator", "spec_version": "2.1", "id": "indicator--1d3d213b-53b8-4a34-8d1c-04ebccc69a28", "modified": "2020-04-02T07:58:55.279Z"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--989e9d58-f65f-44d2-a4b1-a6ad023e3a5f", "created": "2020-04-02T07:58:55.291Z", "modified": "2020-04-02T07:58:55.291Z", "source_ref": "indicator--1d3d213b-53b8-4a34-8d1c-04ebccc69a28", "relationship_type": "indicates", "target_ref": "attack-pattern--f4882e23-8aa7-4b12-b28a-b349c12ee9e0"}, {"name": "Suspicious PowerShell Invocations - Specific", "description": "Detects suspicious PowerShell invocation command parameters", "created": "2017-03-05T00:00:00.000Z", "valid_from": "2017-03-05T00:00:00Z", "indicator_types": ["malicious-activity"], "pattern_type": "sigma", "pattern": "title: Suspicious PowerShell Invocations - Specific\nid: fce5f582-cc00-41e1-941a-c6fabf0fdb8c\nstatus: experimental\ndescription: Detects suspicious PowerShell invocation command parameters\ntags:\n    - attack.execution\n    - attack.t1086\nauthor: Florian Roth (rule)\ndate: 2017/03/05\nlogsource:\n    product: windows\n    service: powershell\ndetection:\n    keywords:\n        Message:\n            - '* -nop -w hidden -c * [Convert]::FromBase64String*'\n            - '* -w hidden -noni -nop -c \"iex(New-Object*'\n            - '* -w hidden -ep bypass -Enc*'\n            - '*powershell.exe reg add HKCU\\software\\microsoft\\windows\\currentversion\\run*'\n            - '*bypass -noprofile -windowstyle hidden (new-object system.net.webclient).download*'\n            - '*iex(New-Object Net.WebClient).Download*'\n    condition: keywords\nfalsepositives:\n    - Penetration tests\nlevel: high\n", "object_marking_refs": ["marking-definition--0a872d70-1d05-45dd-a25f-031af547a102"], "created_by_ref": "identity--082ca4f0-d825-45b6-aa42-ab9afd1e5503", "type": "indicator", "spec_version": "2.1", "id": "indicator--58d76eb3-6830-4bad-9ddf-1ddee25d03c0", "modified": "2020-04-02T07:58:55.294Z"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--f3c10626-cc28-400f-8898-7e8334e4ab23", "created": "2020-04-02T07:58:55.309Z", "modified": "2020-04-02T07:58:55.309Z", "source_ref": "indicator--58d76eb3-6830-4bad-9ddf-1ddee25d03c0", "relationship_type": "indicates", "target_ref": "attack-pattern--f4882e23-8aa7-4b12-b28a-b349c12ee9e0"}, {"name": "Data Compressed - Powershell", "description": "An adversary may compress data (e.g., sensitive documents) that is collected prior to exfiltration in order to make it portable and minimize the amount of data sent over the network", "created": "2019-10-21T00:00:00.000Z", "modified": "2019-11-04T00:00:00.000Z", "valid_from": "2019-10-21T00:00:00Z", "indicator_types": ["malicious-activity"], "pattern_type": "sigma", "pattern": "title: Data Compressed - Powershell\nid: 6dc5d284-69ea-42cf-9311-fb1c3932a69a\nstatus: experimental\ndescription: An adversary may compress data (e.g., sensitive documents) that is collected prior to exfiltration in order to make it portable and minimize the amount\n    of data sent over the network\nauthor: Timur Zinniatullin, oscd.community\ndate: 2019/10/21\nmodified: 2019/11/04\nreferences:\n    - https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1002/T1002.yaml\nlogsource:\n    product: windows\n    service: powershell\n    description: 'Script block logging must be enabled'\ndetection:\n    selection:\n        EventID: 4104\n        keywords|contains|all: \n            - '-Recurse'\n            - '|'\n            - 'Compress-Archive'\n    condition: selection\nfalsepositives:\n    - highly likely if archive ops are done via PS\nlevel: low\ntags:\n    - attack.exfiltration\n    - attack.t1002\n", "object_marking_refs": ["marking-definition--0a872d70-1d05-45dd-a25f-031af547a102"], "created_by_ref": "identity--082ca4f0-d825-45b6-aa42-ab9afd1e5503", "type": "indicator", "spec_version": "2.1", "id": "indicator--11accd66-e30b-48f3-bacc-394c6bdb183f"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--3ef49514-b4db-4fb7-9eef-335f310ab1f9", "created": "2020-04-02T07:58:55.331Z", "modified": "2020-04-02T07:58:55.331Z", "source_ref": "indicator--11accd66-e30b-48f3-bacc-394c6bdb183f", "relationship_type": "indicates", "target_ref": "attack-pattern--b9f5dbe2-4c55-4fc5-af2e-d42c1d182ec4"}, {"name": "Alternate PowerShell Hosts", "description": "Detects alternate PowerShell hosts potentially bypassing detections looking for powershell.exe", "created": "2019-08-11T00:00:00.000Z", "modified": "2020-02-25T00:00:00.000Z", "valid_from": "2019-08-11T00:00:00Z", "indicator_types": ["malicious-activity"], "pattern_type": "sigma", "pattern": "title: Alternate PowerShell Hosts\nid: 64e8e417-c19a-475a-8d19-98ea705394cc\ndescription: Detects alternate PowerShell hosts potentially bypassing detections looking for powershell.exe\nstatus: experimental\ndate: 2019/08/11\nmodified: 2020/02/25\nauthor: Roberto Rodriguez @Cyb3rWard0g\nreferences:\n    - https://github.com/Cyb3rWard0g/ThreatHunter-Playbook/tree/master/playbooks/windows/02_execution/T1086_powershell/alternate_signed_powershell_hosts.md\ntags:\n    - attack.execution\n    - attack.t1086\nlogsource:\n    product: windows\n    service: powershell\ndetection:\n    selection: \n        EventID:\n            - 4103\n            - 400\n        ContextInfo: '*'\n    filter:\n        - ContextInfo: 'powershell.exe'\n        - Message: 'powershell.exe'\n        # Both fields contain key=value pairs where the key HostApplication ist relevant but\n        # can't be referred directly as event field.\n    condition: selection and not filter\nfalsepositives:\n    - Programs using PowerShell directly without invocation of a dedicated interpreter\n    - MSP Detection Searcher\n    - Citrix ConfigSync.ps1\nlevel: medium\n", "object_marking_refs": ["marking-definition--0a872d70-1d05-45dd-a25f-031af547a102"], "created_by_ref": "identity--082ca4f0-d825-45b6-aa42-ab9afd1e5503", "type": "indicator", "spec_version": "2.1", "id": "indicator--9ed5cca4-5854-48ac-8632-233e074b0c7a"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--c93ae79e-3a11-4b58-b0d3-dcd9edab6ae1", "created": "2020-04-02T07:58:55.348Z", "modified": "2020-04-02T07:58:55.348Z", "source_ref": "indicator--9ed5cca4-5854-48ac-8632-233e074b0c7a", "relationship_type": "indicates", "target_ref": "attack-pattern--f4882e23-8aa7-4b12-b28a-b349c12ee9e0"}, {"name": "Winlogon Helper DLL", "description": "Winlogon.exe is a Windows component responsible for actions at logon/logoff as well as the secure attention sequence (SAS) triggered by Ctrl-Alt-Delete. Registry entries in HKLM\\Software[Wow6432Node]Microsoft\\Windows NT\\CurrentVersion\\Winlogon\\ and HKCU\\Software\\Microsoft\\Windows NT\\CurrentVersion\\Winlogon\\ are used to manage additional helper programs and functionalities that support Winlogon. Malicious modifications to these Registry keys may cause Winlogon to load and execute malicious DLLs and/or executables.", "created": "2019-10-21T00:00:00.000Z", "modified": "2019-11-04T00:00:00.000Z", "valid_from": "2019-10-21T00:00:00Z", "indicator_types": ["malicious-activity"], "pattern_type": "sigma", "pattern": "title: Winlogon Helper DLL\nid: 851c506b-6b7c-4ce2-8802-c703009d03c0\nstatus: experimental\ndescription: Winlogon.exe is a Windows component responsible for actions at logon/logoff as well as the secure attention sequence (SAS) triggered by Ctrl-Alt-Delete.\n    Registry entries in HKLM\\Software[Wow6432Node]Microsoft\\Windows NT\\CurrentVersion\\Winlogon\\ and HKCU\\Software\\Microsoft\\Windows NT\\CurrentVersion\\Winlogon\\ are\n    used to manage additional helper programs and functionalities that support Winlogon. Malicious modifications to these Registry keys may cause Winlogon to load\n    and execute malicious DLLs and/or executables.\nauthor: Timur Zinniatullin, oscd.community\ndate: 2019/10/21\nmodified: 2019/11/04\nreferences:\n    - https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1004/T1004.yaml\nlogsource:\n    product: windows\n    service: powershell\n    description: 'Script block logging must be enabled'\ndetection:\n    selection:\n        EventID: 4104\n    keyword1: \n        - '*Set-ItemProperty*'\n        - '*New-Item*'\n    keyword2: \n        - '*CurrentVersion\\Winlogon*'\n    condition: selection and ( keyword1 and keyword2 )\nfalsepositives:\n    - Unknown\nlevel: medium\ntags:\n    - attack.persistence\n    - attack.t1004\n", "object_marking_refs": ["marking-definition--0a872d70-1d05-45dd-a25f-031af547a102"], "created_by_ref": "identity--082ca4f0-d825-45b6-aa42-ab9afd1e5503", "type": "indicator", "spec_version": "2.1", "id": "indicator--03e82892-d99a-4da0-8f70-7c09209f339a"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--164f5f74-e8d9-473a-8ce5-775063965121", "created": "2020-04-02T07:58:55.373Z", "modified": "2020-04-02T07:58:55.373Z", "source_ref": "indicator--03e82892-d99a-4da0-8f70-7c09209f339a", "relationship_type": "indicates", "target_ref": "attack-pattern--514ede4c-78b3-4d78-a38b-daddf6217a79"}, {"name": "Clear PowerShell History", "description": "Detects keywords that could indicate clearing PowerShell history", "created": "2019-10-25T00:00:00.000Z", "valid_from": "2019-10-25T00:00:00Z", "indicator_types": ["malicious-activity"], "pattern_type": "sigma", "pattern": "title: Clear PowerShell History\nid: dfba4ce1-e0ea-495f-986e-97140f31af2d\nstatus: experimental\ndescription: Detects keywords that could indicate clearing PowerShell history\ndate: 2019/10/25\nauthor: Ilyas Ochkov, oscd.community\nreferences:\n    - https://gist.github.com/hook-s3c/7363a856c3cdbadeb71085147f042c1a\ntags:\n    - attack.defense_evasion\n    - attack.t1146\nlogsource:\n    product: windows\n    service: powershell\ndetection:\n    keywords:\n        - 'del (Get-PSReadlineOption).HistorySavePath'\n        - 'Set-PSReadlineOption \u2013HistorySaveStyle SaveNothing'\n        - 'Remove-Item (Get-PSReadlineOption).HistorySavePath'\n        - 'rm (Get-PSReadlineOption).HistorySavePath'\n    condition: keywords\nfalsepositives:\n    - some PS-scripts\nlevel: medium\n", "object_marking_refs": ["marking-definition--0a872d70-1d05-45dd-a25f-031af547a102"], "created_by_ref": "identity--082ca4f0-d825-45b6-aa42-ab9afd1e5503", "type": "indicator", "spec_version": "2.1", "id": "indicator--f7c53f42-9f45-43e7-8da4-fa7aaec13684", "modified": "2020-04-02T07:58:55.377Z"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--18888977-8f96-425b-8f8b-b50d977f4906", "created": "2020-04-02T07:58:55.390Z", "modified": "2020-04-02T07:58:55.390Z", "source_ref": "indicator--f7c53f42-9f45-43e7-8da4-fa7aaec13684", "relationship_type": "indicates", "target_ref": "attack-pattern--d3046a90-580c-4004-8208-66915bc29830"}, {"name": "Interactive AT Job", "description": "Detect an interactive AT job, which may be used as a form of privilege escalation", "created": "2019-10-24T00:00:00.000Z", "modified": "2019-11-11T00:00:00.000Z", "valid_from": "2019-10-24T00:00:00Z", "indicator_types": ["malicious-activity"], "pattern_type": "sigma", "pattern": "title: Interactive AT Job\nid: 60fc936d-2eb0-4543-8a13-911c750a1dfc\ndescription: Detect an interactive AT job, which may be used as a form of privilege escalation\nstatus: experimental\nauthor: E.M. Anhaus (orignally from Atomic Blue Detections, Endgame), oscd.community\nreferences:\n    - https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1053/T1053.yaml\n    - https://eqllib.readthedocs.io/en/latest/analytics/d8db43cf-ed52-4f5c-9fb3-c9a4b95a0b56.html\ndate: 2019/10/24\nmodified: 2019/11/11\ntags:\n    - attack.privilege_escalation\n    - attack.t1053\nlogsource:\n    category: process_creation\n    product: windows\ndetection:\n    selection:\n        Image|endswith: '\\at.exe'\n        CommandLine|contains: 'interactive'\n    condition: selection\nfields:\n    - ComputerName\n    - User\n    - CommandLine\nfalsepositives:\n    - Unlikely (at.exe deprecated as of Windows 8)\nlevel: high\n", "object_marking_refs": ["marking-definition--0a872d70-1d05-45dd-a25f-031af547a102"], "created_by_ref": "identity--082ca4f0-d825-45b6-aa42-ab9afd1e5503", "type": "indicator", "spec_version": "2.1", "id": "indicator--1a8cbac7-8878-4f86-b6d9-0925b919438f"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--c66efaa2-b571-43db-858f-d1bd60e68044", "created": "2020-04-02T07:58:55.407Z", "modified": "2020-04-02T07:58:55.407Z", "source_ref": "indicator--1a8cbac7-8878-4f86-b6d9-0925b919438f", "relationship_type": "indicates", "target_ref": "attack-pattern--35dd844a-b219-4e2b-a6bb-efa9a75995a9"}, {"name": "WMI Persistence - Script Event Consumer", "description": "Detects WMI script event consumers", "created": "2018-03-07T00:00:00.000Z", "valid_from": "2018-03-07T00:00:00Z", "indicator_types": ["malicious-activity"], "pattern_type": "sigma", "pattern": "title: WMI Persistence - Script Event Consumer\nid: ec1d5e28-8f3b-4188-a6f8-6e8df81dc28e\nstatus: experimental\ndescription: Detects WMI script event consumers\nreferences:\n    - https://www.eideon.com/2018-03-02-THL03-WMIBackdoors/\nauthor: Thomas Patzke\ndate: 2018/03/07\ntags:\n    - attack.execution\n    - attack.persistence\n    - attack.t1047\nlogsource:\n    category: process_creation\n    product: windows\ndetection:\n    selection:\n        Image: C:\\WINDOWS\\system32\\wbem\\scrcons.exe\n        ParentImage: C:\\Windows\\System32\\svchost.exe\n    condition: selection\nfalsepositives:\n    - Legitimate event consumers\nlevel: high\n", "object_marking_refs": ["marking-definition--0a872d70-1d05-45dd-a25f-031af547a102"], "created_by_ref": "identity--082ca4f0-d825-45b6-aa42-ab9afd1e5503", "type": "indicator", "spec_version": "2.1", "id": "indicator--516817e2-ebb9-40fd-a866-101f18d53786", "modified": "2020-04-02T07:58:55.411Z"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--e29622b3-c33e-42d7-99c1-b4a735a451aa", "created": "2020-04-02T07:58:55.422Z", "modified": "2020-04-02T07:58:55.422Z", "source_ref": "indicator--516817e2-ebb9-40fd-a866-101f18d53786", "relationship_type": "indicates", "target_ref": "attack-pattern--01a5a209-b94c-450b-b7f9-946497d91055"}, {"name": "WSF/JSE/JS/VBA/VBE File Execution", "description": "Detects suspicious file execution by wscript and cscript", "created": "2019-01-16T00:00:00.000Z", "valid_from": "2019-01-16T00:00:00Z", "indicator_types": ["malicious-activity"], "pattern_type": "sigma", "pattern": "title: WSF/JSE/JS/VBA/VBE File Execution\nid: 1e33157c-53b1-41ad-bbcc-780b80b58288\nstatus: experimental\ndescription: Detects suspicious file execution by wscript and cscript\nauthor: Michael Haag\ndate: 2019/01/16\ntags:\n    - attack.execution\n    - attack.t1064\nlogsource:\n    category: process_creation\n    product: windows\ndetection:\n    selection:\n        Image:\n            - '*\\wscript.exe'\n            - '*\\cscript.exe'\n        CommandLine:\n            - '*.jse'\n            - '*.vbe'\n            - '*.js'\n            - '*.vba'\n    condition: selection\nfields:\n    - CommandLine\n    - ParentCommandLine\nfalsepositives:\n    - Will need to be tuned. I recommend adding the user profile path in CommandLine if it is getting too noisy.\nlevel: medium\n", "object_marking_refs": ["marking-definition--0a872d70-1d05-45dd-a25f-031af547a102"], "created_by_ref": "identity--082ca4f0-d825-45b6-aa42-ab9afd1e5503", "type": "indicator", "spec_version": "2.1", "id": "indicator--8df4c861-44bd-4218-b5df-530fcbadbd57", "modified": "2020-04-02T07:58:55.426Z"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--6626f8f6-bf61-44ee-a8c1-06f6a318b25e", "created": "2020-04-02T07:58:55.445Z", "modified": "2020-04-02T07:58:55.445Z", "source_ref": "indicator--8df4c861-44bd-4218-b5df-530fcbadbd57", "relationship_type": "indicates", "target_ref": "attack-pattern--7fd87010-3a00-4da3-b905-410525e8ec44"}, {"name": "Winnti Malware HK University Campaign", "description": "Detects specific process characteristics of Winnti malware noticed in Dec/Jan 2020 in a campaign against Honk Kong universities", "created": "2020-02-01T00:00:00.000Z", "valid_from": "2020-02-01T00:00:00Z", "indicator_types": ["malicious-activity"], "pattern_type": "sigma", "pattern": "title: Winnti Malware HK University Campaign\nid: 3121461b-5aa0-4a41-b910-66d25524edbb\nstatus: experimental\ndescription: Detects specific process characteristics of Winnti malware noticed in Dec/Jan 2020 in a campaign against Honk Kong universities\nreferences:\n    - https://www.welivesecurity.com/2020/01/31/winnti-group-targeting-universities-hong-kong/\ntags:\n    - attack.defense_evasion\n    - attack.t1073\n    - attack.g0044\nauthor: Florian Roth, Markus Neis\ndate: 2020/02/01\nlogsource:\n    category: process_creation\n    product: windows\ndetection:\n    selection1:\n        ParentImage|contains: \n          - 'C:\\Windows\\Temp'\n          - '\\hpqhvind.exe'\n        Image|startswith: 'C:\\ProgramData\\DRM'\n    selection2:\n        ParentImage|startswith: 'C:\\ProgramData\\DRM'\n        Image|endswith: '\\wmplayer.exe'\n    selection3:\n        ParentImage|endswith: '\\Test.exe'\n        Image|endswith: '\\wmplayer.exe'\n    selection4:\n        Image: 'C:\\ProgramData\\DRM\\CLR\\CLR.exe'\n    selection5:\n        ParentImage|startswith: 'C:\\ProgramData\\DRM\\Windows'\n        Image|endswith: '\\SearchFilterHost.exe'\n    condition: 1 of them\nfalsepositives:\n    - Unlikely\nlevel: critical\n", "object_marking_refs": ["marking-definition--0a872d70-1d05-45dd-a25f-031af547a102"], "created_by_ref": "identity--082ca4f0-d825-45b6-aa42-ab9afd1e5503", "type": "indicator", "spec_version": "2.1", "id": "indicator--3a88aed3-ce18-4ca1-80ed-ed062574dffd", "modified": "2020-04-02T07:58:55.452Z"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--456ed86e-f821-4379-a265-88a1780a8e52", "created": "2020-04-02T07:58:55.464Z", "modified": "2020-04-02T07:58:55.464Z", "source_ref": "indicator--3a88aed3-ce18-4ca1-80ed-ed062574dffd", "relationship_type": "indicates", "target_ref": "attack-pattern--b2001907-166b-4d71-bb3c-9d26c871de09"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--1b80c6d5-76e0-499e-a4d5-f17194075552", "created": "2020-04-02T07:58:55.473Z", "modified": "2020-04-02T07:58:55.473Z", "source_ref": "indicator--3a88aed3-ce18-4ca1-80ed-ed062574dffd", "relationship_type": "indicates", "target_ref": "intrusion-set--c5947e1c-1cbc-434c-94b8-27c7e3be0fff"}, {"name": "Suspicious XOR Encoded PowerShell Command Line", "description": "Detects suspicious powershell process which includes bxor command, alternatvide obfuscation method to b64 encoded commands.", "created": "2018-09-05T00:00:00.000Z", "valid_from": "2018-09-05T00:00:00Z", "indicator_types": ["malicious-activity"], "pattern_type": "sigma", "pattern": "title: Suspicious XOR Encoded PowerShell Command Line\nid: bb780e0c-16cf-4383-8383-1e5471db6cf9\ndescription: Detects suspicious powershell process which includes bxor command, alternatvide obfuscation method to b64 encoded commands.\nstatus: experimental\nauthor: Sami Ruohonen\ndate: 2018/09/05\ntags:\n    - attack.execution\n    - attack.t1086\ndetection:\n    selection:\n        CommandLine:\n            - '* -bxor*'\n    condition: selection\nfalsepositives:\n    - unknown\nlevel: medium\nlogsource:\n    category: process_creation\n    product: windows\n", "object_marking_refs": ["marking-definition--0a872d70-1d05-45dd-a25f-031af547a102"], "created_by_ref": "identity--082ca4f0-d825-45b6-aa42-ab9afd1e5503", "type": "indicator", "spec_version": "2.1", "id": "indicator--1234740e-ac15-426e-af4d-6b62bbc4acb6", "modified": "2020-04-02T07:58:55.479Z"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--83614662-1063-4405-852a-158993261548", "created": "2020-04-02T07:58:55.489Z", "modified": "2020-04-02T07:58:55.489Z", "source_ref": "indicator--1234740e-ac15-426e-af4d-6b62bbc4acb6", "relationship_type": "indicates", "target_ref": "attack-pattern--f4882e23-8aa7-4b12-b28a-b349c12ee9e0"}, {"name": "Suspicious PowerShell Invocation Based on Parent Process", "description": "Detects suspicious powershell invocations from interpreters or unusual programs", "created": "2019-01-16T00:00:00.000Z", "valid_from": "2019-01-16T00:00:00Z", "indicator_types": ["malicious-activity"], "pattern_type": "sigma", "pattern": "title: Suspicious PowerShell Invocation Based on Parent Process\nid: 95eadcb2-92e4-4ed1-9031-92547773a6db\nstatus: experimental\ndescription: Detects suspicious powershell invocations from interpreters or unusual programs\nauthor: Florian Roth\ndate: 2019/01/16\nreferences:\n    - https://www.carbonblack.com/2017/03/15/attackers-leverage-excel-powershell-dns-latest-non-malware-attack/\ntags:\n    - attack.execution\n    - attack.t1086\nlogsource:\n    category: process_creation\n    product: windows\ndetection:\n    selection:\n        ParentImage:\n            - '*\\wscript.exe'\n            - '*\\cscript.exe'\n        Image:\n            - '*\\powershell.exe'\n    falsepositive:\n        CurrentDirectory: '*\\Health Service State\\\\*'\n    condition: selection and not falsepositive\nfields:\n    - CommandLine\n    - ParentCommandLine\nfalsepositives:\n    - Microsoft Operations Manager (MOM)\n    - Other scripts\nlevel: medium\n", "object_marking_refs": ["marking-definition--0a872d70-1d05-45dd-a25f-031af547a102"], "created_by_ref": "identity--082ca4f0-d825-45b6-aa42-ab9afd1e5503", "type": "indicator", "spec_version": "2.1", "id": "indicator--25491cfc-b353-4f27-8514-9e7804880bb3", "modified": "2020-04-02T07:58:55.497Z"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--8315fbbd-0e0c-4063-80f3-3d110fe564f9", "created": "2020-04-02T07:58:55.508Z", "modified": "2020-04-02T07:58:55.508Z", "source_ref": "indicator--25491cfc-b353-4f27-8514-9e7804880bb3", "relationship_type": "indicates", "target_ref": "attack-pattern--f4882e23-8aa7-4b12-b28a-b349c12ee9e0"}, {"name": "Suspicious Compression Tool Parameters", "description": "Detects suspicious command line arguments of common data compression tools", "created": "2019-10-15T00:00:00.000Z", "valid_from": "2019-10-15T00:00:00Z", "indicator_types": ["malicious-activity"], "pattern_type": "sigma", "pattern": "title: Suspicious Compression Tool Parameters\nid: 27a72a60-7e5e-47b1-9d17-909c9abafdcd\nstatus: experimental\ndescription: Detects suspicious command line arguments of common data compression tools\nreferences:\n    - https://twitter.com/SBousseaden/status/1184067445612535811\ntags:\n    - attack.exfiltration\n    - attack.t1020\n    - attack.t1002\nauthor: Florian Roth, Samir Bousseaden\ndate: 2019/10/15\nlogsource:\n    category: process_creation\n    product: windows\ndetection:\n    selection:\n        OriginalFileName:\n            - '7z*.exe'\n            - '*rar.exe'\n            - '*Command*Line*RAR*'\n        CommandLine:\n            - '* -p*'\n            - '* -ta*'\n            - '* -tb*'\n            - '* -sdel*'\n            - '* -dw*'\n            - '* -hp*'\n    falsepositive:\n        ParentImage: 'C:\\Program*'\n    condition: selection and not falsepositive\nfalsepositives:\n    - unknown\nlevel: high\n", "object_marking_refs": ["marking-definition--0a872d70-1d05-45dd-a25f-031af547a102"], "created_by_ref": "identity--082ca4f0-d825-45b6-aa42-ab9afd1e5503", "type": "indicator", "spec_version": "2.1", "id": "indicator--2f20a560-c4ec-4f28-9d96-49f2f5cb8869", "modified": "2020-04-02T07:58:55.512Z"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--198be637-70fd-4dd3-8c6c-0431ac07135d", "created": "2020-04-02T07:58:55.524Z", "modified": "2020-04-02T07:58:55.524Z", "source_ref": "indicator--2f20a560-c4ec-4f28-9d96-49f2f5cb8869", "relationship_type": "indicates", "target_ref": "attack-pattern--774a3188-6ba9-4dc4-879d-d54ee48a5ce9"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--cd683ac4-9050-4732-b2e0-fa25bb87be2c", "created": "2020-04-02T07:58:55.534Z", "modified": "2020-04-02T07:58:55.534Z", "source_ref": "indicator--2f20a560-c4ec-4f28-9d96-49f2f5cb8869", "relationship_type": "indicates", "target_ref": "attack-pattern--b9f5dbe2-4c55-4fc5-af2e-d42c1d182ec4"}, {"name": "Suspicious WMI Execution", "description": "Detects WMI executing suspicious commands", "created": "2019-01-16T00:00:00.000Z", "valid_from": "2019-01-16T00:00:00Z", "indicator_types": ["malicious-activity"], "pattern_type": "sigma", "pattern": "title: Suspicious WMI Execution\nid: 526be59f-a573-4eea-b5f7-f0973207634d\nstatus: experimental\ndescription: Detects WMI executing suspicious commands\nreferences:\n    - https://digital-forensics.sans.org/blog/2010/06/04/wmic-draft/\n    - https://www.hybrid-analysis.com/sample/4be06ecd234e2110bd615649fe4a6fa95403979acf889d7e45a78985eb50acf9?environmentId=1\n    - https://blog.malwarebytes.com/threat-analysis/2016/04/rokku-ransomware/\nauthor: Michael Haag, Florian Roth, juju4\ndate: 2019/01/16\nlogsource:\n    category: process_creation\n    product: windows\ndetection:\n    selection:\n        Image:\n            - '*\\wmic.exe'\n        CommandLine:\n            - '*/NODE:*process call create *'\n            - '* path AntiVirusProduct get *'\n            - '* path FirewallProduct get *'\n            - '* shadowcopy delete *'\n    condition: selection\nfields:\n    - CommandLine\n    - ParentCommandLine\ntags:\n    - attack.execution\n    - attack.t1047\n    - car.2016-03-002\nfalsepositives:\n    - Will need to be tuned\n    - If using Splunk, I recommend | stats count by Computer,CommandLine following for easy hunting by Computer/CommandLine.\nlevel: medium\n", "object_marking_refs": ["marking-definition--0a872d70-1d05-45dd-a25f-031af547a102"], "created_by_ref": "identity--082ca4f0-d825-45b6-aa42-ab9afd1e5503", "type": "indicator", "spec_version": "2.1", "id": "indicator--8390fabe-b879-462d-8f11-409d7cf8c4a0", "modified": "2020-04-02T07:58:55.541Z"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--13592997-a0ec-4bbe-b16e-b0b6332c59b5", "created": "2020-04-02T07:58:55.552Z", "modified": "2020-04-02T07:58:55.552Z", "source_ref": "indicator--8390fabe-b879-462d-8f11-409d7cf8c4a0", "relationship_type": "indicates", "target_ref": "attack-pattern--01a5a209-b94c-450b-b7f9-946497d91055"}, {"name": "Suspicious Service Path Modification", "description": "Detects service path modification to powershell/cmd", "created": "2019-10-21T00:00:00.000Z", "modified": "2019-11-10T00:00:00.000Z", "valid_from": "2019-10-21T00:00:00Z", "indicator_types": ["malicious-activity"], "pattern_type": "sigma", "pattern": "title: Suspicious Service Path Modification\nid: 138d3531-8793-4f50-a2cd-f291b2863d78\ndescription: Detects service path modification to powershell/cmd\nstatus: experimental\nreferences:\n    - https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1031/T1031.yaml\ntags:\n    - attack.persistence\n    - attack.t1031\ndate: 2019/10/21\nmodified: 2019/11/10\nauthor: Victor Sergeev, oscd.community\nlogsource:\n    category: process_creation\n    product: windows\ndetection:\n    selection_1:\n        Image|endswith: '\\sc.exe'\n        CommandLine|contains|all:\n            - 'config'\n            - 'binpath'\n    selection_2:\n        CommandLine|contains:\n            - 'powershell'\n            - 'cmd'\n    condition: selection_1 and selection_2\nfields:\n    - CommandLine\n    - ParentCommandLine\nfalsepositives:\n    - Unknown\nlevel: high\n", "object_marking_refs": ["marking-definition--0a872d70-1d05-45dd-a25f-031af547a102"], "created_by_ref": "identity--082ca4f0-d825-45b6-aa42-ab9afd1e5503", "type": "indicator", "spec_version": "2.1", "id": "indicator--c02f1fff-a09f-4f62-8038-cd8189904d5d"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--94c9dc74-0697-427a-8f1e-c55ba3b05f9f", "created": "2020-04-02T07:58:55.565Z", "modified": "2020-04-02T07:58:55.565Z", "source_ref": "indicator--c02f1fff-a09f-4f62-8038-cd8189904d5d", "relationship_type": "indicates", "target_ref": "attack-pattern--62dfd1ca-52d5-483c-a84b-d6e80bf94b7b"}, {"name": "Impacket Lateralization Detection", "description": "Detects wmiexec/dcomexec/atexec/smbexec from Impacket framework", "created": "2019-09-03T00:00:00.000Z", "valid_from": "2019-09-03T00:00:00Z", "indicator_types": ["malicious-activity"], "pattern_type": "sigma", "pattern": "title: Impacket Lateralization Detection\nid: 10c14723-61c7-4c75-92ca-9af245723ad2\nstatus: experimental\ndescription: Detects wmiexec/dcomexec/atexec/smbexec from Impacket framework\nreferences:\n    - https://github.com/SecureAuthCorp/impacket/blob/master/examples/wmiexec.py\n    - https://github.com/SecureAuthCorp/impacket/blob/master/examples/atexec.py\n    - https://github.com/SecureAuthCorp/impacket/blob/master/examples/smbexec.py\n    - https://github.com/SecureAuthCorp/impacket/blob/master/examples/dcomexec.py\nauthor: Ecco\ndate: 2019/09/03\nlogsource:\n    category: process_creation\n    product: windows\ndetection:\n    selection_other:\n        # *** wmiexec.py \n        #    parent is wmiprvse.exe\n        #    examples:\n        #       cmd.exe /Q /c whoami 1> \\\\127.0.0.1\\ADMIN$\\__1567439113.54 2>&1\n        #       cmd.exe /Q /c cd  1> \\\\127.0.0.1\\ADMIN$\\__1567439113.54 2>&1\n        # *** dcomexec.py -object MMC20 \n        #   parent is mmc.exe\n        #   example:\n        #       \"C:\\Windows\\System32\\cmd.exe\" /Q /c cd  1> \\\\127.0.0.1\\ADMIN$\\__1567442499.05 2>&1\n        # *** dcomexec.py -object ShellBrowserWindow\n        #  runs %SystemRoot%\\System32\\rundll32.exe shell32.dll,SHCreateLocalServerRunDll {c08afd90-f2a1-11d1-8455-00a0c91f3880} but parent command is explorer.exe\n        #  example:\n        #   \"C:\\Windows\\System32\\cmd.exe\" /Q /c cd \\ 1> \\\\127.0.0.1\\ADMIN$\\__1567520103.71 2>&1\n        # *** smbexec.py\n        #   parent is services.exe\n        #   example:\n        #       C:\\Windows\\system32\\cmd.exe /Q /c echo tasklist ^> \\\\127.0.0.1\\C$\\__output 2^>^&1 > C:\\Windows\\TEMP\\execute.bat & C:\\Windows\\system32\\cmd.exe /Q /c C:\\Windows\\TEMP\\execute.bat & del C:\\Windows\\TEMP\\execute.bat\n        ParentImage:\n            - '*\\wmiprvse.exe'  # wmiexec\n            - '*\\mmc.exe'  # dcomexec MMC\n            - '*\\explorer.exe'  # dcomexec ShellBrowserWindow\n            - '*\\services.exe'  # smbexec\n        CommandLine:\n            - '*cmd.exe* /Q /c * \\\\\\\\127.0.0.1\\\\*&1*'\n    selection_atexec:\n        ParentCommandLine:\n            - '*svchost.exe -k netsvcs' # atexec on win10 (parent is \"C:\\Windows\\system32\\svchost.exe -k netsvcs\")\n            - 'taskeng.exe*' # atexec on win7 (parent is \"taskeng.exe {AFA79333-694C-4BEE-910E-E57D9A3518F6} S-1-5-18:NT AUTHORITY\\System:Service:\")\n        # cmd.exe /C tasklist /m > C:\\Windows\\Temp\\bAJrYQtL.tmp 2>&1\n        CommandLine:\n            - 'cmd.exe /C *Windows\\\\Temp\\\\*&1'\n    condition: (1 of selection_*)\nfields:\n    - CommandLine\n    - ParentCommandLine\ntags:\n    - attack.lateral_movement\n    - attack.t1047\n    - attack.t1175\nfalsepositives:\n    - pentesters\nlevel: critical\n", "object_marking_refs": ["marking-definition--0a872d70-1d05-45dd-a25f-031af547a102"], "created_by_ref": "identity--082ca4f0-d825-45b6-aa42-ab9afd1e5503", "type": "indicator", "spec_version": "2.1", "id": "indicator--d4747de2-eb60-4d9e-92ad-82d80462e3c6", "modified": "2020-04-02T07:58:55.572Z"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--1e4f413f-6503-4e6c-916e-8bb63d9877e0", "created": "2020-04-02T07:58:55.583Z", "modified": "2020-04-02T07:58:55.583Z", "source_ref": "indicator--d4747de2-eb60-4d9e-92ad-82d80462e3c6", "relationship_type": "indicates", "target_ref": "attack-pattern--01a5a209-b94c-450b-b7f9-946497d91055"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--271aa124-3c41-4ee0-b9ed-0a0e1a6c1e19", "created": "2020-04-02T07:58:55.593Z", "modified": "2020-04-02T07:58:55.593Z", "source_ref": "indicator--d4747de2-eb60-4d9e-92ad-82d80462e3c6", "relationship_type": "indicates", "target_ref": "attack-pattern--772bc7a8-a157-42cc-8728-d648e25c7fe7"}, {"name": "Direct Autorun Keys Modification", "description": "Detects direct modification of autostart extensibility point (ASEP) in registry using reg.exe.", "created": "2019-10-25T00:00:00.000Z", "modified": "2019-11-10T00:00:00.000Z", "valid_from": "2019-10-25T00:00:00Z", "indicator_types": ["malicious-activity"], "pattern_type": "sigma", "pattern": "title: Direct Autorun Keys Modification\nid: 24357373-078f-44ed-9ac4-6d334a668a11\ndescription: Detects direct modification of autostart extensibility point (ASEP) in registry using reg.exe.\nstatus: experimental\nreferences:\n    - https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1060/T1060.yaml\ntags:\n    - attack.persistence\n    - attack.t1060\ndate: 2019/10/25\nmodified: 2019/11/10\nauthor: Victor Sergeev, Daniil Yugoslavskiy, oscd.community\nlogsource:\n    category: process_creation\n    product: windows\ndetection:\n    selection_1:\n        Image|endswith: '*\\reg.exe'\n        CommandLine|contains: 'add' # to avoid intersection with discovery tactic rules\n    selection_2:\n        CommandLine|contains:       # need to improve this list, there are plenty of ASEP reg keys\n            - '\\software\\Microsoft\\Windows\\CurrentVersion\\Run'\n            - '\\software\\Microsoft\\Windows\\CurrentVersion\\RunOnce'\n            - '\\software\\Microsoft\\Windows\\CurrentVersion\\RunOnceEx'\n            - '\\software\\Microsoft\\Windows\\CurrentVersion\\RunServices'\n            - '\\software\\Microsoft\\Windows\\CurrentVersion\\RunServicesOnce'\n            - '\\software\\Microsoft\\Windows NT\\CurrentVersion\\Winlogon\\Userinit'\n            - '\\software\\Microsoft\\Windows NT\\CurrentVersion\\Winlogon\\Shell'\n            - '\\software\\Microsoft\\Windows NT\\CurrentVersion\\Windows'\n            - '\\software\\Microsoft\\Windows\\CurrentVersion\\Explorer\\User Shell Folders'\n            - '\\system\\CurrentControlSet\\Control\\SafeBoot\\AlternateShell'\n    condition: selection_1 and selection_2\nfields:\n    - CommandLine\n    - ParentCommandLine\nfalsepositives:\n    - Legitimate software automatically (mostly, during installation) sets up autorun keys for legitimate reason\n    - Legitimate administrator sets up autorun keys for legitimate reason\nlevel: medium\n", "object_marking_refs": ["marking-definition--0a872d70-1d05-45dd-a25f-031af547a102"], "created_by_ref": "identity--082ca4f0-d825-45b6-aa42-ab9afd1e5503", "type": "indicator", "spec_version": "2.1", "id": "indicator--aecd0fee-8e73-44dc-b12b-4877a10bffab"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--9c9da38b-cc56-4442-a902-acd0ea33244a", "created": "2020-04-02T07:58:55.609Z", "modified": "2020-04-02T07:58:55.609Z", "source_ref": "indicator--aecd0fee-8e73-44dc-b12b-4877a10bffab", "relationship_type": "indicates", "target_ref": "attack-pattern--9422fc14-1c43-410d-ab0f-a709b76c72dc"}, {"name": "Taskmgr as LOCAL_SYSTEM", "description": "Detects the creation of taskmgr.exe process in context of LOCAL_SYSTEM", "created": "2018-03-18T00:00:00.000Z", "valid_from": "2018-03-18T00:00:00Z", "indicator_types": ["malicious-activity"], "pattern_type": "sigma", "pattern": "title: Taskmgr as LOCAL_SYSTEM\nid: 9fff585c-c33e-4a86-b3cd-39312079a65f\nstatus: experimental\ndescription: Detects the creation of taskmgr.exe process in context of LOCAL_SYSTEM\ntags:\n    - attack.defense_evasion\n    - attack.t1036\nauthor: Florian Roth\ndate: 2018/03/18\nlogsource:\n    category: process_creation\n    product: windows\ndetection:\n    selection:\n        User: NT AUTHORITY\\SYSTEM\n        Image: '*\\taskmgr.exe'\n    condition: selection\nfalsepositives:\n    - Unkown\nlevel: high\n", "object_marking_refs": ["marking-definition--0a872d70-1d05-45dd-a25f-031af547a102"], "created_by_ref": "identity--082ca4f0-d825-45b6-aa42-ab9afd1e5503", "type": "indicator", "spec_version": "2.1", "id": "indicator--640fcb64-0ace-4897-871d-707d4170959f", "modified": "2020-04-02T07:58:55.612Z"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--b7a0133b-2d11-4e45-9ecb-78bd8e85c8ea", "created": "2020-04-02T07:58:55.622Z", "modified": "2020-04-02T07:58:55.622Z", "source_ref": "indicator--640fcb64-0ace-4897-871d-707d4170959f", "relationship_type": "indicates", "target_ref": "attack-pattern--42e8de7b-37b2-4258-905a-6897815e58e0"}, {"name": "Windows Kernel and 3rd-Party Drivers Exploits Token Stealing", "description": "Detection of child processes spawned with SYSTEM privileges by parents with non-SYSTEM privileges and Medium integrity level", "created": "2019-06-03T00:00:00.000Z", "valid_from": "2019-06-03T00:00:00Z", "indicator_types": ["malicious-activity"], "pattern_type": "sigma", "pattern": "title: Windows Kernel and 3rd-Party Drivers Exploits Token Stealing\nid: 8065b1b4-1778-4427-877f-6bf948b26d38\ndescription: Detection of child processes spawned with SYSTEM privileges by parents with non-SYSTEM privileges and Medium integrity level\nreferences:\n    - https://www.slideshare.net/heirhabarov/hunting-for-privilege-escalation-in-windows-environment\ntags:\n    - attack.privilege_escalation\n    - attack.t1068\nstatus: experimental\nauthor: Teymur Kheirkhabarov (source), Daniil Yugoslavskiy (rule)\ndate: 2019/06/03\nlogsource:\n    category: process_creation\n    product: windows\ndetection:\n    selection:\n        ParentIntegrityLevel: Medium\n        IntegrityLevel: System\n        User: \"NT AUTHORITY\\\\SYSTEM\"\n    condition: selection\nfalsepositives:\n    - Unknown\nlevel: critical\nenrichment:\n    - EN_0001_cache_sysmon_event_id_1_info                # http://bit.ly/314zc6x\n    - EN_0002_enrich_sysmon_event_id_1_with_parent_info   # http://bit.ly/2KmSC0l\n", "object_marking_refs": ["marking-definition--0a872d70-1d05-45dd-a25f-031af547a102"], "created_by_ref": "identity--082ca4f0-d825-45b6-aa42-ab9afd1e5503", "type": "indicator", "spec_version": "2.1", "id": "indicator--500dd321-6355-4055-bfb9-7a2dedca8659", "modified": "2020-04-02T07:58:55.625Z"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--cc6c0c0f-95c7-41c5-8855-593b63d4ed93", "created": "2020-04-02T07:58:55.636Z", "modified": "2020-04-02T07:58:55.636Z", "source_ref": "indicator--500dd321-6355-4055-bfb9-7a2dedca8659", "relationship_type": "indicates", "target_ref": "attack-pattern--b21c3b2d-02e6-45b1-980b-e69051040839"}, {"name": "Powershell AMSI Bypass via .NET Reflection", "description": "Detects Request to amsiInitFailed that can be used to disable AMSI Scanning", "created": "2018-08-17T00:00:00.000Z", "valid_from": "2018-08-17T00:00:00Z", "indicator_types": ["malicious-activity"], "pattern_type": "sigma", "pattern": "title: Powershell AMSI Bypass via .NET Reflection\nid: 30edb182-aa75-42c0-b0a9-e998bb29067c\nstatus: experimental\ndescription: Detects Request to amsiInitFailed that can be used to disable AMSI Scanning\nreferences:\n    - https://twitter.com/mattifestation/status/735261176745988096\n    - https://www.hybrid-analysis.com/sample/0ced17419e01663a0cd836c9c2eb925e3031ffb5b18ccf35f4dea5d586d0203e?environmentId=120\ntags:\n    - attack.execution\n    - attack.defense_evasion\n    - attack.t1086\nauthor: Markus Neis\ndate: 2018/08/17\nlogsource:\n    category: process_creation\n    product: windows\ndetection:\n    selection1:\n        CommandLine:\n            - '*System.Management.Automation.AmsiUtils*'\n    selection2:\n        CommandLine:\n            - '*amsiInitFailed*'\n    condition: selection1 and selection2\nfalsepositives:\n    - Potential Admin Activity\nlevel: high\n", "object_marking_refs": ["marking-definition--0a872d70-1d05-45dd-a25f-031af547a102"], "created_by_ref": "identity--082ca4f0-d825-45b6-aa42-ab9afd1e5503", "type": "indicator", "spec_version": "2.1", "id": "indicator--04d9ef4a-a5ce-417e-9348-151cdf764327", "modified": "2020-04-02T07:58:55.640Z"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--35e3bac8-c848-4693-a841-aa4a24d8ca83", "created": "2020-04-02T07:58:55.651Z", "modified": "2020-04-02T07:58:55.651Z", "source_ref": "indicator--04d9ef4a-a5ce-417e-9348-151cdf764327", "relationship_type": "indicates", "target_ref": "attack-pattern--f4882e23-8aa7-4b12-b28a-b349c12ee9e0"}, {"name": "Net.exe Execution", "description": "Detects execution of Net.exe, whether suspicious or benign.", "created": "2019-01-16T00:00:00.000Z", "valid_from": "2019-01-16T00:00:00Z", "indicator_types": ["malicious-activity"], "pattern_type": "sigma", "pattern": "title: Net.exe Execution\nid: 183e7ea8-ac4b-4c23-9aec-b3dac4e401ac\nstatus: experimental\ndescription: Detects execution of Net.exe, whether suspicious or benign.\nreferences:\n    - https://pentest.blog/windows-privilege-escalation-methods-for-pentesters/\n    - https://eqllib.readthedocs.io/en/latest/analytics/4d2e7fc1-af0b-4915-89aa-03d25ba7805e.html\n    - https://eqllib.readthedocs.io/en/latest/analytics/e61f557c-a9d0-4c25-ab5b-bbc46bb24deb.html\n    - https://eqllib.readthedocs.io/en/latest/analytics/9b3dd402-891c-4c4d-a662-28947168ce61.html\nauthor: Michael Haag, Mark Woan (improvements), James Pemberton / @4A616D6573 / oscd.community (improvements)\ndate: 2019/01/16\ntags:\n    - attack.s0039\n    - attack.t1027\n    - attack.t1049\n    - attack.t1077\n    - attack.t1135\n    - attack.lateral_movement\n    - attack.discovery\n    - attack.defense_evasion\nlogsource:\n    category: process_creation\n    product: windows\ndetection:\n    selection:\n        Image:\n            - '*\\net.exe'\n            - '*\\net1.exe'\n    cmdline:\n        CommandLine:\n            - '* group*'\n            - '* localgroup*'\n            - '* user*'\n            - '* view*'\n            - '* share'\n            - '* accounts*'\n            - '* use*'\n            - '* stop *'\n    condition: selection and cmdline\nfields:\n    - ComputerName\n    - User\n    - CommandLine\n    - ParentCommandLine\nfalsepositives:\n    - Will need to be tuned. If using Splunk, I recommend | stats count by Computer,CommandLine following the search for easy hunting by computer/CommandLine.\nlevel: low\n", "object_marking_refs": ["marking-definition--0a872d70-1d05-45dd-a25f-031af547a102"], "created_by_ref": "identity--082ca4f0-d825-45b6-aa42-ab9afd1e5503", "type": "indicator", "spec_version": "2.1", "id": "indicator--ae3d010c-38e9-4546-a5e1-769765568ec1", "modified": "2020-04-02T07:58:55.656Z"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--9f40168d-8cc1-4ea7-9c4d-383c9700ab59", "created": "2020-04-02T07:58:55.667Z", "modified": "2020-04-02T07:58:55.667Z", "source_ref": "indicator--ae3d010c-38e9-4546-a5e1-769765568ec1", "relationship_type": "indicates", "target_ref": "tool--03342581-f790-4f03-ba41-e82e67392e23"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--8dd72927-cf63-4525-a203-e3318f8894c2", "created": "2020-04-02T07:58:55.678Z", "modified": "2020-04-02T07:58:55.678Z", "source_ref": "indicator--ae3d010c-38e9-4546-a5e1-769765568ec1", "relationship_type": "indicates", "target_ref": "attack-pattern--b3d682b6-98f2-4fb0-aa3b-b4df007ca70a"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--fa426fde-a261-4006-972d-692b02731e4e", "created": "2020-04-02T07:58:55.692Z", "modified": "2020-04-02T07:58:55.692Z", "source_ref": "indicator--ae3d010c-38e9-4546-a5e1-769765568ec1", "relationship_type": "indicates", "target_ref": "attack-pattern--7e150503-88e7-4861-866b-ff1ac82c4475"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--73196954-d2be-4ba7-bc01-b08076f5874c", "created": "2020-04-02T07:58:55.702Z", "modified": "2020-04-02T07:58:55.702Z", "source_ref": "indicator--ae3d010c-38e9-4546-a5e1-769765568ec1", "relationship_type": "indicates", "target_ref": "attack-pattern--ffe742ed-9100-4686-9e00-c331da544787"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--f1f11034-bf19-4ef6-a18a-c800e9170f90", "created": "2020-04-02T07:58:55.712Z", "modified": "2020-04-02T07:58:55.712Z", "source_ref": "indicator--ae3d010c-38e9-4546-a5e1-769765568ec1", "relationship_type": "indicates", "target_ref": "attack-pattern--3489cfc5-640f-4bb3-a103-9137b97de79f"}, {"name": "Mimikatz Command Line", "description": "Detection well-known mimikatz command line arguments", "created": "2019-10-22T00:00:00.000Z", "valid_from": "2019-10-22T00:00:00Z", "indicator_types": ["malicious-activity"], "pattern_type": "sigma", "pattern": "title: Mimikatz Command Line\nid: a642964e-bead-4bed-8910-1bb4d63e3b4d\ndescription: Detection well-known mimikatz command line arguments\nauthor: Teymur Kheirkhabarov, oscd.community\ndate: 2019/10/22\nreferences:\n    - https://www.slideshare.net/heirhabarov/hunting-for-credentials-dumping-in-windows-environment\ntags:\n    - attack.credential_access\n    - attack.t1003\nlogsource:\n    category: process_creation\n    product: windows\ndetection:\n    selection_1:\n        CommandLine|contains:\n            - DumpCreds\n            - invoke-mimikatz\n    selection_2:\n        CommandLine|contains:\n            - rpc\n            - token\n            - crypto\n            - dpapi\n            - sekurlsa\n            - kerberos\n            - lsadump\n            - privilege\n            - process\n    selection_3:\n        CommandLine|contains:\n            - '::'\n    condition: selection_1 or \n               selection_2 and selection_3\nfalsepositives:\n    - Legitimate Administrator using tool for password recovery\nlevel: medium\nstatus: experimental\n", "object_marking_refs": ["marking-definition--0a872d70-1d05-45dd-a25f-031af547a102"], "created_by_ref": "identity--082ca4f0-d825-45b6-aa42-ab9afd1e5503", "type": "indicator", "spec_version": "2.1", "id": "indicator--2229e390-0cd5-4c3c-baa6-59035c695d36", "modified": "2020-04-02T07:58:55.716Z"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--fa7fb13c-5cc7-49af-bf27-69e606fda622", "created": "2020-04-02T07:58:55.728Z", "modified": "2020-04-02T07:58:55.728Z", "source_ref": "indicator--2229e390-0cd5-4c3c-baa6-59035c695d36", "relationship_type": "indicates", "target_ref": "attack-pattern--0a3ead4e-6d47-4ccb-854c-a6a4f9d96b22"}, {"name": "Microsoft Workflow Compiler", "description": "Detects invocation of Microsoft Workflow Compiler, which may permit the execution of arbitrary unsigned code.", "created": "2019-01-16T00:00:00.000Z", "valid_from": "2019-01-16T00:00:00Z", "indicator_types": ["malicious-activity"], "pattern_type": "sigma", "pattern": "title: Microsoft Workflow Compiler\nid: 419dbf2b-8a9b-4bea-bf99-7544b050ec8d\nstatus: experimental\ndescription: Detects invocation of Microsoft Workflow Compiler, which may permit the execution of arbitrary unsigned code.\ntags:\n    - attack.defense_evasion\n    - attack.execution\n    - attack.t1127\nauthor: Nik Seetharaman\ndate: 2019/01/16\nreferences:\n    - https://posts.specterops.io/arbitrary-unsigned-code-execution-vector-in-microsoft-workflow-compiler-exe-3d9294bc5efb\nlogsource:\n    category: process_creation\n    product: windows\ndetection:\n    selection:\n        Image: '*\\Microsoft.Workflow.Compiler.exe'\n    condition: selection\nfields:\n    - CommandLine\n    - ParentCommandLine\nfalsepositives:\n    - Legitimate MWC use (unlikely in modern enterprise environments)\nlevel: high\n", "object_marking_refs": ["marking-definition--0a872d70-1d05-45dd-a25f-031af547a102"], "created_by_ref": "identity--082ca4f0-d825-45b6-aa42-ab9afd1e5503", "type": "indicator", "spec_version": "2.1", "id": "indicator--8b0f1d62-f40b-4f2c-995b-a21b87615bcd", "modified": "2020-04-02T07:58:55.731Z"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--2c46e3d1-ed79-4eda-9204-91407d3a1c9c", "created": "2020-04-02T07:58:55.741Z", "modified": "2020-04-02T07:58:55.741Z", "source_ref": "indicator--8b0f1d62-f40b-4f2c-995b-a21b87615bcd", "relationship_type": "indicates", "target_ref": "attack-pattern--ff25900d-76d5-449b-a351-8824e62fc81b"}, {"name": "NotPetya Ransomware Activity", "description": "Detects NotPetya ransomware activity in which the extracted passwords are passed back to the main module via named pipe, the file system journal of drive C is deleted and windows eventlogs are cleared using wevtutil", "created": "2019-01-16T00:00:00.000Z", "valid_from": "2019-01-16T00:00:00Z", "indicator_types": ["malicious-activity"], "pattern_type": "sigma", "pattern": "title: NotPetya Ransomware Activity\nid: 79aeeb41-8156-4fac-a0cd-076495ab82a1\nstatus: experimental\ndescription: Detects NotPetya ransomware activity in which the extracted passwords are passed back to the main module via named pipe, the file system journal of drive\n    C is deleted and windows eventlogs are cleared using wevtutil\nauthor: Florian Roth, Tom Ueltschi\ndate: 2019/01/16\nreferences:\n    - https://securelist.com/schroedingers-petya/78870/\n    - https://www.hybrid-analysis.com/sample/64b0b58a2c030c77fdb2b537b2fcc4af432bc55ffb36599a31d418c7c69e94b1?environmentId=100\ntags:\n    - attack.execution\n    - attack.credential_access\n    - attack.defense_evasion\n    - attack.t1085\n    - attack.t1070\n    - attack.t1003\n    - car.2016-04-002\nlogsource:\n    category: process_creation\n    product: windows\ndetection:\n    pipe_com:\n        CommandLine: '*\\AppData\\Local\\Temp\\\\* \\\\.\\pipe\\\\*'\n    rundll32_dash1:\n        Image: '*\\rundll32.exe'\n        CommandLine: '*.dat,#1'\n    perfc_keyword:\n        - '*\\perfc.dat*'\n    condition: 1 of them\nfields:\n    - CommandLine\n    - ParentCommandLine\nfalsepositives:\n    - Admin activity\nlevel: critical\n", "object_marking_refs": ["marking-definition--0a872d70-1d05-45dd-a25f-031af547a102"], "created_by_ref": "identity--082ca4f0-d825-45b6-aa42-ab9afd1e5503", "type": "indicator", "spec_version": "2.1", "id": "indicator--fa7909f7-8abe-428c-afa2-2bc4274a3118", "modified": "2020-04-02T07:58:55.746Z"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--1f4438b9-7b29-4670-9d42-e324e17127b1", "created": "2020-04-02T07:58:55.755Z", "modified": "2020-04-02T07:58:55.755Z", "source_ref": "indicator--fa7909f7-8abe-428c-afa2-2bc4274a3118", "relationship_type": "indicates", "target_ref": "attack-pattern--62b8c999-dcc0-4755-bd69-09442d9359f5"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--32d84fbd-9630-45a1-ad0e-68537a062bb9", "created": "2020-04-02T07:58:55.765Z", "modified": "2020-04-02T07:58:55.765Z", "source_ref": "indicator--fa7909f7-8abe-428c-afa2-2bc4274a3118", "relationship_type": "indicates", "target_ref": "attack-pattern--799ace7f-e227-4411-baa0-8868704f2a69"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--c17fd853-bc36-4889-973f-15125b2bce77", "created": "2020-04-02T07:58:55.773Z", "modified": "2020-04-02T07:58:55.773Z", "source_ref": "indicator--fa7909f7-8abe-428c-afa2-2bc4274a3118", "relationship_type": "indicates", "target_ref": "attack-pattern--0a3ead4e-6d47-4ccb-854c-a6a4f9d96b22"}, {"name": "PsExec Service Start", "description": "Detects a PsExec service start", "created": "2018-03-13T00:00:00.000Z", "modified": "2012-12-11T00:00:00.000Z", "valid_from": "2018-03-13T00:00:00Z", "indicator_types": ["malicious-activity"], "pattern_type": "sigma", "pattern": "title: PsExec Service Start\nid: 3ede524d-21cc-472d-a3ce-d21b568d8db7\ndescription: Detects a PsExec service start\nauthor: Florian Roth\ndate: 2018/03/13\nmodified: 2012/12/11\ntags:\n    - attack.execution\n    - attack.t1035\n    - attack.s0029\nlogsource:\n    category: process_creation\n    product: windows\ndetection:\n    selection:\n        ProcessCommandLine: C:\\Windows\\PSEXESVC.exe\n    condition: selection\nfalsepositives:\n    - Administrative activity\nlevel: low\n", "object_marking_refs": ["marking-definition--0a872d70-1d05-45dd-a25f-031af547a102"], "created_by_ref": "identity--082ca4f0-d825-45b6-aa42-ab9afd1e5503", "type": "indicator", "spec_version": "2.1", "id": "indicator--92503038-b520-44fe-892e-cac159a180e9"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--302c9cee-2d42-414a-9094-5b0f8306dc60", "created": "2020-04-02T07:58:55.786Z", "modified": "2020-04-02T07:58:55.786Z", "source_ref": "indicator--92503038-b520-44fe-892e-cac159a180e9", "relationship_type": "indicates", "target_ref": "attack-pattern--f44731de-ea9f-406d-9b83-30ecbb9b4392"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--b12636c8-968c-4c26-84d6-38a78c098b7e", "created": "2020-04-02T07:58:55.795Z", "modified": "2020-04-02T07:58:55.795Z", "source_ref": "indicator--92503038-b520-44fe-892e-cac159a180e9", "relationship_type": "indicates", "target_ref": "tool--ff6caf67-ea1f-4895-b80e-4bb0fc31c6db"}, {"name": "Quick Execution of a Series of Suspicious Commands", "description": "Detects multiple suspicious process in a limited timeframe", "created": "2019-01-16T00:00:00.000Z", "valid_from": "2019-01-16T00:00:00Z", "indicator_types": ["malicious-activity"], "pattern_type": "sigma", "pattern": "title: Quick Execution of a Series of Suspicious Commands\nid: 61ab5496-748e-4818-a92f-de78e20fe7f1\ndescription: Detects multiple suspicious process in a limited timeframe\nstatus: experimental\nreferences:\n    - https://car.mitre.org/wiki/CAR-2013-04-002\nauthor: juju4\ndate: 2019/01/16\ntags:\n    - car.2013-04-002\nlogsource:\n    category: process_creation\n    product: windows\ndetection:\n    selection:\n        CommandLine:\n            - arp.exe\n            - at.exe\n            - attrib.exe\n            - cscript.exe\n            - dsquery.exe\n            - hostname.exe\n            - ipconfig.exe\n            - mimikatz.exe\n            - nbtstat.exe\n            - net.exe\n            - netsh.exe\n            - nslookup.exe\n            - ping.exe\n            - quser.exe\n            - qwinsta.exe\n            - reg.exe\n            - runas.exe\n            - sc.exe\n            - schtasks.exe\n            - ssh.exe\n            - systeminfo.exe\n            - taskkill.exe\n            - telnet.exe\n            - tracert.exe\n            - wscript.exe\n            - xcopy.exe\n            - pscp.exe\n            - copy.exe\n            - robocopy.exe\n            - certutil.exe\n            - vssadmin.exe\n            - powershell.exe\n            - wevtutil.exe\n            - psexec.exe\n            - bcedit.exe\n            - wbadmin.exe\n            - icacls.exe\n            - diskpart.exe\n    timeframe: 5m\n    condition: selection | count() by MachineName > 5\nfalsepositives:\n    - False positives depend on scripts and administrative tools used in the monitored environment\nlevel: low\n", "object_marking_refs": ["marking-definition--0a872d70-1d05-45dd-a25f-031af547a102"], "created_by_ref": "identity--082ca4f0-d825-45b6-aa42-ab9afd1e5503", "type": "indicator", "spec_version": "2.1", "id": "indicator--f1233b90-f147-4d60-a545-7e6008fcc785", "modified": "2020-04-02T07:58:55.801Z"}, {"name": "Suspicious GUP Usage", "description": "Detects execution of the Notepad++ updater in a suspicious directory, which is often used in DLL side-loading attacks", "created": "2019-02-06T00:00:00.000Z", "valid_from": "2019-02-06T00:00:00Z", "indicator_types": ["malicious-activity"], "pattern_type": "sigma", "pattern": "title: Suspicious GUP Usage\nid: 0a4f6091-223b-41f6-8743-f322ec84930b\ndescription: Detects execution of the Notepad++ updater in a suspicious directory, which is often used in DLL side-loading attacks\nstatus: experimental\nreferences:\n    - https://www.fireeye.com/blog/threat-research/2018/09/apt10-targeting-japanese-corporations-using-updated-ttps.html\ntags:\n    - attack.defense_evasion\n    - attack.t1073\nauthor: Florian Roth\ndate: 2019/02/06\nlogsource:\n    category: process_creation\n    product: windows\ndetection:\n    selection:\n        Image: '*\\GUP.exe'\n    filter:\n        Image:\n            - 'C:\\Users\\\\*\\AppData\\Local\\Notepad++\\updater\\gup.exe'\n            - 'C:\\Users\\\\*\\AppData\\Roaming\\Notepad++\\updater\\gup.exe'\n            - 'C:\\Program Files\\Notepad++\\updater\\gup.exe'\n            - 'C:\\Program Files (x86)\\Notepad++\\updater\\gup.exe'\n    condition: selection and not filter\nfalsepositives:\n    - Execution of tools named GUP.exe and located in folders different than Notepad++\\updater\nlevel: high\n", "object_marking_refs": ["marking-definition--0a872d70-1d05-45dd-a25f-031af547a102"], "created_by_ref": "identity--082ca4f0-d825-45b6-aa42-ab9afd1e5503", "type": "indicator", "spec_version": "2.1", "id": "indicator--d592ece8-0586-4e5a-9567-18797e2dfb43", "modified": "2020-04-02T07:58:55.806Z"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--3713cddb-a384-4c73-a073-47458f516bde", "created": "2020-04-02T07:58:55.816Z", "modified": "2020-04-02T07:58:55.816Z", "source_ref": "indicator--d592ece8-0586-4e5a-9567-18797e2dfb43", "relationship_type": "indicates", "target_ref": "attack-pattern--b2001907-166b-4d71-bb3c-9d26c871de09"}, {"name": "Psr.exe Capture Screenshots", "description": "The psr.exe captures desktop screenshots and saves them on the local machine", "created": "2019-10-12T00:00:00.000Z", "modified": "2019-11-04T00:00:00.000Z", "valid_from": "2019-10-12T00:00:00Z", "indicator_types": ["malicious-activity"], "pattern_type": "sigma", "pattern": "title: Psr.exe Capture Screenshots\nid: 2158f96f-43c2-43cb-952a-ab4580f32382\nstatus: experimental\ndescription: The psr.exe captures desktop screenshots and saves them on the local machine\nreferences:\n    - https://github.com/LOLBAS-Project/LOLBAS/blob/master/yml/LOLUtilz/OSBinaries/Psr.yml\n    - https://www.sans.org/summit-archives/file/summit-archive-1493861893.pdf\nauthor: Beyu Denis, oscd.community\ndate: 2019/10/12\nmodified: 2019/11/04\ntags:\n    - attack.persistence\n    - attack.t1218\nlevel: medium\nlogsource:\n    category: process_creation\n    product: windows\ndetection:\n    selection:\n        Image|endswith: '\\Psr.exe'\n        CommandLine|contains: '/start'\n    condition: selection\nfalsepositives:\n    - Unknown\n", "object_marking_refs": ["marking-definition--0a872d70-1d05-45dd-a25f-031af547a102"], "created_by_ref": "identity--082ca4f0-d825-45b6-aa42-ab9afd1e5503", "type": "indicator", "spec_version": "2.1", "id": "indicator--78d1ab3b-ba31-4c29-9d44-10108323dedd"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--dd21b81b-8a72-45e0-8f1e-eadf384e0f7c", "created": "2020-04-02T07:58:55.831Z", "modified": "2020-04-02T07:58:55.831Z", "source_ref": "indicator--78d1ab3b-ba31-4c29-9d44-10108323dedd", "relationship_type": "indicates", "target_ref": "attack-pattern--457c7820-d331-465a-915e-42f85500ccc4"}, {"name": "Suspicious Process Creation", "description": "Detects suspicious process starts on Windows systems based on keywords", "created": "2018-01-01T00:00:00.000Z", "modified": "2019-11-01T00:00:00.000Z", "valid_from": "2018-01-01T00:00:00Z", "indicator_types": ["malicious-activity"], "pattern_type": "sigma", "pattern": "title: Suspicious Process Creation\nid: 5f0f47a5-cb16-4dbe-9e31-e8d976d73de3\ndescription: Detects suspicious process starts on Windows systems based on keywords\nstatus: experimental\nreferences:\n    - https://www.swordshield.com/2015/07/getting-hashes-from-ntds-dit-file/\n    - https://www.youtube.com/watch?v=H3t_kHQG1Js&feature=youtu.be&t=15m35s\n    - https://winscripting.blog/2017/05/12/first-entry-welcome-and-uac-bypass/\n    - https://twitter.com/subTee/status/872244674609676288\n    - https://docs.microsoft.com/en-us/windows-hardware/drivers/debugger/remote-tool-examples\n    - https://tyranidslair.blogspot.ca/2017/07/dg-on-windows-10-s-executing-arbitrary.html\n    - https://www.trustedsec.com/2017/07/new-tool-release-nps_payload/\n    - https://subt0x10.blogspot.ca/2017/04/bypassing-application-whitelisting.html\n    - https://gist.github.com/subTee/7937a8ef07409715f15b84781e180c46#file-rat-bat\n    - https://twitter.com/vector_sec/status/896049052642533376\n    - http://security-research.dyndns.org/pub/slides/FIRST-TC-2018/FIRST-TC-2018_Tom-Ueltschi_Sysmon_PUBLIC.pdf\nauthor: Florian Roth, Daniil Yugoslavskiy, oscd.community (update)\ndate: 2018/01/01\nmodified: 2019/11/01\ntags:\n    - car.2013-07-001\nlogsource:\n    category: process_creation\n    product: windows\ndetection:\n    selection:\n        CommandLine:\n            - '* sekurlsa:*'\n            - net localgroup administrators * /add\n            - net group \"Domain Admins\" * /ADD /DOMAIN\n            - certutil.exe *-urlcache* http*\n            - certutil.exe *-urlcache* ftp*\n            - netsh advfirewall firewall *\\AppData\\\\*\n            - attrib +S +H +R *\\AppData\\\\*\n            - schtasks* /create *\\AppData\\\\*\n            - schtasks* /sc minute*\n            - '*\\Regasm.exe *\\AppData\\\\*'\n            - '*\\Regasm *\\AppData\\\\*'\n            - '*\\bitsadmin* /transfer*'\n            - '*\\certutil.exe * -decode *'\n            - '*\\certutil.exe * -decodehex *'\n            - '*\\certutil.exe -ping *'\n            - icacls * /grant Everyone:F /T /C /Q\n            - '* wbadmin.exe delete catalog -quiet*'\n            - '*\\wscript.exe *.jse'\n            - '*\\wscript.exe *.js'\n            - '*\\wscript.exe *.vba'\n            - '*\\wscript.exe *.vbe'\n            - '*\\cscript.exe *.jse'\n            - '*\\cscript.exe *.js'\n            - '*\\cscript.exe *.vba'\n            - '*\\cscript.exe *.vbe'\n            - '*\\fodhelper.exe'\n            - '*waitfor*/s*'\n            - '*waitfor*/si persist*'\n            - '*remote*/s*'\n            - '*remote*/c*'\n            - '*remote*/q*'\n            - '*AddInProcess*'\n            - '* /stext *'\n            - '* /scomma *'\n            - '* /stab *'\n            - '* /stabular *'\n            - '* /shtml *'\n            - '* /sverhtml *'\n            - '* /sxml *'\n    condition: selection\nfields:\n    - ComputerName\n    - User\n    - CommandLine\nfalsepositives:\n    - False positives depend on scripts and administrative tools used in the monitored environment\nlevel: medium\n", "object_marking_refs": ["marking-definition--0a872d70-1d05-45dd-a25f-031af547a102"], "created_by_ref": "identity--082ca4f0-d825-45b6-aa42-ab9afd1e5503", "type": "indicator", "spec_version": "2.1", "id": "indicator--842c1d11-8a2c-4cf7-bd6c-113f9791c396"}, {"name": "Fireball Archer Install", "description": "Detects Archer malware invocation via rundll32", "created": "2017-06-03T00:00:00.000Z", "valid_from": "2017-06-03T00:00:00Z", "indicator_types": ["malicious-activity"], "pattern_type": "sigma", "pattern": "title: Fireball Archer Install\nid: 3d4aebe0-6d29-45b2-a8a4-3dfde586a26d\nstatus: experimental\ndescription: Detects Archer malware invocation via rundll32\nauthor: Florian Roth\ndate: 2017/06/03\nreferences:\n    - https://www.virustotal.com/en/file/9b4971349ae85aa09c0a69852ed3e626c954954a3927b3d1b6646f139b930022/analysis/\n    - https://www.hybrid-analysis.com/sample/9b4971349ae85aa09c0a69852ed3e626c954954a3927b3d1b6646f139b930022?environmentId=100\ntags:\n    - attack.execution\n    - attack.t1059\n    - attack.defense_evasion\n    - attack.t1085\nlogsource:\n    category: process_creation\n    product: windows\ndetection:\n    selection:\n        CommandLine: '*\\rundll32.exe *,InstallArcherSvc'\n    condition: selection\nfields:\n    - CommandLine\n    - ParentCommandLine\nfalsepositives:\n    - Unknown\nlevel: high\n", "object_marking_refs": ["marking-definition--0a872d70-1d05-45dd-a25f-031af547a102"], "created_by_ref": "identity--082ca4f0-d825-45b6-aa42-ab9afd1e5503", "type": "indicator", "spec_version": "2.1", "id": "indicator--5f0e8f21-42a9-419c-ac05-2d1121373cd2", "modified": "2020-04-02T07:58:56.933Z"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--725094ea-d0fe-4f60-8a62-2794ade6db4a", "created": "2020-04-02T07:58:56.947Z", "modified": "2020-04-02T07:58:56.947Z", "source_ref": "indicator--5f0e8f21-42a9-419c-ac05-2d1121373cd2", "relationship_type": "indicates", "target_ref": "attack-pattern--7385dfaf-6886-4229-9ecd-6fd678040830"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--930221fd-e34d-4272-8c96-b8781c69a0c8", "created": "2020-04-02T07:58:56.959Z", "modified": "2020-04-02T07:58:56.959Z", "source_ref": "indicator--5f0e8f21-42a9-419c-ac05-2d1121373cd2", "relationship_type": "indicates", "target_ref": "attack-pattern--62b8c999-dcc0-4755-bd69-09442d9359f5"}, {"name": "BlueMashroom DLL Load", "description": "Detects a suspicious DLL loading from AppData Local path as described in BlueMashroom report", "created": "2019-10-02T00:00:00.000Z", "valid_from": "2019-10-02T00:00:00Z", "indicator_types": ["malicious-activity"], "pattern_type": "sigma", "pattern": "title: BlueMashroom DLL Load\nid: bd70d3f8-e60e-4d25-89f0-0b5a9cff20e0\nstatus: experimental\ndescription: Detects a suspicious DLL loading from AppData Local path as described in BlueMashroom report\nreferences:\n    - https://www.virusbulletin.com/conference/vb2019/abstracts/apt-cases-exploiting-vulnerabilities-region-specific-software\ntags:\n    - attack.defense_evasion\n    - attack.t1117\nauthor: Florian Roth\ndate: 2019/10/02\nlogsource:\n    category: process_creation\n    product: windows\ndetection:\n    selection:\n        CommandLine: \n            - '*\\regsvr32*\\AppData\\Local\\\\*'\n            - '*\\AppData\\Local\\\\*,DllEntry*'\n    condition: selection\nfalsepositives:\n    - Unlikely\nlevel: critical\n", "object_marking_refs": ["marking-definition--0a872d70-1d05-45dd-a25f-031af547a102"], "created_by_ref": "identity--082ca4f0-d825-45b6-aa42-ab9afd1e5503", "type": "indicator", "spec_version": "2.1", "id": "indicator--fac8849d-3a90-409e-a5e3-941a478bf3bf", "modified": "2020-04-02T07:58:56.963Z"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--d5c8a255-acd6-40df-bb12-ea53fbb0955b", "created": "2020-04-02T07:58:56.975Z", "modified": "2020-04-02T07:58:56.975Z", "source_ref": "indicator--fac8849d-3a90-409e-a5e3-941a478bf3bf", "relationship_type": "indicates", "target_ref": "attack-pattern--68f7e3a1-f09f-4164-9a62-16b648a0dd5a"}, {"name": "Possible Shim Database Persistence via sdbinst.exe", "description": "Detects installation of a new shim using sdbinst.exe. A shim can be used to load malicious DLLs into applications.", "created": "2019-01-16T00:00:00.000Z", "valid_from": "2019-01-16T00:00:00Z", "indicator_types": ["malicious-activity"], "pattern_type": "sigma", "pattern": "title: Possible Shim Database Persistence via sdbinst.exe\nid: 517490a7-115a-48c6-8862-1a481504d5a8\nstatus: experimental\ndescription: Detects installation of a new shim using sdbinst.exe. A shim can be used to load malicious DLLs into applications.\nreferences:\n    - https://www.fireeye.com/blog/threat-research/2017/05/fin7-shim-databases-persistence.html\ntags:\n    - attack.persistence\n    - attack.t1138\nauthor: Markus Neis\ndate: 2019/01/16\nlogsource:\n    category: process_creation\n    product: windows\ndetection:\n    selection:\n        Image:\n            - '*\\sdbinst.exe'\n        CommandLine:\n            - '*.sdb*'\n    condition: selection\nfalsepositives:\n    - Unknown\nlevel: high\n", "object_marking_refs": ["marking-definition--0a872d70-1d05-45dd-a25f-031af547a102"], "created_by_ref": "identity--082ca4f0-d825-45b6-aa42-ab9afd1e5503", "type": "indicator", "spec_version": "2.1", "id": "indicator--32375ad0-8f54-4ce3-b6ff-322183500d3b", "modified": "2020-04-02T07:58:56.979Z"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--d9ac87f7-6b10-4261-9627-7c4a0757d0f3", "created": "2020-04-02T07:58:56.991Z", "modified": "2020-04-02T07:58:56.991Z", "source_ref": "indicator--32375ad0-8f54-4ce3-b6ff-322183500d3b", "relationship_type": "indicates", "target_ref": "attack-pattern--7c93aa74-4bc0-4a9e-90ea-f25f86301566"}, {"name": "MMC Spawning Windows Shell", "description": "Detects a Windows command line executable started from MMC.", "created": "2019-08-05T00:00:00.000Z", "valid_from": "2019-08-05T00:00:00Z", "indicator_types": ["malicious-activity"], "pattern_type": "sigma", "pattern": "title: MMC Spawning Windows Shell\nid: 05a2ab7e-ce11-4b63-86db-ab32e763e11d\nstatus: experimental\ndescription: Detects a Windows command line executable started from MMC.\nauthor: Karneades, Swisscom CSIRT\ndate: 2019/08/05\ntags:\n    - attack.lateral_movement\n    - attack.t1175\nlogsource:\n    category: process_creation\n    product: windows\ndetection:\n    selection:\n        ParentImage: '*\\mmc.exe'\n        Image:\n            - '*\\cmd.exe'\n            - '*\\powershell.exe'\n            - '*\\wscript.exe'\n            - '*\\cscript.exe'\n            - '*\\sh.exe'\n            - '*\\bash.exe'\n            - '*\\reg.exe'\n            - '*\\regsvr32.exe'\n            - '*\\BITSADMIN*'\n    condition: selection\nfields:\n    - CommandLine\n    - Image\n    - ParentCommandLine\nlevel: high\n", "object_marking_refs": ["marking-definition--0a872d70-1d05-45dd-a25f-031af547a102"], "created_by_ref": "identity--082ca4f0-d825-45b6-aa42-ab9afd1e5503", "type": "indicator", "spec_version": "2.1", "id": "indicator--102bcfc0-0633-437e-a30b-18885782e155", "modified": "2020-04-02T07:58:56.995Z"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--36f4f874-3fb8-4296-a176-b3d28faee8c9", "created": "2020-04-02T07:58:57.006Z", "modified": "2020-04-02T07:58:57.006Z", "source_ref": "indicator--102bcfc0-0633-437e-a30b-18885782e155", "relationship_type": "indicates", "target_ref": "attack-pattern--772bc7a8-a157-42cc-8728-d648e25c7fe7"}, {"name": "Suspicious Svchost Process", "description": "Detects a suspicious svchost process start", "created": "2017-08-15T00:00:00.000Z", "valid_from": "2017-08-15T00:00:00Z", "indicator_types": ["malicious-activity"], "pattern_type": "sigma", "pattern": "title: Suspicious Svchost Process\nid: 01d2e2a1-5f09-44f7-9fc1-24faa7479b6d\nstatus: experimental\ndescription: Detects a suspicious svchost process start\ntags:\n    - attack.defense_evasion\n    - attack.t1036\nauthor: Florian Roth\ndate: 2017/08/15\nlogsource:\n    category: process_creation\n    product: windows\ndetection:\n    selection:\n        Image: '*\\svchost.exe'\n    filter:\n        ParentImage:\n            - '*\\services.exe'\n            - '*\\MsMpEng.exe'\n            - '*\\Mrt.exe'\n            - '*\\rpcnet.exe'\n            - '*\\svchost.exe'\n    filter_null:\n        ParentImage: null\n    condition: selection and not filter and not filter_null\nfields:\n    - CommandLine\n    - ParentCommandLine\nfalsepositives:\n    - Unknown\nlevel: high\n", "object_marking_refs": ["marking-definition--0a872d70-1d05-45dd-a25f-031af547a102"], "created_by_ref": "identity--082ca4f0-d825-45b6-aa42-ab9afd1e5503", "type": "indicator", "spec_version": "2.1", "id": "indicator--244b7325-2dc0-4313-92cc-46b41c8e25fd", "modified": "2020-04-02T07:58:57.011Z"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--03cb77e4-a2db-4975-81e0-2392f063bc81", "created": "2020-04-02T07:58:57.023Z", "modified": "2020-04-02T07:58:57.023Z", "source_ref": "indicator--244b7325-2dc0-4313-92cc-46b41c8e25fd", "relationship_type": "indicates", "target_ref": "attack-pattern--42e8de7b-37b2-4258-905a-6897815e58e0"}, {"name": "Netsh", "description": "Allow Incoming Connections by Port or Application on Windows Firewall", "created": "2019-01-29T00:00:00.000Z", "valid_from": "2019-01-29T00:00:00Z", "indicator_types": ["malicious-activity"], "pattern_type": "sigma", "pattern": "title: Netsh\nid: cd5cfd80-aa5f-44c0-9c20-108c4ae12e3c\ndescription: Allow Incoming Connections by Port or Application on Windows Firewall\nreferences:\n    - https://attack.mitre.org/software/S0246/ (Lazarus HARDRAIN)\n    - https://www.operationblockbuster.com/wp-content/uploads/2016/02/Operation-Blockbuster-RAT-and-Staging-Report.pdf\ndate: 2019/01/29\ntags:\n    - attack.lateral_movement\n    - attack.command_and_control\n    - attack.t1090 \nstatus: experimental\nauthor: Markus Neis\nlogsource:\n    category: process_creation\n    product: windows\ndetection:\n    selection:\n        CommandLine:\n            - '*netsh firewall add*'\n    condition: selection\nfalsepositives:\n    - Legitimate administration\nlevel: medium\n", "object_marking_refs": ["marking-definition--0a872d70-1d05-45dd-a25f-031af547a102"], "created_by_ref": "identity--082ca4f0-d825-45b6-aa42-ab9afd1e5503", "type": "indicator", "spec_version": "2.1", "id": "indicator--10261c3f-5477-4f3d-bf7f-a30db186e46a", "modified": "2020-04-02T07:58:57.027Z"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--f1487f2a-2647-415b-a923-6419f94b62a6", "created": "2020-04-02T07:58:57.037Z", "modified": "2020-04-02T07:58:57.037Z", "source_ref": "indicator--10261c3f-5477-4f3d-bf7f-a30db186e46a", "relationship_type": "indicates", "target_ref": "attack-pattern--731f4f55-b6d0-41d1-a7a9-072a66389aea"}, {"name": "Shadow Copies Deletion Using Operating Systems Utilities", "description": "Shadow Copies deletion using operating systems utilities", "created": "2019-10-22T00:00:00.000Z", "valid_from": "2019-10-22T00:00:00Z", "indicator_types": ["malicious-activity"], "pattern_type": "sigma", "pattern": "title: Shadow Copies Deletion Using Operating Systems Utilities\nid: c947b146-0abc-4c87-9c64-b17e9d7274a2\nstatus: stable\ndescription: Shadow Copies deletion using operating systems utilities\nauthor: Florian Roth, Michael Haag, Teymur Kheirkhabarov, Daniil Yugoslavskiy, oscd.community\ndate: 2019/10/22\nreferences:\n    - https://www.slideshare.net/heirhabarov/hunting-for-credentials-dumping-in-windows-environment\n    - https://blog.talosintelligence.com/2017/05/wannacry.html\n    - https://securingtomorrow.mcafee.com/other-blogs/mcafee-labs/new-teslacrypt-ransomware-arrives-via-spam/\n    - https://www.bleepingcomputer.com/news/security/why-everyone-should-disable-vssadmin-exe-now/\n    - https://www.hybrid-analysis.com/sample/ed01ebfbc9eb5bbea545af4d01bf5f1071661840480439c6e5babe8e080e41aa?environmentId=100\ntags:\n    - attack.defense_evasion\n    - attack.impact\n    - attack.t1070\n    - attack.t1490\nlogsource:\n    category: process_creation\n    product: windows\ndetection:\n    selection:\n        NewProcessName|endswith:\n            - '\\powershell.exe'\n            - '\\wmic.exe'\n            - '\\vssadmin.exe'\n        CommandLine|contains|all:\n            - shadow\n            - delete\n    condition: selection\nfields:\n    - CommandLine\n    - ParentCommandLine\nfalsepositives:\n    - Legitimate Administrator deletes Shadow Copies using operating systems utilities for legitimate reason\nlevel: critical\n", "object_marking_refs": ["marking-definition--0a872d70-1d05-45dd-a25f-031af547a102"], "created_by_ref": "identity--082ca4f0-d825-45b6-aa42-ab9afd1e5503", "type": "indicator", "spec_version": "2.1", "id": "indicator--12d35584-f1f0-4f09-b58a-e28cfe563b5e", "modified": "2020-04-02T07:58:57.042Z"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--058f67be-837e-4970-bf75-69b95abafd37", "created": "2020-04-02T07:58:57.053Z", "modified": "2020-04-02T07:58:57.053Z", "source_ref": "indicator--12d35584-f1f0-4f09-b58a-e28cfe563b5e", "relationship_type": "indicates", "target_ref": "attack-pattern--799ace7f-e227-4411-baa0-8868704f2a69"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--2757273f-2705-4a31-a8d8-bb07235b73e5", "created": "2020-04-02T07:58:57.062Z", "modified": "2020-04-02T07:58:57.062Z", "source_ref": "indicator--12d35584-f1f0-4f09-b58a-e28cfe563b5e", "relationship_type": "indicates", "target_ref": "attack-pattern--f5d8eed6-48a9-4cdf-a3d7-d1ffa99c3d2a"}, {"name": "Bypass UAC via Fodhelper.exe", "description": "Identifies use of Fodhelper.exe to bypass User Account Control. Adversaries use this technique to execute privileged processes.", "created": "2019-10-24T00:00:00.000Z", "modified": "2019-11-11T00:00:00.000Z", "valid_from": "2019-10-24T00:00:00Z", "indicator_types": ["malicious-activity"], "pattern_type": "sigma", "pattern": "title: Bypass UAC via Fodhelper.exe\nid: 7f741dcf-fc22-4759-87b4-9ae8376676a2\ndescription: Identifies use of Fodhelper.exe to bypass User Account Control. Adversaries use this technique to execute privileged processes.\nstatus: experimental\nauthor: E.M. Anhaus (orignally from Atomic Blue Detections, Tony Lambert), oscd.community\ndate: 2019/10/24\nmodified: 2019/11/11\nreferences:\n    - https://eqllib.readthedocs.io/en/latest/analytics/e491ce22-792f-11e9-8f5c-d46d6d62a49e.html\n    - https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1088/T1088.md\ntags:\n    - attack.privilege_escalation\n    - attack.t1088\nlogsource:\n    category: process_creation\n    product: windows\ndetection:\n    selection:\n        ParentImage|endswith: '\\fodhelper.exe'\n    condition: selection\nfields:\n    - ComputerName\n    - User\n    - CommandLine\nfalsepositives:\n    - Legitimate use of fodhelper.exe utility by legitimate user\nlevel: high\n", "object_marking_refs": ["marking-definition--0a872d70-1d05-45dd-a25f-031af547a102"], "created_by_ref": "identity--082ca4f0-d825-45b6-aa42-ab9afd1e5503", "type": "indicator", "spec_version": "2.1", "id": "indicator--6f3ff4e4-1e3c-4c9a-b775-984671b70206"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--6e91732e-0c93-4c04-ae84-d82dc2f93218", "created": "2020-04-02T07:58:57.079Z", "modified": "2020-04-02T07:58:57.079Z", "source_ref": "indicator--6f3ff4e4-1e3c-4c9a-b775-984671b70206", "relationship_type": "indicates", "target_ref": "attack-pattern--ca1a3f50-5ebd-41f8-8320-2c7d6a6e88be"}, {"name": "WMIExec VBS Script", "description": "Detects suspicious file execution by wscript and cscript", "created": "2017-04-07T00:00:00.000Z", "valid_from": "2017-04-07T00:00:00Z", "indicator_types": ["malicious-activity"], "pattern_type": "sigma", "pattern": "title: WMIExec VBS Script\nid: 966e4016-627f-44f7-8341-f394905c361f\ndescription: Detects suspicious file execution by wscript and cscript\nauthor: Florian Roth\ndate: 2017/04/07\nreferences:\n    - https://www.pwc.co.uk/cyber-security/pdf/cloud-hopper-annex-b-final.pdf\ntags:\n    - attack.execution\n    - attack.g0045\n    - attack.t1064\nlogsource:\n    category: process_creation\n    product: windows\ndetection:\n    selection:\n        Image: '*\\cscript.exe'\n        CommandLine: '*.vbs /shell *'\n    condition: selection\nfields:\n    - CommandLine\n    - ParentCommandLine\nfalsepositives:\n    - Unlikely\nlevel: critical\n", "object_marking_refs": ["marking-definition--0a872d70-1d05-45dd-a25f-031af547a102"], "created_by_ref": "identity--082ca4f0-d825-45b6-aa42-ab9afd1e5503", "type": "indicator", "spec_version": "2.1", "id": "indicator--1f212805-232b-4bdb-95b1-90690a22de22", "modified": "2020-04-02T07:58:57.083Z"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--d043652c-844e-4a87-aede-9551352b61c5", "created": "2020-04-02T07:58:57.094Z", "modified": "2020-04-02T07:58:57.094Z", "source_ref": "indicator--1f212805-232b-4bdb-95b1-90690a22de22", "relationship_type": "indicates", "target_ref": "intrusion-set--222fbd21-fc4f-4b7e-9f85-0e6e3a76c33f"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--73236972-1de0-46a2-bb09-97f97aacbb43", "created": "2020-04-02T07:58:57.105Z", "modified": "2020-04-02T07:58:57.105Z", "source_ref": "indicator--1f212805-232b-4bdb-95b1-90690a22de22", "relationship_type": "indicates", "target_ref": "attack-pattern--7fd87010-3a00-4da3-b905-410525e8ec44"}, {"name": "Tap Installer Execution", "description": "Well-known TAP software installation. Possible preparation for data exfiltration using tunneling techniques", "created": "2019-10-24T00:00:00.000Z", "valid_from": "2019-10-24T00:00:00Z", "indicator_types": ["malicious-activity"], "pattern_type": "sigma", "pattern": "title: Tap Installer Execution\nid: 99793437-3e16-439b-be0f-078782cf953d\ndescription: Well-known TAP software installation. Possible preparation for data exfiltration using tunneling techniques\nstatus: experimental\nauthor: Daniil Yugoslavskiy, Ian Davis, oscd.community\ndate: 2019/10/24\ntags:\n    - attack.exfiltration\n    - attack.t1048\nlogsource:\n     category: process_creation\n     product: windows\ndetection:\n    selection:\n        Image|endswith: '\\tapinstall.exe'\n    condition: selection\nfalsepositives:\n    - Legitimate OpenVPN TAP insntallation\nlevel: medium\n", "object_marking_refs": ["marking-definition--0a872d70-1d05-45dd-a25f-031af547a102"], "created_by_ref": "identity--082ca4f0-d825-45b6-aa42-ab9afd1e5503", "type": "indicator", "spec_version": "2.1", "id": "indicator--11a515a8-d91d-4bbf-8f96-68199e2fb81d", "modified": "2020-04-02T07:58:57.109Z"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--ed584c0a-c126-42c5-b54b-e78f2fbbf524", "created": "2020-04-02T07:58:57.119Z", "modified": "2020-04-02T07:58:57.119Z", "source_ref": "indicator--11a515a8-d91d-4bbf-8f96-68199e2fb81d", "relationship_type": "indicates", "target_ref": "attack-pattern--a19e86f8-1c0a-4fea-8407-23b73d615776"}, {"name": "Koadic Execution", "description": "Detects command line parameters used by Koadic hack tool", "created": "2020-01-12T00:00:00.000Z", "valid_from": "2020-01-12T00:00:00Z", "indicator_types": ["malicious-activity"], "pattern_type": "sigma", "pattern": "title: Koadic Execution\nid: 5cddf373-ef00-4112-ad72-960ac29bac34\nstatus: experimental\ndescription: Detects command line parameters used by Koadic hack tool \nreferences:\n    - https://unit42.paloaltonetworks.com/unit42-sofacy-groups-parallel-attacks/\n    - https://github.com/zerosum0x0/koadic/blob/master/data/stager/js/stdlib.js#L955\n    - https://blog.f-secure.com/hunting-for-koadic-a-com-based-rootkit/\ntags:\n    - attack.execution\n    - attack.t1170\ndate: 2020/01/12\nauthor: wagga\nlogsource:\n    category: process_creation\n    product: windows\ndetection:\n    selection1:\n        CommandLine:\n            - '*cmd.exe* /q /c chcp *'\n    condition: selection1\nfields:\n    - CommandLine\n    - ParentCommandLine\nfalsepositives:\n    - Pentest\nlevel: high\n", "object_marking_refs": ["marking-definition--0a872d70-1d05-45dd-a25f-031af547a102"], "created_by_ref": "identity--082ca4f0-d825-45b6-aa42-ab9afd1e5503", "type": "indicator", "spec_version": "2.1", "id": "indicator--39bad869-9f85-4e78-8da9-bea4d8640fcb", "modified": "2020-04-02T07:58:57.123Z"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--1132f3f8-cadc-4074-8a93-695bfa3ff861", "created": "2020-04-02T07:58:57.133Z", "modified": "2020-04-02T07:58:57.133Z", "source_ref": "indicator--39bad869-9f85-4e78-8da9-bea4d8640fcb", "relationship_type": "indicates", "target_ref": "attack-pattern--a127c32c-cbb0-4f9d-be07-881a792408ec"}, {"name": "Suspicious Debugger Registration Cmdline", "description": "Detects the registration of a debugger for a program that is available in the logon screen (sticky key backdoor).", "created": "2019-09-06T00:00:00.000Z", "valid_from": "2019-09-06T00:00:00Z", "indicator_types": ["malicious-activity"], "pattern_type": "sigma", "pattern": "title: Suspicious Debugger Registration Cmdline\nid: ae215552-081e-44c7-805f-be16f975c8a2\nstatus: experimental\ndescription: Detects the registration of a debugger for a program that is available in the logon screen (sticky key backdoor).\nreferences:\n    - https://blogs.technet.microsoft.com/jonathantrull/2016/10/03/detecting-sticky-key-backdoors/\ntags:\n    - attack.persistence\n    - attack.privilege_escalation\n    - attack.t1015\nauthor: Florian Roth\ndate: 2019/09/06\nlogsource:\n    category: process_creation\n    product: windows\ndetection:\n    selection:\n        CommandLine:\n            - '*\\CurrentVersion\\Image File Execution Options\\sethc.exe*'\n            - '*\\CurrentVersion\\Image File Execution Options\\utilman.exe*'\n            - '*\\CurrentVersion\\Image File Execution Options\\osk.exe*'\n            - '*\\CurrentVersion\\Image File Execution Options\\magnify.exe*'\n            - '*\\CurrentVersion\\Image File Execution Options\\narrator.exe*'\n            - '*\\CurrentVersion\\Image File Execution Options\\displayswitch.exe*'\n            - '*\\CurrentVersion\\Image File Execution Options\\atbroker.exe*'\n    condition: selection\nfalsepositives:\n    - Penetration Tests\nlevel: high\n        \n", "object_marking_refs": ["marking-definition--0a872d70-1d05-45dd-a25f-031af547a102"], "created_by_ref": "identity--082ca4f0-d825-45b6-aa42-ab9afd1e5503", "type": "indicator", "spec_version": "2.1", "id": "indicator--68d5c479-f8ec-47fb-b6f7-1edafac93ff9", "modified": "2020-04-02T07:58:57.138Z"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--35f99ec3-ea40-4dad-b764-7fdd2527f6ed", "created": "2020-04-02T07:58:57.151Z", "modified": "2020-04-02T07:58:57.151Z", "source_ref": "indicator--68d5c479-f8ec-47fb-b6f7-1edafac93ff9", "relationship_type": "indicates", "target_ref": "attack-pattern--9b99b83a-1aac-4e29-b975-b374950551a3"}, {"name": "SecurityXploded Tool", "description": "Detects the execution of SecurityXploded Tools", "created": "2018-12-19T00:00:00.000Z", "valid_from": "2018-12-19T00:00:00Z", "indicator_types": ["malicious-activity"], "pattern_type": "sigma", "pattern": "title: SecurityXploded Tool\nid: 7679d464-4f74-45e2-9e01-ac66c5eb041a\ndescription: Detects the execution of SecurityXploded Tools\nauthor: Florian Roth\nreferences:\n    - https://securityxploded.com/\n    - https://cyberx-labs.com/blog/gangnam-industrial-style-apt-campaign-targets-korean-industrial-companies/\ndate: 2018/12/19\ntags:\n    - attack.credential_access\n    - attack.t1003\n    - attack.s0005\nlogsource:\n    category: process_creation\n    product: windows\ndetection:\n    selection1:\n        Company: SecurityXploded\n    selection2:\n        Image|endswith: 'PasswordDump.exe'\n    selection3:\n        OriginalFilename|endswith: 'PasswordDump.exe'\n    condition: 1 of them\nfalsepositives:\n    - unlikely\nlevel: critical\n", "object_marking_refs": ["marking-definition--0a872d70-1d05-45dd-a25f-031af547a102"], "created_by_ref": "identity--082ca4f0-d825-45b6-aa42-ab9afd1e5503", "type": "indicator", "spec_version": "2.1", "id": "indicator--f0f12b19-bc45-4b5b-ac83-43a2d2f9dce6", "modified": "2020-04-02T07:58:57.155Z"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--51bc2c62-d298-49c6-9ccd-b8324d0302e9", "created": "2020-04-02T07:58:57.166Z", "modified": "2020-04-02T07:58:57.166Z", "source_ref": "indicator--f0f12b19-bc45-4b5b-ac83-43a2d2f9dce6", "relationship_type": "indicates", "target_ref": "attack-pattern--0a3ead4e-6d47-4ccb-854c-a6a4f9d96b22"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--15e0ffd4-92c6-42c6-89c7-1b28941abe09", "created": "2020-04-02T07:58:57.175Z", "modified": "2020-04-02T07:58:57.175Z", "source_ref": "indicator--f0f12b19-bc45-4b5b-ac83-43a2d2f9dce6", "relationship_type": "indicates", "target_ref": "tool--242f3da3-4425-4d11-8f5c-b842886da966"}, {"name": "Suspicious Encoded PowerShell Command Line", "description": "Detects suspicious powershell process starts with base64 encoded commands (e.g. Emotet)", "created": "2018-09-03T00:00:00.000Z", "modified": "2019-12-16T00:00:00.000Z", "valid_from": "2018-09-03T00:00:00Z", "indicator_types": ["malicious-activity"], "pattern_type": "sigma", "pattern": "title: Suspicious Encoded PowerShell Command Line\nid: ca2092a1-c273-4878-9b4b-0d60115bf5ea\ndescription: Detects suspicious powershell process starts with base64 encoded commands (e.g. Emotet)\nstatus: experimental\nreferences:\n    - https://app.any.run/tasks/6217d77d-3189-4db2-a957-8ab239f3e01e\nauthor: Florian Roth, Markus Neis\ndate: 2018/09/03\nmodified: 2019/12/16\ntags:\n  - attack.execution\n  - attack.t1086\nlogsource:\n    category: process_creation\n    product: windows\ndetection:\n    selection:\n        CommandLine:\n            - '* -e JAB*'\n            - '* -e  JAB*'\n            - '* -e   JAB*'\n            - '* -e    JAB*'\n            - '* -e     JAB*'\n            - '* -e      JAB*'\n            - '* -en JAB*'\n            - '* -enc JAB*'\n            - '* -enc* JAB*'\n            - '* -w hidden -e* JAB*'\n            - '* BA^J e-'\n            - '* -e SUVYI*'\n            - '* -e aWV4I*'\n            - '* -e SQBFAFgA*'\n            - '* -e aQBlAHgA*'\n            - '* -enc SUVYI*'\n            - '* -enc aWV4I*'\n            - '* -enc SQBFAFgA*'\n            - '* -enc aQBlAHgA*'\n    falsepositive1:\n        CommandLine: '* -ExecutionPolicy remotesigned *'\n    condition: selection and not falsepositive1\nlevel: high\n", "object_marking_refs": ["marking-definition--0a872d70-1d05-45dd-a25f-031af547a102"], "created_by_ref": "identity--082ca4f0-d825-45b6-aa42-ab9afd1e5503", "type": "indicator", "spec_version": "2.1", "id": "indicator--3f539deb-1944-4b59-aa36-91ce1f9c4e67"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--f8b2ab08-38e9-424b-a346-9e3e31b69921", "created": "2020-04-02T07:58:57.189Z", "modified": "2020-04-02T07:58:57.189Z", "source_ref": "indicator--3f539deb-1944-4b59-aa36-91ce1f9c4e67", "relationship_type": "indicates", "target_ref": "attack-pattern--f4882e23-8aa7-4b12-b28a-b349c12ee9e0"}, {"name": "Tasks Folder Evasion", "description": "The Tasks folder in system32 and syswow64 are globally writable paths. Adversaries can take advantage of this and load or influence any script hosts or ANY .NET Application in Tasks to load and execute a custom assembly into cscript, wscript, regsvr32, mshta, eventvwr", "created": "2020-01-13T00:00:00.000Z", "valid_from": "2020-01-13T00:00:00Z", "indicator_types": ["malicious-activity"], "pattern_type": "sigma", "pattern": "title: Tasks Folder Evasion\nid: cc4e02ba-9c06-48e2-b09e-2500cace9ae0\nstatus: experimental\ndescription: The Tasks folder in system32 and syswow64 are globally writable paths. Adversaries can take advantage of this and load or influence any script hosts or ANY .NET Application in Tasks to load and execute a custom assembly into cscript, wscript, regsvr32, mshta, eventvwr \nreferences: \n    - https://twitter.com/subTee/status/1216465628946563073\n    - https://gist.github.com/am0nsec/8378da08f848424e4ab0cc5b317fdd26\ndate: 2020/01/13\nauthor: Sreeman\ntags:\n    - attack.t1064\n    - attack.t1211\n    - attack.t1059\n    - attack.defense_evasion\n    - attack.persistence\nlogsource:\n    product: Windows\ndetection:\n    selection1:\n        CommandLine|contains:\n            - 'echo '\n            - 'copy '\n            - 'type '\n            - 'file createnew'\n    selection2:\n        CommandLine|contains:\n            - ' C:\\Windows\\System32\\Tasks\\'\n            - ' C:\\Windows\\SysWow64\\Tasks\\'\n    condition: selection1 and selection2\nfields:\n    - CommandLine\n    - ParentProcess\n    - CommandLine\nfalsepositives:\n    - Unknown\nlevel: high\n", "object_marking_refs": ["marking-definition--0a872d70-1d05-45dd-a25f-031af547a102"], "created_by_ref": "identity--082ca4f0-d825-45b6-aa42-ab9afd1e5503", "type": "indicator", "spec_version": "2.1", "id": "indicator--8ce4c07c-030c-47c8-b9e6-21655491a4a9", "modified": "2020-04-02T07:58:57.194Z"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--6e496069-1660-49ff-ae89-0ecaf6391644", "created": "2020-04-02T07:58:57.204Z", "modified": "2020-04-02T07:58:57.204Z", "source_ref": "indicator--8ce4c07c-030c-47c8-b9e6-21655491a4a9", "relationship_type": "indicates", "target_ref": "attack-pattern--7fd87010-3a00-4da3-b905-410525e8ec44"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--ca2a6406-4ba6-46c9-a3d5-888634ffa106", "created": "2020-04-02T07:58:57.214Z", "modified": "2020-04-02T07:58:57.214Z", "source_ref": "indicator--8ce4c07c-030c-47c8-b9e6-21655491a4a9", "relationship_type": "indicates", "target_ref": "attack-pattern--fe926152-f431-4baf-956c-4ad3cb0bf23b"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--c5904f8e-f468-48ee-a19c-1a75a023caa1", "created": "2020-04-02T07:58:57.223Z", "modified": "2020-04-02T07:58:57.223Z", "source_ref": "indicator--8ce4c07c-030c-47c8-b9e6-21655491a4a9", "relationship_type": "indicates", "target_ref": "attack-pattern--7385dfaf-6886-4229-9ecd-6fd678040830"}, {"name": "Execution in Outlook Temp Folder", "description": "Detects a suspicious program execution in Outlook temp folder", "created": "2019-10-01T00:00:00.000Z", "valid_from": "2019-10-01T00:00:00Z", "indicator_types": ["malicious-activity"], "pattern_type": "sigma", "pattern": "title: Execution in Outlook Temp Folder\nid: a018fdc3-46a3-44e5-9afb-2cd4af1d4b39\nstatus: experimental\ndescription: Detects a suspicious program execution in Outlook temp folder\nauthor: Florian Roth\ndate: 2019/10/01\ntags:\n    - attack.initial_access\n    - attack.t1193\nlogsource:\n    category: process_creation\n    product: windows\ndetection:\n    selection:\n        Image: '*\\Temporary Internet Files\\Content.Outlook\\\\*'\n    condition: selection\nfields:\n    - CommandLine\n    - ParentCommandLine\nfalsepositives:\n    - Unknown\nlevel: high\n", "object_marking_refs": ["marking-definition--0a872d70-1d05-45dd-a25f-031af547a102"], "created_by_ref": "identity--082ca4f0-d825-45b6-aa42-ab9afd1e5503", "type": "indicator", "spec_version": "2.1", "id": "indicator--3321f455-49af-478c-95aa-a6bbcd0c225e", "modified": "2020-04-02T07:58:57.227Z"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--c6656bca-ab62-434a-b839-236ebeb613d4", "created": "2020-04-02T07:58:57.239Z", "modified": "2020-04-02T07:58:57.239Z", "source_ref": "indicator--3321f455-49af-478c-95aa-a6bbcd0c225e", "relationship_type": "indicates", "target_ref": "attack-pattern--6aac77c4-eaf2-4366-8c13-ce50ab951f38"}, {"name": "Malicious Base64 Encoded PowerShell Keywords in Command Lines", "description": "Detects base64 encoded strings used in hidden malicious PowerShell command lines", "created": "2019-01-16T00:00:00.000Z", "valid_from": "2019-01-16T00:00:00Z", "indicator_types": ["malicious-activity"], "pattern_type": "sigma", "pattern": "title: Malicious Base64 Encoded PowerShell Keywords in Command Lines\nid: f26c6093-6f14-4b12-800f-0fcb46f5ffd0\nstatus: experimental\ndescription: Detects base64 encoded strings used in hidden malicious PowerShell command lines\nreferences:\n    - http://www.leeholmes.com/blog/2017/09/21/searching-for-content-in-base-64-strings/\ntags:\n    - attack.execution\n    - attack.t1086\nauthor: John Lambert (rule)\ndate: 2019/01/16\nlogsource:\n    category: process_creation\n    product: windows\ndetection:\n    encoded:\n        Image: '*\\powershell.exe'\n        CommandLine: '* hidden *'\n    selection:\n        CommandLine:\n            - '*AGkAdABzAGEAZABtAGkAbgAgAC8AdAByAGEAbgBzAGYAZQByA*'\n            - '*aXRzYWRtaW4gL3RyYW5zZmVy*'\n            - '*IAaQB0AHMAYQBkAG0AaQBuACAALwB0AHIAYQBuAHMAZgBlAHIA*'\n            - '*JpdHNhZG1pbiAvdHJhbnNmZX*'\n            - '*YgBpAHQAcwBhAGQAbQBpAG4AIAAvAHQAcgBhAG4AcwBmAGUAcg*'\n            - '*Yml0c2FkbWluIC90cmFuc2Zlc*'\n            - '*AGMAaAB1AG4AawBfAHMAaQB6AGUA*'\n            - '*JABjAGgAdQBuAGsAXwBzAGkAegBlA*'\n            - '*JGNodW5rX3Npem*'\n            - '*QAYwBoAHUAbgBrAF8AcwBpAHoAZQ*'\n            - '*RjaHVua19zaXpl*'\n            - '*Y2h1bmtfc2l6Z*'\n            - '*AE8ALgBDAG8AbQBwAHIAZQBzAHMAaQBvAG4A*'\n            - '*kATwAuAEMAbwBtAHAAcgBlAHMAcwBpAG8Abg*'\n            - '*lPLkNvbXByZXNzaW9u*'\n            - '*SQBPAC4AQwBvAG0AcAByAGUAcwBzAGkAbwBuA*'\n            - '*SU8uQ29tcHJlc3Npb2*'\n            - '*Ty5Db21wcmVzc2lvb*'\n            - '*AE8ALgBNAGUAbQBvAHIAeQBTAHQAcgBlAGEAbQ*'\n            - '*kATwAuAE0AZQBtAG8AcgB5AFMAdAByAGUAYQBtA*'\n            - '*lPLk1lbW9yeVN0cmVhb*'\n            - '*SQBPAC4ATQBlAG0AbwByAHkAUwB0AHIAZQBhAG0A*'\n            - '*SU8uTWVtb3J5U3RyZWFt*'\n            - '*Ty5NZW1vcnlTdHJlYW*'\n            - '*4ARwBlAHQAQwBoAHUAbgBrA*'\n            - '*5HZXRDaHVua*'\n            - '*AEcAZQB0AEMAaAB1AG4Aaw*'\n            - '*LgBHAGUAdABDAGgAdQBuAGsA*'\n            - '*LkdldENodW5r*'\n            - '*R2V0Q2h1bm*'\n            - '*AEgAUgBFAEEARABfAEkATgBGAE8ANgA0A*'\n            - '*QASABSAEUAQQBEAF8ASQBOAEYATwA2ADQA*'\n            - '*RIUkVBRF9JTkZPNj*'\n            - '*SFJFQURfSU5GTzY0*'\n            - '*VABIAFIARQBBAEQAXwBJAE4ARgBPADYANA*'\n            - '*VEhSRUFEX0lORk82N*'\n            - '*AHIAZQBhAHQAZQBSAGUAbQBvAHQAZQBUAGgAcgBlAGEAZA*'\n            - '*cmVhdGVSZW1vdGVUaHJlYW*'\n            - '*MAcgBlAGEAdABlAFIAZQBtAG8AdABlAFQAaAByAGUAYQBkA*'\n            - '*NyZWF0ZVJlbW90ZVRocmVhZ*'\n            - '*Q3JlYXRlUmVtb3RlVGhyZWFk*'\n            - '*QwByAGUAYQB0AGUAUgBlAG0AbwB0AGUAVABoAHIAZQBhAGQA*'\n            - '*0AZQBtAG0AbwB2AGUA*'\n            - '*1lbW1vdm*'\n            - '*AGUAbQBtAG8AdgBlA*'\n            - '*bQBlAG0AbQBvAHYAZQ*'\n            - '*bWVtbW92Z*'\n            - '*ZW1tb3Zl*'\n    condition: encoded and selection\nfalsepositives:\n    - Penetration tests\nlevel: high\n", "object_marking_refs": ["marking-definition--0a872d70-1d05-45dd-a25f-031af547a102"], "created_by_ref": "identity--082ca4f0-d825-45b6-aa42-ab9afd1e5503", "type": "indicator", "spec_version": "2.1", "id": "indicator--e8ee07d3-9d22-41b9-a658-490cc56206b6", "modified": "2020-04-02T07:58:57.248Z"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--ab009306-d0e9-4e7a-a669-faaa822f8096", "created": "2020-04-02T07:58:57.260Z", "modified": "2020-04-02T07:58:57.260Z", "source_ref": "indicator--e8ee07d3-9d22-41b9-a658-490cc56206b6", "relationship_type": "indicates", "target_ref": "attack-pattern--f4882e23-8aa7-4b12-b28a-b349c12ee9e0"}, {"name": "PowerShell Download from URL", "description": "Detects a Powershell process that contains download commands in its command line string", "created": "2019-01-16T00:00:00.000Z", "valid_from": "2019-01-16T00:00:00Z", "indicator_types": ["malicious-activity"], "pattern_type": "sigma", "pattern": "title: PowerShell Download from URL\nid: 3b6ab547-8ec2-4991-b9d2-2b06702a48d7\nstatus: experimental\ndescription: Detects a Powershell process that contains download commands in its command line string\nauthor: Florian Roth\ndate: 2019/01/16\ntags:\n    - attack.t1086\n    - attack.execution\nlogsource:\n    category: process_creation\n    product: windows\ndetection:\n    selection:\n        Image: '*\\powershell.exe'\n        CommandLine:\n            - '*new-object system.net.webclient).downloadstring(*'\n            - '*new-object system.net.webclient).downloadfile(*'\n            - '*new-object net.webclient).downloadstring(*'\n            - '*new-object net.webclient).downloadfile(*'\n    condition: selection\nfields:\n    - CommandLine\n    - ParentCommandLine\nfalsepositives:\n    - unknown\nlevel: medium\n", "object_marking_refs": ["marking-definition--0a872d70-1d05-45dd-a25f-031af547a102"], "created_by_ref": "identity--082ca4f0-d825-45b6-aa42-ab9afd1e5503", "type": "indicator", "spec_version": "2.1", "id": "indicator--15a1dc3a-a573-4084-b7e8-f23ab1e79e13", "modified": "2020-04-02T07:58:57.270Z"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--5a299e8d-4d21-4430-8d05-3d22d4ddd6a8", "created": "2020-04-02T07:58:57.282Z", "modified": "2020-04-02T07:58:57.282Z", "source_ref": "indicator--15a1dc3a-a573-4084-b7e8-f23ab1e79e13", "relationship_type": "indicates", "target_ref": "attack-pattern--f4882e23-8aa7-4b12-b28a-b349c12ee9e0"}, {"name": "Application Whitelisting Bypass via Dxcap.exe", "description": "Detects execution of of Dxcap.exe", "created": "2019-10-26T00:00:00.000Z", "modified": "2019-11-04T00:00:00.000Z", "valid_from": "2019-10-26T00:00:00Z", "indicator_types": ["malicious-activity"], "pattern_type": "sigma", "pattern": "title: Application Whitelisting Bypass via Dxcap.exe\nid: 60f16a96-db70-42eb-8f76-16763e333590\nstatus: experimental\ndescription: Detects execution of of Dxcap.exe\nreferences:\n    - https://github.com/LOLBAS-Project/LOLBAS/blob/master/yml/OtherMSBinaries/Dxcap.yml\n    - https://twitter.com/harr0ey/status/992008180904419328\nauthor: Beyu Denis, oscd.community\ndate: 2019/10/26\nmodified: 2019/11/04\ntags:\n    - attack.defense_evasion\n    - attack.execution\n    - attack.t1218\nlevel: medium\nlogsource:\n    category: process_creation\n    product: windows\ndetection:\n    selection:\n        Image|endswith: '\\dxcap.exe'\n        CommandLine|contains|all:\n            - '-c'\n            - '.exe'\n    condition: selection\nfalsepositives:\n    - Legitimate execution of dxcap.exe by legitimate user\n", "object_marking_refs": ["marking-definition--0a872d70-1d05-45dd-a25f-031af547a102"], "created_by_ref": "identity--082ca4f0-d825-45b6-aa42-ab9afd1e5503", "type": "indicator", "spec_version": "2.1", "id": "indicator--493b9f2e-6d02-496b-b1ff-1902102a84ae"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--9f684c2c-7da3-4c08-8cfa-ee000cedbac0", "created": "2020-04-02T07:58:57.297Z", "modified": "2020-04-02T07:58:57.297Z", "source_ref": "indicator--493b9f2e-6d02-496b-b1ff-1902102a84ae", "relationship_type": "indicates", "target_ref": "attack-pattern--457c7820-d331-465a-915e-42f85500ccc4"}, {"name": "Suspicious Use of CSharp Interactive Console", "description": "Detects the execution of CSharp interactive console by PowerShell", "created": "2020-03-08T00:00:00.000Z", "valid_from": "2020-03-08T00:00:00Z", "indicator_types": ["malicious-activity"], "pattern_type": "sigma", "pattern": "title: Suspicious Use of CSharp Interactive Console\nid: a9e416a8-e613-4f8b-88b8-a7d1d1af2f61\nstatus: experimental\ndescription: Detects the execution of CSharp interactive console by PowerShell\nreferences:\n    - https://redcanary.com/blog/detecting-attacks-leveraging-the-net-framework/\nauthor: Michael R. (@nahamike01)\ndate: 2020/03/08\ntags:\n    - attack.execution\n    - attack.t1127\nlogsource:\n    category: process_creation\n    product: windows\ndetection:\n    selection:\n        Image|endswith: '\\csi.exe'\n        ParentImage|endswith: '\\powershell.exe'\n        OriginalFileName: 'csi.exe'\n    condition: selection\nfalsepositives:\n    - Possible depending on environment. Pair with other factors such as net connections, command-line args, etc.\nlevel: high\n", "object_marking_refs": ["marking-definition--0a872d70-1d05-45dd-a25f-031af547a102"], "created_by_ref": "identity--082ca4f0-d825-45b6-aa42-ab9afd1e5503", "type": "indicator", "spec_version": "2.1", "id": "indicator--ee9ed3a2-969b-4d7b-bf84-b26a51fd6aff", "modified": "2020-04-02T07:58:57.301Z"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--c2001879-23d7-4848-ba05-ac3fbdc5ec84", "created": "2020-04-02T07:58:57.312Z", "modified": "2020-04-02T07:58:57.312Z", "source_ref": "indicator--ee9ed3a2-969b-4d7b-bf84-b26a51fd6aff", "relationship_type": "indicates", "target_ref": "attack-pattern--ff25900d-76d5-449b-a351-8824e62fc81b"}, {"name": "OpenWith.exe Executes Specified Binary", "description": "The OpenWith.exe executes other binary", "created": "2019-10-12T00:00:00.000Z", "modified": "2019-11-04T00:00:00.000Z", "valid_from": "2019-10-12T00:00:00Z", "indicator_types": ["malicious-activity"], "pattern_type": "sigma", "pattern": "title: OpenWith.exe Executes Specified Binary\nid: cec8e918-30f7-4e2d-9bfa-a59cc97ae60f\nstatus: experimental\ndescription: The OpenWith.exe executes other binary\nreferences:\n    - https://github.com/LOLBAS-Project/LOLBAS/blob/master/yml/LOLUtilz/OSBinaries/Openwith.yml\n    - https://twitter.com/harr0ey/status/991670870384021504\nauthor: Beyu Denis, oscd.community (rule), @harr0ey (idea)\ndate: 2019/10/12\nmodified: 2019/11/04\ntags:\n    - attack.defense_evasion\n    - attack.execution\n    - attack.t1218\nlevel: high\nlogsource:\n    category: process_creation\n    product: windows\ndetection:\n    selection:\n        Image|endswith: '\\OpenWith.exe'\n        CommandLine|contains: '/c'\n    condition: selection\nfalsepositives:\n    - Legitimate use of OpenWith.exe by legitimate user\n", "object_marking_refs": ["marking-definition--0a872d70-1d05-45dd-a25f-031af547a102"], "created_by_ref": "identity--082ca4f0-d825-45b6-aa42-ab9afd1e5503", "type": "indicator", "spec_version": "2.1", "id": "indicator--ab27dfd7-ff8b-40d7-a68a-d925889c1770"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--d6a76851-0fb3-4360-a5e3-485574ee2ade", "created": "2020-04-02T07:58:57.330Z", "modified": "2020-04-02T07:58:57.330Z", "source_ref": "indicator--ab27dfd7-ff8b-40d7-a68a-d925889c1770", "relationship_type": "indicates", "target_ref": "attack-pattern--457c7820-d331-465a-915e-42f85500ccc4"}, {"name": "Grabbing Sensitive Hives via Reg Utility", "description": "Dump sam, system or security hives using REG.exe utility", "created": "2019-10-22T00:00:00.000Z", "valid_from": "2019-10-22T00:00:00Z", "indicator_types": ["malicious-activity"], "pattern_type": "sigma", "pattern": "title: Grabbing Sensitive Hives via Reg Utility\nid: fd877b94-9bb5-4191-bb25-d79cbd93c167\ndescription: Dump sam, system or security hives using REG.exe utility\nauthor: Teymur Kheirkhabarov, Endgame, JHasenbusch, Daniil Yugoslavskiy, oscd.community\ndate: 2019/10/22\nreferences:\n    - https://www.slideshare.net/heirhabarov/hunting-for-credentials-dumping-in-windows-environment\n    - https://eqllib.readthedocs.io/en/latest/analytics/aed95fc6-5e3f-49dc-8b35-06508613f979.html\n    - https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1003/T1003.md\ntags:\n    - attack.credential_access\n    - attack.t1003\n    - car.2013-07-001\nlogsource:\n    category: process_creation\n    product: windows\ndetection:\n    selection_1:\n        NewProcessName: '*\\reg.exe'\n        CommandLine|contains: \n            - 'save'\n            - 'export'\n    selection_2:\n        CommandLine|contains: \n            - 'hklm'\n            - 'hkey_local_machine'\n    selection_3:\n        CommandLine|endswith:\n            - '\\system'\n            - '\\sam'\n            - '\\security'\n    condition: selection_1 and selection_2 and selection_3\nfalsepositives:\n    - Dumping hives for legitimate purpouse i.e. backup or forensic investigation\nlevel: medium\nstatus: experimental\n", "object_marking_refs": ["marking-definition--0a872d70-1d05-45dd-a25f-031af547a102"], "created_by_ref": "identity--082ca4f0-d825-45b6-aa42-ab9afd1e5503", "type": "indicator", "spec_version": "2.1", "id": "indicator--99647f7e-14a5-45cf-ab6d-63ca75a389c2", "modified": "2020-04-02T07:58:57.335Z"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--70abb77d-c0e9-4b9e-b188-0a6009e38616", "created": "2020-04-02T07:58:57.346Z", "modified": "2020-04-02T07:58:57.346Z", "source_ref": "indicator--99647f7e-14a5-45cf-ab6d-63ca75a389c2", "relationship_type": "indicates", "target_ref": "attack-pattern--0a3ead4e-6d47-4ccb-854c-a6a4f9d96b22"}, {"name": "Possible SPN Enumeration", "description": "Detects Service Principal Name Enumeration used for Kerberoasting", "created": "2018-11-14T00:00:00.000Z", "valid_from": "2018-11-14T00:00:00Z", "indicator_types": ["malicious-activity"], "pattern_type": "sigma", "pattern": "title: Possible SPN Enumeration\nid: 1eeed653-dbc8-4187-ad0c-eeebb20e6599\ndescription: Detects Service Principal Name Enumeration used for Kerberoasting\nstatus: experimental\nreferences:\n    - https://p16.praetorian.com/blog/how-to-use-kerberoasting-t1208-for-privilege-escalation\nauthor: Markus Neis, keepwatch\ndate: 2018/11/14\ntags:\n    - attack.credential_access\n    - attack.t1208\nlogsource:\n    category: process_creation\n    product: windows\ndetection:\n    selection_image:\n        Image: '*\\setspn.exe'\n    selection_desc:\n        Description: '*Query or reset the computer* SPN attribute*'\n    cmd:\n        CommandLine: '*-q*'\n    condition: (selection_image or selection_desc) and cmd\nfalsepositives:\n    - Administrator Activity\nlevel: medium\n", "object_marking_refs": ["marking-definition--0a872d70-1d05-45dd-a25f-031af547a102"], "created_by_ref": "identity--082ca4f0-d825-45b6-aa42-ab9afd1e5503", "type": "indicator", "spec_version": "2.1", "id": "indicator--c7aa0d95-abe5-4b49-8d23-dfb7824604d7", "modified": "2020-04-02T07:58:57.350Z"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--ff9a98cc-8dd0-473a-a276-d62b25717f46", "created": "2020-04-02T07:58:57.362Z", "modified": "2020-04-02T07:58:57.362Z", "source_ref": "indicator--c7aa0d95-abe5-4b49-8d23-dfb7824604d7", "relationship_type": "indicates", "target_ref": "attack-pattern--b39d03cb-7b98-41c4-a878-c40c1a913dc0"}, {"name": "Windows Network Enumeration", "description": "Identifies attempts to enumerate hosts in a network using the built-in Windows net.exe tool.", "created": "2018-10-30T00:00:00.000Z", "modified": "2019-11-11T00:00:00.000Z", "valid_from": "2018-10-30T00:00:00Z", "indicator_types": ["malicious-activity"], "pattern_type": "sigma", "pattern": "title: Windows Network Enumeration\nid: 62510e69-616b-4078-b371-847da438cc03\nstatus: stable\ndescription: Identifies attempts to enumerate hosts in a network using the built-in Windows net.exe tool.\nreferences:\n    - https://eqllib.readthedocs.io/en/latest/analytics/b8a94d2f-dc75-4630-9d73-1edc6bd26fff.html\n    - https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1018/T1018.yaml\nauthor: Endgame, JHasenbusch (ported for oscd.community)\ndate: 2018/10/30\nmodified: 2019/11/11\ntags:\n    - attack.discovery\n    - attack.t1018\nlogsource:\n    category: process_creation\n    product: windows\ndetection:\n    selection:\n        Image|endswith: \n            - '\\net.exe'\n            - '\\net1.exe'\n        CommandLine|contains: 'view'\n    filter:\n        CommandLine|contains: '\\\\'\n    condition: selection and not filter\nfields:\n    - ComputerName\n    - User\n    - CommandLine\nfalsepositives:\n    - Legitimate use of net.exe utility by legitimate user\nlevel: low \n", "object_marking_refs": ["marking-definition--0a872d70-1d05-45dd-a25f-031af547a102"], "created_by_ref": "identity--082ca4f0-d825-45b6-aa42-ab9afd1e5503", "type": "indicator", "spec_version": "2.1", "id": "indicator--aa183382-4820-48ca-a500-7ce694398de5"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--b017e929-ea08-4cb5-af4f-a37f0aedabe2", "created": "2020-04-02T07:58:57.380Z", "modified": "2020-04-02T07:58:57.380Z", "source_ref": "indicator--aa183382-4820-48ca-a500-7ce694398de5", "relationship_type": "indicates", "target_ref": "attack-pattern--e358d692-23c0-4a31-9eb6-ecc13a8d7735"}, {"name": "Modification of Boot Configuration", "description": "Identifies use of the bcdedit command to delete boot configuration data. This tactic is sometimes used as by malware or an attacker as a destructive technique.", "created": "2019-10-24T00:00:00.000Z", "modified": "2019-11-11T00:00:00.000Z", "valid_from": "2019-10-24T00:00:00Z", "indicator_types": ["malicious-activity"], "pattern_type": "sigma", "pattern": "title: Modification of Boot Configuration\nid: 1444443e-6757-43e4-9ea4-c8fc705f79a2\ndescription: Identifies use of the bcdedit command to delete boot configuration data. This tactic is sometimes used as by malware or an attacker as a destructive\n    technique.\nstatus: experimental\nauthor: E.M. Anhaus (orignally from Atomic Blue Detections, Endgame), oscd.community\ndate: 2019/10/24\nmodified: 2019/11/11\nreferences:\n    - https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1490/T1490.yaml\n    - https://eqllib.readthedocs.io/en/latest/analytics/c4732632-9c1d-4980-9fa8-1d98c93f918e.html\ntags:\n    - attack.impact\n    - attack.t1490\nlogsource:\n    category: process_creation\n    product: windows\ndetection:\n    selection1:\n        Image|endswith: \\bcdedit.exe\n        CommandLine: set\n    selection2:\n        - CommandLine|contains|all:\n            - bootstatuspolicy\n            - ignoreallfailures\n        - CommandLine|contains|all:\n            - recoveryenabled\n            - 'no'\n    condition: selection1 and selection2\nfields:\n    - ComputerName\n    - User\n    - CommandLine\nfalsepositives:\n    - Unlikely\nlevel: high\n", "object_marking_refs": ["marking-definition--0a872d70-1d05-45dd-a25f-031af547a102"], "created_by_ref": "identity--082ca4f0-d825-45b6-aa42-ab9afd1e5503", "type": "indicator", "spec_version": "2.1", "id": "indicator--119562b8-a485-4784-9e6c-a655695bfb0c"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--64c7deda-be66-4868-a02f-583d385d5194", "created": "2020-04-02T07:58:57.397Z", "modified": "2020-04-02T07:58:57.397Z", "source_ref": "indicator--119562b8-a485-4784-9e6c-a655695bfb0c", "relationship_type": "indicates", "target_ref": "attack-pattern--f5d8eed6-48a9-4cdf-a3d7-d1ffa99c3d2a"}, {"name": "Bloodhound and Sharphound Hack Tool", "description": "Detects command line parameters used by Bloodhound and Sharphound hack tools", "created": "2019-12-20T00:00:00.000Z", "modified": "2019-12-21T00:00:00.000Z", "valid_from": "2019-12-20T00:00:00Z", "indicator_types": ["malicious-activity"], "pattern_type": "sigma", "pattern": "title: Bloodhound and Sharphound Hack Tool\nid: f376c8a7-a2d0-4ddc-aa0c-16c17236d962\ndescription: Detects command line parameters used by Bloodhound and Sharphound hack tools\nauthor: Florian Roth\nreferences:\n    - https://github.com/BloodHoundAD/BloodHound\n    - https://github.com/BloodHoundAD/SharpHound\ndate: 2019/12/20\nmodified: 2019/12/21\ntags:\n    - attack.discovery\n    - attack.t1087\nlogsource:\n    category: process_creation\n    product: windows\ndetection:\n    selection1: \n        Image|contains: \n            - '\\Bloodhound.exe'\n            - '\\SharpHound.exe'\n    selection2:\n        CommandLine|contains: \n            - ' -CollectionMethod All '\n            - '.exe -c All -d '\n            - 'Invoke-Bloodhound'\n            - 'Get-BloodHoundData'\n    selection3:\n        CommandLine|contains|all: \n            - ' -JsonFolder '\n            - ' -ZipFileName '\n    selection4:\n        CommandLine|contains|all: \n            - ' DCOnly '\n            - ' --NoSaveCache '\n    condition: 1 of them\nfalsepositives:\n    - Other programs that use these command line option and accepts an 'All' parameter\nlevel: high\n\n", "object_marking_refs": ["marking-definition--0a872d70-1d05-45dd-a25f-031af547a102"], "created_by_ref": "identity--082ca4f0-d825-45b6-aa42-ab9afd1e5503", "type": "indicator", "spec_version": "2.1", "id": "indicator--90ae68a2-0a54-4a31-97f3-1a219f60030a"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--ce8d9fb6-1ac4-495d-8489-74c9de0045cd", "created": "2020-04-02T07:58:57.415Z", "modified": "2020-04-02T07:58:57.415Z", "source_ref": "indicator--90ae68a2-0a54-4a31-97f3-1a219f60030a", "relationship_type": "indicates", "target_ref": "attack-pattern--72b74d71-8169-42aa-92e0-e7b04b9f5a08"}, {"name": "Java Running with Remote Debugging", "description": "Detects a JAVA process running with remote debugging allowing more than just localhost to connect", "created": "2019-01-16T00:00:00.000Z", "valid_from": "2019-01-16T00:00:00Z", "indicator_types": ["malicious-activity"], "pattern_type": "sigma", "pattern": "title: Java Running with Remote Debugging\nid: 8f88e3f6-2a49-48f5-a5c4-2f7eedf78710\ndescription: Detects a JAVA process running with remote debugging allowing more than just localhost to connect\nauthor: Florian Roth\ndate: 2019/01/16\ntags:\n    - attack.discovery\n    - attack.t1046\nlogsource:\n    category: process_creation\n    product: windows\ndetection:\n    selection:\n        CommandLine: '*transport=dt_socket,address=*'\n    exclusion:\n        - CommandLine: '*address=127.0.0.1*'\n        - CommandLine: '*address=localhost*'\n    condition: selection and not exclusion\nfields:\n    - CommandLine\n    - ParentCommandLine\nfalsepositives:\n    - unknown\nlevel: medium\n", "object_marking_refs": ["marking-definition--0a872d70-1d05-45dd-a25f-031af547a102"], "created_by_ref": "identity--082ca4f0-d825-45b6-aa42-ab9afd1e5503", "type": "indicator", "spec_version": "2.1", "id": "indicator--211c3793-59b9-44cd-9063-790578bf7fa8", "modified": "2020-04-02T07:58:57.423Z"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--aeb1df4f-54b5-4d48-8ebf-62acfb5a19ee", "created": "2020-04-02T07:58:57.433Z", "modified": "2020-04-02T07:58:57.433Z", "source_ref": "indicator--211c3793-59b9-44cd-9063-790578bf7fa8", "relationship_type": "indicates", "target_ref": "attack-pattern--e3a12395-188d-4051-9a16-ea8e14d07b88"}, {"name": "Wmiprvse Spawning Process", "description": "Detects wmiprvse spawning processes", "created": "2019-08-15T00:00:00.000Z", "modified": "2019-11-10T00:00:00.000Z", "valid_from": "2019-08-15T00:00:00Z", "indicator_types": ["malicious-activity"], "pattern_type": "sigma", "pattern": "title: Wmiprvse Spawning Process\nid: d21374ff-f574-44a7-9998-4a8c8bf33d7d\ndescription: Detects wmiprvse spawning processes\nstatus: experimental\ndate: 2019/08/15\nmodified: 2019/11/10\nauthor: Roberto Rodriguez @Cyb3rWard0g\nreferences:\n    - https://github.com/Cyb3rWard0g/ThreatHunter-Playbook/tree/master/playbooks/windows/02_execution/T1047_windows_management_instrumentation/wmi_win32_process_create_remote.md\ntags:\n    - attack.execution\n    - attack.t1047\nlogsource:\n    category: process_creation\n    product: windows\ndetection:\n    selection:\n        ParentImage|endswith: '\\WmiPrvSe.exe'\n    filter:\n        - LogonId: '0x3e7'  # LUID 999 for SYSTEM\n        - Username: 'NT AUTHORITY\\SYSTEM'  # if we don't have LogonId data, fallback on username detection\n    condition: selection and not filter\nfalsepositives:\n    - Unknown\nlevel: critical\n", "object_marking_refs": ["marking-definition--0a872d70-1d05-45dd-a25f-031af547a102"], "created_by_ref": "identity--082ca4f0-d825-45b6-aa42-ab9afd1e5503", "type": "indicator", "spec_version": "2.1", "id": "indicator--f92e2538-54bd-41e7-8608-8349fd174f55"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--472b64f2-1930-477f-9ae0-479507d6e8da", "created": "2020-04-02T07:58:57.450Z", "modified": "2020-04-02T07:58:57.450Z", "source_ref": "indicator--f92e2538-54bd-41e7-8608-8349fd174f55", "relationship_type": "indicates", "target_ref": "attack-pattern--01a5a209-b94c-450b-b7f9-946497d91055"}, {"name": "Dridex Process Pattern", "description": "Detects typical Dridex process patterns", "created": "2019-01-10T00:00:00.000Z", "valid_from": "2019-01-10T00:00:00Z", "indicator_types": ["malicious-activity"], "pattern_type": "sigma", "pattern": "title: Dridex Process Pattern\nid: e6eb5a96-9e6f-4a18-9cdd-642cfda21c8e\nstatus: experimental\ndescription: Detects typical Dridex process patterns\nreferences:\n    - https://app.any.run/tasks/993daa5e-112a-4ff6-8b5a-edbcec7c7ba3\nauthor: Florian Roth\ndate: 2019/01/10\ntags:\n    - attack.defense_evasion\n    - attack.privilege_escalation\n    - attack.t1055\nlogsource:\n    category: process_creation\n    product: windows\ndetection:\n    selection1:\n        CommandLine: '*\\svchost.exe C:\\Users\\\\*\\Desktop\\\\*'\n    selection2:\n        ParentImage: '*\\svchost.exe*'\n        CommandLine:\n            - '*whoami.exe /all'\n            - '*net.exe view'\n    condition: 1 of them\nfalsepositives:\n    - Unlikely\nlevel: critical\n", "object_marking_refs": ["marking-definition--0a872d70-1d05-45dd-a25f-031af547a102"], "created_by_ref": "identity--082ca4f0-d825-45b6-aa42-ab9afd1e5503", "type": "indicator", "spec_version": "2.1", "id": "indicator--e1ae6def-d6e1-4209-9e2c-d74b7ca06a38", "modified": "2020-04-02T07:58:57.454Z"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--4b7ba1b0-55c6-4f0d-a6f3-e7e05023b3b0", "created": "2020-04-02T07:58:57.465Z", "modified": "2020-04-02T07:58:57.465Z", "source_ref": "indicator--e1ae6def-d6e1-4209-9e2c-d74b7ca06a38", "relationship_type": "indicates", "target_ref": "attack-pattern--43e7dc91-05b2-474c-b9ac-2ed4fe101f4d"}, {"name": "Hiding Files with Attrib.exe", "description": "Detects usage of attrib.exe to hide files from users.", "created": "2019-01-16T00:00:00.000Z", "valid_from": "2019-01-16T00:00:00Z", "indicator_types": ["malicious-activity"], "pattern_type": "sigma", "pattern": "title: Hiding Files with Attrib.exe\nid: 4281cb20-2994-4580-aa63-c8b86d019934\nstatus: experimental\ndescription: Detects usage of attrib.exe to hide files from users.\nauthor: Sami Ruohonen\ndate: 2019/01/16\nlogsource:\n    category: process_creation\n    product: windows\ndetection:\n    selection:\n        Image: '*\\attrib.exe'\n        CommandLine: '* +h *'\n    ini:\n        CommandLine: '*\\desktop.ini *'\n    intel:\n        ParentImage: '*\\cmd.exe'\n        CommandLine: +R +H +S +A \\\\*.cui\n        ParentCommandLine: C:\\WINDOWS\\system32\\\\*.bat\n    condition: selection and not (ini or intel)\nfields:\n    - CommandLine\n    - ParentCommandLine\n    - User\ntags:\n    - attack.defense_evasion\n    - attack.persistence\n    - attack.t1158\nfalsepositives:\n    - igfxCUIService.exe hiding *.cui files via .bat script (attrib.exe a child of cmd.exe and igfxCUIService.exe is the parent of the cmd.exe)\n    - msiexec.exe hiding desktop.ini\nlevel: low\n", "object_marking_refs": ["marking-definition--0a872d70-1d05-45dd-a25f-031af547a102"], "created_by_ref": "identity--082ca4f0-d825-45b6-aa42-ab9afd1e5503", "type": "indicator", "spec_version": "2.1", "id": "indicator--9f40d1bf-0ecf-447e-89f2-42f1c76cc382", "modified": "2020-04-02T07:58:57.470Z"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--27f5b24b-99ea-4e29-b75a-67435607f21b", "created": "2020-04-02T07:58:57.481Z", "modified": "2020-04-02T07:58:57.481Z", "source_ref": "indicator--9f40d1bf-0ecf-447e-89f2-42f1c76cc382", "relationship_type": "indicates", "target_ref": "attack-pattern--dc27c2ec-c5f9-4228-ba57-d67b590bda93"}, {"name": "Possible Applocker Bypass", "description": "Detects execution of executables that can be used to bypass Applocker whitelisting", "created": "2019-01-16T00:00:00.000Z", "valid_from": "2019-01-16T00:00:00Z", "indicator_types": ["malicious-activity"], "pattern_type": "sigma", "pattern": "title: Possible Applocker Bypass\nid: 82a19e3a-2bfe-4a91-8c0d-5d4c98fbb719\ndescription: Detects execution of executables that can be used to bypass Applocker whitelisting\nstatus: experimental\nreferences:\n    - https://github.com/subTee/ApplicationWhitelistBypassTechniques/blob/master/TheList.txt\n    - https://room362.com/post/2014/2014-01-16-application-whitelist-bypass-using-ieexec-dot-exe/\nauthor: juju4\ndate: 2019/01/16\ntags:\n    - attack.defense_evasion\n    - attack.t1118\n    - attack.t1121\n    - attack.t1127\n    - attack.t1170\nlogsource:\n    category: process_creation\n    product: windows\ndetection:\n    selection:\n        CommandLine|contains:\n            - '\\msdt.exe'\n            - '\\installutil.exe'\n            - '\\regsvcs.exe'\n            - '\\regasm.exe'\n            # - '\\regsvr32.exe'  # too many FPs, very noisy\n            - '\\msbuild.exe'\n            - '\\ieexec.exe'\n            #- '\\mshta.exe'\n            #- '\\csc.exe'\n    condition: selection\nfalsepositives:\n    - False positives depend on scripts and administrative tools used in the monitored environment\n    - Using installutil to add features for .NET applications (primarly would occur in developer environments)\nlevel: low\n", "object_marking_refs": ["marking-definition--0a872d70-1d05-45dd-a25f-031af547a102"], "created_by_ref": "identity--082ca4f0-d825-45b6-aa42-ab9afd1e5503", "type": "indicator", "spec_version": "2.1", "id": "indicator--9af34465-c30b-4652-a83d-75987b49fca2", "modified": "2020-04-02T07:58:57.485Z"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--10d840eb-60e6-48a9-8cb4-68bd0bb5d99e", "created": "2020-04-02T07:58:57.497Z", "modified": "2020-04-02T07:58:57.497Z", "source_ref": "indicator--9af34465-c30b-4652-a83d-75987b49fca2", "relationship_type": "indicates", "target_ref": "attack-pattern--f792d02f-813d-402b-86a5-ab98cb391d3b"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--594f21be-a0f6-4dae-a8d1-5b209b4e18e5", "created": "2020-04-02T07:58:57.506Z", "modified": "2020-04-02T07:58:57.506Z", "source_ref": "indicator--9af34465-c30b-4652-a83d-75987b49fca2", "relationship_type": "indicates", "target_ref": "attack-pattern--215190a9-9f02-4e83-bb5f-e0589965a302"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--e45060cd-55fd-41f2-b142-3e5dc7c6b8cc", "created": "2020-04-02T07:58:57.514Z", "modified": "2020-04-02T07:58:57.514Z", "source_ref": "indicator--9af34465-c30b-4652-a83d-75987b49fca2", "relationship_type": "indicates", "target_ref": "attack-pattern--ff25900d-76d5-449b-a351-8824e62fc81b"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--9082eaae-54e0-49e2-9abb-a8cddf05d295", "created": "2020-04-02T07:58:57.521Z", "modified": "2020-04-02T07:58:57.521Z", "source_ref": "indicator--9af34465-c30b-4652-a83d-75987b49fca2", "relationship_type": "indicates", "target_ref": "attack-pattern--a127c32c-cbb0-4f9d-be07-881a792408ec"}, {"name": "Audio Capture via PowerShell", "description": "Detects audio capture via PowerShell Cmdlet", "created": "2019-10-24T00:00:00.000Z", "modified": "2019-11-11T00:00:00.000Z", "valid_from": "2019-10-24T00:00:00Z", "indicator_types": ["malicious-activity"], "pattern_type": "sigma", "pattern": "title: Audio Capture via PowerShell\nid: 932fb0d8-692b-4b0f-a26e-5643a50fe7d6\ndescription: Detects audio capture via PowerShell Cmdlet\nstatus: experimental\nauthor: E.M. Anhaus (orignally from Atomic Blue Detections, Endgame), oscd.community\ndate: 2019/10/24\nmodified: 2019/11/11\nreferences:\n    - https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1123/T1123.yaml\n    - https://eqllib.readthedocs.io/en/latest/analytics/ab7a6ef4-0983-4275-a4f1-5c6bd3c31c23.html\ntags:\n    - attack.collection\n    - attack.t1123\ndetection:\n    selection:\n        CommandLine|contains: 'WindowsAudioDevice-Powershell-Cmdlet'\n    condition: selection\nfalsepositives:\n    - Legitimate audio capture by legitimate user\nlevel: medium\nlogsource:\n    category: process_creation\n    product: windows\n", "object_marking_refs": ["marking-definition--0a872d70-1d05-45dd-a25f-031af547a102"], "created_by_ref": "identity--082ca4f0-d825-45b6-aa42-ab9afd1e5503", "type": "indicator", "spec_version": "2.1", "id": "indicator--03c0bcfe-3676-4007-bf8d-0930c1fc02cd"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--5b804f72-759d-4ded-b339-93523ce429dc", "created": "2020-04-02T07:58:57.536Z", "modified": "2020-04-02T07:58:57.536Z", "source_ref": "indicator--03c0bcfe-3676-4007-bf8d-0930c1fc02cd", "relationship_type": "indicates", "target_ref": "attack-pattern--1035cdf2-3e5f-446f-a7a7-e8f6d7925967"}, {"name": "Run Whoami as SYSTEM", "description": "Detects a whoami.exe executed by LOCAL SYSTEM. This may be a sign of a successful local privilege escalation.", "created": "2019-10-23T00:00:00.000Z", "modified": "2019-11-11T00:00:00.000Z", "valid_from": "2019-10-23T00:00:00Z", "indicator_types": ["malicious-activity"], "pattern_type": "sigma", "pattern": "title: Run Whoami as SYSTEM\nid: 80167ada-7a12-41ed-b8e9-aa47195c66a1\nstatus: experimental\ndescription: Detects a whoami.exe executed by LOCAL SYSTEM. This may be a sign of a successful local privilege escalation.\nreferences:\n    - https://speakerdeck.com/heirhabarov/hunting-for-privilege-escalation-in-windows-environment\nauthor: Teymur Kheirkhabarov\ndate: 2019/10/23\nmodified: 2019/11/11\ntags:\n    - attack.discovery\n    - attack.privilege_escalation\n    - attack.t1033\nlogsource:\n    category: process_creation\n    product: windows\ndetection:\n    selection:\n        User: 'NT AUTHORITY\\SYSTEM'\n        Image|endswith: '\\whoami.exe'\n    condition: selection\nfalsepositives:\n    - Unknown\nlevel: high\n", "object_marking_refs": ["marking-definition--0a872d70-1d05-45dd-a25f-031af547a102"], "created_by_ref": "identity--082ca4f0-d825-45b6-aa42-ab9afd1e5503", "type": "indicator", "spec_version": "2.1", "id": "indicator--73e34ebe-466b-4629-89f1-d6d3c1ee8d2b"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--df0b8aef-11a2-4f7f-9f72-04418c874b0a", "created": "2020-04-02T07:58:57.549Z", "modified": "2020-04-02T07:58:57.549Z", "source_ref": "indicator--73e34ebe-466b-4629-89f1-d6d3c1ee8d2b", "relationship_type": "indicates", "target_ref": "attack-pattern--03d7999c-1f4c-42cc-8373-e7690d318104"}, {"name": "Renamed Binary", "description": "Detects the execution of a renamed binary often used by attackers or malware leveraging new Sysmon OriginalFileName datapoint.", "created": "2019-06-15T00:00:00.000Z", "modified": "2019-11-11T00:00:00.000Z", "valid_from": "2019-06-15T00:00:00Z", "indicator_types": ["malicious-activity"], "pattern_type": "sigma", "pattern": "title: Renamed Binary\nid: 36480ae1-a1cb-4eaa-a0d6-29801d7e9142\nstatus: experimental\ndescription: Detects the execution of a renamed binary often used by attackers or malware leveraging new Sysmon OriginalFileName datapoint.\nauthor: Matthew Green - @mgreen27, Ecco, James Pemberton / @4A616D6573, oscd.community (improvements)\ndate: 2019/06/15\nmodified: 2019/11/11\nreferences:\n    - https://attack.mitre.org/techniques/T1036/\n    - https://mgreen27.github.io/posts/2019/05/12/BinaryRename.html\n    - https://mgreen27.github.io/posts/2019/05/29/BinaryRename2.html\ntags:\n    - attack.t1036\n    - attack.defense_evasion\nlogsource:\n    category: process_creation\n    product: windows\ndetection:\n    selection:\n        OriginalFileName:\n            - 'cmd.exe'\n            - 'powershell.exe'\n            - 'powershell_ise.exe'\n            - 'psexec.exe'\n            - 'psexec.c'  # old versions of psexec (2016 seen)\n            - 'cscript.exe'\n            - 'wscript.exe'\n            - 'mshta.exe'\n            - 'regsvr32.exe'\n            - 'wmic.exe'\n            - 'certutil.exe'\n            - 'rundll32.exe'\n            - 'cmstp.exe'\n            - 'msiexec.exe'\n            - '7z.exe'\n            - 'winrar.exe'\n            - 'wevtutil.exe'\n            - 'net.exe'\n            - 'net1.exe'\n    filter:\n        Image|endswith:\n            - '\\cmd.exe'\n            - '\\powershell.exe'\n            - '\\powershell_ise.exe'\n            - '\\psexec.exe'\n            - '\\psexec64.exe'\n            - '\\cscript.exe'\n            - '\\wscript.exe'\n            - '\\mshta.exe'\n            - '\\regsvr32.exe'\n            - '\\wmic.exe'\n            - '\\certutil.exe'\n            - '\\rundll32.exe'\n            - '\\cmstp.exe'\n            - '\\msiexec.exe'\n            - '\\7z.exe'\n            - '\\winrar.exe'\n            - '\\wevtutil.exe'\n            - '\\net.exe'\n            - '\\net1.exe'\n    condition: selection and not filter\nfalsepositives:\n    - Custom applications use renamed binaries adding slight change to binary name. Typically this is easy to spot and add to whitelist\nlevel: medium\n", "object_marking_refs": ["marking-definition--0a872d70-1d05-45dd-a25f-031af547a102"], "created_by_ref": "identity--082ca4f0-d825-45b6-aa42-ab9afd1e5503", "type": "indicator", "spec_version": "2.1", "id": "indicator--48064817-2411-4a2c-97e0-2bd9cc25466e"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--0f4feac5-78e6-4ab8-85fc-1e685f32c16f", "created": "2020-04-02T07:58:57.565Z", "modified": "2020-04-02T07:58:57.565Z", "source_ref": "indicator--48064817-2411-4a2c-97e0-2bd9cc25466e", "relationship_type": "indicates", "target_ref": "attack-pattern--42e8de7b-37b2-4258-905a-6897815e58e0"}, {"name": "Sofacy Trojan Loader Activity", "description": "Detects Trojan loader acitivty as used by APT28", "created": "2018-03-01T00:00:00.000Z", "valid_from": "2018-03-01T00:00:00Z", "indicator_types": ["malicious-activity"], "pattern_type": "sigma", "pattern": "title: Sofacy Trojan Loader Activity\nid: ba778144-5e3d-40cf-8af9-e28fb1df1e20\nauthor: Florian Roth\nstatus: experimental\ndate: 2018/03/01\ndescription: Detects Trojan loader acitivty as used by APT28\nreferences:\n    - https://researchcenter.paloaltonetworks.com/2018/02/unit42-sofacy-attacks-multiple-government-entities/\n    - https://www.reverse.it/sample/e3399d4802f9e6d6d539e3ae57e7ea9a54610a7c4155a6541df8e94d67af086e?environmentId=100\n    - https://twitter.com/ClearskySec/status/960924755355369472\ntags:\n    - attack.g0007\n    - attack.execution\n    - attack.t1059\n    - attack.defense_evasion\n    - attack.t1085\n    - car.2013-10-002\nlogsource:\n    category: process_creation\n    product: windows\ndetection:\n    selection:\n        CommandLine:\n            - 'rundll32.exe %APPDATA%\\\\*.dat\",*'\n            - 'rundll32.exe %APPDATA%\\\\*.dll\",#1'\n    condition: selection\nfalsepositives:\n    - Unknown\nlevel: critical\n", "object_marking_refs": ["marking-definition--0a872d70-1d05-45dd-a25f-031af547a102"], "created_by_ref": "identity--082ca4f0-d825-45b6-aa42-ab9afd1e5503", "type": "indicator", "spec_version": "2.1", "id": "indicator--9ee41f3b-32c5-4af6-acc8-ac9192bf2986", "modified": "2020-04-02T07:58:57.569Z"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--04a7ed53-c76d-453a-96bd-6ebb239d44bd", "created": "2020-04-02T07:58:57.579Z", "modified": "2020-04-02T07:58:57.579Z", "source_ref": "indicator--9ee41f3b-32c5-4af6-acc8-ac9192bf2986", "relationship_type": "indicates", "target_ref": "intrusion-set--bef4c620-0787-42a8-a96d-b7eb6e85917c"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--17deec0b-7139-4b5e-8570-15350c720668", "created": "2020-04-02T07:58:57.587Z", "modified": "2020-04-02T07:58:57.587Z", "source_ref": "indicator--9ee41f3b-32c5-4af6-acc8-ac9192bf2986", "relationship_type": "indicates", "target_ref": "attack-pattern--7385dfaf-6886-4229-9ecd-6fd678040830"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--9c0e392c-ba44-4a81-81b4-40b58823d33a", "created": "2020-04-02T07:58:57.594Z", "modified": "2020-04-02T07:58:57.594Z", "source_ref": "indicator--9ee41f3b-32c5-4af6-acc8-ac9192bf2986", "relationship_type": "indicates", "target_ref": "attack-pattern--62b8c999-dcc0-4755-bd69-09442d9359f5"}, {"name": "Malicious Payload Download via Office Binaries", "description": "Downloads payload from remote server", "created": "2019-10-26T00:00:00.000Z", "modified": "2019-11-04T00:00:00.000Z", "valid_from": "2019-10-26T00:00:00Z", "indicator_types": ["malicious-activity"], "pattern_type": "sigma", "pattern": "title: Malicious Payload Download via Office Binaries\nid: 0c79148b-118e-472b-bdb7-9b57b444cc19\nstatus: experimental\ndescription: Downloads payload from remote server\nreferences:\n    - https://github.com/LOLBAS-Project/LOLBAS/blob/master/yml/OtherMSBinaries/Powerpnt.yml\n    - https://medium.com/@reegun/unsanitized-file-validation-leads-to-malicious-payload-download-via-office-binaries-202d02db7191\n    - Reegun J (OCBC Bank)\nauthor: Beyu Denis, oscd.community\ndate: 2019/10/26\nmodified: 2019/11/04\ntags:\n    - attack.command_and_control\n    - attack.t1105\nlevel: high\nlogsource:\n    category: process_creation\n    product: windows\ndetection:\n    selection:\n        Image|endswith:\n            - '\\powerpnt.exe'\n            - '\\winword.exe'\n            - '\\excel.exe'\n        CommandLine|contains: 'http'\n    condition: selection\nfalsepositives:\n    - Unknown\n", "object_marking_refs": ["marking-definition--0a872d70-1d05-45dd-a25f-031af547a102"], "created_by_ref": "identity--082ca4f0-d825-45b6-aa42-ab9afd1e5503", "type": "indicator", "spec_version": "2.1", "id": "indicator--69779019-d5d2-4843-adf2-4515accce7cb"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--e2ed4834-a64f-489e-9f72-823e9699a7d8", "created": "2020-04-02T07:58:57.607Z", "modified": "2020-04-02T07:58:57.607Z", "source_ref": "indicator--69779019-d5d2-4843-adf2-4515accce7cb", "relationship_type": "indicates", "target_ref": "attack-pattern--e6919abc-99f9-4c6c-95a5-14761e7b2add"}, {"name": "MsiExec Web Install", "description": "Detects suspicious msiexec process starts with web addreses as parameter", "created": "2018-02-09T00:00:00.000Z", "modified": "2012-12-11T00:00:00.000Z", "valid_from": "2018-02-09T00:00:00Z", "indicator_types": ["malicious-activity"], "pattern_type": "sigma", "pattern": "title: MsiExec Web Install\nid: f7b5f842-a6af-4da5-9e95-e32478f3cd2f\nstatus: experimental\ndescription: Detects suspicious msiexec process starts with web addreses as parameter\nreferences:\n    - https://blog.trendmicro.com/trendlabs-security-intelligence/attack-using-windows-installer-msiexec-exe-leads-lokibot/\ntags:\n    - attack.defense_evasion\nauthor: Florian Roth\ndate: 2018/02/09\nmodified: 2012/12/11\nlogsource:\n    category: process_creation\n    product: windows\ndetection:\n    selection:\n        CommandLine:\n            - '* msiexec*://*'\n    condition: selection\nfalsepositives:\n    - False positives depend on scripts and administrative tools used in the monitored environment\nlevel: medium\n", "object_marking_refs": ["marking-definition--0a872d70-1d05-45dd-a25f-031af547a102"], "created_by_ref": "identity--082ca4f0-d825-45b6-aa42-ab9afd1e5503", "type": "indicator", "spec_version": "2.1", "id": "indicator--54513aca-6854-4f99-bc05-c5f8183a22f1"}, {"name": "Exploiting SetupComplete.cmd CVE-2019-1378", "description": "Detects exploitation attempt of privilege escalation vulnerability via SetupComplete.cmd and PartnerSetupComplete.cmd decribed in CVE-2019-1378", "created": "2019-11-15T00:00:00.000Z", "valid_from": "2019-11-15T00:00:00Z", "indicator_types": ["malicious-activity"], "pattern_type": "sigma", "pattern": "title: Exploiting SetupComplete.cmd CVE-2019-1378\nid: 1c373b6d-76ce-4553-997d-8c1da9a6b5f5\nstatus: experimental\ndescription: Detects exploitation attempt of privilege escalation vulnerability via SetupComplete.cmd and PartnerSetupComplete.cmd decribed in CVE-2019-1378 \nreferences:\n    - https://www.embercybersecurity.com/blog/cve-2019-1378-exploiting-an-access-control-privilege-escalation-vulnerability-in-windows-10-update-assistant-wua\nauthor: Florian Roth\ndate: 2019/11/15\ntags:\n  - attack.defense_evasion\n  - attack.privilege_escalation\n  - attack.t1055\nlogsource:\n    category: process_creation\n    product: windows\ndetection:\n    selection:\n        ParentCommandLine: \n            - '*\\cmd.exe /c C:\\Windows\\Setup\\Scripts\\SetupComplete.cmd'\n            - '*\\cmd.exe /c C:\\Windows\\Setup\\Scripts\\PartnerSetupComplete.cmd'\n    filter:\n        Image: \n            - 'C:\\Windows\\System32\\\\*'\n            - 'C:\\Windows\\SysWOW64\\\\*'\n            - 'C:\\Windows\\WinSxS\\\\*'\n            - 'C:\\Windows\\Setup\\\\*'\n    condition: selection and not filter\nfalsepositives:\n    - Unknown\nlevel: high\n", "object_marking_refs": ["marking-definition--0a872d70-1d05-45dd-a25f-031af547a102"], "created_by_ref": "identity--082ca4f0-d825-45b6-aa42-ab9afd1e5503", "type": "indicator", "spec_version": "2.1", "id": "indicator--ad133701-db8e-421a-9ca2-84a2d83a6e8b", "modified": "2020-04-02T07:58:57.615Z"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--4482d88f-fe8a-4989-8c87-fa8b95c74560", "created": "2020-04-02T07:58:57.624Z", "modified": "2020-04-02T07:58:57.624Z", "source_ref": "indicator--ad133701-db8e-421a-9ca2-84a2d83a6e8b", "relationship_type": "indicates", "target_ref": "attack-pattern--43e7dc91-05b2-474c-b9ac-2ed4fe101f4d"}, {"name": "Application Whitelisting Bypass via Dnx.exe", "description": "Execute C# code located in the consoleapp folder", "created": "2019-10-26T00:00:00.000Z", "modified": "2019-11-04T00:00:00.000Z", "valid_from": "2019-10-26T00:00:00Z", "indicator_types": ["malicious-activity"], "pattern_type": "sigma", "pattern": "title: Application Whitelisting Bypass via Dnx.exe\nid: 81ebd28b-9607-4478-bf06-974ed9d53ed7\nstatus: experimental\ndescription: Execute C# code located in the consoleapp folder\nreferences:\n    - https://github.com/LOLBAS-Project/LOLBAS/blob/master/yml/OtherMSBinaries/Csi.yml\n    - https://enigma0x3.net/2016/11/17/bypassing-application-whitelisting-by-using-dnx-exe/\nauthor: Beyu Denis, oscd.community\ndate: 2019/10/26\nmodified: 2019/11/04\ntags:\n    - attack.defense_evasion\n    - attack.execution\n    - attack.t1218\nlevel: medium\nlogsource:\n    category: process_creation\n    product: windows\ndetection:\n    selection:\n        Image|endswith: '\\dnx.exe'\n    condition: selection\nfalsepositives:\n    - Legitimate use of dnx.exe by legitimate user\n", "object_marking_refs": ["marking-definition--0a872d70-1d05-45dd-a25f-031af547a102"], "created_by_ref": "identity--082ca4f0-d825-45b6-aa42-ab9afd1e5503", "type": "indicator", "spec_version": "2.1", "id": "indicator--16e5594c-ce39-4ede-9ee3-2e5daa4fe344"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--a00e0e1c-da1f-4f50-95d0-f70b64dfd03a", "created": "2020-04-02T07:58:57.638Z", "modified": "2020-04-02T07:58:57.638Z", "source_ref": "indicator--16e5594c-ce39-4ede-9ee3-2e5daa4fe344", "relationship_type": "indicates", "target_ref": "attack-pattern--457c7820-d331-465a-915e-42f85500ccc4"}, {"name": "MS Office Product Spawning Exe in User Dir", "description": "Detects an executable in the users directory started from Microsoft Word, Excel, Powerpoint, Publisher or Visio", "created": "2019-04-02T00:00:00.000Z", "valid_from": "2019-04-02T00:00:00Z", "indicator_types": ["malicious-activity"], "pattern_type": "sigma", "pattern": "title: MS Office Product Spawning Exe in User Dir\nid: aa3a6f94-890e-4e22-b634-ffdfd54792cc\nstatus: experimental\ndescription: Detects an executable in the users directory started from Microsoft Word, Excel, Powerpoint, Publisher or Visio\nreferences:\n    - sha256=23160972c6ae07f740800fa28e421a81d7c0ca5d5cab95bc082b4a986fbac57c\n    - https://blog.morphisec.com/fin7-not-finished-morphisec-spots-new-campaign\ntags:\n    - attack.execution\n    - attack.defense_evasion\n    - attack.t1059\n    - attack.t1202\n    - FIN7\n    - car.2013-05-002\nauthor: Jason Lynch \ndate: 2019/04/02\nlogsource:\n    category: process_creation\n    product: windows\ndetection:\n    selection:\n        ParentImage:\n            - '*\\WINWORD.EXE'\n            - '*\\EXCEL.EXE'\n            - '*\\POWERPNT.exe'\n            - '*\\MSPUB.exe'\n            - '*\\VISIO.exe'\n            - '*\\OUTLOOK.EXE'\n        Image:\n            - 'C:\\users\\\\*.exe'\n    condition: selection\nfields:\n    - CommandLine\n    - ParentCommandLine\nfalsepositives:\n    - unknown\nlevel: high\n", "object_marking_refs": ["marking-definition--0a872d70-1d05-45dd-a25f-031af547a102"], "created_by_ref": "identity--082ca4f0-d825-45b6-aa42-ab9afd1e5503", "type": "indicator", "spec_version": "2.1", "id": "indicator--76cb2029-d2fa-4968-a861-6c5f00ba8f6e", "modified": "2020-04-02T07:58:57.642Z"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--57161321-ac66-4636-8851-f3b83d88471f", "created": "2020-04-02T07:58:57.651Z", "modified": "2020-04-02T07:58:57.651Z", "source_ref": "indicator--76cb2029-d2fa-4968-a861-6c5f00ba8f6e", "relationship_type": "indicates", "target_ref": "attack-pattern--7385dfaf-6886-4229-9ecd-6fd678040830"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--64ea492a-7e94-459b-a801-f1b0f8548bfb", "created": "2020-04-02T07:58:57.659Z", "modified": "2020-04-02T07:58:57.659Z", "source_ref": "indicator--76cb2029-d2fa-4968-a861-6c5f00ba8f6e", "relationship_type": "indicates", "target_ref": "attack-pattern--3b0e52ce-517a-4614-a523-1bd5deef6c5e"}, {"name": "Sysprep on AppData Folder", "description": "Detects suspicious sysprep process start with AppData folder as target (as used by Trojan Syndicasec in Thrip report by Symantec)", "created": "2018-06-22T00:00:00.000Z", "modified": "2018-12-11T00:00:00.000Z", "valid_from": "2018-06-22T00:00:00Z", "indicator_types": ["malicious-activity"], "pattern_type": "sigma", "pattern": "title: Sysprep on AppData Folder\nid: d5b9ae7a-e6fc-405e-80ff-2ff9dcc64e7e\nstatus: experimental\ndescription: Detects suspicious sysprep process start with AppData folder as target (as used by Trojan Syndicasec in Thrip report by Symantec)\nreferences:\n    - https://www.symantec.com/blogs/threat-intelligence/thrip-hits-satellite-telecoms-defense-targets\n    - https://app.any.run/tasks/61a296bb-81ad-4fee-955f-3b399f4aaf4b\ntags:\n    - attack.execution\nauthor: Florian Roth\ndate: 2018/06/22\nmodified: 2018/12/11\nlogsource:\n    category: process_creation\n    product: windows\ndetection:\n    selection:\n        CommandLine:\n            - '*\\sysprep.exe *\\AppData\\\\*'\n            - sysprep.exe *\\AppData\\\\*\n    condition: selection\nfalsepositives:\n    - False positives depend on scripts and administrative tools used in the monitored environment\nlevel: medium\n", "object_marking_refs": ["marking-definition--0a872d70-1d05-45dd-a25f-031af547a102"], "created_by_ref": "identity--082ca4f0-d825-45b6-aa42-ab9afd1e5503", "type": "indicator", "spec_version": "2.1", "id": "indicator--87c1319e-0cd8-4555-9b61-8a3fee5d16c3"}, {"name": "Application Whitelisting Bypass via Bginfo", "description": "Execute VBscript code that is referenced within the *.bgi file.", "created": "2019-10-26T00:00:00.000Z", "modified": "2019-11-04T00:00:00.000Z", "valid_from": "2019-10-26T00:00:00Z", "indicator_types": ["malicious-activity"], "pattern_type": "sigma", "pattern": "title: Application Whitelisting Bypass via Bginfo\nid: aaf46cdc-934e-4284-b329-34aa701e3771\nstatus: experimental\ndescription: Execute VBscript code that is referenced within the *.bgi file.\nreferences:\n    - https://github.com/LOLBAS-Project/LOLBAS/blob/master/yml/OtherMSBinaries/Bginfo.yml\n    - https://oddvar.moe/2017/05/18/bypassing-application-whitelisting-with-bginfo/\nauthor: Beyu Denis, oscd.community\ndate: 2019/10/26\nmodified: 2019/11/04\ntags:\n    - attack.defense_evasion\n    - attack.execution\n    - attack.t1218\nlevel: medium\nlogsource:\n    category: process_creation\n    product: windows\ndetection:\n  selection:\n    Image|endswith: '\\bginfo.exe'\n    CommandLine|contains|all:\n        - '/popup'\n        - '/nolicprompt'\n  condition: selection\nfalsepositives:\n    - Unknown\n", "object_marking_refs": ["marking-definition--0a872d70-1d05-45dd-a25f-031af547a102"], "created_by_ref": "identity--082ca4f0-d825-45b6-aa42-ab9afd1e5503", "type": "indicator", "spec_version": "2.1", "id": "indicator--5d7bdf48-b207-4a5e-a41e-32a5fd19a864"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--408d1a8d-8b33-4115-a06b-a4a90373d8c4", "created": "2020-04-02T07:58:57.679Z", "modified": "2020-04-02T07:58:57.679Z", "source_ref": "indicator--5d7bdf48-b207-4a5e-a41e-32a5fd19a864", "relationship_type": "indicates", "target_ref": "attack-pattern--457c7820-d331-465a-915e-42f85500ccc4"}, {"name": "Suspicious Parent of Csc.exe", "description": "Detects a suspicious parent of csc.exe, which could by a sign of payload delivery", "created": "2019-02-11T00:00:00.000Z", "valid_from": "2019-02-11T00:00:00Z", "indicator_types": ["malicious-activity"], "pattern_type": "sigma", "pattern": "title: Suspicious Parent of Csc.exe\nid: b730a276-6b63-41b8-bcf8-55930c8fc6ee\ndescription: Detects a suspicious parent of csc.exe, which could by a sign of payload delivery\nstatus: experimental\nreferences:\n    - https://twitter.com/SBousseaden/status/1094924091256176641\nauthor: Florian Roth\ndate: 2019/02/11\ntags:\n    - attack.defense_evasion\n    - attack.t1036\nlogsource:\n    category: process_creation\n    product: windows\ndetection:\n    selection:\n        Image: '*\\csc.exe*'\n        ParentImage:\n            - '*\\wscript.exe'\n            - '*\\cscript.exe'\n            - '*\\mshta.exe'\n    condition: selection\nfalsepositives:\n    - Unkown\nlevel: high\n", "object_marking_refs": ["marking-definition--0a872d70-1d05-45dd-a25f-031af547a102"], "created_by_ref": "identity--082ca4f0-d825-45b6-aa42-ab9afd1e5503", "type": "indicator", "spec_version": "2.1", "id": "indicator--7aa9f766-4dae-4414-ab00-88472e3accbf", "modified": "2020-04-02T07:58:57.682Z"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--7d3c00a7-8d71-43f5-86ed-ffa1ec8c009d", "created": "2020-04-02T07:58:57.691Z", "modified": "2020-04-02T07:58:57.691Z", "source_ref": "indicator--7aa9f766-4dae-4414-ab00-88472e3accbf", "relationship_type": "indicates", "target_ref": "attack-pattern--42e8de7b-37b2-4258-905a-6897815e58e0"}, {"name": "FromBase64String Command Line", "description": "Detects suspicious FromBase64String expressions in command line arguments", "created": "2020-01-29T00:00:00.000Z", "valid_from": "2020-01-29T00:00:00Z", "indicator_types": ["malicious-activity"], "pattern_type": "sigma", "pattern": "title: FromBase64String Command Line\nid: e32d4572-9826-4738-b651-95fa63747e8a\nstatus: experimental\ndescription: Detects suspicious FromBase64String expressions in command line arguments\nreferences:\n    - https://gist.github.com/Neo23x0/6af876ee72b51676c82a2db8d2cd3639\nauthor: Florian Roth\ndate: 2020/01/29\ntags: \n    - attack.t1027\n    - attack.defense_evasion\nlogsource:\n    category: process_creation\n    product: windows\ndetection:\n    selection:\n        CommandLine|contains: '::FromBase64String('\n    condition: selection\nfalsepositives:\n    - Administrative script libraries\nlevel: high\n", "object_marking_refs": ["marking-definition--0a872d70-1d05-45dd-a25f-031af547a102"], "created_by_ref": "identity--082ca4f0-d825-45b6-aa42-ab9afd1e5503", "type": "indicator", "spec_version": "2.1", "id": "indicator--c6163b4b-495b-438b-861b-88398b33b9e6", "modified": "2020-04-02T07:58:57.694Z"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--7a409e2f-e300-49e2-83c1-e9d729d6ac31", "created": "2020-04-02T07:58:57.704Z", "modified": "2020-04-02T07:58:57.704Z", "source_ref": "indicator--c6163b4b-495b-438b-861b-88398b33b9e6", "relationship_type": "indicates", "target_ref": "attack-pattern--b3d682b6-98f2-4fb0-aa3b-b4df007ca70a"}, {"name": "Windows 10 Scheduled Task SandboxEscaper 0-day", "description": "Detects Task Scheduler .job import arbitrary DACL write\\par", "created": "2019-05-22T00:00:00.000Z", "valid_from": "2019-05-22T00:00:00Z", "indicator_types": ["malicious-activity"], "pattern_type": "sigma", "pattern": "title: Windows 10 Scheduled Task SandboxEscaper 0-day\nid: 931b6802-d6a6-4267-9ffa-526f57f22aaf\nstatus: experimental\ndescription: Detects Task Scheduler .job import arbitrary DACL write\\par\nreferences:\n    - https://github.com/SandboxEscaper/polarbearrepo/tree/master/bearlpe\nauthor: Olaf Hartong\ndate: 2019/05/22\nlogsource:\n    category: process_creation\n    product: windows\ndetection:\n    selection:\n        Image: schtasks.exe\n        CommandLine: '*/change*/TN*/RU*/RP*'\n    condition: selection\nfalsepositives:\n    - Unknown\ntags:\n    - attack.privilege_escalation\n    - attack.execution\n    - attack.t1053\n    - car.2013-08-001\nlevel: high\n", "object_marking_refs": ["marking-definition--0a872d70-1d05-45dd-a25f-031af547a102"], "created_by_ref": "identity--082ca4f0-d825-45b6-aa42-ab9afd1e5503", "type": "indicator", "spec_version": "2.1", "id": "indicator--42dec5bf-38c8-4380-890c-7c46b845610f", "modified": "2020-04-02T07:58:57.707Z"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--5993a2e7-c416-45e7-b176-523d7f14097a", "created": "2020-04-02T07:58:57.717Z", "modified": "2020-04-02T07:58:57.717Z", "source_ref": "indicator--42dec5bf-38c8-4380-890c-7c46b845610f", "relationship_type": "indicates", "target_ref": "attack-pattern--35dd844a-b219-4e2b-a6bb-efa9a75995a9"}, {"name": "Turla Group Lateral Movement", "description": "Detects automated lateral movement by Turla group", "created": "2017-11-07T00:00:00.000Z", "valid_from": "2017-11-07T00:00:00Z", "indicator_types": ["malicious-activity"], "pattern_type": "sigma", "pattern": "action: global\ntitle: Turla Group Lateral Movement\nid: c601f20d-570a-4cde-a7d6-e17f99cb8e7f\nstatus: experimental\ndescription: Detects automated lateral movement by Turla group\nreferences:\n    - https://securelist.com/the-epic-turla-operation/65545/\ntags:\n    - attack.g0010\n    - attack.execution\n    - attack.t1059\n    - attack.lateral_movement\n    - attack.t1077\n    - attack.discovery\n    - attack.t1083\n    - attack.t1135\nauthor: Markus Neis\ndate: 2017/11/07\nlogsource:\n    category: process_creation\n    product: windows\nfalsepositives:\n   - Unknown\n", "object_marking_refs": ["marking-definition--0a872d70-1d05-45dd-a25f-031af547a102"], "created_by_ref": "identity--082ca4f0-d825-45b6-aa42-ab9afd1e5503", "type": "indicator", "spec_version": "2.1", "id": "indicator--5c1701dd-0971-4d95-80e4-b3d5ace555c4", "modified": "2020-04-02T07:58:57.720Z"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--5e823899-b653-47ca-9d08-3452b9428252", "created": "2020-04-02T07:58:57.731Z", "modified": "2020-04-02T07:58:57.731Z", "source_ref": "indicator--5c1701dd-0971-4d95-80e4-b3d5ace555c4", "relationship_type": "indicates", "target_ref": "intrusion-set--7a19ecb1-3c65-4de3-a230-993516aed6a6"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--e24c923c-81f0-4da7-8bb6-9232fc2c9454", "created": "2020-04-02T07:58:57.741Z", "modified": "2020-04-02T07:58:57.741Z", "source_ref": "indicator--5c1701dd-0971-4d95-80e4-b3d5ace555c4", "relationship_type": "indicates", "target_ref": "attack-pattern--7385dfaf-6886-4229-9ecd-6fd678040830"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--cf13c2e1-bfe1-41d4-ba2c-6c937bd6667c", "created": "2020-04-02T07:58:57.748Z", "modified": "2020-04-02T07:58:57.748Z", "source_ref": "indicator--5c1701dd-0971-4d95-80e4-b3d5ace555c4", "relationship_type": "indicates", "target_ref": "attack-pattern--ffe742ed-9100-4686-9e00-c331da544787"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--492c9d53-399c-40ee-9c0c-037f4f3303c1", "created": "2020-04-02T07:58:57.755Z", "modified": "2020-04-02T07:58:57.755Z", "source_ref": "indicator--5c1701dd-0971-4d95-80e4-b3d5ace555c4", "relationship_type": "indicates", "target_ref": "attack-pattern--7bc57495-ea59-4380-be31-a64af124ef18"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--db7c6dca-0e86-408e-a3fe-99da2e17aeb6", "created": "2020-04-02T07:58:57.761Z", "modified": "2020-04-02T07:58:57.761Z", "source_ref": "indicator--5c1701dd-0971-4d95-80e4-b3d5ace555c4", "relationship_type": "indicates", "target_ref": "attack-pattern--3489cfc5-640f-4bb3-a103-9137b97de79f"}, {"name": "Empire PowerShell Launch Parameters", "description": "Detects suspicious powershell command line parameters used in Empire", "created": "2019-04-20T00:00:00.000Z", "valid_from": "2019-04-20T00:00:00Z", "indicator_types": ["malicious-activity"], "pattern_type": "sigma", "pattern": "title: Empire PowerShell Launch Parameters\nid: 79f4ede3-402e-41c8-bc3e-ebbf5f162581\ndescription: Detects suspicious powershell command line parameters used in Empire\nstatus: experimental\nreferences:\n    - https://github.com/EmpireProject/Empire/blob/c2ba61ca8d2031dad0cfc1d5770ba723e8b710db/lib/common/helpers.py#L165\n    - https://github.com/EmpireProject/Empire/blob/e37fb2eef8ff8f5a0a689f1589f424906fe13055/lib/modules/powershell/persistence/powerbreach/deaduser.py#L191\n    - https://github.com/EmpireProject/Empire/blob/e37fb2eef8ff8f5a0a689f1589f424906fe13055/lib/modules/powershell/persistence/powerbreach/resolver.py#L178\n    - https://github.com/EmpireProject/Empire/blob/e37fb2eef8ff8f5a0a689f1589f424906fe13055/data/module_source/privesc/Invoke-EventVwrBypass.ps1#L64\nauthor: Florian Roth\ndate: 2019/04/20\ntags:\n  - attack.execution\n  - attack.t1086\nlogsource:\n    category: process_creation\n    product: windows\ndetection:\n    selection:\n        CommandLine:\n            - '* -NoP -sta -NonI -W Hidden -Enc *'\n            - '* -noP -sta -w 1 -enc *'\n            - '* -NoP -NonI -W Hidden -enc *'\n    condition: selection\nlevel: critical\n", "object_marking_refs": ["marking-definition--0a872d70-1d05-45dd-a25f-031af547a102"], "created_by_ref": "identity--082ca4f0-d825-45b6-aa42-ab9afd1e5503", "type": "indicator", "spec_version": "2.1", "id": "indicator--83bf5f0d-b333-4394-93af-ff051e9ef5fc", "modified": "2020-04-02T07:58:57.767Z"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--56bef0ae-0e4c-4e3a-9046-841aba7bad74", "created": "2020-04-02T07:58:57.778Z", "modified": "2020-04-02T07:58:57.778Z", "source_ref": "indicator--83bf5f0d-b333-4394-93af-ff051e9ef5fc", "relationship_type": "indicates", "target_ref": "attack-pattern--f4882e23-8aa7-4b12-b28a-b349c12ee9e0"}, {"name": "Data Compressed - rar.exe", "description": "An adversary may compress data (e.g., sensitive documents) that is collected prior to exfiltration in order to make it portable and minimize the amount of data sent over the network", "created": "2019-10-21T00:00:00.000Z", "modified": "2019-11-04T00:00:00.000Z", "valid_from": "2019-10-21T00:00:00Z", "indicator_types": ["malicious-activity"], "pattern_type": "sigma", "pattern": "title: Data Compressed - rar.exe\nid: 6f3e2987-db24-4c78-a860-b4f4095a7095\nstatus: experimental\ndescription: An adversary may compress data (e.g., sensitive documents) that is collected prior to exfiltration in order to make it portable and minimize the amount of data sent over the network\nauthor: Timur Zinniatullin, E.M. Anhaus, oscd.community\ndate: 2019/10/21\nmodified: 2019/11/04\nreferences:\n    - https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1002/T1002.yaml\n    - https://eqllib.readthedocs.io/en/latest/analytics/1ec33c93-3d0b-4a28-8014-dbdaae5c60ae.html\nlogsource:\n    category: process_creation\n    product: windows\ndetection:\n    selection:\n        Image|endswith: '\\rar.exe'\n        CommandLine|contains: ' a '\n    condition: selection\nfields:\n    - Image\n    - CommandLine\n    - User\n    - LogonGuid\n    - Hashes\n    - ParentProcessGuid\n    - ParentCommandLine\nfalsepositives:\n    - highly likely if rar is default archiver in the monitored environment\nlevel: low\ntags:\n    - attack.exfiltration\n    - attack.t1002", "object_marking_refs": ["marking-definition--0a872d70-1d05-45dd-a25f-031af547a102"], "created_by_ref": "identity--082ca4f0-d825-45b6-aa42-ab9afd1e5503", "type": "indicator", "spec_version": "2.1", "id": "indicator--73cf8c2c-ff6b-4da8-ada0-ca92ee89e8dd"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--87d970d1-dc00-41c1-927a-55fbc2b4a755", "created": "2020-04-02T07:58:57.793Z", "modified": "2020-04-02T07:58:57.793Z", "source_ref": "indicator--73cf8c2c-ff6b-4da8-ada0-ca92ee89e8dd", "relationship_type": "indicates", "target_ref": "attack-pattern--b9f5dbe2-4c55-4fc5-af2e-d42c1d182ec4"}, {"name": "Suspicious Execution from Outlook", "description": "Detects EnableUnsafeClientMailRules used for Script Execution from Outlook", "created": "2018-12-27T00:00:00.000Z", "valid_from": "2018-12-27T00:00:00Z", "indicator_types": ["malicious-activity"], "pattern_type": "sigma", "pattern": "title: Suspicious Execution from Outlook\nid: e212d415-0e93-435f-9e1a-f29005bb4723\nstatus: experimental\ndescription: Detects EnableUnsafeClientMailRules used for Script Execution from Outlook\nreferences:\n    - https://github.com/sensepost/ruler\n    - https://www.fireeye.com/blog/threat-research/2018/12/overruled-containing-a-potentially-destructive-adversary.html\ntags:\n    - attack.execution\n    - attack.t1059\n    - attack.t1202\nauthor: Markus Neis\ndate: 2018/12/27\nlogsource:\n    category: process_creation\n    product: windows\ndetection:\n    clientMailRules:\n        CommandLine: '*EnableUnsafeClientMailRules*'\n    outlookExec:\n        ParentImage: '*\\outlook.exe'\n        CommandLine: \\\\\\\\*\\\\*.exe\n    condition: clientMailRules or outlookExec\nfalsepositives:\n    - unknown\nlevel: high\n", "object_marking_refs": ["marking-definition--0a872d70-1d05-45dd-a25f-031af547a102"], "created_by_ref": "identity--082ca4f0-d825-45b6-aa42-ab9afd1e5503", "type": "indicator", "spec_version": "2.1", "id": "indicator--cda1ac5e-e9c3-48c1-883d-762f0a6a54c2", "modified": "2020-04-02T07:58:57.797Z"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--cdfedf1c-1d87-451e-8011-afdbffc1d84b", "created": "2020-04-02T07:58:57.810Z", "modified": "2020-04-02T07:58:57.810Z", "source_ref": "indicator--cda1ac5e-e9c3-48c1-883d-762f0a6a54c2", "relationship_type": "indicates", "target_ref": "attack-pattern--7385dfaf-6886-4229-9ecd-6fd678040830"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--eeba5b11-abc1-424f-ad59-4327736a102b", "created": "2020-04-02T07:58:57.820Z", "modified": "2020-04-02T07:58:57.820Z", "source_ref": "indicator--cda1ac5e-e9c3-48c1-883d-762f0a6a54c2", "relationship_type": "indicates", "target_ref": "attack-pattern--3b0e52ce-517a-4614-a523-1bd5deef6c5e"}, {"name": "Hurricane Panda Activity", "description": "Detects Hurricane Panda Activity", "created": "2019-03-04T00:00:00.000Z", "valid_from": "2019-03-04T00:00:00Z", "indicator_types": ["malicious-activity"], "pattern_type": "sigma", "pattern": "title: Hurricane Panda Activity\nid: 0eb2107b-a596-422e-b123-b389d5594ed7\nauthor: Florian Roth\ndate: 2019/03/04\nstatus: experimental\ndescription: Detects Hurricane Panda Activity\nreferences:\n    - https://www.crowdstrike.com/blog/crowdstrike-discovers-use-64-bit-zero-day-privilege-escalation-exploit-cve-2014-4113-hurricane-panda/\ntags:\n    - attack.privilege_escalation\n    - attack.g0009\n    - attack.t1068\nlogsource:\n    category: process_creation\n    product: windows\ndetection:\n    selection:\n        CommandLine:\n            - '* localgroup administrators admin /add'\n            - '*\\Win64.exe*'\n    condition: selection\nfalsepositives:\n    - Unknown\nlevel: high\n", "object_marking_refs": ["marking-definition--0a872d70-1d05-45dd-a25f-031af547a102"], "created_by_ref": "identity--082ca4f0-d825-45b6-aa42-ab9afd1e5503", "type": "indicator", "spec_version": "2.1", "id": "indicator--daf745cf-557c-4339-a7aa-f04bd8d15ca1", "modified": "2020-04-02T07:58:57.824Z"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--6437078e-1b73-4b82-8e8a-44e5e27407ad", "created": "2020-04-02T07:58:57.835Z", "modified": "2020-04-02T07:58:57.835Z", "source_ref": "indicator--daf745cf-557c-4339-a7aa-f04bd8d15ca1", "relationship_type": "indicates", "target_ref": "intrusion-set--a653431d-6a5e-4600-8ad3-609b5af57064"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--8605f3e3-aa03-4a09-accb-4d004ad1f74a", "created": "2020-04-02T07:58:57.845Z", "modified": "2020-04-02T07:58:57.845Z", "source_ref": "indicator--daf745cf-557c-4339-a7aa-f04bd8d15ca1", "relationship_type": "indicates", "target_ref": "attack-pattern--b21c3b2d-02e6-45b1-980b-e69051040839"}, {"name": "Curl Start Combination", "description": "Adversaries can use curl to download payloads remotely and execute them. Curl is included by default in Windows 10 build 17063 and later.", "created": "2020-01-13T00:00:00.000Z", "valid_from": "2020-01-13T00:00:00Z", "indicator_types": ["malicious-activity"], "pattern_type": "sigma", "pattern": "title: Curl Start Combination\nid: 21dd6d38-2b18-4453-9404-a0fe4a0cc288\nstatus: experimental\ndescription: Adversaries can use curl to download payloads remotely and execute them. Curl is included by default in Windows 10 build 17063 and later.\nreferences: \n    - https://medium.com/@reegun/curl-exe-is-the-new-rundll32-exe-lolbin-3f79c5f35983\nauthor: Sreeman\ndate: 2020/01/13\ntags:\n    - attack.execution\n    - attack.t1218\nlogsource:\n   category: process_creation\n   product: windows\ndetection:\n  condition: selection\n  selection:\n      CommandLine|contains: 'curl* start '\nfalsepositives:\n    - Administrative scripts (installers)\nfields:\n    - ParentImage\n    - CommandLine\nlevel: medium\n", "object_marking_refs": ["marking-definition--0a872d70-1d05-45dd-a25f-031af547a102"], "created_by_ref": "identity--082ca4f0-d825-45b6-aa42-ab9afd1e5503", "type": "indicator", "spec_version": "2.1", "id": "indicator--25640694-876a-4b13-a2f6-37ec1fddc528", "modified": "2020-04-02T07:58:57.853Z"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--e0b5de72-bae9-4a1e-a684-3502797f53b2", "created": "2020-04-02T07:58:57.864Z", "modified": "2020-04-02T07:58:57.864Z", "source_ref": "indicator--25640694-876a-4b13-a2f6-37ec1fddc528", "relationship_type": "indicates", "target_ref": "attack-pattern--457c7820-d331-465a-915e-42f85500ccc4"}, {"name": "Encoded FromBase64String", "description": "Detects a base64 encoded FromBase64String keyword in a process command line", "created": "2019-08-24T00:00:00.000Z", "valid_from": "2019-08-24T00:00:00Z", "indicator_types": ["malicious-activity"], "pattern_type": "sigma", "pattern": "title: Encoded FromBase64String\nid: fdb62a13-9a81-4e5c-a38f-ea93a16f6d7c\nstatus: experimental\ndescription: Detects a base64 encoded FromBase64String keyword in a process command line\nauthor: Florian Roth\ndate: 2019/08/24\ntags:\n    - attack.t1086\n    - attack.t1140\n    - attack.execution\n    - attack.defense_evasion\nlogsource:\n    category: process_creation\n    product: windows\ndetection:\n    selection:\n        CommandLine|base64offset|contains: '::FromBase64String'\n    condition: selection\nfields:\n    - CommandLine\n    - ParentCommandLine\nfalsepositives:\n    - unknown\nlevel: critical\n", "object_marking_refs": ["marking-definition--0a872d70-1d05-45dd-a25f-031af547a102"], "created_by_ref": "identity--082ca4f0-d825-45b6-aa42-ab9afd1e5503", "type": "indicator", "spec_version": "2.1", "id": "indicator--e2bbfcd2-8e87-4331-ab02-583c712e08a4", "modified": "2020-04-02T07:58:57.868Z"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--3fefe101-e14e-44ab-a86c-6296aafed1c9", "created": "2020-04-02T07:58:57.878Z", "modified": "2020-04-02T07:58:57.878Z", "source_ref": "indicator--e2bbfcd2-8e87-4331-ab02-583c712e08a4", "relationship_type": "indicates", "target_ref": "attack-pattern--f4882e23-8aa7-4b12-b28a-b349c12ee9e0"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--ff0a682e-8b2c-4417-83bd-c09a52d27f07", "created": "2020-04-02T07:58:57.888Z", "modified": "2020-04-02T07:58:57.888Z", "source_ref": "indicator--e2bbfcd2-8e87-4331-ab02-583c712e08a4", "relationship_type": "indicates", "target_ref": "attack-pattern--3ccef7ae-cb5e-48f6-8302-897105fbf55c"}, {"name": "WMI Spawning Windows PowerShell", "description": "Detects WMI spawning PowerShell", "created": "2019-04-03T00:00:00.000Z", "valid_from": "2019-04-03T00:00:00Z", "indicator_types": ["malicious-activity"], "pattern_type": "sigma", "pattern": "title: WMI Spawning Windows PowerShell\nid: 692f0bec-83ba-4d04-af7e-e884a96059b6\nstatus: experimental\ndescription: Detects WMI spawning PowerShell\nreferences:\n    - https://github.com/Neo23x0/sigma/blob/master/rules/windows/process_creation/win_shell_spawn_susp_program.yml\n    - https://any.run/report/68bc255f9b0db6a0d30a8f2dadfbee3256acfe12497bf93943bc1eab0735e45e/a2385d6f-34f7-403c-90d3-b1f9d2a90a5e\nauthor: Markus Neis / @Karneades\ndate: 2019/04/03\ntags:\n    - attack.execution\n    - attack.defense_evasion\n    - attack.t1064\nlogsource:\n    category: process_creation\n    product: windows\ndetection:\n    selection:\n        ParentImage:\n            - '*\\wmiprvse.exe'\n        Image:\n            - '*\\powershell.exe'\n    condition: selection\nfalsepositives:\n    - AppvClient\n    - CCM\nlevel: high\n", "object_marking_refs": ["marking-definition--0a872d70-1d05-45dd-a25f-031af547a102"], "created_by_ref": "identity--082ca4f0-d825-45b6-aa42-ab9afd1e5503", "type": "indicator", "spec_version": "2.1", "id": "indicator--cd72aa1c-3881-4094-91bb-f17997c4daef", "modified": "2020-04-02T07:58:57.892Z"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--353f92c3-64c6-4b1e-8cb6-21566b6e992d", "created": "2020-04-02T07:58:57.904Z", "modified": "2020-04-02T07:58:57.904Z", "source_ref": "indicator--cd72aa1c-3881-4094-91bb-f17997c4daef", "relationship_type": "indicates", "target_ref": "attack-pattern--7fd87010-3a00-4da3-b905-410525e8ec44"}, {"name": "TropicTrooper Campaign November 2018", "description": "Detects TropicTrooper activity, an actor who targeted high-profile organizations in the energy and food and beverage sectors in Asia", "created": "2019-11-12T00:00:00.000Z", "valid_from": "2019-11-12T00:00:00Z", "indicator_types": ["malicious-activity"], "pattern_type": "sigma", "pattern": "title: TropicTrooper Campaign November 2018\nid: 8c7090c3-e0a0-4944-bd08-08c3a0cecf79\nauthor: '@41thexplorer, Windows Defender ATP'\nstatus: stable\ndate: 2019/11/12\ndescription: Detects TropicTrooper activity, an actor who targeted high-profile organizations in the energy and food and beverage sectors in Asia\nreferences:\n    - https://cloudblogs.microsoft.com/microsoftsecure/2018/11/28/windows-defender-atp-device-risk-score-exposes-new-cyberattack-drives-conditional-access-to-protect-networks/\ntags:\n    - attack.execution\n    - attack.t1085\nlogsource:\n    category: process_creation\n    product: windows\ndetection:\n    selection:\n        CommandLine: '*abCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCc*'\n    condition: selection\nlevel: high\n", "object_marking_refs": ["marking-definition--0a872d70-1d05-45dd-a25f-031af547a102"], "created_by_ref": "identity--082ca4f0-d825-45b6-aa42-ab9afd1e5503", "type": "indicator", "spec_version": "2.1", "id": "indicator--18341e4a-98bd-43d4-8c12-e026e49f7f1c", "modified": "2020-04-02T07:58:57.907Z"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--2dd245c3-586b-49fb-b61a-c5abc41a31e3", "created": "2020-04-02T07:58:57.918Z", "modified": "2020-04-02T07:58:57.918Z", "source_ref": "indicator--18341e4a-98bd-43d4-8c12-e026e49f7f1c", "relationship_type": "indicates", "target_ref": "attack-pattern--62b8c999-dcc0-4755-bd69-09442d9359f5"}, {"name": "Suspicious Control Panel DLL Load", "description": "Detects suspicious Rundll32 execution from control.exe as used by Equation Group and Exploit Kits", "created": "2017-04-15T00:00:00.000Z", "valid_from": "2017-04-15T00:00:00Z", "indicator_types": ["malicious-activity"], "pattern_type": "sigma", "pattern": "title: Suspicious Control Panel DLL Load\nid: d7eb979b-c2b5-4a6f-a3a7-c87ce6763819\nstatus: experimental\ndescription: Detects suspicious Rundll32 execution from control.exe as used by Equation Group and Exploit Kits\nauthor: Florian Roth\ndate: 2017/04/15\nreferences:\n    - https://twitter.com/rikvduijn/status/853251879320662017\ntags:\n    - attack.defense_evasion\n    - attack.t1073\n    - attack.t1085\n    - car.2013-10-002\nlogsource:\n    category: process_creation\n    product: windows\ndetection:\n    selection:\n        ParentImage: '*\\System32\\control.exe'\n        CommandLine: '*\\rundll32.exe *'\n    filter:\n        CommandLine: '*Shell32.dll*'\n    condition: selection and not filter\nfields:\n    - CommandLine\n    - ParentCommandLine\nfalsepositives:\n    - Unknown\nlevel: high\n", "object_marking_refs": ["marking-definition--0a872d70-1d05-45dd-a25f-031af547a102"], "created_by_ref": "identity--082ca4f0-d825-45b6-aa42-ab9afd1e5503", "type": "indicator", "spec_version": "2.1", "id": "indicator--897e904a-d354-47b4-a679-1b648912786e", "modified": "2020-04-02T07:58:57.922Z"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--ef1d8e7f-2c3f-453d-a1f2-19f03cb22f70", "created": "2020-04-02T07:58:57.932Z", "modified": "2020-04-02T07:58:57.932Z", "source_ref": "indicator--897e904a-d354-47b4-a679-1b648912786e", "relationship_type": "indicates", "target_ref": "attack-pattern--b2001907-166b-4d71-bb3c-9d26c871de09"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--c85f4e41-06c4-4277-ac32-f3a48a92e49e", "created": "2020-04-02T07:58:57.941Z", "modified": "2020-04-02T07:58:57.941Z", "source_ref": "indicator--897e904a-d354-47b4-a679-1b648912786e", "relationship_type": "indicates", "target_ref": "attack-pattern--62b8c999-dcc0-4755-bd69-09442d9359f5"}, {"name": "Default PowerSploit and Empire Schtasks Persistence", "description": "Detects the creation of a schtask via PowerSploit or Empire Default Configuration.", "created": "2018-03-06T00:00:00.000Z", "valid_from": "2018-03-06T00:00:00Z", "indicator_types": ["malicious-activity"], "pattern_type": "sigma", "pattern": "title: Default PowerSploit and Empire Schtasks Persistence\nid: 56c217c3-2de2-479b-990f-5c109ba8458f\nstatus: experimental\ndescription: Detects the creation of a schtask via PowerSploit or Empire Default Configuration.\nreferences:\n    - https://github.com/0xdeadbeefJERKY/PowerSploit/blob/8690399ef70d2cad10213575ac67e8fa90ddf7c3/Persistence/Persistence.psm1\n    - https://github.com/EmpireProject/Empire/blob/master/lib/modules/powershell/persistence/userland/schtasks.py\n    - https://github.com/EmpireProject/Empire/blob/master/lib/modules/powershell/persistence/elevated/schtasks.py\nauthor: Markus Neis, @Karneades\ndate: 2018/03/06\nlogsource:\n    product: windows\n    category: process_creation\ndetection:\n    selection:\n        ParentImage:\n            - '*\\powershell.exe'\n        CommandLine:\n            - '*schtasks*/Create*/SC *ONLOGON*/TN *Updater*/TR *powershell*'\n            - '*schtasks*/Create*/SC *DAILY*/TN *Updater*/TR *powershell*'\n            - '*schtasks*/Create*/SC *ONIDLE*/TN *Updater*/TR *powershell*'\n            - '*schtasks*/Create*/SC *Updater*/TN *Updater*/TR *powershell*'\n    condition: selection\ntags:\n    - attack.execution\n    - attack.persistence\n    - attack.privilege_escalation\n    - attack.t1053\n    - attack.t1086\n    - attack.s0111\n    - attack.g0022\n    - attack.g0060\n    - car.2013-08-001\nfalsepositives:\n    - False positives are possible, depends on organisation and processes\nlevel: high\n", "object_marking_refs": ["marking-definition--0a872d70-1d05-45dd-a25f-031af547a102"], "created_by_ref": "identity--082ca4f0-d825-45b6-aa42-ab9afd1e5503", "type": "indicator", "spec_version": "2.1", "id": "indicator--a42e0717-003a-45bd-9826-81a1d27c89f9", "modified": "2020-04-02T07:58:57.947Z"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--7a3c9e2d-074b-45ff-9160-12da3a331216", "created": "2020-04-02T07:58:57.957Z", "modified": "2020-04-02T07:58:57.957Z", "source_ref": "indicator--a42e0717-003a-45bd-9826-81a1d27c89f9", "relationship_type": "indicates", "target_ref": "attack-pattern--35dd844a-b219-4e2b-a6bb-efa9a75995a9"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--83e04749-0cf9-4621-83d0-17ca65f33869", "created": "2020-04-02T07:58:57.965Z", "modified": "2020-04-02T07:58:57.965Z", "source_ref": "indicator--a42e0717-003a-45bd-9826-81a1d27c89f9", "relationship_type": "indicates", "target_ref": "attack-pattern--f4882e23-8aa7-4b12-b28a-b349c12ee9e0"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--5b0df5d6-2dfb-44f9-a78d-c5e68fc6b6d9", "created": "2020-04-02T07:58:57.975Z", "modified": "2020-04-02T07:58:57.975Z", "source_ref": "indicator--a42e0717-003a-45bd-9826-81a1d27c89f9", "relationship_type": "indicates", "target_ref": "tool--c9703cd3-141c-43a0-a926-380082be5d04"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--a96fc287-4b83-431f-9ad2-e39347f21209", "created": "2020-04-02T07:58:57.983Z", "modified": "2020-04-02T07:58:57.983Z", "source_ref": "indicator--a42e0717-003a-45bd-9826-81a1d27c89f9", "relationship_type": "indicates", "target_ref": "intrusion-set--0bbdf25b-30ff-4894-a1cd-49260d0dd2d9"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--b03e4329-0353-4b7e-a614-c3e02f8e6249", "created": "2020-04-02T07:58:57.994Z", "modified": "2020-04-02T07:58:57.994Z", "source_ref": "indicator--a42e0717-003a-45bd-9826-81a1d27c89f9", "relationship_type": "indicates", "target_ref": "intrusion-set--93f52415-0fe4-4d3d-896c-fc9b8e88ab90"}, {"name": "Judgement Panda Credential Access Activity", "description": "Detects Russian group activity as described in Global Threat Report 2019 by Crowdstrike", "created": "2019-02-21T00:00:00.000Z", "valid_from": "2019-02-21T00:00:00Z", "indicator_types": ["malicious-activity"], "pattern_type": "sigma", "pattern": "title: Judgement Panda Credential Access Activity\nid: b83f5166-9237-4b5e-9cd4-7b5d52f4d8ee\ndescription: Detects Russian group activity as described in Global Threat Report 2019 by Crowdstrike\nreferences:\n    - https://www.crowdstrike.com/resources/reports/2019-crowdstrike-global-threat-report/\nauthor: Florian Roth\ndate: 2019/02/21\ntags:\n    - attack.credential_access\n    - attack.t1081\n    - attack.t1003\nlogsource:\n    category: process_creation\n    product: windows\ndetection:\n    selection1:\n        Image: '*\\xcopy.exe'\n        CommandLine: '* /S /E /C /Q /H \\\\*'\n    selection2:\n        Image: '*\\adexplorer.exe'\n        CommandLine: '* -snapshot \"\" c:\\users\\\\*'\n    condition: selection1 or selection2\nfalsepositives:\n    - unknown\nlevel: critical\n", "object_marking_refs": ["marking-definition--0a872d70-1d05-45dd-a25f-031af547a102"], "created_by_ref": "identity--082ca4f0-d825-45b6-aa42-ab9afd1e5503", "type": "indicator", "spec_version": "2.1", "id": "indicator--18f50588-9ab0-4fc6-9805-e87ce7ea7fde", "modified": "2020-04-02T07:58:57.999Z"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--583ebd68-69b2-4f65-a62c-7cb8985ccd65", "created": "2020-04-02T07:58:58.010Z", "modified": "2020-04-02T07:58:58.010Z", "source_ref": "indicator--18f50588-9ab0-4fc6-9805-e87ce7ea7fde", "relationship_type": "indicates", "target_ref": "attack-pattern--ba8e391f-14b5-496f-81f2-2d5ecd646c1c"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--86bd2e7e-3577-412c-90c1-f7b46aaefb66", "created": "2020-04-02T07:58:58.021Z", "modified": "2020-04-02T07:58:58.021Z", "source_ref": "indicator--18f50588-9ab0-4fc6-9805-e87ce7ea7fde", "relationship_type": "indicates", "target_ref": "attack-pattern--0a3ead4e-6d47-4ccb-854c-a6a4f9d96b22"}, {"name": "Defrag Deactivation", "description": "Detects the deactivation of the Scheduled defragmentation task as seen by Slingshot APT group", "created": "2019-03-04T00:00:00.000Z", "valid_from": "2019-03-04T00:00:00Z", "indicator_types": ["malicious-activity"], "pattern_type": "sigma", "pattern": "action: global\ntitle: Defrag Deactivation\nid: 958d81aa-8566-4cea-a565-59ccd4df27b0\nauthor: Florian Roth\ndate: 2019/03/04\ndescription: Detects the deactivation of the Scheduled defragmentation task as seen by Slingshot APT group\nreferences:\n    - https://securelist.com/apt-slingshot/84312/\ntags:\n    - attack.persistence\n    - attack.t1053\n    - attack.s0111\ndetection:\n    condition: 1 of them\nfalsepositives:\n    - Unknown\nlevel: medium\n", "object_marking_refs": ["marking-definition--0a872d70-1d05-45dd-a25f-031af547a102"], "created_by_ref": "identity--082ca4f0-d825-45b6-aa42-ab9afd1e5503", "type": "indicator", "spec_version": "2.1", "id": "indicator--33f3e99a-b30e-446c-b7a4-895fdfd0d294", "modified": "2020-04-02T07:58:58.024Z"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--7ace4c8b-d52b-4e3f-93d2-1a3267f507be", "created": "2020-04-02T07:58:58.035Z", "modified": "2020-04-02T07:58:58.035Z", "source_ref": "indicator--33f3e99a-b30e-446c-b7a4-895fdfd0d294", "relationship_type": "indicates", "target_ref": "attack-pattern--35dd844a-b219-4e2b-a6bb-efa9a75995a9"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--37fcd912-bc93-486f-92bd-032e4c228d43", "created": "2020-04-02T07:58:58.043Z", "modified": "2020-04-02T07:58:58.043Z", "source_ref": "indicator--33f3e99a-b30e-446c-b7a4-895fdfd0d294", "relationship_type": "indicates", "target_ref": "tool--c9703cd3-141c-43a0-a926-380082be5d04"}, {"name": "Suspicious SYSVOL Domain Group Policy Access", "description": "Detects Access to Domain Group Policies stored in SYSVOL", "created": "2018-04-09T00:00:00.000Z", "modified": "2018-12-11T00:00:00.000Z", "valid_from": "2018-04-09T00:00:00Z", "indicator_types": ["malicious-activity"], "pattern_type": "sigma", "pattern": "title: Suspicious SYSVOL Domain Group Policy Access\nid: 05f3c945-dcc8-4393-9f3d-af65077a8f86\nstatus: experimental\ndescription: Detects Access to Domain Group Policies stored in SYSVOL\nreferences:\n    - https://adsecurity.org/?p=2288\n    - https://www.hybrid-analysis.com/sample/f2943f5e45befa52fb12748ca7171d30096e1d4fc3c365561497c618341299d5?environmentId=100\nauthor: Markus Neis\ndate: 2018/04/09\nmodified: 2018/12/11\ntags:\n    - attack.credential_access\n    - attack.t1003\nlogsource:\n    category: process_creation\n    product: windows\ndetection:\n    selection:\n        CommandLine: '*\\SYSVOL\\\\*\\policies\\\\*'\n    condition: selection\nfalsepositives:\n    - administrative activity\nlevel: medium\n", "object_marking_refs": ["marking-definition--0a872d70-1d05-45dd-a25f-031af547a102"], "created_by_ref": "identity--082ca4f0-d825-45b6-aa42-ab9afd1e5503", "type": "indicator", "spec_version": "2.1", "id": "indicator--3ca2541a-a570-4fa0-91af-b0a43ce19cf1"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--0fa2a82b-d975-4daa-a4dc-966cedde85d0", "created": "2020-04-02T07:58:58.060Z", "modified": "2020-04-02T07:58:58.060Z", "source_ref": "indicator--3ca2541a-a570-4fa0-91af-b0a43ce19cf1", "relationship_type": "indicates", "target_ref": "attack-pattern--0a3ead4e-6d47-4ccb-854c-a6a4f9d96b22"}, {"name": "Exploit for CVE-2015-1641", "description": "Detects Winword starting uncommon sub process MicroScMgmt.exe as used in exploits for CVE-2015-1641", "created": "2018-02-22T00:00:00.000Z", "valid_from": "2018-02-22T00:00:00Z", "indicator_types": ["malicious-activity"], "pattern_type": "sigma", "pattern": "title: Exploit for CVE-2015-1641\nid: 7993792c-5ce2-4475-a3db-a3a5539827ef\nstatus: experimental\ndescription: Detects Winword starting uncommon sub process MicroScMgmt.exe as used in exploits for CVE-2015-1641\nreferences:\n    - https://www.virustotal.com/en/file/5567408950b744c4e846ba8ae726883cb15268a539f3bb21758a466e47021ae8/analysis/\n    - https://www.hybrid-analysis.com/sample/5567408950b744c4e846ba8ae726883cb15268a539f3bb21758a466e47021ae8?environmentId=100\nauthor: Florian Roth\ndate: 2018/02/22\ntags:\n    - attack.defense_evasion\n    - attack.t1036\nlogsource:\n    category: process_creation\n    product: windows\ndetection:\n    selection:\n        ParentImage: '*\\WINWORD.EXE'\n        Image: '*\\MicroScMgmt.exe '\n    condition: selection\nfalsepositives:\n    - Unknown\nlevel: critical\n", "object_marking_refs": ["marking-definition--0a872d70-1d05-45dd-a25f-031af547a102"], "created_by_ref": "identity--082ca4f0-d825-45b6-aa42-ab9afd1e5503", "type": "indicator", "spec_version": "2.1", "id": "indicator--5491327f-65be-46ad-8576-ef241d5fce95", "modified": "2020-04-02T07:58:58.063Z"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--bd50fed6-0948-4e13-99da-8afb300155f4", "created": "2020-04-02T07:58:58.073Z", "modified": "2020-04-02T07:58:58.073Z", "source_ref": "indicator--5491327f-65be-46ad-8576-ef241d5fce95", "relationship_type": "indicates", "target_ref": "attack-pattern--42e8de7b-37b2-4258-905a-6897815e58e0"}, {"name": "Network Sniffing", "description": "Network sniffing refers to using the network interface on a system to monitor or capture information sent over a wired or wireless connection. An adversary may place a network interface into promiscuous mode to passively access data in transit over the network, or use span ports to capture a larger amount of data.", "created": "2019-10-21T00:00:00.000Z", "modified": "2019-11-04T00:00:00.000Z", "valid_from": "2019-10-21T00:00:00Z", "indicator_types": ["malicious-activity"], "pattern_type": "sigma", "pattern": "title: Network Sniffing\nid: ba1f7802-adc7-48b4-9ecb-81e227fddfd5\nstatus: experimental\ndescription: Network sniffing refers to using the network interface on a system to monitor or capture information sent over a wired or wireless connection. An adversary\n    may place a network interface into promiscuous mode to passively access data in transit over the network, or use span ports to capture a larger amount of data.\nauthor: Timur Zinniatullin, oscd.community\ndate: 2019/10/21\nmodified: 2019/11/04\nreferences:\n    - https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1040/T1040.yaml\nlogsource:\n    category: process_creation\n    product: windows\ndetection:\n    selection:\n      - Image|endswith: '\\tshark.exe'\n        CommandLine|contains: '-i'\n      - Image|endswith: '\\windump.exe'\n    condition: selection\nfalsepositives:\n    - Admin activity\nfields:\n    - Image\n    - CommandLine\n    - User\n    - LogonGuid\n    - Hashes\n    - ParentProcessGuid\n    - ParentCommandLine\nlevel: low\ntags:\n    - attack.credential_access\n    - attack.discovery\n    - attack.t1040\n", "object_marking_refs": ["marking-definition--0a872d70-1d05-45dd-a25f-031af547a102"], "created_by_ref": "identity--082ca4f0-d825-45b6-aa42-ab9afd1e5503", "type": "indicator", "spec_version": "2.1", "id": "indicator--7116e064-09c1-42c9-9355-24785b18a385"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--0d0988da-ca4a-4fa6-9284-a4ca9c15e759", "created": "2020-04-02T07:58:58.086Z", "modified": "2020-04-02T07:58:58.086Z", "source_ref": "indicator--7116e064-09c1-42c9-9355-24785b18a385", "relationship_type": "indicates", "target_ref": "attack-pattern--3257eb21-f9a7-4430-8de1-d8b6e288f529"}, {"name": "Bitsadmin Download", "description": "Detects usage of bitsadmin downloading a file", "created": "2017-03-09T00:00:00.000Z", "modified": "2019-12-06T00:00:00.000Z", "valid_from": "2017-03-09T00:00:00Z", "indicator_types": ["malicious-activity"], "pattern_type": "sigma", "pattern": "title: Bitsadmin Download\nid: d059842b-6b9d-4ed1-b5c3-5b89143c6ede\nstatus: experimental\ndescription: Detects usage of bitsadmin downloading a file\nreferences:\n    - https://blog.netspi.com/15-ways-to-download-a-file/#bitsadmin\n    - https://isc.sans.edu/diary/22264\ntags:\n    - attack.defense_evasion\n    - attack.persistence\n    - attack.t1197\n    - attack.s0190\ndate: 2017/03/09\nmodified: 2019/12/06\nauthor: Michael Haag\nlogsource:\n    category: process_creation\n    product: windows\ndetection:\n    selection1:\n        Image:\n            - '*\\bitsadmin.exe'\n        CommandLine:\n            - '* /transfer *'\n    selection2:\n        CommandLine:\n            - '*copy bitsadmin.exe*'\n    condition: selection1 or selection2\nfields:\n    - CommandLine\n    - ParentCommandLine\nfalsepositives:\n    - Some legitimate apps use this, but limited.\nlevel: medium\n", "object_marking_refs": ["marking-definition--0a872d70-1d05-45dd-a25f-031af547a102"], "created_by_ref": "identity--082ca4f0-d825-45b6-aa42-ab9afd1e5503", "type": "indicator", "spec_version": "2.1", "id": "indicator--9c1f48fd-a043-417c-b88e-3f4d758afc69"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--d64d3d2e-7fd4-4d96-8206-91d48d9bea6c", "created": "2020-04-02T07:58:58.102Z", "modified": "2020-04-02T07:58:58.102Z", "source_ref": "indicator--9c1f48fd-a043-417c-b88e-3f4d758afc69", "relationship_type": "indicates", "target_ref": "attack-pattern--c8e87b83-edbb-48d4-9295-4974897525b7"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--9971e70e-6844-400a-ae76-e0429ce4f26c", "created": "2020-04-02T07:58:58.113Z", "modified": "2020-04-02T07:58:58.113Z", "source_ref": "indicator--9c1f48fd-a043-417c-b88e-3f4d758afc69", "relationship_type": "indicates", "target_ref": "tool--64764dc6-a032-495f-8250-1e4c06bdc163"}, {"name": "XSL Script Processing", "description": "Extensible Stylesheet Language (XSL) files are commonly used to describe the processing and rendering of data within XML files, rule detects when adversaries abuse this functionality to execute arbitrary files while potentially bypassing application whitelisting defenses", "created": "2019-10-21T00:00:00.000Z", "modified": "2019-11-04T00:00:00.000Z", "valid_from": "2019-10-21T00:00:00Z", "indicator_types": ["malicious-activity"], "pattern_type": "sigma", "pattern": "title: XSL Script Processing\nid: 05c36dd6-79d6-4a9a-97da-3db20298ab2d\nstatus: experimental\ndescription: Extensible Stylesheet Language (XSL) files are commonly used to describe the processing and rendering of data within XML files, rule detects when adversaries\n    abuse this functionality to execute arbitrary files while potentially bypassing application whitelisting defenses\nauthor: Timur Zinniatullin, oscd.community\ndate: 2019/10/21\nmodified: 2019/11/04\nreferences:\n    - https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1220/T1220.yaml\nlogsource:\n    category: process_creation\n    product: windows\ndetection:\n    selection:\n      - Image|endswith: '\\wmic.exe'\n        CommandLine|contains: '/format' # wmic process list /FORMAT /?\n      - Image|endswith: '\\msxsl.exe'\n    condition: selection\nfalsepositives:\n    - WMIC.exe FP depend on scripts and administrative methods used in the monitored environment\n    - msxsl.exe is not installed by default so unlikely.\nlevel: medium\ntags:\n    - attack.execution\n    - attack.t1220\n", "object_marking_refs": ["marking-definition--0a872d70-1d05-45dd-a25f-031af547a102"], "created_by_ref": "identity--082ca4f0-d825-45b6-aa42-ab9afd1e5503", "type": "indicator", "spec_version": "2.1", "id": "indicator--02c4e404-7b3a-44ea-9b08-1c6bf9a08972"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--838907df-96c7-42bc-b956-a551050689a1", "created": "2020-04-02T07:58:58.128Z", "modified": "2020-04-02T07:58:58.128Z", "source_ref": "indicator--02c4e404-7b3a-44ea-9b08-1c6bf9a08972", "relationship_type": "indicates", "target_ref": "attack-pattern--ebbe170d-aa74-4946-8511-9921243415a3"}, {"name": "Cmdkey Cached Credentials Recon", "description": "Detects usage of cmdkey to look for cached credentials", "created": "2019-01-16T00:00:00.000Z", "valid_from": "2019-01-16T00:00:00Z", "indicator_types": ["malicious-activity"], "pattern_type": "sigma", "pattern": "title: Cmdkey Cached Credentials Recon\nid: 07f8bdc2-c9b3-472a-9817-5a670b872f53\nstatus: experimental\ndescription: Detects usage of cmdkey to look for cached credentials\nreferences:\n    - https://www.peew.pw/blog/2017/11/26/exploring-cmdkey-an-edge-case-for-privilege-escalation\n    - https://technet.microsoft.com/en-us/library/cc754243(v=ws.11).aspx\nauthor: jmallette\ndate: 2019/01/16\ntags:\n    - attack.credential_access\n    - attack.t1003\nlogsource:\n    category: process_creation\n    product: windows\ndetection:\n    selection:\n        Image: '*\\cmdkey.exe'\n        CommandLine: '* /list *'\n    condition: selection\nfields:\n    - CommandLine\n    - ParentCommandLine\n    - User\nfalsepositives:\n    - Legitimate administrative tasks.\nlevel: low\n", "object_marking_refs": ["marking-definition--0a872d70-1d05-45dd-a25f-031af547a102"], "created_by_ref": "identity--082ca4f0-d825-45b6-aa42-ab9afd1e5503", "type": "indicator", "spec_version": "2.1", "id": "indicator--e9cfc820-9794-42f4-8c8e-8680827a21db", "modified": "2020-04-02T07:58:58.132Z"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--ba17d4c9-149f-47ac-8736-0ffe7c9e5436", "created": "2020-04-02T07:58:58.144Z", "modified": "2020-04-02T07:58:58.144Z", "source_ref": "indicator--e9cfc820-9794-42f4-8c8e-8680827a21db", "relationship_type": "indicates", "target_ref": "attack-pattern--0a3ead4e-6d47-4ccb-854c-a6a4f9d96b22"}, {"name": "Terminal Service Process Spawn", "description": "Detects a process spawned by the terminal service server process (this could be an indicator for an exploitation of CVE-2019-0708)", "created": "2019-05-22T00:00:00.000Z", "valid_from": "2019-05-22T00:00:00Z", "indicator_types": ["malicious-activity"], "pattern_type": "sigma", "pattern": "title: Terminal Service Process Spawn\nid: 1012f107-b8f1-4271-af30-5aed2de89b39\nstatus: experimental\ndescription: Detects a process spawned by the terminal service server process (this could be an indicator for an exploitation of CVE-2019-0708)\nreferences:\n    - https://securingtomorrow.mcafee.com/other-blogs/mcafee-labs/rdp-stands-for-really-do-patch-understanding-the-wormable-rdp-vulnerability-cve-2019-0708/\nauthor: Florian Roth\ndate: 2019/05/22\ntags:\n    - car.2013-07-002\nlogsource:\n    product: windows\n    category: process_creation\ndetection:\n    selection:\n        ParentCommandLine: '*\\svchost.exe*termsvcs'\n    filter:\n        Image: '*\\rdpclip.exe'\n    condition: selection and not filter\nfalsepositives:\n    - Unknown\nlevel: high\n\n", "object_marking_refs": ["marking-definition--0a872d70-1d05-45dd-a25f-031af547a102"], "created_by_ref": "identity--082ca4f0-d825-45b6-aa42-ab9afd1e5503", "type": "indicator", "spec_version": "2.1", "id": "indicator--261ffccd-4533-477c-8987-1be97166d9a9", "modified": "2020-04-02T07:58:58.147Z"}, {"name": "Process Dump via Comsvcs DLL", "description": "Detects process memory dump via comsvcs.dll and rundll32", "created": "2019-09-02T00:00:00.000Z", "valid_from": "2019-09-02T00:00:00Z", "indicator_types": ["malicious-activity"], "pattern_type": "sigma", "pattern": "title: Process Dump via Comsvcs DLL\nid: 09e6d5c0-05b8-4ff8-9eeb-043046ec774c\nstatus: experimental\ndescription: Detects process memory dump via comsvcs.dll and rundll32\nreferences:\n    - https://modexp.wordpress.com/2019/08/30/minidumpwritedump-via-com-services-dll/\n    - https://twitter.com/SBousseaden/status/1167417096374050817\nauthor: Modexp (idea)\ndate: 2019/09/02\nlogsource:\n    category: process_creation\n    product: windows\ndetection:\n    rundll_image:\n        Image: '*\\rundll32.exe'\n    rundll_ofn:\n        OriginalFileName: 'RUNDLL32.EXE'\n    selection:\n        CommandLine:\n            - '*comsvcs*MiniDump*full*'\n            - '*comsvcs*MiniDumpW*full*'\n    condition: (rundll_image or rundll_ofn) and selection\nfields:\n    - CommandLine\n    - ParentCommandLine\ntags:\n    - attack.credential_access\n    - attack.t1003\nfalsepositives:\n    - unknown\nlevel: medium\n", "object_marking_refs": ["marking-definition--0a872d70-1d05-45dd-a25f-031af547a102"], "created_by_ref": "identity--082ca4f0-d825-45b6-aa42-ab9afd1e5503", "type": "indicator", "spec_version": "2.1", "id": "indicator--5cd8b461-d4ad-43f0-b41a-3acc6c0b3f72", "modified": "2020-04-02T07:58:58.152Z"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--8dfdde86-7b35-49dd-afc8-4d8e67e23394", "created": "2020-04-02T07:58:58.164Z", "modified": "2020-04-02T07:58:58.164Z", "source_ref": "indicator--5cd8b461-d4ad-43f0-b41a-3acc6c0b3f72", "relationship_type": "indicates", "target_ref": "attack-pattern--0a3ead4e-6d47-4ccb-854c-a6a4f9d96b22"}, {"name": "Suspicious PowerShell Parameter Substring", "description": "Detects suspicious PowerShell invocation with a parameter substring", "created": "2019-01-16T00:00:00.000Z", "valid_from": "2019-01-16T00:00:00Z", "indicator_types": ["malicious-activity"], "pattern_type": "sigma", "pattern": "title: Suspicious PowerShell Parameter Substring\nid: 36210e0d-5b19-485d-a087-c096088885f0\nstatus: experimental\ndescription: Detects suspicious PowerShell invocation with a parameter substring\nreferences:\n    - http://www.danielbohannon.com/blog-1/2017/3/12/powershell-execution-argument-obfuscation-how-it-can-make-detection-easier\ntags:\n    - attack.execution\n    - attack.t1086\nauthor: Florian Roth (rule), Daniel Bohannon (idea), Roberto Rodriguez (Fix)\ndate: 2019/01/16\nlogsource:\n    category: process_creation\n    product: windows\ndetection:\n    selection:\n        Image:\n            - '*\\Powershell.exe'\n        CommandLine:\n            - ' -windowstyle h '\n            - ' -windowstyl h'\n            - ' -windowsty h'\n            - ' -windowst h'\n            - ' -windows h'\n            - ' -windo h'\n            - ' -wind h'\n            - ' -win h'\n            - ' -wi h'\n            - ' -win h '\n            - ' -win hi '\n            - ' -win hid '\n            - ' -win hidd '\n            - ' -win hidde '\n            - ' -NoPr '\n            - ' -NoPro '\n            - ' -NoProf '\n            - ' -NoProfi '\n            - ' -NoProfil '\n            - ' -nonin '\n            - ' -nonint '\n            - ' -noninte '\n            - ' -noninter '\n            - ' -nonintera '\n            - ' -noninterac '\n            - ' -noninteract '\n            - ' -noninteracti '\n            - ' -noninteractiv '\n            - ' -ec '\n            - ' -encodedComman '\n            - ' -encodedComma '\n            - ' -encodedComm '\n            - ' -encodedCom '\n            - ' -encodedCo '\n            - ' -encodedC '\n            - ' -encoded '\n            - ' -encode '\n            - ' -encod '\n            - ' -enco '\n            - ' -en '\n    condition: selection\nfalsepositives:\n    - Penetration tests\nlevel: high\n", "object_marking_refs": ["marking-definition--0a872d70-1d05-45dd-a25f-031af547a102"], "created_by_ref": "identity--082ca4f0-d825-45b6-aa42-ab9afd1e5503", "type": "indicator", "spec_version": "2.1", "id": "indicator--eb7a04e6-11c5-4666-94d1-c3a9ac535a26", "modified": "2020-04-02T07:58:58.171Z"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--0e56afd9-d9d5-4f88-a03a-a1d379bcf9ff", "created": "2020-04-02T07:58:58.185Z", "modified": "2020-04-02T07:58:58.185Z", "source_ref": "indicator--eb7a04e6-11c5-4666-94d1-c3a9ac535a26", "relationship_type": "indicates", "target_ref": "attack-pattern--f4882e23-8aa7-4b12-b28a-b349c12ee9e0"}, {"name": "Whoami Execution", "description": "Detects the execution of whoami, which is often used by attackers after exloitation / privilege escalation but rarely used by administrators", "created": "2018-08-13T00:00:00.000Z", "valid_from": "2018-08-13T00:00:00Z", "indicator_types": ["malicious-activity"], "pattern_type": "sigma", "pattern": "title: Whoami Execution\nid: e28a5a99-da44-436d-b7a0-2afc20a5f413\nstatus: experimental\ndescription: Detects the execution of whoami, which is often used by attackers after exloitation / privilege escalation but rarely used by administrators\nreferences:\n    - https://brica.de/alerts/alert/public/1247926/agent-tesla-keylogger-delivered-inside-a-power-iso-daa-archive/\n    - https://app.any.run/tasks/7eaba74e-c1ea-400f-9c17-5e30eee89906/\nauthor: Florian Roth\ndate: 2018/08/13\ntags:\n    - attack.discovery\n    - attack.t1033\n    - car.2016-03-001\nlogsource:\n    category: process_creation\n    product: windows\ndetection:\n    selection:\n        Image: '*\\whoami.exe'\n    selection2:\n        OriginalFileName: 'whoami.exe'\n    condition: selection or selection2\nfalsepositives:\n    - Admin activity\n    - Scripts and administrative tools used in the monitored environment\nlevel: high\n", "object_marking_refs": ["marking-definition--0a872d70-1d05-45dd-a25f-031af547a102"], "created_by_ref": "identity--082ca4f0-d825-45b6-aa42-ab9afd1e5503", "type": "indicator", "spec_version": "2.1", "id": "indicator--e0c96cc2-5c78-44c8-962e-341359670362", "modified": "2020-04-02T07:58:58.189Z"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--2943e45e-5efa-4226-915c-73a2beb0b9a5", "created": "2020-04-02T07:58:58.198Z", "modified": "2020-04-02T07:58:58.198Z", "source_ref": "indicator--e0c96cc2-5c78-44c8-962e-341359670362", "relationship_type": "indicates", "target_ref": "attack-pattern--03d7999c-1f4c-42cc-8373-e7690d318104"}, {"name": "Suspicious Bitsadmin Job via PowerShell", "description": "Detect download by BITS jobs via PowerShell", "created": "2018-10-30T00:00:00.000Z", "modified": "2019-11-11T00:00:00.000Z", "valid_from": "2018-10-30T00:00:00Z", "indicator_types": ["malicious-activity"], "pattern_type": "sigma", "pattern": "title: Suspicious Bitsadmin Job via PowerShell\nid: f67dbfce-93bc-440d-86ad-a95ae8858c90\nstatus: experimental\ndescription: Detect download by BITS jobs via PowerShell\nreferences:\n    - https://eqllib.readthedocs.io/en/latest/analytics/ec5180c9-721a-460f-bddc-27539a284273.html\n    - https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1197/T1197.md\nauthor: Endgame, JHasenbusch (ported to sigma for oscd.community)\ndate: 2018/10/30\nmodified: 2019/11/11\ntags:\n    - attack.defense_evasion\n    - attack.persistence\n    - attack.t1197\nlogsource:\n    category: process_creation\n    product: windows\ndetection:\n    selection:\n        Image|endswith: '\\powershell.exe'\n        CommandLine|contains: 'Start-BitsTransfer'\n    condition: selection\nfields:\n    - ComputerName\n    - User\n    - CommandLine\nfalsepositives:\n    - Unknown\nlevel: medium\n", "object_marking_refs": ["marking-definition--0a872d70-1d05-45dd-a25f-031af547a102"], "created_by_ref": "identity--082ca4f0-d825-45b6-aa42-ab9afd1e5503", "type": "indicator", "spec_version": "2.1", "id": "indicator--12d69597-0d6a-4314-b84b-b588b0614753"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--d7848958-ff7d-45fa-9eb4-315de7e79b32", "created": "2020-04-02T07:58:58.212Z", "modified": "2020-04-02T07:58:58.212Z", "source_ref": "indicator--12d69597-0d6a-4314-b84b-b588b0614753", "relationship_type": "indicates", "target_ref": "attack-pattern--c8e87b83-edbb-48d4-9295-4974897525b7"}, {"name": "Windows Processes Suspicious Parent Directory", "description": "Detect suspicious parent processes of well-known Windows processes", "created": "2019-02-23T00:00:00.000Z", "modified": "2019-08-20T00:00:00.000Z", "valid_from": "2019-02-23T00:00:00Z", "indicator_types": ["malicious-activity"], "pattern_type": "sigma", "pattern": "title: Windows Processes Suspicious Parent Directory\nid: 96036718-71cc-4027-a538-d1587e0006a7\nstatus: experimental\ndescription: Detect suspicious parent processes of well-known Windows processes\nauthor: vburov\nreferences:\n    - https://securitybytes.io/blue-team-fundamentals-part-two-windows-processes-759fe15965e2\n    - https://www.carbonblack.com/2014/06/10/screenshot-demo-hunt-evil-faster-than-ever-with-carbon-black/\n    - https://www.13cubed.com/downloads/windows_process_genealogy_v2.pdf\n    - https://attack.mitre.org/techniques/T1036/\ndate: 2019/02/23\nmodified: 2019/08/20\ntags:\n    - attack.defense_evasion\n    - attack.t1036\nlogsource:\n    category: process_creation\n    product: windows\ndetection:\n    selection:\n        Image:\n            - '*\\svchost.exe'\n            - '*\\taskhost.exe'\n            - '*\\lsm.exe'\n            - '*\\lsass.exe'\n            - '*\\services.exe'\n            - '*\\lsaiso.exe'\n            - '*\\csrss.exe'\n            - '*\\wininit.exe'\n            - '*\\winlogon.exe'\n    filter:\n        ParentImage:\n            - '*\\System32\\\\*'\n            - '*\\SysWOW64\\\\*'\n            - '*\\SavService.exe'\n            - '*\\Windows Defender\\\\*\\MsMpEng.exe'\n    filter_null:\n        ParentImage: null\n    condition: selection and not filter and not filter_null\nfalsepositives:\n    - Some security products seem to spawn these\nlevel: low\n", "object_marking_refs": ["marking-definition--0a872d70-1d05-45dd-a25f-031af547a102"], "created_by_ref": "identity--082ca4f0-d825-45b6-aa42-ab9afd1e5503", "type": "indicator", "spec_version": "2.1", "id": "indicator--8d8c026f-a0ca-453c-96ab-f2034d335416"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--b8938cd7-3282-4ce9-b207-d2a6d1138b24", "created": "2020-04-02T07:58:58.230Z", "modified": "2020-04-02T07:58:58.230Z", "source_ref": "indicator--8d8c026f-a0ca-453c-96ab-f2034d335416", "relationship_type": "indicates", "target_ref": "attack-pattern--42e8de7b-37b2-4258-905a-6897815e58e0"}, {"name": "Renamed ZOHO Dctask64", "description": "Detects a renamed dctask64.exe used for process injection, command execution, process creation with a signed binary by ZOHO Corporation", "created": "2020-01-28T00:00:00.000Z", "valid_from": "2020-01-28T00:00:00Z", "indicator_types": ["malicious-activity"], "pattern_type": "sigma", "pattern": "title: Renamed ZOHO Dctask64\nid: 340a090b-c4e9-412e-bb36-b4b16fe96f9b\nstatus: experimental\ndescription: Detects a renamed dctask64.exe used for process injection, command execution, process creation with a signed binary by ZOHO Corporation\nreferences:\n    - https://twitter.com/gN3mes1s/status/1222088214581825540\n    - https://twitter.com/gN3mes1s/status/1222095963789111296\n    - https://twitter.com/gN3mes1s/status/1222095371175911424\nauthor: Florian Roth\ndate: 2020/01/28\ntags:\n    - attack.defense_evasion\n    - attack.t1055\nlogsource:\n    category: process_creation\n    product: windows\ndetection:\n    selection:\n        Imphash: '6834B1B94E49701D77CCB3C0895E1AFD'\n    filter:\n        Image|endswith: '\\dctask64.exe'\n    condition: selection and not filter\nfields:\n    - CommandLine\n    - ParentCommandLine\n    - ParentImage\nfalsepositives:\n    - Unknown yet\nlevel: high\n", "object_marking_refs": ["marking-definition--0a872d70-1d05-45dd-a25f-031af547a102"], "created_by_ref": "identity--082ca4f0-d825-45b6-aa42-ab9afd1e5503", "type": "indicator", "spec_version": "2.1", "id": "indicator--4e498190-510d-4562-87fe-6af3b7581023", "modified": "2020-04-02T07:58:58.234Z"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--73794e94-0bf3-4566-bbc8-b5154a5f0314", "created": "2020-04-02T07:58:58.247Z", "modified": "2020-04-02T07:58:58.247Z", "source_ref": "indicator--4e498190-510d-4562-87fe-6af3b7581023", "relationship_type": "indicates", "target_ref": "attack-pattern--43e7dc91-05b2-474c-b9ac-2ed4fe101f4d"}, {"name": "Suspicious Process Start Locations", "description": "Detects suspicious process run from unusual locations", "created": "2019-01-16T00:00:00.000Z", "valid_from": "2019-01-16T00:00:00Z", "indicator_types": ["malicious-activity"], "pattern_type": "sigma", "pattern": "title: Suspicious Process Start Locations\nid: 15b75071-74cc-47e0-b4c6-b43744a62a2b\ndescription: Detects suspicious process run from unusual locations\nstatus: experimental\nreferences:\n    - https://car.mitre.org/wiki/CAR-2013-05-002\nauthor: juju4\ndate: 2019/01/16\ntags:\n    - attack.defense_evasion\n    - attack.t1036\n    - car.2013-05-002\nlogsource:\n    category: process_creation\n    product: windows\ndetection:\n    selection:\n        Image:\n            - '*:\\RECYCLER\\\\*'\n            - '*:\\SystemVolumeInformation\\\\*'\n            - 'C:\\\\Windows\\\\Tasks\\\\*'\n            - 'C:\\\\Windows\\\\debug\\\\*'\n            - 'C:\\\\Windows\\\\fonts\\\\*'\n            - 'C:\\\\Windows\\\\help\\\\*'\n            - 'C:\\\\Windows\\\\drivers\\\\*'\n            - 'C:\\\\Windows\\\\addins\\\\*'\n            - 'C:\\\\Windows\\\\cursors\\\\*'\n            - 'C:\\\\Windows\\\\system32\\tasks\\\\*'\n\n    condition: selection\nfalsepositives:\n    - False positives depend on scripts and administrative tools used in the monitored environment\nlevel: medium\n", "object_marking_refs": ["marking-definition--0a872d70-1d05-45dd-a25f-031af547a102"], "created_by_ref": "identity--082ca4f0-d825-45b6-aa42-ab9afd1e5503", "type": "indicator", "spec_version": "2.1", "id": "indicator--70602375-5642-4d43-a105-7181574a163c", "modified": "2020-04-02T07:58:58.251Z"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--fe75a656-74f2-4205-8a2c-9e057c14ccd9", "created": "2020-04-02T07:58:58.263Z", "modified": "2020-04-02T07:58:58.263Z", "source_ref": "indicator--70602375-5642-4d43-a105-7181574a163c", "relationship_type": "indicates", "target_ref": "attack-pattern--42e8de7b-37b2-4258-905a-6897815e58e0"}, {"name": "Execution in Webserver Root Folder", "description": "Detects a suspicious program execution in a web service root folder (filter out false positives)", "created": "2019-01-16T00:00:00.000Z", "valid_from": "2019-01-16T00:00:00Z", "indicator_types": ["malicious-activity"], "pattern_type": "sigma", "pattern": "title: Execution in Webserver Root Folder\nid: 35efb964-e6a5-47ad-bbcd-19661854018d\nstatus: experimental\ndescription: Detects a suspicious program execution in a web service root folder (filter out false positives)\nauthor: Florian Roth\ndate: 2019/01/16\ntags:\n    - attack.persistence\n    - attack.t1100\nlogsource:\n    category: process_creation\n    product: windows\ndetection:\n    selection:\n        Image:\n            - '*\\wwwroot\\\\*'\n            - '*\\wmpub\\\\*'\n            - '*\\htdocs\\\\*'\n    filter:\n        Image:\n            - '*bin\\\\*'\n            - '*\\Tools\\\\*'\n            - '*\\SMSComponent\\\\*'\n        ParentImage:\n            - '*\\services.exe'\n    condition: selection and not filter\nfields:\n    - CommandLine\n    - ParentCommandLine\nfalsepositives:\n    - Various applications\n    - Tools that include ping or nslookup command invocations\nlevel: medium\n", "object_marking_refs": ["marking-definition--0a872d70-1d05-45dd-a25f-031af547a102"], "created_by_ref": "identity--082ca4f0-d825-45b6-aa42-ab9afd1e5503", "type": "indicator", "spec_version": "2.1", "id": "indicator--d76f7b39-4f38-4ef0-94da-79fb11d0c3ae", "modified": "2020-04-02T07:58:58.268Z"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--e00a0e91-bcca-4acf-8ca9-044ee38ee8f3", "created": "2020-04-02T07:58:58.280Z", "modified": "2020-04-02T07:58:58.280Z", "source_ref": "indicator--d76f7b39-4f38-4ef0-94da-79fb11d0c3ae", "relationship_type": "indicates", "target_ref": "attack-pattern--c16e5409-ee53-4d79-afdc-4099dc9292df"}, {"name": "Ps.exe Renamed SysInternals Tool", "description": "Detects renamed SysInternals tool execution with a binary named ps.exe as used by Dragonfly APT group and documented in TA17-293A report", "created": "2017-10-22T00:00:00.000Z", "valid_from": "2017-10-22T00:00:00Z", "indicator_types": ["malicious-activity"], "pattern_type": "sigma", "pattern": "title: Ps.exe Renamed SysInternals Tool\nid: 18da1007-3f26-470f-875d-f77faf1cab31\ndescription: Detects renamed SysInternals tool execution with a binary named ps.exe as used by Dragonfly APT group and documented in TA17-293A report\nreferences:\n    - https://www.us-cert.gov/ncas/alerts/TA17-293A\ntags:\n    - attack.defense_evasion\n    - attack.g0035\n    - attack.t1036\n    - car.2013-05-009\nauthor: Florian Roth\ndate: 2017/10/22\nlogsource:\n    category: process_creation\n    product: windows\ndetection:\n    selection:\n        CommandLine: 'ps.exe -accepteula'\n    condition: selection\nfalsepositives:\n    - Renamed SysInternals tool\nlevel: high", "object_marking_refs": ["marking-definition--0a872d70-1d05-45dd-a25f-031af547a102"], "created_by_ref": "identity--082ca4f0-d825-45b6-aa42-ab9afd1e5503", "type": "indicator", "spec_version": "2.1", "id": "indicator--9b7eb5ab-d9f6-4993-9705-097db6061a72", "modified": "2020-04-02T07:58:58.283Z"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--30f4edda-6298-4ba5-80ed-7b0160b93132", "created": "2020-04-02T07:58:58.295Z", "modified": "2020-04-02T07:58:58.295Z", "source_ref": "indicator--9b7eb5ab-d9f6-4993-9705-097db6061a72", "relationship_type": "indicates", "target_ref": "intrusion-set--1c63d4ec-0a75-4daa-b1df-0d11af3d3cc1"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--bfa00ac0-f0ab-43b2-9eca-04f554eed277", "created": "2020-04-02T07:58:58.306Z", "modified": "2020-04-02T07:58:58.306Z", "source_ref": "indicator--9b7eb5ab-d9f6-4993-9705-097db6061a72", "relationship_type": "indicates", "target_ref": "attack-pattern--42e8de7b-37b2-4258-905a-6897815e58e0"}, {"name": "Non Interactive PowerShell", "description": "Detects non-interactive PowerShell activity by looking at powershell.exe with not explorer.exe as a parent.", "created": "2019-09-12T00:00:00.000Z", "modified": "2019-11-10T00:00:00.000Z", "valid_from": "2019-09-12T00:00:00Z", "indicator_types": ["malicious-activity"], "pattern_type": "sigma", "pattern": "title: Non Interactive PowerShell\nid: f4bbd493-b796-416e-bbf2-121235348529\ndescription: Detects non-interactive PowerShell activity by looking at powershell.exe with not explorer.exe as a parent.\nstatus: experimental\ndate: 2019/09/12\nmodified: 2019/11/10\nauthor: Roberto Rodriguez @Cyb3rWard0g (rule), oscd.community (improvements)\nreferences:\n    - https://github.com/Cyb3rWard0g/ThreatHunter-Playbook/tree/master/playbooks/windows/02_execution/T1086_powershell/basic_powershell_execution.md\ntags:\n    - attack.execution\n    - attack.t1086\nlogsource:\n    category: process_creation\n    product: windows\ndetection:\n    selection: \n        Image|endswith: '\\powershell.exe'\n    filter:\n        ParentImage|endswith: '\\explorer.exe'\n    condition: selection and not filter\nfalsepositives:\n    - Legitimate programs executing PowerShell scripts\nlevel: medium\n", "object_marking_refs": ["marking-definition--0a872d70-1d05-45dd-a25f-031af547a102"], "created_by_ref": "identity--082ca4f0-d825-45b6-aa42-ab9afd1e5503", "type": "indicator", "spec_version": "2.1", "id": "indicator--7bc81fed-58fe-404b-a04d-6eae09d56946"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--e06687ca-75dc-4958-9687-50f71b85193e", "created": "2020-04-02T07:58:58.321Z", "modified": "2020-04-02T07:58:58.321Z", "source_ref": "indicator--7bc81fed-58fe-404b-a04d-6eae09d56946", "relationship_type": "indicates", "target_ref": "attack-pattern--f4882e23-8aa7-4b12-b28a-b349c12ee9e0"}, {"name": "PowerShell Script Run in AppData", "description": "Detects a suspicious command line execution that invokes PowerShell with reference to an AppData folder", "created": "2019-01-09T00:00:00.000Z", "valid_from": "2019-01-09T00:00:00Z", "indicator_types": ["malicious-activity"], "pattern_type": "sigma", "pattern": "title: PowerShell Script Run in AppData\nid: ac175779-025a-4f12-98b0-acdaeb77ea85\nstatus: experimental\ndescription: Detects a suspicious command line execution that invokes PowerShell with reference to an AppData folder\nreferences:\n    - https://twitter.com/JohnLaTwC/status/1082851155481288706\n    - https://app.any.run/tasks/f87f1c4e-47e2-4c46-9cf4-31454c06ce03\ntags:\n    - attack.execution\n    - attack.t1086\nauthor: Florian Roth\ndate: 2019/01/09\nlogsource:\n    category: process_creation\n    product: windows\ndetection:\n    selection:\n        CommandLine:\n            - '* /c powershell*\\AppData\\Local\\\\*'\n            - '* /c powershell*\\AppData\\Roaming\\\\*'\n    condition: selection\nfalsepositives:\n    - Administrative scripts\nlevel: medium\n", "object_marking_refs": ["marking-definition--0a872d70-1d05-45dd-a25f-031af547a102"], "created_by_ref": "identity--082ca4f0-d825-45b6-aa42-ab9afd1e5503", "type": "indicator", "spec_version": "2.1", "id": "indicator--46f40cff-91c9-4744-9729-8fef33938f0b", "modified": "2020-04-02T07:58:58.325Z"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--4d4d783f-ab94-456d-83de-e4d1cbdddfa4", "created": "2020-04-02T07:58:58.336Z", "modified": "2020-04-02T07:58:58.336Z", "source_ref": "indicator--46f40cff-91c9-4744-9729-8fef33938f0b", "relationship_type": "indicates", "target_ref": "attack-pattern--f4882e23-8aa7-4b12-b28a-b349c12ee9e0"}, {"name": "Audio Capture via SoundRecorder", "description": "Detect attacker collecting audio via SoundRecorder application", "created": "2019-10-24T00:00:00.000Z", "modified": "2019-11-11T00:00:00.000Z", "valid_from": "2019-10-24T00:00:00Z", "indicator_types": ["malicious-activity"], "pattern_type": "sigma", "pattern": "title: Audio Capture via SoundRecorder\nid: 83865853-59aa-449e-9600-74b9d89a6d6e\ndescription: Detect attacker collecting audio via SoundRecorder application\nstatus: experimental\nauthor: E.M. Anhaus (orignally from Atomic Blue Detections, Endgame), oscd.community\ndate: 2019/10/24\nmodified: 2019/11/11\nreferences:\n    - https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1123/T1123.yaml\n    - https://eqllib.readthedocs.io/en/latest/analytics/f72a98cb-7b3d-4100-99c3-a138b6e9ff6e.html\ntags:\n    - attack.collection\n    - attack.t1123\nlogsource:\n    category: process_creation\n    product: windows\ndetection:\n    selection:\n        Image|endswith: '\\SoundRecorder.exe'\n        CommandLine|contains: '/FILE'\n    condition: selection\nfalsepositives:\n    - Legitimate audio capture by legitimate user\nlevel: medium\n", "object_marking_refs": ["marking-definition--0a872d70-1d05-45dd-a25f-031af547a102"], "created_by_ref": "identity--082ca4f0-d825-45b6-aa42-ab9afd1e5503", "type": "indicator", "spec_version": "2.1", "id": "indicator--e7824b31-52b1-4913-bf82-4a16867bdedf"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--ae4dcc9e-0996-4096-8d6a-b5437ec1095c", "created": "2020-04-02T07:58:58.351Z", "modified": "2020-04-02T07:58:58.351Z", "source_ref": "indicator--e7824b31-52b1-4913-bf82-4a16867bdedf", "relationship_type": "indicates", "target_ref": "attack-pattern--1035cdf2-3e5f-446f-a7a7-e8f6d7925967"}, {"name": "Baby Shark Activity", "description": "Detects activity that could be related to Baby Shark malware", "created": "2019-02-24T00:00:00.000Z", "valid_from": "2019-02-24T00:00:00Z", "indicator_types": ["malicious-activity"], "pattern_type": "sigma", "pattern": "title: Baby Shark Activity\nid: 2b30fa36-3a18-402f-a22d-bf4ce2189f35\nstatus: experimental\ndescription: Detects activity that could be related to Baby Shark malware\nreferences:\n    - https://unit42.paloaltonetworks.com/new-babyshark-malware-targets-u-s-national-security-think-tanks/\ntags:\n    - attack.execution\n    - attack.t1059\n    - attack.t1086\n    - attack.discovery\n    - attack.t1012\n    - attack.defense_evasion\n    - attack.t1170\nlogsource:\n    category: process_creation\n    product: windows\nauthor: Florian Roth\ndate: 2019/02/24\ndetection:\n    selection:\n        CommandLine:\n            - reg query \"HKEY_CURRENT_USER\\Software\\Microsoft\\Terminal Server Client\\Default\"\n            - powershell.exe mshta.exe http*\n            - cmd.exe /c taskkill /im cmd.exe\n    condition: selection\nfalsepositives:\n    - unknown\nlevel: high\n", "object_marking_refs": ["marking-definition--0a872d70-1d05-45dd-a25f-031af547a102"], "created_by_ref": "identity--082ca4f0-d825-45b6-aa42-ab9afd1e5503", "type": "indicator", "spec_version": "2.1", "id": "indicator--dd660d79-0688-41ca-8fcd-96bb808affc7", "modified": "2020-04-02T07:58:58.359Z"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--2ab4d7d5-fd76-4bb0-bea2-9fbf38f72855", "created": "2020-04-02T07:58:58.371Z", "modified": "2020-04-02T07:58:58.371Z", "source_ref": "indicator--dd660d79-0688-41ca-8fcd-96bb808affc7", "relationship_type": "indicates", "target_ref": "attack-pattern--7385dfaf-6886-4229-9ecd-6fd678040830"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--e207084f-1460-4e05-b47c-f033406783d2", "created": "2020-04-02T07:58:58.382Z", "modified": "2020-04-02T07:58:58.382Z", "source_ref": "indicator--dd660d79-0688-41ca-8fcd-96bb808affc7", "relationship_type": "indicates", "target_ref": "attack-pattern--f4882e23-8aa7-4b12-b28a-b349c12ee9e0"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--4db46930-53e4-4784-a0a0-92ff537c4acd", "created": "2020-04-02T07:58:58.392Z", "modified": "2020-04-02T07:58:58.392Z", "source_ref": "indicator--dd660d79-0688-41ca-8fcd-96bb808affc7", "relationship_type": "indicates", "target_ref": "attack-pattern--c32f7008-9fea-41f7-8366-5eb9b74bd896"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--feb02889-835a-46ba-8a51-b66b41bb9bd1", "created": "2020-04-02T07:58:58.402Z", "modified": "2020-04-02T07:58:58.402Z", "source_ref": "indicator--dd660d79-0688-41ca-8fcd-96bb808affc7", "relationship_type": "indicates", "target_ref": "attack-pattern--a127c32c-cbb0-4f9d-be07-881a792408ec"}, {"name": "Fsutil Suspicious Invocation", "description": "Detects suspicious parameters of fsutil (deleting USN journal, configuring it with small size..). Might be used by ransomwares during the attack (seen by NotPetya and others)", "created": "2019-09-26T00:00:00.000Z", "modified": "2019-11-11T00:00:00.000Z", "valid_from": "2019-09-26T00:00:00Z", "indicator_types": ["malicious-activity"], "pattern_type": "sigma", "pattern": "title: Fsutil Suspicious Invocation\nid: add64136-62e5-48ea-807e-88638d02df1e\ndescription: Detects suspicious parameters of fsutil (deleting USN journal, configuring it with small size..). Might be used by ransomwares during the attack (seen by NotPetya and others)\nauthor: Ecco, E.M. Anhaus, oscd.community\ndate: 2019/09/26\nmodified: 2019/11/11\nlevel: high\nreferences:\n    - https://docs.microsoft.com/en-us/windows-server/administration/windows-commands/fsutil-usn\n    - https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1070/T1070.yaml\n    - https://eqllib.readthedocs.io/en/latest/analytics/c91f422a-5214-4b17-8664-c5fcf115c0a2.html\ntags:\n    - attack.defense_evasion\n    - attack.t1070\nlogsource:\n    category: process_creation\n    product: windows\ndetection:\n    binary_1:\n        Image|endswith: '\\fsutil.exe'\n    binary_2:\n        OriginalFileName: 'fsutil.exe'\n    selection:\n        CommandLine|contains: \n            - 'deletejournal'  # usn deletejournal ==> generally ransomware or attacker\n            - 'createjournal'  # usn createjournal ==> can modify config to set it to a tiny size\n    condition: (1 of binary_*) and selection\nfalsepositives:\n    - Admin activity\n    - Scripts and administrative tools used in the monitored environment\n", "object_marking_refs": ["marking-definition--0a872d70-1d05-45dd-a25f-031af547a102"], "created_by_ref": "identity--082ca4f0-d825-45b6-aa42-ab9afd1e5503", "type": "indicator", "spec_version": "2.1", "id": "indicator--1c927ce9-caf9-486f-b32f-97b40e416feb"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--35cac5ff-99ab-4158-a245-19664a4009e6", "created": "2020-04-02T07:58:58.418Z", "modified": "2020-04-02T07:58:58.418Z", "source_ref": "indicator--1c927ce9-caf9-486f-b32f-97b40e416feb", "relationship_type": "indicates", "target_ref": "attack-pattern--799ace7f-e227-4411-baa0-8868704f2a69"}, {"name": "Reconnaissance Activity with Net Command", "description": "Detects a set of commands often used in recon stages by different attack groups", "created": "2018-08-22T00:00:00.000Z", "modified": "2018-12-11T00:00:00.000Z", "valid_from": "2018-08-22T00:00:00Z", "indicator_types": ["malicious-activity"], "pattern_type": "sigma", "pattern": "title: Reconnaissance Activity with Net Command\nid: 2887e914-ce96-435f-8105-593937e90757\nstatus: experimental\ndescription: Detects a set of commands often used in recon stages by different attack groups\nreferences:\n    - https://twitter.com/haroonmeer/status/939099379834658817\n    - https://twitter.com/c_APT_ure/status/939475433711722497\n    - https://www.fireeye.com/blog/threat-research/2016/05/targeted_attacksaga.html\nauthor: Florian Roth, Markus Neis\ndate: 2018/08/22\nmodified: 2018/12/11\ntags:\n    - attack.discovery\n    - attack.t1087\n    - attack.t1082\n    - car.2016-03-001\nlogsource:\n    category: process_creation\n    product: windows\ndetection:\n    selection:\n        CommandLine:\n            - tasklist\n            - net time\n            - systeminfo\n            - whoami\n            - nbtstat\n            - net start\n            - '*\\net1 start'\n            - qprocess\n            - nslookup\n            - hostname.exe\n            - '*\\net1 user /domain'\n            - '*\\net1 group /domain'\n            - '*\\net1 group \"domain admins\" /domain'\n            - '*\\net1 group \"Exchange Trusted Subsystem\" /domain'\n            - '*\\net1 accounts /domain'\n            - '*\\net1 user net localgroup administrators'\n            - netstat -an\n    timeframe: 15s\n    condition: selection | count() by CommandLine > 4\nfalsepositives:\n    - False positives depend on scripts and administrative tools used in the monitored environment\nlevel: medium\n", "object_marking_refs": ["marking-definition--0a872d70-1d05-45dd-a25f-031af547a102"], "created_by_ref": "identity--082ca4f0-d825-45b6-aa42-ab9afd1e5503", "type": "indicator", "spec_version": "2.1", "id": "indicator--ca4c4a63-e6d9-4505-9aa6-16dc2f2c94c9"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--b4c8d22c-fe81-4ed0-8f26-810eb380aa8d", "created": "2020-04-02T07:58:58.436Z", "modified": "2020-04-02T07:58:58.436Z", "source_ref": "indicator--ca4c4a63-e6d9-4505-9aa6-16dc2f2c94c9", "relationship_type": "indicates", "target_ref": "attack-pattern--72b74d71-8169-42aa-92e0-e7b04b9f5a08"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--044ac64e-d71b-4b13-92c3-05aa50445369", "created": "2020-04-02T07:58:58.446Z", "modified": "2020-04-02T07:58:58.446Z", "source_ref": "indicator--ca4c4a63-e6d9-4505-9aa6-16dc2f2c94c9", "relationship_type": "indicates", "target_ref": "attack-pattern--354a7f88-63fb-41b5-a801-ce3b377b36f1"}, {"name": "Wsreset UAC Bypass", "description": "Detects a method that uses Wsreset.exe tool that can be used to reset the Windows Store to bypass UAC", "created": "2020-01-30T00:00:00.000Z", "valid_from": "2020-01-30T00:00:00Z", "indicator_types": ["malicious-activity"], "pattern_type": "sigma", "pattern": "title: Wsreset UAC Bypass\nid: bdc8918e-a1d5-49d1-9db7-ea0fd91aa2ae\nstatus: experimental\ndescription: Detects a method that uses Wsreset.exe tool that can be used to reset the Windows Store to bypass UAC \nreferences:\n    - https://lolbas-project.github.io/lolbas/Binaries/Wsreset/\n    - https://www.activecyber.us/activelabs/windows-uac-bypass\n    - https://twitter.com/ReaQta/status/1222548288731217921\nauthor: Florian Roth\ndate: 2020/01/30\ntags:\n    - attack.defense_evasion\n    - attack.execution\n    - attack.t1088\nlogsource:\n    category: process_creation\n    product: windows\ndetection:\n    selection:\n        ParentImage|endswith:\n            - '\\WSreset.exe'\n    condition: selection\nfields:\n    - CommandLine\nfalsepositives:\n    - Unknown sub processes of Wsreset.exe\nlevel: high\n", "object_marking_refs": ["marking-definition--0a872d70-1d05-45dd-a25f-031af547a102"], "created_by_ref": "identity--082ca4f0-d825-45b6-aa42-ab9afd1e5503", "type": "indicator", "spec_version": "2.1", "id": "indicator--bcf8d527-2f5c-4df8-98c6-21f63507eea3", "modified": "2020-04-02T07:58:58.450Z"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--154115f0-f0a4-4627-9f54-463146db4a45", "created": "2020-04-02T07:58:58.461Z", "modified": "2020-04-02T07:58:58.461Z", "source_ref": "indicator--bcf8d527-2f5c-4df8-98c6-21f63507eea3", "relationship_type": "indicates", "target_ref": "attack-pattern--ca1a3f50-5ebd-41f8-8320-2c7d6a6e88be"}, {"name": "Suspicious Netsh DLL Persistence", "description": "Detects persitence via netsh helper", "created": "2019-10-25T00:00:00.000Z", "modified": "2019-10-25T00:00:00.000Z", "valid_from": "2019-10-25T00:00:00Z", "indicator_types": ["malicious-activity"], "pattern_type": "sigma", "pattern": "title: Suspicious Netsh DLL Persistence\nid: 56321594-9087-49d9-bf10-524fe8479452\ndescription: Detects persitence via netsh helper\nstatus: test\nreferences:\n    - https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1060/T1060.yaml\ntags:\n    - attack.persistence\n    - attack.t1060\ndate: 2019/10/25\nmodified: 2019/10/25\nauthor: Victor Sergeev, oscd.community\nlogsource:\n    category: process_creation\n    product: windows   \ndetection:\n    selection:\n        Image|endswith: '\\netsh.exe'\n        CommandLine|contains|all:\n            - 'add'\n            - 'helper'\n    condition: selection\nfields:\n    - ComputerName\n    - User\n    - CommandLine\n    - ParentCommandLine\nfalsepositives:\n    - Unkown\nlevel: high\n", "object_marking_refs": ["marking-definition--0a872d70-1d05-45dd-a25f-031af547a102"], "created_by_ref": "identity--082ca4f0-d825-45b6-aa42-ab9afd1e5503", "type": "indicator", "spec_version": "2.1", "id": "indicator--87f03847-d6ba-4106-b5fc-bf14403f05aa"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--7ce8e0e5-8476-4d21-9d5d-af4968354d85", "created": "2020-04-02T07:58:58.474Z", "modified": "2020-04-02T07:58:58.474Z", "source_ref": "indicator--87f03847-d6ba-4106-b5fc-bf14403f05aa", "relationship_type": "indicates", "target_ref": "attack-pattern--9422fc14-1c43-410d-ab0f-a709b76c72dc"}, {"name": "Shadow Copies Access via Symlink", "description": "Shadow Copies storage symbolic link creation using operating systems utilities", "created": "2019-10-22T00:00:00.000Z", "valid_from": "2019-10-22T00:00:00Z", "indicator_types": ["malicious-activity"], "pattern_type": "sigma", "pattern": "title: Shadow Copies Access via Symlink\nid: 40b19fa6-d835-400c-b301-41f3a2baacaf\ndescription: Shadow Copies storage symbolic link creation using operating systems utilities\nauthor: Teymur Kheirkhabarov, oscd.community\ndate: 2019/10/22\nreferences:\n    - https://www.slideshare.net/heirhabarov/hunting-for-credentials-dumping-in-windows-environment\ntags:\n    - attack.credential_access\n    - attack.t1003\nlogsource:\n    category: process_creation\n    product: windows\ndetection:\n    selection:\n        CommandLine|contains|all: \n          - mklink\n          - HarddiskVolumeShadowCopy\n    condition: selection\nfalsepositives:\n    - Legitimate administrator working with shadow copies, access for backup purposes\nstatus: experimental\nlevel: medium\n", "object_marking_refs": ["marking-definition--0a872d70-1d05-45dd-a25f-031af547a102"], "created_by_ref": "identity--082ca4f0-d825-45b6-aa42-ab9afd1e5503", "type": "indicator", "spec_version": "2.1", "id": "indicator--467dad1a-a29d-46e1-948d-f30e8873e8a9", "modified": "2020-04-02T07:58:58.478Z"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--751d8712-4cc4-489d-a42f-28892150e775", "created": "2020-04-02T07:58:58.488Z", "modified": "2020-04-02T07:58:58.488Z", "source_ref": "indicator--467dad1a-a29d-46e1-948d-f30e8873e8a9", "relationship_type": "indicates", "target_ref": "attack-pattern--0a3ead4e-6d47-4ccb-854c-a6a4f9d96b22"}, {"name": "Scheduled Task Creation", "description": "Detects the creation of scheduled tasks in user session", "created": "2019-01-16T00:00:00.000Z", "valid_from": "2019-01-16T00:00:00Z", "indicator_types": ["malicious-activity"], "pattern_type": "sigma", "pattern": "title: Scheduled Task Creation\nid: 92626ddd-662c-49e3-ac59-f6535f12d189\nstatus: experimental\ndescription: Detects the creation of scheduled tasks in user session\nauthor: Florian Roth\ndate: 2019/01/16\nlogsource:\n    category: process_creation\n    product: windows\ndetection:\n    selection:\n        Image: '*\\schtasks.exe'\n        CommandLine: '* /create *'\n    filter:\n        User: NT AUTHORITY\\SYSTEM\n    condition: selection and not filter\nfields:\n    - CommandLine\n    - ParentCommandLine\ntags:\n    - attack.execution\n    - attack.persistence\n    - attack.privilege_escalation\n    - attack.t1053\n    - attack.s0111\n    - car.2013-08-001\nfalsepositives:\n    - Administrative activity\n    - Software installation\nlevel: low\n", "object_marking_refs": ["marking-definition--0a872d70-1d05-45dd-a25f-031af547a102"], "created_by_ref": "identity--082ca4f0-d825-45b6-aa42-ab9afd1e5503", "type": "indicator", "spec_version": "2.1", "id": "indicator--0e2032e1-25c5-4992-b1e3-8467959469d7", "modified": "2020-04-02T07:58:58.493Z"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--58ba2b04-c5eb-45da-9c57-b5db0c07a134", "created": "2020-04-02T07:58:58.502Z", "modified": "2020-04-02T07:58:58.502Z", "source_ref": "indicator--0e2032e1-25c5-4992-b1e3-8467959469d7", "relationship_type": "indicates", "target_ref": "attack-pattern--35dd844a-b219-4e2b-a6bb-efa9a75995a9"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--4169b54e-8b0a-4f03-b1f9-743bda07d1f6", "created": "2020-04-02T07:58:58.510Z", "modified": "2020-04-02T07:58:58.510Z", "source_ref": "indicator--0e2032e1-25c5-4992-b1e3-8467959469d7", "relationship_type": "indicates", "target_ref": "tool--c9703cd3-141c-43a0-a926-380082be5d04"}, {"name": "Webshell Detection With Command Line Keywords", "description": "Detects certain command line parameters often used during reconnaissance activity via web shells", "created": "2017-01-01T00:00:00.000Z", "modified": "2019-10-26T00:00:00.000Z", "valid_from": "2017-01-01T00:00:00Z", "indicator_types": ["malicious-activity"], "pattern_type": "sigma", "pattern": "title: Webshell Detection With Command Line Keywords\nid: bed2a484-9348-4143-8a8a-b801c979301c\ndescription: Detects certain command line parameters often used during reconnaissance activity via web shells\nauthor: Florian Roth\nreference:\n    - https://www.fireeye.com/blog/threat-research/2013/08/breaking-down-the-china-chopper-web-shell-part-ii.html\ndate: 2017/01/01\nmodified: 2019/10/26\ntags:\n    - attack.privilege_escalation\n    - attack.persistence\n    - attack.t1100\nlogsource:\n    category: process_creation\n    product: windows\ndetection:\n    selection:\n        ParentImage:\n            - '*\\apache*'\n            - '*\\tomcat*'\n            - '*\\w3wp.exe'\n            - '*\\php-cgi.exe'\n            - '*\\nginx.exe'\n            - '*\\httpd.exe'\n        CommandLine:\n            - '*whoami*'\n            - '*net user *'\n            - '*ping -n *'\n            - '*systeminfo'\n            - '*&cd&echo*'\n            - '*cd /d*'  # https://www.computerhope.com/cdhlp.htm\n    condition: selection\nfields:\n    - CommandLine\n    - ParentCommandLine\nfalsepositives:\n    - unknown\nlevel: high\n", "object_marking_refs": ["marking-definition--0a872d70-1d05-45dd-a25f-031af547a102"], "created_by_ref": "identity--082ca4f0-d825-45b6-aa42-ab9afd1e5503", "type": "indicator", "spec_version": "2.1", "id": "indicator--a3fd4311-c65d-4348-8954-0c3cae14d063"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--9d843de5-bb4c-4de8-a0f4-f77b882bc7ea", "created": "2020-04-02T07:58:58.525Z", "modified": "2020-04-02T07:58:58.525Z", "source_ref": "indicator--a3fd4311-c65d-4348-8954-0c3cae14d063", "relationship_type": "indicates", "target_ref": "attack-pattern--c16e5409-ee53-4d79-afdc-4099dc9292df"}, {"name": "Process Dump via Rundll32 and Comsvcs.dll", "description": "Detects a process memory dump performed via ordinal function 24 in comsvcs.dll", "created": "2020-02-18T00:00:00.000Z", "valid_from": "2020-02-18T00:00:00Z", "indicator_types": ["malicious-activity"], "pattern_type": "sigma", "pattern": "title: Process Dump via Rundll32 and Comsvcs.dll\nid: 646ea171-dded-4578-8a4d-65e9822892e3\ndescription: Detects a process memory dump performed via ordinal function 24 in comsvcs.dll\nstatus: experimental\nreferences:\n    - https://twitter.com/shantanukhande/status/1229348874298388484\nauthor: Florian Roth\ndate: 2020/02/18\ntags:\n    - attack.defense_evasion\n    - attack.t1036\n    - attack.credential_access\n    - attack.t1003\n    - car.2013-05-009\nlogsource:\n    category: process_creation\n    product: windows\ndetection:\n    selection:\n        CommandLine|contains:\n            - 'comsvcs.dll,#24'\n            - 'comsvcs.dll,MiniDump'\n    condition: selection\nfalsepositives:\n    - Unlikely, because no one should dump the process memory in that way\nlevel: high\n", "object_marking_refs": ["marking-definition--0a872d70-1d05-45dd-a25f-031af547a102"], "created_by_ref": "identity--082ca4f0-d825-45b6-aa42-ab9afd1e5503", "type": "indicator", "spec_version": "2.1", "id": "indicator--045daab8-7eed-40a1-a570-382d05d3afa4", "modified": "2020-04-02T07:58:58.529Z"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--647dc98f-c728-463a-abfa-161d20b7a41e", "created": "2020-04-02T07:58:58.539Z", "modified": "2020-04-02T07:58:58.539Z", "source_ref": "indicator--045daab8-7eed-40a1-a570-382d05d3afa4", "relationship_type": "indicates", "target_ref": "attack-pattern--42e8de7b-37b2-4258-905a-6897815e58e0"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--49d282d3-d75d-48aa-b5c3-ae64a74f77ff", "created": "2020-04-02T07:58:58.546Z", "modified": "2020-04-02T07:58:58.546Z", "source_ref": "indicator--045daab8-7eed-40a1-a570-382d05d3afa4", "relationship_type": "indicates", "target_ref": "attack-pattern--0a3ead4e-6d47-4ccb-854c-a6a4f9d96b22"}, {"name": "Bypass UAC via WSReset.exe", "description": "Identifies use of WSReset.exe to bypass User Account Control. Adversaries use this technique to execute privileged processes.", "created": "2019-10-24T00:00:00.000Z", "modified": "2019-11-11T00:00:00.000Z", "valid_from": "2019-10-24T00:00:00Z", "indicator_types": ["malicious-activity"], "pattern_type": "sigma", "pattern": "title: Bypass UAC via WSReset.exe\nid: d797268e-28a9-49a7-b9a8-2f5039011c5c\ndescription: Identifies use of WSReset.exe to bypass User Account Control. Adversaries use this technique to execute privileged processes.\nstatus: experimental\nauthor: E.M. Anhaus (orignally from Atomic Blue Detections, Tony Lambert), oscd.community\ndate: 2019/10/24\nmodified: 2019/11/11\nreferences:\n    - https://eqllib.readthedocs.io/en/latest/analytics/532b5ed4-7930-11e9-8f5c-d46d6d62a49e.html\ntags:\n    - attack.privilege_escalation\n    - attack.t1088\nlogsource:\n    category: process_creation\n    product: windows\ndetection:\n    selection:\n        ParentImage|endswith: '\\wsreset.exe'\n    filter:\n        Image|endswith: '\\conhost.exe'\n    condition: selection and not filter\nfalsepositives:\n    - Unknown\nlevel: high\n", "object_marking_refs": ["marking-definition--0a872d70-1d05-45dd-a25f-031af547a102"], "created_by_ref": "identity--082ca4f0-d825-45b6-aa42-ab9afd1e5503", "type": "indicator", "spec_version": "2.1", "id": "indicator--7405dc4c-1aca-4459-bc95-f14a41e10bde"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--02d70896-9c9a-41e9-aa51-8738faeb29c1", "created": "2020-04-02T07:58:58.558Z", "modified": "2020-04-02T07:58:58.558Z", "source_ref": "indicator--7405dc4c-1aca-4459-bc95-f14a41e10bde", "relationship_type": "indicates", "target_ref": "attack-pattern--ca1a3f50-5ebd-41f8-8320-2c7d6a6e88be"}, {"name": "Netsh Port Forwarding", "description": "Detects netsh commands that configure a port forwarding", "created": "2019-01-29T00:00:00.000Z", "valid_from": "2019-01-29T00:00:00Z", "indicator_types": ["malicious-activity"], "pattern_type": "sigma", "pattern": "title: Netsh Port Forwarding\nid: 322ed9ec-fcab-4f67-9a34-e7c6aef43614\ndescription: Detects netsh commands that configure a port forwarding\nreferences:\n    - https://www.fireeye.com/blog/threat-research/2019/01/bypassing-network-restrictions-through-rdp-tunneling.html\ndate: 2019/01/29\ntags:\n    - attack.lateral_movement\n    - attack.command_and_control\n    - attack.t1090\nstatus: experimental\nauthor: Florian Roth\nlogsource:\n    category: process_creation\n    product: windows\ndetection:\n    selection:\n        CommandLine:\n            - netsh interface portproxy add v4tov4 *\n    condition: selection\nfalsepositives:\n    - Legitimate administration\nlevel: medium\n", "object_marking_refs": ["marking-definition--0a872d70-1d05-45dd-a25f-031af547a102"], "created_by_ref": "identity--082ca4f0-d825-45b6-aa42-ab9afd1e5503", "type": "indicator", "spec_version": "2.1", "id": "indicator--5abc1b94-4313-4a2c-b0ee-f3817607109b", "modified": "2020-04-02T07:58:58.561Z"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--9cc724c6-36fe-4b85-a644-696f3ad8b7d9", "created": "2020-04-02T07:58:58.570Z", "modified": "2020-04-02T07:58:58.570Z", "source_ref": "indicator--5abc1b94-4313-4a2c-b0ee-f3817607109b", "relationship_type": "indicates", "target_ref": "attack-pattern--731f4f55-b6d0-41d1-a7a9-072a66389aea"}, {"name": "DNS Exfiltration Tools Execution", "description": "Well-known DNS Exfiltration tools execution", "created": "2019-10-24T00:00:00.000Z", "valid_from": "2019-10-24T00:00:00Z", "indicator_types": ["malicious-activity"], "pattern_type": "sigma", "pattern": "title: DNS Exfiltration Tools Execution\nid: 98a96a5a-64a0-4c42-92c5-489da3866cb0\ndescription: Well-known DNS Exfiltration tools execution\nstatus: experimental\nauthor: Daniil Yugoslavskiy, oscd.community\ndate: 2019/10/24\ntags:\n    - attack.exfiltration\n    - attack.t1048\nlogsource:\n    category: process_creation\n    product: windows\ndetection:\n    selection:\n        - Image|endswith: '*\\iodine.exe'\n        - Image|contains: '\\dnscat2'\n    condition: selection\nfalsepositives:\n    - Legitimate usage of iodine or dnscat2 \u2014 DNS Exfiltration tools (unlikely)\nlevel: high\n", "object_marking_refs": ["marking-definition--0a872d70-1d05-45dd-a25f-031af547a102"], "created_by_ref": "identity--082ca4f0-d825-45b6-aa42-ab9afd1e5503", "type": "indicator", "spec_version": "2.1", "id": "indicator--ebc06380-7ea5-43b5-8a10-61fcaa995610", "modified": "2020-04-02T07:58:58.573Z"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--c9dfecd4-ae56-4c9b-9515-37a1958759e2", "created": "2020-04-02T07:58:58.584Z", "modified": "2020-04-02T07:58:58.584Z", "source_ref": "indicator--ebc06380-7ea5-43b5-8a10-61fcaa995610", "relationship_type": "indicates", "target_ref": "attack-pattern--a19e86f8-1c0a-4fea-8407-23b73d615776"}, {"name": "Net.exe User Account Creation", "description": "Identifies creation of local users via the net.exe command", "created": "2018-10-30T00:00:00.000Z", "modified": "2019-11-11T00:00:00.000Z", "valid_from": "2018-10-30T00:00:00Z", "indicator_types": ["malicious-activity"], "pattern_type": "sigma", "pattern": "title: Net.exe User Account Creation\nid: cd219ff3-fa99-45d4-8380-a7d15116c6dc\nstatus: experimental\ndescription: Identifies creation of local users via the net.exe command\nreferences:\n    - https://eqllib.readthedocs.io/en/latest/analytics/014c3f51-89c6-40f1-ac9c-5688f26090ab.html\n    - https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1136/T1136.yaml\nauthor: Endgame, JHasenbusch (adapted to sigma for oscd.community)\ndate: 2018/10/30\nmodified: 2019/11/11\ntags:\n    - attack.persistence\n    - attack.credential_access\n    - attack.t1136\nlogsource:\n    category: process_creation\n    product: windows\ndetection:\n    selection:\n        Image|endswith: \n            - '\\net.exe'\n            - '\\net1.exe'\n        CommandLine|contains|all: \n            - 'user'\n            - 'add'\n    condition: selection\nfields:\n    - ComputerName\n    - User\n    - CommandLine\nfalsepositives:\n    - Legit user creation\n    - Better use event ids for user creation rather than command line rules\nlevel: medium\n", "object_marking_refs": ["marking-definition--0a872d70-1d05-45dd-a25f-031af547a102"], "created_by_ref": "identity--082ca4f0-d825-45b6-aa42-ab9afd1e5503", "type": "indicator", "spec_version": "2.1", "id": "indicator--55d38a5d-ce95-4603-9da1-eba1f1c1c64f"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--64ee1e83-d959-4252-90bc-be809f16253c", "created": "2020-04-02T07:58:58.597Z", "modified": "2020-04-02T07:58:58.597Z", "source_ref": "indicator--55d38a5d-ce95-4603-9da1-eba1f1c1c64f", "relationship_type": "indicates", "target_ref": "attack-pattern--e01be9c5-e763-4caf-aeb7-000b416aef67"}, {"name": "Service Execution", "description": "Detects manual service execution (start) via system utilities", "created": "2019-10-21T00:00:00.000Z", "modified": "2019-11-04T00:00:00.000Z", "valid_from": "2019-10-21T00:00:00Z", "indicator_types": ["malicious-activity"], "pattern_type": "sigma", "pattern": "title: Service Execution\nid: 2a072a96-a086-49fa-bcb5-15cc5a619093\nstatus: experimental\ndescription: Detects manual service execution (start) via system utilities\nauthor: Timur Zinniatullin, Daniil Yugoslavskiy, oscd.community\ndate: 2019/10/21\nmodified: 2019/11/04\nreferences:\n    - https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1035/T1035.yaml\nlogsource:\n    category: process_creation\n    product: windows\ndetection:\n    selection:\n        Image|endswith: \n            - '\\net.exe'\n            - '\\net1.exe'\n        CommandLine|contains: ' start ' # space character after the 'start' keyword indicates that a service name follows, in contrast to `net start` discovery expression \n    condition: selection\nfalsepositives:\n    - Legitimate administrator or user executes a service for legitimate reason\nlevel: low\ntags:\n    - attack.execution\n    - attack.t1035\n", "object_marking_refs": ["marking-definition--0a872d70-1d05-45dd-a25f-031af547a102"], "created_by_ref": "identity--082ca4f0-d825-45b6-aa42-ab9afd1e5503", "type": "indicator", "spec_version": "2.1", "id": "indicator--64939cff-3adb-4acc-a16a-589767aad228"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--3bfc539f-532f-49e1-b01c-8cfb77a58429", "created": "2020-04-02T07:58:58.611Z", "modified": "2020-04-02T07:58:58.611Z", "source_ref": "indicator--64939cff-3adb-4acc-a16a-589767aad228", "relationship_type": "indicates", "target_ref": "attack-pattern--f44731de-ea9f-406d-9b83-30ecbb9b4392"}, {"name": "Possible App Whitelisting Bypass via WinDbg/CDB as a Shellcode Runner", "description": "Launch 64-bit shellcode from the x64_calc.wds file using cdb.exe.", "created": "2019-10-26T00:00:00.000Z", "modified": "2019-11-04T00:00:00.000Z", "valid_from": "2019-10-26T00:00:00Z", "indicator_types": ["malicious-activity"], "pattern_type": "sigma", "pattern": "title: Possible App Whitelisting Bypass via WinDbg/CDB as a Shellcode Runner\nid: b5c7395f-e501-4a08-94d4-57fe7a9da9d2\nstatus: experimental\ndescription: Launch 64-bit shellcode from the x64_calc.wds file using cdb.exe.\nreferences:\n    - https://github.com/LOLBAS-Project/LOLBAS/blob/master/yml/OtherMSBinaries/Cdb.yml\n    - http://www.exploit-monday.com/2016/08/windbg-cdb-shellcode-runner.html\nauthor: Beyu Denis, oscd.community\ndate: 2019/10/26\nmodified: 2019/11/04\ntags:\n    - attack.defense_evasion\n    - attack.execution\n    - attack.t1218\nlevel: medium\nlogsource:\n    category: process_creation\n    product: windows\ndetection:\n    selection:\n        Image|endswith: '\\cdb.exe'\n        CommandLine|contains: '-cf'\n    condition: selection\nfalsepositives:\n    - Legitimate use of debugging tools\n", "object_marking_refs": ["marking-definition--0a872d70-1d05-45dd-a25f-031af547a102"], "created_by_ref": "identity--082ca4f0-d825-45b6-aa42-ab9afd1e5503", "type": "indicator", "spec_version": "2.1", "id": "indicator--ef81755e-700a-40b2-83c2-bafd3a979e63"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--a7e51251-1ebd-4b84-9bbc-ea622dbd8369", "created": "2020-04-02T07:58:58.624Z", "modified": "2020-04-02T07:58:58.624Z", "source_ref": "indicator--ef81755e-700a-40b2-83c2-bafd3a979e63", "relationship_type": "indicates", "target_ref": "attack-pattern--457c7820-d331-465a-915e-42f85500ccc4"}, {"name": "Change Default File Association", "description": "When a file is opened, the default program used to open the file (also called the file association or handler) is checked. File association selections are stored in the Windows Registry and can be edited by users, administrators, or programs that have Registry access or by administrators using the built-in assoc utility. Applications can modify the file association for a given file extension to call an arbitrary program when a file with the given extension is opened.", "created": "2019-10-21T00:00:00.000Z", "modified": "2019-11-04T00:00:00.000Z", "valid_from": "2019-10-21T00:00:00Z", "indicator_types": ["malicious-activity"], "pattern_type": "sigma", "pattern": "title: Change Default File Association\nid: 3d3aa6cd-6272-44d6-8afc-7e88dfef7061\nstatus: experimental\ndescription: When a file is opened, the default program used to open the file (also called the file association or handler) is checked. File association selections\n    are stored in the Windows Registry and can be edited by users, administrators, or programs that have Registry access or by administrators using the built-in assoc\n    utility. Applications can modify the file association for a given file extension to call an arbitrary program when a file with the given extension is opened.\nauthor: Timur Zinniatullin, oscd.community\ndate: 2019/10/21\nmodified: 2019/11/04\nreferences:\n    - https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1042/T1042.yaml\nlogsource:\n    category: process_creation\n    product: windows\ndetection:\n    selection:\n        CommandLine|contains|all:\n          - 'cmd'\n          - '/c'\n          - 'assoc'\n    condition: selection\nfalsepositives:\n    - Admin activity\nfields:\n    - Image\n    - CommandLine\n    - User\n    - LogonGuid\n    - Hashes\n    - ParentProcessGuid\n    - ParentCommandLine\nlevel: low\ntags:\n    - attack.persistence\n    - attack.t1042\n", "object_marking_refs": ["marking-definition--0a872d70-1d05-45dd-a25f-031af547a102"], "created_by_ref": "identity--082ca4f0-d825-45b6-aa42-ab9afd1e5503", "type": "indicator", "spec_version": "2.1", "id": "indicator--e7fee99d-2762-42ad-8fa4-e17bfcdcca4c"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--a6f78fca-5aea-4208-8c67-eccc96d23fc5", "created": "2020-04-02T07:58:58.639Z", "modified": "2020-04-02T07:58:58.639Z", "source_ref": "indicator--e7fee99d-2762-42ad-8fa4-e17bfcdcca4c", "relationship_type": "indicates", "target_ref": "attack-pattern--68c96494-1a50-403e-8844-69a6af278c68"}, {"name": "WScript or CScript Dropper", "description": "Detects wscript/cscript executions of scripts located in user directories", "created": "2019-01-16T00:00:00.000Z", "valid_from": "2019-01-16T00:00:00Z", "indicator_types": ["malicious-activity"], "pattern_type": "sigma", "pattern": "title: WScript or CScript Dropper\nid: cea72823-df4d-4567-950c-0b579eaf0846\nstatus: experimental\ndescription: Detects wscript/cscript executions of scripts located in user directories\nauthor: Margaritis Dimitrios (idea), Florian Roth (rule)\ndate: 2019/01/16\ntags:\n    - attack.defense_evasion\n    - attack.execution\n    - attack.t1064\nlogsource:\n    category: process_creation\n    product: windows\ndetection:\n    selection:\n        Image:\n            - '*\\wscript.exe'\n            - '*\\cscript.exe'\n        CommandLine:\n            - '* C:\\Users\\\\*.jse *'\n            - '* C:\\Users\\\\*.vbe *'\n            - '* C:\\Users\\\\*.js *'\n            - '* C:\\Users\\\\*.vba *'\n            - '* C:\\Users\\\\*.vbs *'\n            - '* C:\\ProgramData\\\\*.jse *'\n            - '* C:\\ProgramData\\\\*.vbe *'\n            - '* C:\\ProgramData\\\\*.js *'\n            - '* C:\\ProgramData\\\\*.vba *'\n            - '* C:\\ProgramData\\\\*.vbs *'\n    falsepositive:\n        ParentImage: '*\\winzip*'\n    condition: selection and not falsepositive\nfields:\n    - CommandLine\n    - ParentCommandLine\nfalsepositives:\n    - Winzip\n    - Other self-extractors\nlevel: high\n", "object_marking_refs": ["marking-definition--0a872d70-1d05-45dd-a25f-031af547a102"], "created_by_ref": "identity--082ca4f0-d825-45b6-aa42-ab9afd1e5503", "type": "indicator", "spec_version": "2.1", "id": "indicator--47c36af3-8093-43d2-9c0f-8b58dcfe9337", "modified": "2020-04-02T07:58:58.644Z"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--9123a466-b1a0-4908-a4e8-b739b1b69df3", "created": "2020-04-02T07:58:58.655Z", "modified": "2020-04-02T07:58:58.655Z", "source_ref": "indicator--47c36af3-8093-43d2-9c0f-8b58dcfe9337", "relationship_type": "indicates", "target_ref": "attack-pattern--7fd87010-3a00-4da3-b905-410525e8ec44"}, {"name": "ZOHO Dctask64 Process Injection", "description": "Detects suspicious process injection using ZOHO's dctask64.exe", "created": "2020-01-28T00:00:00.000Z", "valid_from": "2020-01-28T00:00:00Z", "indicator_types": ["malicious-activity"], "pattern_type": "sigma", "pattern": "title: ZOHO Dctask64 Process Injection\nid: 6345b048-8441-43a7-9bed-541133633d7a\nstatus: experimental\ndescription: Detects suspicious process injection using ZOHO's dctask64.exe\nreferences:\n    - https://twitter.com/gN3mes1s/status/1222088214581825540\n    - https://twitter.com/gN3mes1s/status/1222095963789111296\n    - https://twitter.com/gN3mes1s/status/1222095371175911424\nauthor: Florian Roth\ndate: 2020/01/28\ntags:\n    - attack.defense_evasion\n    - attack.t1055\nlogsource:\n    category: process_creation\n    product: windows\ndetection:\n    selection:\n        Image|endswith:\n            - '\\dctask64.exe'\n    filter:\n        CommandLine|contains:\n            - 'DesktopCentral_Agent\\agent'\n    condition: selection and not filter\nfields:\n    - CommandLine\n    - ParentCommandLine\n    - ParentImage\nfalsepositives:\n    - Unknown yet\nlevel: high\n", "object_marking_refs": ["marking-definition--0a872d70-1d05-45dd-a25f-031af547a102"], "created_by_ref": "identity--082ca4f0-d825-45b6-aa42-ab9afd1e5503", "type": "indicator", "spec_version": "2.1", "id": "indicator--0697993b-642d-4826-b85d-363702e54f19", "modified": "2020-04-02T07:58:58.662Z"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--be239c31-d8bd-4d1a-9c5c-cde90be89e9b", "created": "2020-04-02T07:58:58.674Z", "modified": "2020-04-02T07:58:58.674Z", "source_ref": "indicator--0697993b-642d-4826-b85d-363702e54f19", "relationship_type": "indicates", "target_ref": "attack-pattern--43e7dc91-05b2-474c-b9ac-2ed4fe101f4d"}, {"name": "Exploit for CVE-2017-8759", "description": "Detects Winword starting uncommon sub process csc.exe as used in exploits for CVE-2017-8759", "created": "2017-09-15T00:00:00.000Z", "valid_from": "2017-09-15T00:00:00Z", "indicator_types": ["malicious-activity"], "pattern_type": "sigma", "pattern": "title: Exploit for CVE-2017-8759\nid: fdd84c68-a1f6-47c9-9477-920584f94905\ndescription: Detects Winword starting uncommon sub process csc.exe as used in exploits for CVE-2017-8759\nreferences:\n    - https://www.hybrid-analysis.com/sample/0b4ef455e385b750d9f90749f1467eaf00e46e8d6c2885c260e1b78211a51684?environmentId=100\n    - https://www.reverse.it/sample/0b4ef455e385b750d9f90749f1467eaf00e46e8d6c2885c260e1b78211a51684?environmentId=100\ntags:\n    - attack.execution\n    - attack.t1203\nauthor: Florian Roth\ndate: 2017/09/15\nlogsource:\n    category: process_creation\n    product: windows\ndetection:\n    selection:\n        ParentImage: '*\\WINWORD.EXE'\n        Image: '*\\csc.exe'\n    condition: selection\nfalsepositives:\n    - Unknown\nlevel: critical\n", "object_marking_refs": ["marking-definition--0a872d70-1d05-45dd-a25f-031af547a102"], "created_by_ref": "identity--082ca4f0-d825-45b6-aa42-ab9afd1e5503", "type": "indicator", "spec_version": "2.1", "id": "indicator--9fc5f58a-67f8-4be6-ad29-dca2ae741e51", "modified": "2020-04-02T07:58:58.677Z"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--3d39ec95-d9dc-42d0-aabf-a0b64bf3d936", "created": "2020-04-02T07:58:58.687Z", "modified": "2020-04-02T07:58:58.687Z", "source_ref": "indicator--9fc5f58a-67f8-4be6-ad29-dca2ae741e51", "relationship_type": "indicates", "target_ref": "attack-pattern--be2dcee9-a7a7-4e38-afd6-21b31ecc3d63"}, {"name": "Empire Monkey", "description": "Detects EmpireMonkey APT reported Activity", "created": "2019-04-02T00:00:00.000Z", "valid_from": "2019-04-02T00:00:00Z", "indicator_types": ["malicious-activity"], "pattern_type": "sigma", "pattern": "action: global\ntitle: Empire Monkey\nid: 10152a7b-b566-438f-a33c-390b607d1c8d\ndescription: Detects EmpireMonkey APT reported Activity\nreferences:\n    - https://app.any.run/tasks/a4107649-8cb0-41af-ad75-113152d4d57b\ntags:\n    - attack.t1086\n    - attack.execution\ndate: 2019/04/02\nauthor: Markus Neis\ndetection:\n    condition: 1 of them\nfalsepositives:\n    - Very Unlikely \nlevel: critical\n", "object_marking_refs": ["marking-definition--0a872d70-1d05-45dd-a25f-031af547a102"], "created_by_ref": "identity--082ca4f0-d825-45b6-aa42-ab9afd1e5503", "type": "indicator", "spec_version": "2.1", "id": "indicator--0778c556-5865-4823-be12-a04c06863306", "modified": "2020-04-02T07:58:58.690Z"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--5c96508e-4ae4-40ed-b4c2-30c6ef7f0ff9", "created": "2020-04-02T07:58:58.697Z", "modified": "2020-04-02T07:58:58.697Z", "source_ref": "indicator--0778c556-5865-4823-be12-a04c06863306", "relationship_type": "indicates", "target_ref": "attack-pattern--f4882e23-8aa7-4b12-b28a-b349c12ee9e0"}, {"name": "Squirrel Lolbin", "description": "Detects Possible Squirrel Packages Manager as Lolbin", "created": "2019-11-12T00:00:00.000Z", "valid_from": "2019-11-12T00:00:00Z", "indicator_types": ["malicious-activity"], "pattern_type": "sigma", "pattern": "title: Squirrel Lolbin\nid: fa4b21c9-0057-4493-b289-2556416ae4d7\nstatus: experimental\ndescription: Detects Possible Squirrel Packages Manager as Lolbin\nreferences:\n    - http://www.hexacorn.com/blog/2019/03/30/sqirrel-packages-manager-as-a-lolbin-a-k-a-many-electron-apps-are-lolbins-by-default/\n    - http://www.hexacorn.com/blog/2018/08/16/squirrel-as-a-lolbin/\ntags:\n    - attack.execution\nauthor: Karneades / Markus Neis\ndate: 2019/11/12\nfalsepositives:\n    - 1Clipboard\n    - Beaker Browser\n    - Caret\n    - Collectie\n    - Discord\n    - Figma\n    - Flow\n    - Ghost\n    - GitHub Desktop\n    - GitKraken\n    - Hyper\n    - Insomnia\n    - JIBO\n    - Kap\n    - Kitematic\n    - Now Desktop\n    - Postman\n    - PostmanCanary\n    - Rambox\n    - Simplenote\n    - Skype\n    - Slack\n    - SourceTree\n    - Stride\n    - Svgsus\n    - WebTorrent\n    - WhatsApp\n    - WordPress.com\n    - atom\n    - gitkraken\n    - slack\n    - teams\nlevel: high\nlogsource:\n    category: process_creation\n    product: windows\ndetection:\n    selection:\n        Image:\n            - '*\\update.exe'                           # Check if folder Name matches executed binary  \\\\(?P<first>[^\\\\]*)\\\\Update.*Start.{2}(?P<second>\\1)\\.exe (example: https://regex101.com/r/SGSQGz/2)\n        CommandLine:\n            - '*--processStart*.exe*'\n            - '*--processStartAndWait*.exe*'\n            - '*--createShortcut*.exe*'\n    condition: selection\n", "object_marking_refs": ["marking-definition--0a872d70-1d05-45dd-a25f-031af547a102"], "created_by_ref": "identity--082ca4f0-d825-45b6-aa42-ab9afd1e5503", "type": "indicator", "spec_version": "2.1", "id": "indicator--a8a538dc-15d7-4c19-8225-d59146f2fc20", "modified": "2020-04-02T07:58:58.704Z"}, {"name": "Microsoft Office Product Spawning Windows Shell", "description": "Detects a Windows command line executable started from Microsoft Word, Excel, Powerpoint, Publisher and Visio.", "created": "2018-04-06T00:00:00.000Z", "valid_from": "2018-04-06T00:00:00Z", "indicator_types": ["malicious-activity"], "pattern_type": "sigma", "pattern": "title: Microsoft Office Product Spawning Windows Shell\nid: 438025f9-5856-4663-83f7-52f878a70a50\nstatus: experimental\ndescription: Detects a Windows command line executable started from Microsoft Word, Excel, Powerpoint, Publisher and Visio.\nreferences:\n    - https://www.hybrid-analysis.com/sample/465aabe132ccb949e75b8ab9c5bda36d80cf2fd503d52b8bad54e295f28bbc21?environmentId=100\n    - https://mgreen27.github.io/posts/2018/04/02/DownloadCradle.html\ntags:\n    - attack.execution\n    - attack.defense_evasion\n    - attack.t1059\n    - attack.t1202\n    - car.2013-02-003\n    - car.2014-04-003\nauthor: Michael Haag, Florian Roth, Markus Neis\ndate: 2018/04/06\nlogsource:\n    category: process_creation\n    product: windows\ndetection:\n    selection:\n        ParentImage:\n            - '*\\WINWORD.EXE'\n            - '*\\EXCEL.EXE'\n            - '*\\POWERPNT.exe'\n            - '*\\MSPUB.exe'\n            - '*\\VISIO.exe'\n            - '*\\OUTLOOK.EXE'\n        Image:\n            - '*\\cmd.exe'\n            - '*\\powershell.exe'\n            - '*\\wscript.exe'\n            - '*\\cscript.exe'\n            - '*\\sh.exe'\n            - '*\\bash.exe'\n            - '*\\scrcons.exe'\n            - '*\\schtasks.exe'\n            - '*\\regsvr32.exe'\n            - '*\\hh.exe'\n            - '*\\wmic.exe'  # https://app.any.run/tasks/c903e9c8-0350-440c-8688-3881b556b8e0/\n            - '*\\mshta.exe'\n            - '*\\rundll32.exe'\n            - '*\\msiexec.exe'\n            - '*\\forfiles.exe'\n            - '*\\scriptrunner.exe'\n            - '*\\mftrace.exe'\n            - '*\\AppVLP.exe'\n            - '*\\svchost.exe'  # https://www.vmray.com/analyses/2d2fa29185ad/report/overview.html\n    condition: selection\nfields:\n    - CommandLine\n    - ParentCommandLine\nfalsepositives:\n    - unknown\nlevel: high\n", "object_marking_refs": ["marking-definition--0a872d70-1d05-45dd-a25f-031af547a102"], "created_by_ref": "identity--082ca4f0-d825-45b6-aa42-ab9afd1e5503", "type": "indicator", "spec_version": "2.1", "id": "indicator--696bbbd1-e30c-4d97-8077-bbe74119f0e6", "modified": "2020-04-02T07:58:58.712Z"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--c39e6d90-32f8-4809-8e5a-70fb89548809", "created": "2020-04-02T07:58:58.722Z", "modified": "2020-04-02T07:58:58.722Z", "source_ref": "indicator--696bbbd1-e30c-4d97-8077-bbe74119f0e6", "relationship_type": "indicates", "target_ref": "attack-pattern--7385dfaf-6886-4229-9ecd-6fd678040830"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--ff5e86ce-5e20-4beb-9022-bec7cc3d3d79", "created": "2020-04-02T07:58:58.733Z", "modified": "2020-04-02T07:58:58.733Z", "source_ref": "indicator--696bbbd1-e30c-4d97-8077-bbe74119f0e6", "relationship_type": "indicates", "target_ref": "attack-pattern--3b0e52ce-517a-4614-a523-1bd5deef6c5e"}, {"name": "PowerShell Base64 Encoded Shellcode", "description": "Detects Base64 encoded Shellcode", "created": "2018-11-17T00:00:00.000Z", "valid_from": "2018-11-17T00:00:00Z", "indicator_types": ["malicious-activity"], "pattern_type": "sigma", "pattern": "title: PowerShell Base64 Encoded Shellcode\nid: 2d117e49-e626-4c7c-bd1f-c3c0147774c8\ndescription: Detects Base64 encoded Shellcode\nstatus: experimental\nreferences:\n    - https://twitter.com/cyb3rops/status/1063072865992523776\nauthor: Florian Roth\ndate: 2018/11/17\ntags:\n    - attack.defense_evasion\n    - attack.t1036\nlogsource:\n    category: process_creation\n    product: windows\ndetection:\n    selection1:\n        CommandLine: '*AAAAYInlM*'\n    selection2:\n        CommandLine:\n            - '*OiCAAAAYInlM*'\n            - '*OiJAAAAYInlM*'\n    condition: selection1 and selection2\nfalsepositives:\n    - Unknown\nlevel: critical\n", "object_marking_refs": ["marking-definition--0a872d70-1d05-45dd-a25f-031af547a102"], "created_by_ref": "identity--082ca4f0-d825-45b6-aa42-ab9afd1e5503", "type": "indicator", "spec_version": "2.1", "id": "indicator--1db8ef91-27f4-4fbc-b33a-dfe300cdf58f", "modified": "2020-04-02T07:58:58.737Z"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--8129556a-de5d-42ed-aa23-0e57b38118fa", "created": "2020-04-02T07:58:58.748Z", "modified": "2020-04-02T07:58:58.748Z", "source_ref": "indicator--1db8ef91-27f4-4fbc-b33a-dfe300cdf58f", "relationship_type": "indicates", "target_ref": "attack-pattern--42e8de7b-37b2-4258-905a-6897815e58e0"}, {"name": "Local Accounts Discovery", "description": "Local accounts, System Owner/User discovery using operating systems utilities", "created": "2019-10-21T00:00:00.000Z", "modified": "2019-11-04T00:00:00.000Z", "valid_from": "2019-10-21T00:00:00Z", "indicator_types": ["malicious-activity"], "pattern_type": "sigma", "pattern": "title: Local Accounts Discovery\nid: 502b42de-4306-40b4-9596-6f590c81f073\nstatus: experimental\ndescription: Local accounts, System Owner/User discovery using operating systems utilities\nauthor: Timur Zinniatullin, Daniil Yugoslavskiy, oscd.community\ndate: 2019/10/21\nmodified: 2019/11/04\nreferences:\n    - https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1033/T1033.yaml\nlogsource:\n    category: process_creation\n    product: windows\ndetection:\n    selection_1:\n      - Image|endswith: '\\whoami.exe'\n      - Image|endswith: '\\wmic.exe'\n        CommandLine|contains|all:\n            - 'useraccount'\n            - 'get'\n      - Image|endswith: \n            - '\\quser.exe'\n            - '\\qwinsta.exe'\n      - Image|endswith: '\\cmdkey.exe'\n        CommandLine|contains: '/list'\n      - Image|endswith: '\\cmd.exe'\n        CommandLine|contains|all: \n            - '/c'\n            - 'dir '\n            - '\\Users\\'\n    filter_1:\n        CommandLine|contains:\n            - ' rmdir '       # don't match on 'dir'   \"C:\\Windows\\System32\\cmd.exe\" /q /c rmdir /s /q \"C:\\Users\\XX\\AppData\\Local\\Microsoft\\OneDrive\\19.232.1124.0005\"\n    selection_2:\n        Image|endswith:\n            - '\\net.exe'\n            - '\\net1.exe'\n        CommandLine|contains: 'user'\n    filter_2:\n        CommandLine|contains:\n            - '/domain'       # local account discovery only\n            - '/add'          # discovery only\n            - '/delete'       # discovery only\n            - '/active'       # discovery only\n            - '/expires'      # discovery only\n            - '/passwordreq'  # discovery only\n            - '/scriptpath'   # discovery only\n            - '/times'        # discovery only\n            - '/workstations' # discovery only\n    condition: (selection_1 and not filter_1) or ( selection_2 and not filter_2)\nfields:\n    - Image\n    - CommandLine\n    - User\n    - LogonGuid\n    - Hashes\n    - ParentProcessGuid\n    - ParentCommandLine\nfalsepositives:\n     - Legitimate administrator or user enumerates local users for legitimate reason\nlevel: low\ntags:\n    - attack.discovery\n    - attack.t1033\n    - attack.t1087\n", "object_marking_refs": ["marking-definition--0a872d70-1d05-45dd-a25f-031af547a102"], "created_by_ref": "identity--082ca4f0-d825-45b6-aa42-ab9afd1e5503", "type": "indicator", "spec_version": "2.1", "id": "indicator--5709c8ff-e104-4b4a-b1dd-c37b6220594b"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--042ede05-c7ac-486d-8bb7-16caace13ba7", "created": "2020-04-02T07:58:58.769Z", "modified": "2020-04-02T07:58:58.769Z", "source_ref": "indicator--5709c8ff-e104-4b4a-b1dd-c37b6220594b", "relationship_type": "indicates", "target_ref": "attack-pattern--03d7999c-1f4c-42cc-8373-e7690d318104"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--8f218f47-c712-405c-a113-eba975a4431a", "created": "2020-04-02T07:58:58.777Z", "modified": "2020-04-02T07:58:58.777Z", "source_ref": "indicator--5709c8ff-e104-4b4a-b1dd-c37b6220594b", "relationship_type": "indicates", "target_ref": "attack-pattern--72b74d71-8169-42aa-92e0-e7b04b9f5a08"}, {"name": "Regsvr32 Anomaly", "description": "Detects various anomalies in relation to regsvr32.exe", "created": "2019-01-16T00:00:00.000Z", "valid_from": "2019-01-16T00:00:00Z", "indicator_types": ["malicious-activity"], "pattern_type": "sigma", "pattern": "title: Regsvr32 Anomaly\nid: 8e2b24c9-4add-46a0-b4bb-0057b4e6187d\nstatus: experimental\ndescription: Detects various anomalies in relation to regsvr32.exe\nauthor: Florian Roth\ndate: 2019/01/16\nreferences:\n    - https://subt0x10.blogspot.de/2017/04/bypass-application-whitelisting-script.html\ntags:\n    - attack.t1117\n    - attack.defense_evasion\n    - attack.execution\n    - car.2019-04-002\n    - car.2019-04-003\nlogsource:\n    category: process_creation\n    product: windows\ndetection:\n    selection1:\n        Image: '*\\regsvr32.exe'\n        CommandLine: '*\\Temp\\\\*'\n    selection2:\n        Image: '*\\regsvr32.exe'\n        ParentImage: '*\\powershell.exe'\n    selection3:\n        Image: '*\\regsvr32.exe'\n        ParentImage: '*\\cmd.exe'\n    selection4:\n        Image: '*\\regsvr32.exe'\n        CommandLine:\n            - '*/i:http* scrobj.dll'\n            - '*/i:ftp* scrobj.dll'\n    selection5:\n        Image: '*\\wscript.exe'\n        ParentImage: '*\\regsvr32.exe'\n    selection6:\n        Image: '*\\EXCEL.EXE'\n        CommandLine: '*..\\..\\..\\Windows\\System32\\regsvr32.exe *'\n    condition: 1 of them\nfields:\n    - CommandLine\n    - ParentCommandLine\nfalsepositives:\n    - Unknown\nlevel: high\n", "object_marking_refs": ["marking-definition--0a872d70-1d05-45dd-a25f-031af547a102"], "created_by_ref": "identity--082ca4f0-d825-45b6-aa42-ab9afd1e5503", "type": "indicator", "spec_version": "2.1", "id": "indicator--234e5fb0-f754-43a9-bdf7-0427386a33e7", "modified": "2020-04-02T07:58:58.782Z"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--bf29a697-9629-43de-961a-9342b22caa0e", "created": "2020-04-02T07:58:58.793Z", "modified": "2020-04-02T07:58:58.793Z", "source_ref": "indicator--234e5fb0-f754-43a9-bdf7-0427386a33e7", "relationship_type": "indicates", "target_ref": "attack-pattern--68f7e3a1-f09f-4164-9a62-16b648a0dd5a"}, {"name": "Shells Spawned by Web Servers", "description": "Web servers that spawn shell processes could be the result of a successfully placed web shell or an other attack", "created": "2019-01-16T00:00:00.000Z", "modified": "2020-03-25T00:00:00.000Z", "valid_from": "2019-01-16T00:00:00Z", "indicator_types": ["malicious-activity"], "pattern_type": "sigma", "pattern": "title: Shells Spawned by Web Servers\nid: 8202070f-edeb-4d31-a010-a26c72ac5600\nstatus: experimental\ndescription: Web servers that spawn shell processes could be the result of a successfully placed web shell or an other attack\nauthor: Thomas Patzke\ndate: 2019/01/16\nmodified: 2020/03/25\nlogsource:\n    category: process_creation\n    product: windows\ndetection:\n    selection:\n        ParentImage:\n            - '*\\w3wp.exe'\n            - '*\\httpd.exe'\n            - '*\\nginx.exe'\n            - '*\\php-cgi.exe'\n            - '*\\tomcat.exe'\n        Image:\n            - '*\\cmd.exe'\n            - '*\\sh.exe'\n            - '*\\bash.exe'\n            - '*\\powershell.exe'\n            - '*\\bitsadmin.exe'\n    condition: selection\nfields:\n    - CommandLine\n    - ParentCommandLine\ntags:\n    - attack.privilege_escalation\n    - attack.persistence\n    - attack.t1100\nfalsepositives:\n    - Particular web applications may spawn a shell process legitimately\nlevel: high\n", "object_marking_refs": ["marking-definition--0a872d70-1d05-45dd-a25f-031af547a102"], "created_by_ref": "identity--082ca4f0-d825-45b6-aa42-ab9afd1e5503", "type": "indicator", "spec_version": "2.1", "id": "indicator--da61b14f-3683-4cf4-a0cb-8436c24dc6a0"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--fc155d44-424c-4308-ab11-0aab828028d6", "created": "2020-04-02T07:58:58.810Z", "modified": "2020-04-02T07:58:58.810Z", "source_ref": "indicator--da61b14f-3683-4cf4-a0cb-8436c24dc6a0", "relationship_type": "indicates", "target_ref": "attack-pattern--c16e5409-ee53-4d79-afdc-4099dc9292df"}, {"name": "Bypass UAC via CMSTP", "description": "Detect child processes of automatically elevated instances of Microsoft Connection Manager Profile Installer (cmstp.exe).", "created": "2019-10-24T00:00:00.000Z", "modified": "2019-11-11T00:00:00.000Z", "valid_from": "2019-10-24T00:00:00Z", "indicator_types": ["malicious-activity"], "pattern_type": "sigma", "pattern": "title: Bypass UAC via CMSTP\nid: e66779cc-383e-4224-a3a4-267eeb585c40\ndescription: Detect child processes of automatically elevated instances of Microsoft Connection Manager Profile Installer (cmstp.exe).\nstatus: experimental\nauthor: E.M. Anhaus (orignally from Atomic Blue Detections, Endgame), oscd.community\nmodified: 2019/11/11\ndate: 2019/10/24\nreferences:\n    - https://eqllib.readthedocs.io/en/latest/analytics/e584f1a1-c303-4885-8a66-21360c90995b.html\n    - https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1191/T1191.md\ntags:\n    - attack.defense_evasion\n    - attack.execution\n    - attack.t1191\n    - attack.t1088\nlogsource:\n    category: process_creation\n    product: windows\ndetection:\n    selection:\n        Image|endswith: '\\cmstp.exe'\n        CommandLine|contains: \n            - '/s'\n            - '/au'\n    condition: selection\nfields:\n    - ComputerName\n    - User\n    - CommandLine\nfalsepositives:\n    - Legitimate use of cmstp.exe utility by legitimate user\nlevel: high\n", "object_marking_refs": ["marking-definition--0a872d70-1d05-45dd-a25f-031af547a102"], "created_by_ref": "identity--082ca4f0-d825-45b6-aa42-ab9afd1e5503", "type": "indicator", "spec_version": "2.1", "id": "indicator--ce710931-9f46-4157-b3ae-dc5e73add177"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--58ac2c57-01ff-4fd3-8b34-5a91e8ff7b1b", "created": "2020-04-02T07:58:58.826Z", "modified": "2020-04-02T07:58:58.826Z", "source_ref": "indicator--ce710931-9f46-4157-b3ae-dc5e73add177", "relationship_type": "indicates", "target_ref": "attack-pattern--7d6f590f-544b-45b4-9a42-e0805f342af3"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--f9efb0dc-f866-4b98-83ff-f47c5dfb4cce", "created": "2020-04-02T07:58:58.835Z", "modified": "2020-04-02T07:58:58.835Z", "source_ref": "indicator--ce710931-9f46-4157-b3ae-dc5e73add177", "relationship_type": "indicates", "target_ref": "attack-pattern--ca1a3f50-5ebd-41f8-8320-2c7d6a6e88be"}, {"name": "SILENTTRINITY Stager Execution", "description": "Detects SILENTTRINITY stager use", "created": "2019-10-22T00:00:00.000Z", "modified": "2019-11-04T00:00:00.000Z", "valid_from": "2019-10-22T00:00:00Z", "indicator_types": ["malicious-activity"], "pattern_type": "sigma", "pattern": "action: global\ntitle: SILENTTRINITY Stager Execution\nid: 03552375-cc2c-4883-bbe4-7958d5a980be\nstatus: experimental\ndescription: Detects SILENTTRINITY stager use\nreferences:\n    - https://github.com/byt3bl33d3r/SILENTTRINITY\nauthor: Aleksey Potapov, oscd.community\ndate: 2019/10/22\nmodified: 2019/11/04\ntags:\n    - attack.execution\ndetection:\n    selection:\n        Description|contains: 'st2stager'\n    condition: selection\nfalsepositives:\n    - unknown\nlevel: high\n", "object_marking_refs": ["marking-definition--0a872d70-1d05-45dd-a25f-031af547a102"], "created_by_ref": "identity--082ca4f0-d825-45b6-aa42-ab9afd1e5503", "type": "indicator", "spec_version": "2.1", "id": "indicator--5a62df00-495a-4e9d-a580-da8a3b62a9e7"}, {"name": "Run PowerShell Script from ADS", "description": "Detects PowerShell script execution from Alternate Data Stream (ADS)", "created": "2019-10-30T00:00:00.000Z", "valid_from": "2019-10-30T00:00:00Z", "indicator_types": ["malicious-activity"], "pattern_type": "sigma", "pattern": "title: Run PowerShell Script from ADS\nid: 45a594aa-1fbd-4972-a809-ff5a99dd81b8\nstatus: experimental\ndescription: Detects PowerShell script execution from Alternate Data Stream (ADS)\nreferences:\n    - https://github.com/p0shkatz/Get-ADS/blob/master/Get-ADS.ps1\nauthor: Sergey Soldatov, Kaspersky Lab, oscd.community\ndate: 2019/10/30\ntags:\n    - attack.defense_evasion\n    - attack.t1096\nlogsource:\n    category: process_creation\n    product: windows\ndetection:\n    selection:\n        ParentImage|endswith: '\\powershell.exe'\n        Image|endswith: '\\powershell.exe'\n        CommandLine|contains|all: \n          - 'Get-Content'\n          - '-Stream'\n    condition: selection\nfalsepositives:\n    - Unknown\nlevel: high\n", "object_marking_refs": ["marking-definition--0a872d70-1d05-45dd-a25f-031af547a102"], "created_by_ref": "identity--082ca4f0-d825-45b6-aa42-ab9afd1e5503", "type": "indicator", "spec_version": "2.1", "id": "indicator--94c5e614-8b3f-43b3-855e-257b6aaad34c", "modified": "2020-04-02T07:58:58.844Z"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--04932929-1a39-4fca-827f-72bea9ed72d9", "created": "2020-04-02T07:58:58.854Z", "modified": "2020-04-02T07:58:58.854Z", "source_ref": "indicator--94c5e614-8b3f-43b3-855e-257b6aaad34c", "relationship_type": "indicates", "target_ref": "attack-pattern--f2d44246-91f1-478a-b6c8-1227e0ca109d"}, {"name": "Chafer Activity", "description": "Detects Chafer activity attributed to OilRig as reported in Nyotron report in March 2018", "created": "2018-03-23T00:00:00.000Z", "modified": "2019-03-01T00:00:00.000Z", "valid_from": "2018-03-23T00:00:00Z", "indicator_types": ["malicious-activity"], "pattern_type": "sigma", "pattern": "action: global\ntitle: Chafer Activity\nid: 53ba33fd-3a50-4468-a5ef-c583635cfa92\ndescription: Detects Chafer activity attributed to OilRig as reported in Nyotron report in March 2018\nreferences:\n    - https://nyotron.com/nyotron-discovers-next-generation-oilrig-attacks/\ntags:\n    - attack.persistence\n    - attack.g0049\n    - attack.t1053\n    - attack.s0111\n    - attack.defense_evasion\n    - attack.t1112\ndate: 2018/03/23\nmodified: 2019/03/01\nauthor: Florian Roth, Markus Neis\ndetection:\n    condition: 1 of them\nfalsepositives:\n    - Unknown\nlevel: critical\n", "object_marking_refs": ["marking-definition--0a872d70-1d05-45dd-a25f-031af547a102"], "created_by_ref": "identity--082ca4f0-d825-45b6-aa42-ab9afd1e5503", "type": "indicator", "spec_version": "2.1", "id": "indicator--6d390c80-3917-4f14-8bb7-e3075365f237"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--4bcfa218-c567-4182-bb94-09967681ac17", "created": "2020-04-02T07:58:58.868Z", "modified": "2020-04-02T07:58:58.868Z", "source_ref": "indicator--6d390c80-3917-4f14-8bb7-e3075365f237", "relationship_type": "indicates", "target_ref": "intrusion-set--4ca1929c-7d64-4aab-b849-badbfc0c760d"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--26367f19-1892-4b40-b0f1-13e26a9e2dc2", "created": "2020-04-02T07:58:58.877Z", "modified": "2020-04-02T07:58:58.877Z", "source_ref": "indicator--6d390c80-3917-4f14-8bb7-e3075365f237", "relationship_type": "indicates", "target_ref": "attack-pattern--35dd844a-b219-4e2b-a6bb-efa9a75995a9"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--f016c11b-5bbc-4f62-a6ec-e2835e6d5336", "created": "2020-04-02T07:58:58.885Z", "modified": "2020-04-02T07:58:58.885Z", "source_ref": "indicator--6d390c80-3917-4f14-8bb7-e3075365f237", "relationship_type": "indicates", "target_ref": "tool--c9703cd3-141c-43a0-a926-380082be5d04"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--7ca392dc-c593-48f5-aaa1-d339babfad72", "created": "2020-04-02T07:58:58.896Z", "modified": "2020-04-02T07:58:58.896Z", "source_ref": "indicator--6d390c80-3917-4f14-8bb7-e3075365f237", "relationship_type": "indicates", "target_ref": "attack-pattern--57340c81-c025-4189-8fa0-fc7ede51bae4"}, {"name": "Copy from Admin Share", "description": "Detects a suspicious copy command from a remote C$ or ADMIN$ share", "created": "2019-12-30T00:00:00.000Z", "valid_from": "2019-12-30T00:00:00Z", "indicator_types": ["malicious-activity"], "pattern_type": "sigma", "pattern": "title: Copy from Admin Share\nid: 855bc8b5-2ae8-402e-a9ed-b889e6df1900\nstatus: experimental\ndescription: Detects a suspicious copy command from a remote C$ or ADMIN$ share\nreferences: \n  - https://twitter.com/SBousseaden/status/1211636381086339073\nauthor: Florian Roth\ndate: 2019/12/30\ntags:\n    - attack.lateral_movement\n    - attack.t1077\n    - attack.t1105\nlogsource:\n    category: process_creation\n    product: windows\ndetection:\n    selection:\n        CommandLine|contains: \n          - 'copy *\\c$'\n          - 'copy *\\ADMIN$'\n    condition: selection\nfields:\n    - CommandLine\n    - ParentCommandLine\nfalsepositives:\n    - Administrative scripts\nlevel: high\n", "object_marking_refs": ["marking-definition--0a872d70-1d05-45dd-a25f-031af547a102"], "created_by_ref": "identity--082ca4f0-d825-45b6-aa42-ab9afd1e5503", "type": "indicator", "spec_version": "2.1", "id": "indicator--aac5a4aa-e07f-49e7-973c-f54a10bbf9e2", "modified": "2020-04-02T07:58:58.907Z"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--b5775ca6-5f4c-4930-8585-d867754266e7", "created": "2020-04-02T07:58:58.918Z", "modified": "2020-04-02T07:58:58.918Z", "source_ref": "indicator--aac5a4aa-e07f-49e7-973c-f54a10bbf9e2", "relationship_type": "indicates", "target_ref": "attack-pattern--ffe742ed-9100-4686-9e00-c331da544787"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--75069ac4-10d5-4e83-82d0-aa107a91605f", "created": "2020-04-02T07:58:58.929Z", "modified": "2020-04-02T07:58:58.929Z", "source_ref": "indicator--aac5a4aa-e07f-49e7-973c-f54a10bbf9e2", "relationship_type": "indicates", "target_ref": "attack-pattern--e6919abc-99f9-4c6c-95a5-14761e7b2add"}, {"name": "Elise Backdoor", "description": "Detects Elise backdoor acitivty as used by APT32", "created": "2018-01-31T00:00:00.000Z", "valid_from": "2018-01-31T00:00:00Z", "indicator_types": ["malicious-activity"], "pattern_type": "sigma", "pattern": "title: Elise Backdoor\nid: e507feb7-5f73-4ef6-a970-91bb6f6d744f\nstatus: experimental\ndescription: Detects Elise backdoor acitivty as used by APT32\nreferences:\n    - https://community.rsa.com/community/products/netwitness/blog/2018/02/13/lotus-blossom-continues-asean-targeting\ntags:\n    - attack.g0030\n    - attack.g0050\n    - attack.s0081\nauthor: Florian Roth\ndate: 2018/01/31\nlogsource:\n    category: process_creation\n    product: windows\ndetection:\n    selection1:\n        Image: 'C:\\Windows\\SysWOW64\\cmd.exe'\n        CommandLine: '*\\Windows\\Caches\\NavShExt.dll *'\n    selection2:\n        CommandLine: '*\\AppData\\Roaming\\MICROS~1\\Windows\\Caches\\NavShExt.dll,Setting'\n    condition: 1 of them\nfalsepositives:\n    - Unknown\nlevel: critical\n", "object_marking_refs": ["marking-definition--0a872d70-1d05-45dd-a25f-031af547a102"], "created_by_ref": "identity--082ca4f0-d825-45b6-aa42-ab9afd1e5503", "type": "indicator", "spec_version": "2.1", "id": "indicator--deeaa792-bdbb-44d4-b9f3-542845c53d54", "modified": "2020-04-02T07:58:58.933Z"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--b526ff45-14c6-47e1-8c7f-c3fea4b9daf0", "created": "2020-04-02T07:58:58.946Z", "modified": "2020-04-02T07:58:58.946Z", "source_ref": "indicator--deeaa792-bdbb-44d4-b9f3-542845c53d54", "relationship_type": "indicates", "target_ref": "intrusion-set--88b7dbc2-32d3-4e31-af2f-3fc24e1582d7"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--d9c158dd-1d77-46d5-b34f-d6195350df53", "created": "2020-04-02T07:58:58.957Z", "modified": "2020-04-02T07:58:58.957Z", "source_ref": "indicator--deeaa792-bdbb-44d4-b9f3-542845c53d54", "relationship_type": "indicates", "target_ref": "intrusion-set--247cb30b-955f-42eb-97a5-a89fef69341e"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--ca842955-0166-4178-a9e3-b507def393cd", "created": "2020-04-02T07:58:58.967Z", "modified": "2020-04-02T07:58:58.967Z", "source_ref": "indicator--deeaa792-bdbb-44d4-b9f3-542845c53d54", "relationship_type": "indicates", "target_ref": "malware--7551188b-8f91-4d34-8350-0d0c57b2b913"}, {"name": "LSASS Memory Dumping", "description": "Detect creation of dump files containing the memory space of lsass.exe, which contains sensitive credentials. Identifies usage of Sysinternals procdump.exe to export the memory space of lsass.exe which contains sensitive credentials.", "created": "2019-10-24T00:00:00.000Z", "modified": "2019-11-11T00:00:00.000Z", "valid_from": "2019-10-24T00:00:00Z", "indicator_types": ["malicious-activity"], "pattern_type": "sigma", "pattern": "title: LSASS Memory Dumping\nid: ffa6861c-4461-4f59-8a41-578c39f3f23e\ndescription: Detect creation of dump files containing the memory space of lsass.exe, which contains sensitive credentials. Identifies usage of Sysinternals procdump.exe\n    to export the memory space of lsass.exe which contains sensitive credentials.\nstatus: experimental\nauthor: E.M. Anhaus (orignally from Atomic Blue Detections, Tony Lambert), oscd.community\ndate: 2019/10/24\nmodified: 2019/11/11\nreferences:\n    - https://eqllib.readthedocs.io/en/latest/analytics/1e1ef6be-12fc-11e9-8d76-4d6bb837cda4.html\n    - https://eqllib.readthedocs.io/en/latest/analytics/210b4ea4-12fc-11e9-8d76-4d6bb837cda4.html\n    - https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1003/T1003.yaml\ntags:\n    - attack.credential_access\n    - attack.t1003\nlogsource:\n    category: process_creation\n    product: windows\ndetection:\n    selection1:\n        CommandLine|contains|all:\n            - 'lsass'\n            - '.dmp'\n    selection2:\n        Image|endswith: '\\werfault.exe'\n    selection3:\n        Image|contains: '\\procdump'\n        Image|endswith: '.exe'\n        CommandLine|contains: 'lsass'\n    condition: selection1 and not selection2 or selection3\nfields:\n    - ComputerName\n    - User\n    - CommandLine\nfalsepositives:\n    - Unlikely\nlevel: high\n", "object_marking_refs": ["marking-definition--0a872d70-1d05-45dd-a25f-031af547a102"], "created_by_ref": "identity--082ca4f0-d825-45b6-aa42-ab9afd1e5503", "type": "indicator", "spec_version": "2.1", "id": "indicator--7f66127a-8e6d-4c81-a095-b3c964bb87e3"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--8fcb05bf-7241-4820-91d7-4120ff83a673", "created": "2020-04-02T07:58:58.985Z", "modified": "2020-04-02T07:58:58.985Z", "source_ref": "indicator--7f66127a-8e6d-4c81-a095-b3c964bb87e3", "relationship_type": "indicates", "target_ref": "attack-pattern--0a3ead4e-6d47-4ccb-854c-a6a4f9d96b22"}, {"name": "Suspicious Calculator Usage", "description": "Detects suspicious use of calc.exe with command line parameters or in a suspicious directory, which is likely caused by some PoC or detection evasion", "created": "2019-02-09T00:00:00.000Z", "valid_from": "2019-02-09T00:00:00Z", "indicator_types": ["malicious-activity"], "pattern_type": "sigma", "pattern": "title: Suspicious Calculator Usage\nid: 737e618a-a410-49b5-bec3-9e55ff7fbc15\ndescription: Detects suspicious use of calc.exe with command line parameters or in a suspicious directory, which is likely caused by some PoC or detection evasion\nstatus: experimental\nreferences:\n    - https://twitter.com/ItsReallyNick/status/1094080242686312448\nauthor: Florian Roth\ndate: 2019/02/09\ntags:\n    - attack.defense_evasion\n    - attack.t1036\nlogsource:\n    category: process_creation\n    product: windows\ndetection:\n    selection1:\n        CommandLine: '*\\calc.exe *'\n    selection2:\n        Image: '*\\calc.exe'\n    filter2:\n        Image: '*\\Windows\\Sys*'\n    condition: selection1 or ( selection2 and not filter2 )\nfalsepositives:\n    - Unknown\nlevel: high\n", "object_marking_refs": ["marking-definition--0a872d70-1d05-45dd-a25f-031af547a102"], "created_by_ref": "identity--082ca4f0-d825-45b6-aa42-ab9afd1e5503", "type": "indicator", "spec_version": "2.1", "id": "indicator--b63ba0bd-f487-4d82-8112-a962f856a3f2", "modified": "2020-04-02T07:58:58.989Z"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--4ac21130-0a8d-4d3e-bb84-aa7f5308f250", "created": "2020-04-02T07:58:59.000Z", "modified": "2020-04-02T07:58:59.000Z", "source_ref": "indicator--b63ba0bd-f487-4d82-8112-a962f856a3f2", "relationship_type": "indicates", "target_ref": "attack-pattern--42e8de7b-37b2-4258-905a-6897815e58e0"}, {"name": "Suspicious Call by Ordinal", "description": "Detects suspicious calls of DLLs in rundll32.dll exports by ordinal", "created": "2019-10-22T00:00:00.000Z", "valid_from": "2019-10-22T00:00:00Z", "indicator_types": ["malicious-activity"], "pattern_type": "sigma", "pattern": "title: Suspicious Call by Ordinal\nid: e79a9e79-eb72-4e78-a628-0e7e8f59e89c\ndescription: Detects suspicious calls of DLLs in rundll32.dll exports by ordinal\nstatus: experimental\nreferences:\n    - https://techtalk.pcmatic.com/2017/11/30/running-dll-files-malware-analysis/\n    - https://github.com/Neo23x0/DLLRunner\n    - https://twitter.com/cyb3rops/status/1186631731543236608\ntags:\n    - attack.defense_evasion\n    - attack.execution\n    - attack.t1085\nauthor: Florian Roth\ndate: 2019/10/22\nlogsource:\n    category: process_creation\n    product: windows\ndetection:\n    selection:\n        CommandLine: '*\\rundll32.exe *,#*'\n    condition: selection\nfalsepositives:\n    - False positives depend on scripts and administrative tools used in the monitored environment\n    - Windows contol panel elements have been identified as source (mmc)\nlevel: high\n", "object_marking_refs": ["marking-definition--0a872d70-1d05-45dd-a25f-031af547a102"], "created_by_ref": "identity--082ca4f0-d825-45b6-aa42-ab9afd1e5503", "type": "indicator", "spec_version": "2.1", "id": "indicator--6ccc0ff5-c7f3-4a65-a70d-3a8bfab22caf", "modified": "2020-04-02T07:58:59.005Z"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--a91ebb77-de51-44aa-96f3-2f9cee45d8d4", "created": "2020-04-02T07:58:59.016Z", "modified": "2020-04-02T07:58:59.016Z", "source_ref": "indicator--6ccc0ff5-c7f3-4a65-a70d-3a8bfab22caf", "relationship_type": "indicates", "target_ref": "attack-pattern--62b8c999-dcc0-4755-bd69-09442d9359f5"}, {"name": "Empire PowerShell UAC Bypass", "description": "Detects some Empire PowerShell UAC bypass methods", "created": "2019-08-30T00:00:00.000Z", "valid_from": "2019-08-30T00:00:00Z", "indicator_types": ["malicious-activity"], "pattern_type": "sigma", "pattern": "title: Empire PowerShell UAC Bypass\nid: 3268b746-88d8-4cd3-bffc-30077d02c787\nstatus: experimental\ndescription: Detects some Empire PowerShell UAC bypass methods\nreferences:\n    - https://github.com/EmpireProject/Empire/blob/e37fb2eef8ff8f5a0a689f1589f424906fe13055/data/module_source/privesc/Invoke-EventVwrBypass.ps1#L64\n    - https://github.com/EmpireProject/Empire/blob/e37fb2eef8ff8f5a0a689f1589f424906fe13055/data/module_source/privesc/Invoke-FodHelperBypass.ps1#L64\nauthor: Ecco\ndate: 2019/08/30\nlogsource:\n    category: process_creation\n    product: windows\ndetection:\n    selection:\n        CommandLine:\n            - '* -NoP -NonI -w Hidden -c $x=$((gp HKCU:Software\\\\Microsoft\\\\Windows Update).Update)*'\n            - '* -NoP -NonI -c $x=$((gp HKCU:Software\\\\Microsoft\\\\Windows Update).Update);*'\n    condition: selection\nfields:\n    - CommandLine\n    - ParentCommandLine\ntags:\n    - attack.defense_evasion\n    - attack.privilege_escalation\n    - attack.t1088\n    - car.2019-04-001\nfalsepositives:\n    - unknown\nlevel: critical\n", "object_marking_refs": ["marking-definition--0a872d70-1d05-45dd-a25f-031af547a102"], "created_by_ref": "identity--082ca4f0-d825-45b6-aa42-ab9afd1e5503", "type": "indicator", "spec_version": "2.1", "id": "indicator--7c33f6fa-4240-478e-b50f-4c3924a56a2b", "modified": "2020-04-02T07:58:59.026Z"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--f445bf76-13f7-4473-a5e7-5eba626debe9", "created": "2020-04-02T07:58:59.037Z", "modified": "2020-04-02T07:58:59.037Z", "source_ref": "indicator--7c33f6fa-4240-478e-b50f-4c3924a56a2b", "relationship_type": "indicates", "target_ref": "attack-pattern--ca1a3f50-5ebd-41f8-8320-2c7d6a6e88be"}, {"name": "Invoke-Obfuscation Obfuscated IEX Invocation", "description": "Detects all variations of obfuscated powershell IEX invocation code generated by Invoke-Obfuscation framework from the following code block \u2014 https://github.com/danielbohannon/Invoke-Obfuscation/blob/master/Out-ObfuscatedStringCommand.ps1#L873-L888", "created": "2019-11-08T00:00:00.000Z", "valid_from": "2019-11-08T00:00:00Z", "indicator_types": ["malicious-activity"], "pattern_type": "sigma", "pattern": "title: Invoke-Obfuscation Obfuscated IEX Invocation\nid: 4bf943c6-5146-4273-98dd-e958fd1e3abf\ndescription: \"Detects all variations of obfuscated powershell IEX invocation code generated by Invoke-Obfuscation framework from the following code block \\u2014 https://github.com/danielbohannon/Invoke-Obfuscation/blob/master/Out-ObfuscatedStringCommand.ps1#L873-L888\"\nstatus: experimental\nauthor: Daniel Bohannon (@Mandiant/@FireEye), oscd.community\ndate: 2019/11/08\ntags:\n    - attack.defense_evasion\n    - attack.t1027\nlogsource:\n    product: windows\n    service: process_creation\ndetection:\n    selection:\n        - CommandLine|re: '\\$PSHome\\[\\s*\\d{1,3}\\s*\\]\\s*\\+\\s*\\$PSHome\\['\n        - CommandLine|re: '\\$ShellId\\[\\s*\\d{1,3}\\s*\\]\\s*\\+\\s*\\$ShellId\\['\n        - CommandLine|re: '\\$env:Public\\[\\s*\\d{1,3}\\s*\\]\\s*\\+\\s*\\$env:Public\\['\n        - CommandLine|re: '\\$env:ComSpec\\[(\\s*\\d{1,3}\\s*,){2}'\n        - CommandLine|re: '\\*mdr\\*\\W\\s*\\)\\.Name'\n        - CommandLine|re: '\\$VerbosePreference\\.ToString\\('\n        - CommandLine|re: '\\String\\]\\s*\\$VerbosePreference'\n    condition: selection\nfalsepositives:\n    - Unknown\nlevel: high\n", "object_marking_refs": ["marking-definition--0a872d70-1d05-45dd-a25f-031af547a102"], "created_by_ref": "identity--082ca4f0-d825-45b6-aa42-ab9afd1e5503", "type": "indicator", "spec_version": "2.1", "id": "indicator--90478966-03e4-4f13-9214-f46a1ddce43d", "modified": "2020-04-02T07:58:59.042Z"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--6e5fa7db-d9a3-4e4e-89b0-4bf5bf53be64", "created": "2020-04-02T07:58:59.051Z", "modified": "2020-04-02T07:58:59.051Z", "source_ref": "indicator--90478966-03e4-4f13-9214-f46a1ddce43d", "relationship_type": "indicates", "target_ref": "attack-pattern--b3d682b6-98f2-4fb0-aa3b-b4df007ca70a"}, {"name": "Suspicious Use of Procdump", "description": "Detects suspicious uses of the SysInternals Procdump utility by using a special command line parameter in combination with the lsass.exe process. This way we're also able to catch cases in which the attacker has renamed the procdump executable.", "created": "2018-10-30T00:00:00.000Z", "modified": "2019-10-14T00:00:00.000Z", "valid_from": "2018-10-30T00:00:00Z", "indicator_types": ["malicious-activity"], "pattern_type": "sigma", "pattern": "title: Suspicious Use of Procdump\nid: 5afee48e-67dd-4e03-a783-f74259dcf998\ndescription: Detects suspicious uses of the SysInternals Procdump utility by using a special command line parameter in combination with the lsass.exe process. This way we're also able to catch cases in which the attacker has renamed the procdump executable.\nstatus: experimental\nreferences:\n    - Internal Research\nauthor: Florian Roth\ndate: 2018/10/30\nmodified: 2019/10/14\ntags:\n    - attack.defense_evasion\n    - attack.t1036\n    - attack.credential_access\n    - attack.t1003\n    - car.2013-05-009\nlogsource:\n    category: process_creation\n    product: windows\ndetection:\n    selection1:\n        CommandLine:\n            - '* -ma *'\n    selection2:\n        CommandLine:\n            - '* lsass*'\n    selection3:\n        CommandLine:\n            - '* -ma ls*'\n    condition: ( selection1 and selection2 ) or selection3\nfalsepositives:\n    - Unlikely, because no one should dump an lsass process memory\n    - Another tool that uses the command line switches of Procdump\nlevel: high\n", "object_marking_refs": ["marking-definition--0a872d70-1d05-45dd-a25f-031af547a102"], "created_by_ref": "identity--082ca4f0-d825-45b6-aa42-ab9afd1e5503", "type": "indicator", "spec_version": "2.1", "id": "indicator--0a074eda-face-4e3b-88b6-771670b98745"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--d409d9b3-7f02-4a03-92b2-f97be553f7eb", "created": "2020-04-02T07:58:59.065Z", "modified": "2020-04-02T07:58:59.065Z", "source_ref": "indicator--0a074eda-face-4e3b-88b6-771670b98745", "relationship_type": "indicates", "target_ref": "attack-pattern--42e8de7b-37b2-4258-905a-6897815e58e0"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--c5ccf5bf-9aa5-45af-9e14-d8c119d3e079", "created": "2020-04-02T07:58:59.074Z", "modified": "2020-04-02T07:58:59.074Z", "source_ref": "indicator--0a074eda-face-4e3b-88b6-771670b98745", "relationship_type": "indicates", "target_ref": "attack-pattern--0a3ead4e-6d47-4ccb-854c-a6a4f9d96b22"}, {"name": "System File Execution Location Anomaly", "description": "Detects a Windows program executable started in a suspicious folder", "created": "2017-11-27T00:00:00.000Z", "valid_from": "2017-11-27T00:00:00Z", "indicator_types": ["malicious-activity"], "pattern_type": "sigma", "pattern": "title: System File Execution Location Anomaly\nid: e4a6b256-3e47-40fc-89d2-7a477edd6915\nstatus: experimental\ndescription: Detects a Windows program executable started in a suspicious folder\nreferences:\n    - https://twitter.com/GelosSnake/status/934900723426439170\nauthor: Florian Roth, Patrick Bareiss\ndate: 2017/11/27\ntags:\n    - attack.defense_evasion\n    - attack.t1036\nlogsource:\n    category: process_creation\n    product: windows\ndetection:\n    selection:\n        Image:\n            - '*\\svchost.exe'\n            - '*\\rundll32.exe'\n            - '*\\services.exe'\n            - '*\\powershell.exe'\n            - '*\\regsvr32.exe'\n            - '*\\spoolsv.exe'\n            - '*\\lsass.exe'\n            - '*\\smss.exe'\n            - '*\\csrss.exe'\n            - '*\\conhost.exe'\n            - '*\\wininit.exe'\n            - '*\\lsm.exe'\n            - '*\\winlogon.exe'\n            - '*\\explorer.exe'\n            - '*\\taskhost.exe'\n    filter:\n        Image:\n            - 'C:\\Windows\\System32\\\\*'\n            - 'C:\\Windows\\system32\\\\*'\n            - 'C:\\Windows\\SysWow64\\\\*'\n            - 'C:\\Windows\\SysWOW64\\\\*'\n            - 'C:\\Windows\\explorer.exe'\n            - 'C:\\Windows\\winsxs\\\\*'\n            - 'C:\\Windows\\WinSxS\\\\*'\n            - '\\SystemRoot\\System32\\\\*'\n    condition: selection and not filter\nfields:\n    - ComputerName\n    - User\n    - Image\nfalsepositives:\n    - Exotic software\nlevel: high\n", "object_marking_refs": ["marking-definition--0a872d70-1d05-45dd-a25f-031af547a102"], "created_by_ref": "identity--082ca4f0-d825-45b6-aa42-ab9afd1e5503", "type": "indicator", "spec_version": "2.1", "id": "indicator--c704a700-f818-447b-a7c7-f2d515e2b5e3", "modified": "2020-04-02T07:58:59.080Z"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--8b2b3efc-b494-478c-965d-439cbb6727ff", "created": "2020-04-02T07:58:59.089Z", "modified": "2020-04-02T07:58:59.089Z", "source_ref": "indicator--c704a700-f818-447b-a7c7-f2d515e2b5e3", "relationship_type": "indicates", "target_ref": "attack-pattern--42e8de7b-37b2-4258-905a-6897815e58e0"}, {"name": "Execution in Non-Executable Folder", "description": "Detects a suspicious exection from an uncommon folder", "created": "2019-01-16T00:00:00.000Z", "valid_from": "2019-01-16T00:00:00Z", "indicator_types": ["malicious-activity"], "pattern_type": "sigma", "pattern": "title: Execution in Non-Executable Folder\nid: 3dfd06d2-eaf4-4532-9555-68aca59f57c4\nstatus: experimental\ndescription: Detects a suspicious exection from an uncommon folder\nauthor: Florian Roth\ndate: 2019/01/16\ntags:\n    - attack.defense_evasion\n    - attack.t1036\nlogsource:\n    category: process_creation\n    product: windows\ndetection:\n    selection:\n        Image:\n            - '*\\$Recycle.bin'\n            - '*\\Users\\All Users\\\\*'\n            - '*\\Users\\Default\\\\*'\n            - '*\\Users\\Public\\\\*'\n            - 'C:\\Perflogs\\\\*'\n            - '*\\config\\systemprofile\\\\*'\n            - '*\\Windows\\Fonts\\\\*'\n            - '*\\Windows\\IME\\\\*'\n            - '*\\Windows\\addins\\\\*'\n    condition: selection\nfields:\n    - CommandLine\n    - ParentCommandLine\nfalsepositives:\n    - Unknown\nlevel: high\n", "object_marking_refs": ["marking-definition--0a872d70-1d05-45dd-a25f-031af547a102"], "created_by_ref": "identity--082ca4f0-d825-45b6-aa42-ab9afd1e5503", "type": "indicator", "spec_version": "2.1", "id": "indicator--08f9cc5a-eaa9-4027-893a-10ea860e3fe1", "modified": "2020-04-02T07:58:59.093Z"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--656e558a-e26f-41fb-922c-6ccead059ddc", "created": "2020-04-02T07:58:59.105Z", "modified": "2020-04-02T07:58:59.105Z", "source_ref": "indicator--08f9cc5a-eaa9-4027-893a-10ea860e3fe1", "relationship_type": "indicates", "target_ref": "attack-pattern--42e8de7b-37b2-4258-905a-6897815e58e0"}, {"name": "Suspicious HWP Sub Processes", "description": "Detects suspicious Hangul Word Processor (Hanword) sub processes that could indicate an exploitation", "created": "2019-10-24T00:00:00.000Z", "valid_from": "2019-10-24T00:00:00Z", "indicator_types": ["malicious-activity"], "pattern_type": "sigma", "pattern": "title: Suspicious HWP Sub Processes\nid: 023394c4-29d5-46ab-92b8-6a534c6f447b\ndescription: Detects suspicious Hangul Word Processor (Hanword) sub processes that could indicate an exploitation\nstatus: experimental\nreferences:\n    - https://www.securitynewspaper.com/2016/11/23/technical-teardown-exploit-malware-hwp-files/\n    - https://www.hybrid-analysis.com/search?query=context:74940dcc5b38f9f9b1a0fea760d344735d7d91b610e6d5bd34533dd0153402c5&from_sample=5db135000388385a7644131f&block_redirect=1\n    - https://twitter.com/cyberwar_15/status/1187287262054076416\n    - https://blog.alyac.co.kr/1901\n    - https://en.wikipedia.org/wiki/Hangul_(word_processor)\ntags:\n    - attack.execution\n    - attack.defense_evasion\n    - attack.initial_access\n    - attack.t1059\n    - attack.t1202\n    - attack.t1193\n    - attack.g0032\nauthor: Florian Roth\ndate: 2019/10/24\nlogsource:\n    category: process_creation\n    product: windows\ndetection:\n    selection:\n        ParentImage: '*\\Hwp.exe'\n        Image: '*\\gbb.exe'\n    condition: selection\nfalsepositives:\n    - Unknown\nlevel: high\n", "object_marking_refs": ["marking-definition--0a872d70-1d05-45dd-a25f-031af547a102"], "created_by_ref": "identity--082ca4f0-d825-45b6-aa42-ab9afd1e5503", "type": "indicator", "spec_version": "2.1", "id": "indicator--a6a6647f-40ea-4662-a8bd-0c898aa9b1d2", "modified": "2020-04-02T07:58:59.109Z"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--221e7942-5ce8-4dae-92cd-efde053c5848", "created": "2020-04-02T07:58:59.120Z", "modified": "2020-04-02T07:58:59.120Z", "source_ref": "indicator--a6a6647f-40ea-4662-a8bd-0c898aa9b1d2", "relationship_type": "indicates", "target_ref": "attack-pattern--7385dfaf-6886-4229-9ecd-6fd678040830"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--7ea36e09-d3d2-4f6d-90a8-8d9f355562c7", "created": "2020-04-02T07:58:59.130Z", "modified": "2020-04-02T07:58:59.130Z", "source_ref": "indicator--a6a6647f-40ea-4662-a8bd-0c898aa9b1d2", "relationship_type": "indicates", "target_ref": "attack-pattern--3b0e52ce-517a-4614-a523-1bd5deef6c5e"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--1031d9f0-5d84-44d3-8b47-4eee7a169bf4", "created": "2020-04-02T07:58:59.140Z", "modified": "2020-04-02T07:58:59.140Z", "source_ref": "indicator--a6a6647f-40ea-4662-a8bd-0c898aa9b1d2", "relationship_type": "indicates", "target_ref": "attack-pattern--6aac77c4-eaf2-4366-8c13-ce50ab951f38"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--8a19d42a-63bf-4149-98b8-b95ca5fb9da6", "created": "2020-04-02T07:58:59.147Z", "modified": "2020-04-02T07:58:59.147Z", "source_ref": "indicator--a6a6647f-40ea-4662-a8bd-0c898aa9b1d2", "relationship_type": "indicates", "target_ref": "intrusion-set--c93fccb1-e8e8-42cf-ae33-2ad1d183913a"}, {"name": "APT29", "description": "This method detects a suspicious powershell command line combination as used by APT29 in a campaign against US think tanks", "created": "2018-12-04T00:00:00.000Z", "valid_from": "2018-12-04T00:00:00Z", "indicator_types": ["malicious-activity"], "pattern_type": "sigma", "pattern": "title: APT29\nid: 033fe7d6-66d1-4240-ac6b-28908009c71f\ndescription: This method detects a suspicious powershell command line combination as used by APT29 in a campaign against US think tanks\nreferences:\n    - https://cloudblogs.microsoft.com/microsoftsecure/2018/12/03/analysis-of-cyberattack-on-u-s-think-tanks-non-profits-public-sector-by-unidentified-attackers/\ntags:\n    - attack.execution\n    - attack.g0016\n    - attack.t1086\nauthor: Florian Roth\ndate: 2018/12/04 \nlogsource:\n    category: process_creation\n    product: windows\ndetection:\n    selection:\n        CommandLine: '*-noni -ep bypass $*'\n    condition: selection\nfalsepositives:\n    - unknown\nlevel: critical\n", "object_marking_refs": ["marking-definition--0a872d70-1d05-45dd-a25f-031af547a102"], "created_by_ref": "identity--082ca4f0-d825-45b6-aa42-ab9afd1e5503", "type": "indicator", "spec_version": "2.1", "id": "indicator--ab9f7729-2038-48de-acb2-db3cba547cce", "modified": "2020-04-02T07:58:59.151Z"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--1e8b0f51-6fd3-458e-a48c-7e6f4171f00b", "created": "2020-04-02T07:58:59.162Z", "modified": "2020-04-02T07:58:59.162Z", "source_ref": "indicator--ab9f7729-2038-48de-acb2-db3cba547cce", "relationship_type": "indicates", "target_ref": "intrusion-set--899ce53f-13a0-479b-a0e4-67d46e241542"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--0683e767-8423-4051-8ebd-99f36c819d11", "created": "2020-04-02T07:58:59.173Z", "modified": "2020-04-02T07:58:59.173Z", "source_ref": "indicator--ab9f7729-2038-48de-acb2-db3cba547cce", "relationship_type": "indicates", "target_ref": "attack-pattern--f4882e23-8aa7-4b12-b28a-b349c12ee9e0"}, {"name": "HH.exe Execution", "description": "Identifies usage of hh.exe executing recently modified .chm files.", "created": "2019-10-24T00:00:00.000Z", "modified": "2019-11-11T00:00:00.000Z", "valid_from": "2019-10-24T00:00:00Z", "indicator_types": ["malicious-activity"], "pattern_type": "sigma", "pattern": "title: HH.exe Execution\nid: 68c8acb4-1b60-4890-8e82-3ddf7a6dba84\ndescription: Identifies usage of hh.exe executing recently modified .chm files.\nstatus: experimental\nauthor: E.M. Anhaus (orignally from Atomic Blue Detections, Dan Beavin), oscd.community\nreferences:\n    - https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1223/T1223.yaml\n    - https://eqllib.readthedocs.io/en/latest/analytics/b25aa548-7937-11e9-8f5c-d46d6d62a49e.html\ndate: 2019/10/24\nmodified: 2019/11/11\ntags:\n    - attack.defense_evasion\n    - attack.execution\n    - attack.t1223\nlogsource:\n    category: process_creation\n    product: windows\ndetection:\n    selection:\n        Image|endswith: '\\hh.exe'\n        CommandLine|contains: '.chm'\n    condition: selection\nfields:\n    - ComputerName\n    - User\n    - CommandLine\nfalsepositives:\n    - unlike\nlevel: high\n", "object_marking_refs": ["marking-definition--0a872d70-1d05-45dd-a25f-031af547a102"], "created_by_ref": "identity--082ca4f0-d825-45b6-aa42-ab9afd1e5503", "type": "indicator", "spec_version": "2.1", "id": "indicator--be9dd49b-d001-4773-88e5-edd4f45880fd"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--467f8fb7-33fd-4245-aaf5-1b49ef656249", "created": "2020-04-02T07:58:59.187Z", "modified": "2020-04-02T07:58:59.187Z", "source_ref": "indicator--be9dd49b-d001-4773-88e5-edd4f45880fd", "relationship_type": "indicates", "target_ref": "attack-pattern--d21a2069-23d5-4043-ad6d-64f6b644cb1a"}, {"name": "Rubeus Hack Tool", "description": "Detects command line parameters used by Rubeus hack tool", "created": "2018-12-19T00:00:00.000Z", "valid_from": "2018-12-19T00:00:00Z", "indicator_types": ["malicious-activity"], "pattern_type": "sigma", "pattern": "title: Rubeus Hack Tool\nid: 7ec2c172-dceb-4c10-92c9-87c1881b7e18\ndescription: Detects command line parameters used by Rubeus hack tool\nauthor: Florian Roth\nreferences:\n    - https://www.harmj0y.net/blog/redteaming/from-kekeo-to-rubeus/\ndate: 2018/12/19\ntags:\n    - attack.credential_access\n    - attack.t1003\n    - attack.s0005\nlogsource:\n    category: process_creation\n    product: windows\ndetection:\n    selection:\n        CommandLine:\n            - '* asreproast *'\n            - '* dump /service:krbtgt *'\n            - '* kerberoast *'\n            - '* createnetonly /program:*'\n            - '* ptt /ticket:*'\n            - '* /impersonateuser:*'\n            - '* renew /ticket:*'\n            - '* asktgt /user:*'\n            - '* harvest /interval:*'\n    condition: selection\nfalsepositives:\n    - unlikely\nlevel: critical\n", "object_marking_refs": ["marking-definition--0a872d70-1d05-45dd-a25f-031af547a102"], "created_by_ref": "identity--082ca4f0-d825-45b6-aa42-ab9afd1e5503", "type": "indicator", "spec_version": "2.1", "id": "indicator--5c6c4a52-c5c6-42f3-b806-0b348b06287d", "modified": "2020-04-02T07:58:59.192Z"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--24d3f71d-266f-4f4e-8223-d5e7c057fdd8", "created": "2020-04-02T07:58:59.201Z", "modified": "2020-04-02T07:58:59.201Z", "source_ref": "indicator--5c6c4a52-c5c6-42f3-b806-0b348b06287d", "relationship_type": "indicates", "target_ref": "attack-pattern--0a3ead4e-6d47-4ccb-854c-a6a4f9d96b22"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--22488928-7409-49d3-9e3e-b1e5f5848c8c", "created": "2020-04-02T07:58:59.210Z", "modified": "2020-04-02T07:58:59.210Z", "source_ref": "indicator--5c6c4a52-c5c6-42f3-b806-0b348b06287d", "relationship_type": "indicates", "target_ref": "tool--242f3da3-4425-4d11-8f5c-b842886da966"}, {"name": "Unidentified Attacker November 2018", "description": "A sigma rule detecting an unidetefied attacker who used phishing emails to target high profile orgs on November 2018. The Actor shares some TTPs with YYTRIUM/APT29 campaign in 2016.", "created": "2018-11-20T00:00:00.000Z", "modified": "2018-12-11T00:00:00.000Z", "valid_from": "2018-11-20T00:00:00Z", "indicator_types": ["malicious-activity"], "pattern_type": "sigma", "pattern": "action: global\ntitle: Unidentified Attacker November 2018\nid: 7453575c-a747-40b9-839b-125a0aae324b\nstatus: stable\ndescription: A sigma rule detecting an unidetefied attacker who used phishing emails to target high profile orgs on November 2018. The Actor shares some TTPs with\n    YYTRIUM/APT29 campaign in 2016.\nreferences:\n    - https://twitter.com/DrunkBinary/status/1063075530180886529\nauthor: '@41thexplorer, Windows Defender ATP'\ndate: 2018/11/20\nmodified: 2018/12/11\ntags:\n    - attack.execution\n    - attack.t1085\ndetection:\n    condition: 1 of them\nlevel: high\n", "object_marking_refs": ["marking-definition--0a872d70-1d05-45dd-a25f-031af547a102"], "created_by_ref": "identity--082ca4f0-d825-45b6-aa42-ab9afd1e5503", "type": "indicator", "spec_version": "2.1", "id": "indicator--7d190299-9aaf-4d65-81b4-3be5d17ffe75"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--10ed6b7a-6d0c-4ce4-a5cb-24f0a00588c8", "created": "2020-04-02T07:58:59.223Z", "modified": "2020-04-02T07:58:59.223Z", "source_ref": "indicator--7d190299-9aaf-4d65-81b4-3be5d17ffe75", "relationship_type": "indicates", "target_ref": "attack-pattern--62b8c999-dcc0-4755-bd69-09442d9359f5"}, {"name": "IIS Native-Code Module Command Line Installation", "description": "Detects suspicious IIS native-code module installations via command line", "created": "2012-12-11T00:00:00.000Z", "valid_from": "2012-12-11T00:00:00Z", "indicator_types": ["malicious-activity"], "pattern_type": "sigma", "pattern": "title: IIS Native-Code Module Command Line Installation\nid: 9465ddf4-f9e4-4ebd-8d98-702df3a93239\ndescription: Detects suspicious IIS native-code module installations via command line\nstatus: experimental\nreferences:\n    - https://researchcenter.paloaltonetworks.com/2018/01/unit42-oilrig-uses-rgdoor-iis-backdoor-targets-middle-east/\nauthor: Florian Roth\ndate: 2012/12/11\ntags:\n    - attack.persistence\n    - attack.t1100\nlogsource:\n    category: process_creation\n    product: windows\ndetection:\n    selection:\n        CommandLine:\n            - '*\\APPCMD.EXE install module /name:*'\n    condition: selection\nfalsepositives:\n    - Unknown as it may vary from organisation to arganisation how admins use to install IIS modules\nlevel: medium\n", "object_marking_refs": ["marking-definition--0a872d70-1d05-45dd-a25f-031af547a102"], "created_by_ref": "identity--082ca4f0-d825-45b6-aa42-ab9afd1e5503", "type": "indicator", "spec_version": "2.1", "id": "indicator--af803066-7c49-4452-b551-c7ca11af90b3", "modified": "2020-04-02T07:58:59.229Z"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--cd012b65-901e-4d45-9cea-2bc438e9074f", "created": "2020-04-02T07:58:59.243Z", "modified": "2020-04-02T07:58:59.243Z", "source_ref": "indicator--af803066-7c49-4452-b551-c7ca11af90b3", "relationship_type": "indicates", "target_ref": "attack-pattern--c16e5409-ee53-4d79-afdc-4099dc9292df"}, {"name": "Stop Windows Service", "description": "Detects a windows service to be stopped", "created": "2019-10-23T00:00:00.000Z", "modified": "2019-11-08T00:00:00.000Z", "valid_from": "2019-10-23T00:00:00Z", "indicator_types": ["malicious-activity"], "pattern_type": "sigma", "pattern": "title: Stop Windows Service\nid: eb87818d-db5d-49cc-a987-d5da331fbd90\ndescription: Detects a windows service to be stopped\nstatus: experimental\nauthor: Jakob Weinzettl, oscd.community\ndate: 2019/10/23\nmodified: 2019/11/08\ntags:\n    - attack.impact\n    - attack.t1489\nlogsource:\n    category: process_creation\n    product: windows\ndetection:\n    selection:\n      - Image|endswith:\n            - '\\sc.exe'\n            - '\\net.exe'\n            - '\\net1.exe'\n        CommandLine|contains: 'stop'\n    condition: selection\nfields:\n    - ComputerName\n    - User\n    - CommandLine\nfalsepositives:\n    - Administrator shutting down the service due to upgrade or removal purposes\nlevel: low\n", "object_marking_refs": ["marking-definition--0a872d70-1d05-45dd-a25f-031af547a102"], "created_by_ref": "identity--082ca4f0-d825-45b6-aa42-ab9afd1e5503", "type": "indicator", "spec_version": "2.1", "id": "indicator--e83ef127-1155-488c-9d46-1059e9384a53"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--b502dc58-27b4-49a5-9736-8f02210791bf", "created": "2020-04-02T07:58:59.260Z", "modified": "2020-04-02T07:58:59.260Z", "source_ref": "indicator--e83ef127-1155-488c-9d46-1059e9384a53", "relationship_type": "indicates", "target_ref": "attack-pattern--20fb2507-d71c-455d-9b6d-6104461cf26b"}, {"name": "Exploiting CVE-2019-1388", "description": "Detects an explotation attempt in which the UAC consent dialogue is used to invoke an Internet Explorer process running as LOCAL_SYSTEM", "created": "2019-11-20T00:00:00.000Z", "valid_from": "2019-11-20T00:00:00Z", "indicator_types": ["malicious-activity"], "pattern_type": "sigma", "pattern": "title: Exploiting CVE-2019-1388\nid: 02e0b2ea-a597-428e-b04a-af6a1a403e5c\nstatus: experimental\ndescription: Detects an explotation attempt in which the UAC consent dialogue is used to invoke an Internet Explorer process running as LOCAL_SYSTEM\nreferences:\n    - https://portal.msrc.microsoft.com/en-US/security-guidance/advisory/CVE-2019-1388\n    - https://www.zerodayinitiative.com/blog/2019/11/19/thanksgiving-treat-easy-as-pie-windows-7-secure-desktop-escalation-of-privilege\nauthor: Florian Roth\ndate: 2019/11/20\ntags:\n    - attack.privilege_escalation\n    - attack.t1068\nlogsource:\n    category: process_creation\n    product: windows\ndetection:\n    selection:\n        ParentImage: '*\\consent.exe'\n        Image: '*\\iexplore.exe'\n        CommandLine: '* http*'\n    rights1:\n        IntegrityLevel: 'System'  # for Sysmon users\n    rights2: \n        User: 'NT AUTHORITY\\SYSTEM'  # for non-Sysmon users - English language settings\n    condition: selection and ( rights1 or rights2 )\nfalsepositives:\n    - Unknown\nlevel: critical\n", "object_marking_refs": ["marking-definition--0a872d70-1d05-45dd-a25f-031af547a102"], "created_by_ref": "identity--082ca4f0-d825-45b6-aa42-ab9afd1e5503", "type": "indicator", "spec_version": "2.1", "id": "indicator--756455ec-a3b7-4dce-b84a-91b36be96da7", "modified": "2020-04-02T07:58:59.264Z"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--a8a94eeb-dc77-4e3a-9ca7-9feb62d16918", "created": "2020-04-02T07:58:59.277Z", "modified": "2020-04-02T07:58:59.277Z", "source_ref": "indicator--756455ec-a3b7-4dce-b84a-91b36be96da7", "relationship_type": "indicates", "target_ref": "attack-pattern--b21c3b2d-02e6-45b1-980b-e69051040839"}, {"name": "Executables Started in Suspicious Folder", "description": "Detects process starts of binaries from a suspicious folder", "created": "2017-10-14T00:00:00.000Z", "modified": "2019-02-21T00:00:00.000Z", "valid_from": "2017-10-14T00:00:00Z", "indicator_types": ["malicious-activity"], "pattern_type": "sigma", "pattern": "title: Executables Started in Suspicious Folder\nid: 7a38aa19-86a9-4af7-ac51-6bfe4e59f254\nstatus: experimental\ndescription: Detects process starts of binaries from a suspicious folder\nauthor: Florian Roth\ndate: 2017/10/14\nmodified: 2019/02/21\nreferences:\n    - https://github.com/mbevilacqua/appcompatprocessor/blob/master/AppCompatSearch.txt\n    - https://www.secureworks.com/research/bronze-butler-targets-japanese-businesses\n    - https://www.crowdstrike.com/resources/reports/2019-crowdstrike-global-threat-report/\n    - https://github.com/ThreatHuntingProject/ThreatHunting/blob/master/hunts/suspicious_process_creation_via_windows_event_logs.md\ntags:\n    - attack.defense_evasion\n    - attack.t1036\nlogsource:\n    category: process_creation\n    product: windows\ndetection:\n    selection:\n        Image:\n            - C:\\PerfLogs\\\\*\n            - C:\\$Recycle.bin\\\\*\n            - C:\\Intel\\Logs\\\\*\n            - C:\\Users\\Default\\\\*\n            - C:\\Users\\Public\\\\*\n            - C:\\Users\\NetworkService\\\\*\n            - C:\\Windows\\Fonts\\\\*\n            - C:\\Windows\\Debug\\\\*\n            - C:\\Windows\\Media\\\\*\n            - C:\\Windows\\Help\\\\*\n            - C:\\Windows\\addins\\\\*\n            - C:\\Windows\\repair\\\\*\n            - C:\\Windows\\security\\\\*\n            - '*\\RSA\\MachineKeys\\\\*'\n            - C:\\Windows\\system32\\config\\systemprofile\\\\*\n            - C:\\Windows\\Tasks\\\\*\n            - C:\\Windows\\System32\\Tasks\\\\*\n    condition: selection\nfalsepositives:\n    - Unknown\nlevel: high\n", "object_marking_refs": ["marking-definition--0a872d70-1d05-45dd-a25f-031af547a102"], "created_by_ref": "identity--082ca4f0-d825-45b6-aa42-ab9afd1e5503", "type": "indicator", "spec_version": "2.1", "id": "indicator--25407bb7-fe5a-44d2-9b52-ab1213208665"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--40090450-405e-4e3d-a835-d3100f07b05b", "created": "2020-04-02T07:58:59.295Z", "modified": "2020-04-02T07:58:59.295Z", "source_ref": "indicator--25407bb7-fe5a-44d2-9b52-ab1213208665", "relationship_type": "indicates", "target_ref": "attack-pattern--42e8de7b-37b2-4258-905a-6897815e58e0"}, {"name": "Suspicious Eventlog Clear or Configuration Using Wevtutil", "description": "Detects clearing or configuration of eventlogs uwing wevtutil, powershell and wmic. Might be used by ransomwares during the attack (seen by NotPetya and others)", "created": "2019-09-26T00:00:00.000Z", "modified": "2019-11-11T00:00:00.000Z", "valid_from": "2019-09-26T00:00:00Z", "indicator_types": ["malicious-activity"], "pattern_type": "sigma", "pattern": "title: Suspicious Eventlog Clear or Configuration Using Wevtutil\nid: cc36992a-4671-4f21-a91d-6c2b72a2edf5\ndescription: Detects clearing or configuration of eventlogs uwing wevtutil, powershell and wmic. Might be used by ransomwares during the attack (seen by NotPetya and others)\nauthor: Ecco, Daniil Yugoslavskiy, oscd.community\nreferences:\n    - https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1070/T1070.yaml\n    - https://eqllib.readthedocs.io/en/latest/analytics/5b223758-07d6-4100-9e11-238cfdd0fe97.html\ndate: 2019/09/26\nmodified: 2019/11/11\ntags:\n    - attack.defense_evasion\n    - attack.t1070\n    - car.2016-04-002\nlevel: high\nlogsource:\n    category: process_creation\n    product: windows\ndetection:\n    selection_wevtutil_binary:\n        Image|endswith: '\\wevtutil.exe'\n    selection_wevtutil_command:\n        CommandLine|contains:  \n            - 'clear-log' # clears specified log\n            - ' cl '        # short version of 'clear-log'\n            - 'set-log'   # modifies config of specified log. could be uset to set it to a tiny size\n            - ' sl '        # short version of 'set-log'\n    selection_other_ps:\n        Image|endswith: '\\powershell.exe'\n        CommandLine|contains: \n            - 'Clear-EventLog'\n            - 'Remove-EventLog'\n            - 'Limit-EventLog'\n    selection_other_wmic:\n        Image|endswith: '\\wmic.exe'\n        CommandLine|contains: ' ClearEventLog '\n    condition: 1 of selection_other_* or (selection_wevtutil_binary and selection_wevtutil_command)\nfalsepositives:\n    - Admin activity\n    - Scripts and administrative tools used in the monitored environment\n", "object_marking_refs": ["marking-definition--0a872d70-1d05-45dd-a25f-031af547a102"], "created_by_ref": "identity--082ca4f0-d825-45b6-aa42-ab9afd1e5503", "type": "indicator", "spec_version": "2.1", "id": "indicator--e6789b77-e93a-4d22-a76b-a3c1cc1fb4b2"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--9c493ff2-0bbc-4a46-af21-b0163e8d3081", "created": "2020-04-02T07:58:59.313Z", "modified": "2020-04-02T07:58:59.313Z", "source_ref": "indicator--e6789b77-e93a-4d22-a76b-a3c1cc1fb4b2", "relationship_type": "indicates", "target_ref": "attack-pattern--799ace7f-e227-4411-baa0-8868704f2a69"}, {"name": "Exfiltration and Tunneling Tools Execution", "description": "Execution of well known tools for data exfiltration and tunneling", "created": "2019-10-24T00:00:00.000Z", "valid_from": "2019-10-24T00:00:00Z", "indicator_types": ["malicious-activity"], "pattern_type": "sigma", "pattern": "title: Exfiltration and Tunneling Tools Execution\nid: c75309a3-59f8-4a8d-9c2c-4c927ad50555\ndescription: Execution of well known tools for data exfiltration and tunneling\nstatus: experimental\nauthor: Daniil Yugoslavskiy, oscd.community\ndate: 2019/10/24\ntags:\n    - attack.exfiltration\n    - attack.t1020\nlogsource:\n    category: process_creation\n    product: windows\ndetection:\n    selection:\n        NewProcessName|endswith:\n            - '\\plink.exe'\n            - '\\socat.exe'\n            - '\\stunnel.exe'\n            - '\\httptunnel.exe'\n    condition: selection\nfalsepositives:\n    - Legitimate Administrator using tools\nlevel: medium\n", "object_marking_refs": ["marking-definition--0a872d70-1d05-45dd-a25f-031af547a102"], "created_by_ref": "identity--082ca4f0-d825-45b6-aa42-ab9afd1e5503", "type": "indicator", "spec_version": "2.1", "id": "indicator--6185f84a-f4a7-4a32-b1dd-bcd4dcc21207", "modified": "2020-04-02T07:58:59.317Z"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--398dbda7-f4a1-4293-8193-7eac8008ed6e", "created": "2020-04-02T07:58:59.329Z", "modified": "2020-04-02T07:58:59.329Z", "source_ref": "indicator--6185f84a-f4a7-4a32-b1dd-bcd4dcc21207", "relationship_type": "indicates", "target_ref": "attack-pattern--774a3188-6ba9-4dc4-879d-d54ee48a5ce9"}, {"name": "Droppers Exploiting CVE-2017-11882", "description": "Detects exploits that use CVE-2017-11882 to start EQNEDT32.EXE and other sub processes like mshta.exe", "created": "2017-11-23T00:00:00.000Z", "valid_from": "2017-11-23T00:00:00Z", "indicator_types": ["malicious-activity"], "pattern_type": "sigma", "pattern": "title: Droppers Exploiting CVE-2017-11882\nid: 678eb5f4-8597-4be6-8be7-905e4234b53a\nstatus: experimental\ndescription: Detects exploits that use CVE-2017-11882 to start EQNEDT32.EXE and other sub processes like mshta.exe\nreferences:\n    - https://www.hybrid-analysis.com/sample/2a4ae284c76f868fc51d3bb65da8caa6efacb707f265b25c30f34250b76b7507?environmentId=100\n    - https://www.google.com/url?hl=en&q=https://embedi.com/blog/skeleton-closet-ms-office-vulnerability-you-didnt-know-about&source=gmail&ust=1511481120837000&usg=AFQjCNGdL7gVwLXaNSl2Td8ylDYbSJFmPw\nauthor: Florian Roth\ndate: 2017/11/23\ntags:\n    - attack.defense_evasion\n    - attack.t1211\nlogsource:\n    category: process_creation\n    product: windows\ndetection:\n    selection:\n        ParentImage: '*\\EQNEDT32.EXE'\n    condition: selection\nfields:\n    - CommandLine\nfalsepositives:\n    - unknown\nlevel: critical\n", "object_marking_refs": ["marking-definition--0a872d70-1d05-45dd-a25f-031af547a102"], "created_by_ref": "identity--082ca4f0-d825-45b6-aa42-ab9afd1e5503", "type": "indicator", "spec_version": "2.1", "id": "indicator--f4edd7ad-3847-403c-b426-5bd61f9aa052", "modified": "2020-04-02T07:58:59.333Z"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--6217377a-f172-406c-b478-4d17a5802fcf", "created": "2020-04-02T07:58:59.346Z", "modified": "2020-04-02T07:58:59.346Z", "source_ref": "indicator--f4edd7ad-3847-403c-b426-5bd61f9aa052", "relationship_type": "indicates", "target_ref": "attack-pattern--fe926152-f431-4baf-956c-4ad3cb0bf23b"}, {"name": "Suspicious Certutil Command", "description": "Detects a suspicious Microsoft certutil execution with sub commands like 'decode' sub command, which is sometimes used to decode malicious code with the built-in certutil utility", "created": "2019-01-16T00:00:00.000Z", "modified": "2019-01-22T00:00:00.000Z", "valid_from": "2019-01-16T00:00:00Z", "indicator_types": ["malicious-activity"], "pattern_type": "sigma", "pattern": "title: Suspicious Certutil Command\nid: e011a729-98a6-4139-b5c4-bf6f6dd8239a\nstatus: experimental\ndescription: Detects a suspicious Microsoft certutil execution with sub commands like 'decode' sub command, which is sometimes used to decode malicious code with\n    the built-in certutil utility\nauthor: Florian Roth, juju4, keepwatch\nmodified: 2019/01/22\ndate: 2019/01/16\nreferences:\n    - https://twitter.com/JohnLaTwC/status/835149808817991680\n    - https://twitter.com/subTee/status/888102593838362624\n    - https://twitter.com/subTee/status/888071631528235010\n    - https://blogs.technet.microsoft.com/pki/2006/11/30/basic-crl-checking-with-certutil/\n    - https://www.trustedsec.com/2017/07/new-tool-release-nps_payload/\n    - https://twitter.com/egre55/status/1087685529016193025\n    - https://lolbas-project.github.io/lolbas/Binaries/Certutil/\nlogsource:\n    category: process_creation\n    product: windows\ndetection:\n    selection:\n        CommandLine:\n            - '* -decode *'\n            - '* /decode *'\n            - '* -decodehex *'\n            - '* /decodehex *'\n            - '* -urlcache *'\n            - '* /urlcache *'\n            - '* -verifyctl *'\n            - '* /verifyctl *'\n            - '* -encode *'\n            - '* /encode *'\n            - '*certutil* -URL*'\n            - '*certutil* /URL*'\n            - '*certutil* -ping*'\n            - '*certutil* /ping*'\n    condition: selection\nfields:\n    - CommandLine\n    - ParentCommandLine\ntags:\n    - attack.defense_evasion\n    - attack.t1140\n    - attack.t1105\n    - attack.s0189\n    - attack.g0007\nfalsepositives:\n    - False positives depend on scripts and administrative tools used in the monitored environment\nlevel: high\n", "object_marking_refs": ["marking-definition--0a872d70-1d05-45dd-a25f-031af547a102"], "created_by_ref": "identity--082ca4f0-d825-45b6-aa42-ab9afd1e5503", "type": "indicator", "spec_version": "2.1", "id": "indicator--6975d81d-fbf0-4b3e-b895-6553af171582"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--43cd4450-795b-4d1e-a794-54cc07fc83ba", "created": "2020-04-02T07:58:59.364Z", "modified": "2020-04-02T07:58:59.364Z", "source_ref": "indicator--6975d81d-fbf0-4b3e-b895-6553af171582", "relationship_type": "indicates", "target_ref": "attack-pattern--3ccef7ae-cb5e-48f6-8302-897105fbf55c"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--98f0ab4e-5449-4b44-b793-a2939268b78b", "created": "2020-04-02T07:58:59.375Z", "modified": "2020-04-02T07:58:59.375Z", "source_ref": "indicator--6975d81d-fbf0-4b3e-b895-6553af171582", "relationship_type": "indicates", "target_ref": "attack-pattern--e6919abc-99f9-4c6c-95a5-14761e7b2add"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--27211b20-9c69-443f-bb18-b74e479df4e4", "created": "2020-04-02T07:58:59.384Z", "modified": "2020-04-02T07:58:59.384Z", "source_ref": "indicator--6975d81d-fbf0-4b3e-b895-6553af171582", "relationship_type": "indicates", "target_ref": "malware--5be33fef-39c0-4532-84ee-bea31e1b5324"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--6eecb87f-ebcc-42bd-959a-a53f05e0b139", "created": "2020-04-02T07:58:59.396Z", "modified": "2020-04-02T07:58:59.396Z", "source_ref": "indicator--6975d81d-fbf0-4b3e-b895-6553af171582", "relationship_type": "indicates", "target_ref": "intrusion-set--bef4c620-0787-42a8-a96d-b7eb6e85917c"}, {"name": "Trickbot Malware Recon Activity", "description": "Trickbot enumerates domain/network topology and executes certain commands automatically every few minutes. This detectors attempts to identify that activity based off a command rarely observed in an enterprise network.", "created": "2019-12-28T00:00:00.000Z", "valid_from": "2019-12-28T00:00:00Z", "indicator_types": ["malicious-activity"], "pattern_type": "sigma", "pattern": "title: Trickbot Malware Recon Activity\nid: 410ad193-a728-4107-bc79-4419789fcbf8\nstatus: experimental\ndescription: Trickbot enumerates domain/network topology and executes certain commands automatically every few minutes. This detectors attempts to identify that activity based off a command rarely observed in an enterprise network.\nreferences:\n    - https://www.sneakymonkey.net/2019/05/22/trickbot-analysis/\nauthor: David Burkett\ndate: 2019/12/28\ntags:\n    - attack.t1482\nlogsource:\n    category: process_creation\n    product: windows\ndetection:\n    selection:\n        Image:\n            - '*\\nltest.exe'\n        CommandLine:\n            - '/domain_trusts /all_trusts'\n            - '/domain_trusts'\n    condition: selection\nfields:\n    - CommandLine\n    - ParentCommandLine\nfalsepositives:\n    - Rare System Admin Activity\nlevel: critical", "object_marking_refs": ["marking-definition--0a872d70-1d05-45dd-a25f-031af547a102"], "created_by_ref": "identity--082ca4f0-d825-45b6-aa42-ab9afd1e5503", "type": "indicator", "spec_version": "2.1", "id": "indicator--9d63c96f-9065-4271-82d6-4e7a82291b7f", "modified": "2020-04-02T07:58:59.400Z"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--d9f80501-cf86-4bb3-a58f-5c6c22d3c354", "created": "2020-04-02T07:58:59.411Z", "modified": "2020-04-02T07:58:59.411Z", "source_ref": "indicator--9d63c96f-9065-4271-82d6-4e7a82291b7f", "relationship_type": "indicates", "target_ref": "attack-pattern--767dbf9e-df3f-45cb-8998-4903ab5f80c0"}, {"name": "Discovery of a System Time", "description": "Identifies use of various commands to query a systems time. This technique may be used before executing a scheduled task or to discover the time zone of a target system.", "created": "2019-10-24T00:00:00.000Z", "modified": "2019-11-11T00:00:00.000Z", "valid_from": "2019-10-24T00:00:00Z", "indicator_types": ["malicious-activity"], "pattern_type": "sigma", "pattern": "title: Discovery of a System Time\nid: b243b280-65fe-48df-ba07-6ddea7646427\ndescription: \"Identifies use of various commands to query a systems time. This technique may be used before executing a scheduled task or to discover the time zone of a target system.\"\nstatus: experimental\nauthor: E.M. Anhaus (orignally from Atomic Blue Detections, Endgame), oscd.community\ndate: 2019/10/24\nmodified: 2019/11/11\nreferences:\n    - https://eqllib.readthedocs.io/en/latest/analytics/fcdb99c2-ac3c-4bde-b664-4b336329bed2.html\n    - https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1124/T1124.md\ntags:\n    - attack.discovery\n    - attack.t1124\nlogsource:\n    category: process_creation\n    product: windows\ndetection:\n    selection:\n      - Image|endswith: \n            - '\\net.exe'\n            - '\\net1.exe'\n        CommandLine|contains: 'time'\n      - Image|endswith: '\\w32tm.exe'\n        CommandLine|contains: 'tz'\n      - Image|endswith: '\\powershell.exe'\n        CommandLine|contains: 'Get-Date'\n    condition: selection\nfalsepositives:\n    - Legitimate use of the system utilities to discover system time for legitimate reason\nlevel: low\n", "object_marking_refs": ["marking-definition--0a872d70-1d05-45dd-a25f-031af547a102"], "created_by_ref": "identity--082ca4f0-d825-45b6-aa42-ab9afd1e5503", "type": "indicator", "spec_version": "2.1", "id": "indicator--1f853b57-dfcf-42a9-9733-0b79fa16a1a8"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--d8734f6b-8095-40ec-99d4-608cc5fec5d6", "created": "2020-04-02T07:58:59.428Z", "modified": "2020-04-02T07:58:59.428Z", "source_ref": "indicator--1f853b57-dfcf-42a9-9733-0b79fa16a1a8", "relationship_type": "indicates", "target_ref": "attack-pattern--f3c544dc-673c-4ef3-accb-53229f1ae077"}, {"name": "Disable of ETW Trace", "description": "Detects a command that clears or disables any ETW trace log which could indicate a logging evasion.", "created": "2019-03-22T00:00:00.000Z", "valid_from": "2019-03-22T00:00:00Z", "indicator_types": ["malicious-activity"], "pattern_type": "sigma", "pattern": "title: Disable of ETW Trace\nid: a238b5d0-ce2d-4414-a676-7a531b3d13d6\ndescription: Detects a command that clears or disables any ETW trace log which could indicate a logging evasion.\nstatus: experimental\nreferences:\n    - https://docs.microsoft.com/en-us/windows-server/administration/windows-commands/wevtutil\n    - https://github.com/Neo23x0/sigma/blob/master/rules/windows/process_creation/win_mal_lockergoga.yml\n    - https://abuse.io/lockergoga.txt\nauthor: '@neu5ron, Florian Roth'\ndate: 2019/03/22\ntags:\n    - attack.execution\n    - attack.t1070  \n    - car.2016-04-002  \nlevel: high\nlogsource:\n    category: process_creation\n    product: windows\ndetection:\n    selection_clear_1:\n        CommandLine: '* cl */Trace*'\n    selection_clear_2:\n        CommandLine: '* clear-log */Trace*'\n    selection_disable_1:\n        CommandLine: '* sl* /e:false*'\n    selection_disable_2:\n        CommandLine: '* set-log* /e:false*'\n    condition: selection_clear_1 or selection_clear_2 or selection_disable_1 or selection_disable_2\nfalsepositives:\n    - Unknown\n", "object_marking_refs": ["marking-definition--0a872d70-1d05-45dd-a25f-031af547a102"], "created_by_ref": "identity--082ca4f0-d825-45b6-aa42-ab9afd1e5503", "type": "indicator", "spec_version": "2.1", "id": "indicator--8fdf48bb-33e7-459e-a663-be8103a35a50", "modified": "2020-04-02T07:58:59.433Z"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--1aa763fe-31c8-44f1-ba60-22c94c3c41e0", "created": "2020-04-02T07:58:59.445Z", "modified": "2020-04-02T07:58:59.445Z", "source_ref": "indicator--8fdf48bb-33e7-459e-a663-be8103a35a50", "relationship_type": "indicates", "target_ref": "attack-pattern--799ace7f-e227-4411-baa0-8868704f2a69"}, {"name": "CrackMapExecWin", "description": "Detects CrackMapExecWin Activity as Described by NCSC", "created": "2018-04-08T00:00:00.000Z", "valid_from": "2018-04-08T00:00:00Z", "indicator_types": ["malicious-activity"], "pattern_type": "sigma", "pattern": "title: CrackMapExecWin\nid: 04d9079e-3905-4b70-ad37-6bdf11304965\ndescription: Detects CrackMapExecWin Activity as Described by NCSC\nstatus: experimental\nreferences:\n    - https://www.ncsc.gov.uk/alerts/hostile-state-actors-compromising-uk-organisations-focus-engineering-and-industrial-control\ntags:\n    - attack.g0035\nauthor: Markus Neis\ndate: 2018/04/08\nlogsource:\n    category: process_creation\n    product: windows\ndetection:\n    selection:\n        Image:\n            - '*\\crackmapexec.exe'\n    condition: selection\nfalsepositives:\n    - None\nlevel: critical\n", "object_marking_refs": ["marking-definition--0a872d70-1d05-45dd-a25f-031af547a102"], "created_by_ref": "identity--082ca4f0-d825-45b6-aa42-ab9afd1e5503", "type": "indicator", "spec_version": "2.1", "id": "indicator--550054d5-d444-4800-8c10-a5facd5d12b1", "modified": "2020-04-02T07:58:59.448Z"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--12b7abc7-8d0f-48e9-877d-5a9951727cb0", "created": "2020-04-02T07:58:59.459Z", "modified": "2020-04-02T07:58:59.459Z", "source_ref": "indicator--550054d5-d444-4800-8c10-a5facd5d12b1", "relationship_type": "indicates", "target_ref": "intrusion-set--1c63d4ec-0a75-4daa-b1df-0d11af3d3cc1"}, {"name": "PowerShell DownloadFile", "description": "Detects the execution of powershell, a WebClient object creation and the invocation of DownloadFile in a single command line", "created": "2020-03-25T00:00:00.000Z", "valid_from": "2020-03-25T00:00:00Z", "indicator_types": ["malicious-activity"], "pattern_type": "sigma", "pattern": "title: PowerShell DownloadFile\nid: 8f70ac5f-1f6f-4f8e-b454-db19561216c5\nstatus: experimental\ndescription: Detects the execution of powershell, a WebClient object creation and the invocation of DownloadFile in a single command line\nreferences:\n    - https://www.fireeye.com/blog/threat-research/2020/03/apt41-initiates-global-intrusion-campaign-using-multiple-exploits.html\nauthor: Florian Roth\ndate: 2020/03/25\ntags:\n    - attack.execution\n    - attack.t1086\nlogsource:\n    category: process_creation\n    product: windows\ndetection:\n    selection:\n        CommandLine|contains|all: \n            - 'powershell'\n            - '.DownloadFile'\n            - 'System.Net.WebClient'\n    condition: selection\nfalsepositives:\n    - Unknown\nlevel: high\n", "object_marking_refs": ["marking-definition--0a872d70-1d05-45dd-a25f-031af547a102"], "created_by_ref": "identity--082ca4f0-d825-45b6-aa42-ab9afd1e5503", "type": "indicator", "spec_version": "2.1", "id": "indicator--ad860f0a-8d4f-4403-93fd-bd8020b359a6", "modified": "2020-04-02T07:58:59.463Z"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--19406a1f-c0cb-41a2-a7ed-46a446f0ce23", "created": "2020-04-02T07:58:59.472Z", "modified": "2020-04-02T07:58:59.472Z", "source_ref": "indicator--ad860f0a-8d4f-4403-93fd-bd8020b359a6", "relationship_type": "indicates", "target_ref": "attack-pattern--f4882e23-8aa7-4b12-b28a-b349c12ee9e0"}, {"name": "Execution of Renamed PaExec", "description": "Detects execution of renamed paexec via imphash and executable product string", "created": "2019-04-17T00:00:00.000Z", "valid_from": "2019-04-17T00:00:00Z", "indicator_types": ["malicious-activity"], "pattern_type": "sigma", "pattern": "title: Execution of Renamed PaExec\nid: 7b0666ad-3e38-4e3d-9bab-78b06de85f7b\nstatus: experimental\ndescription: Detects execution of renamed paexec via imphash and executable product string\nreferences:\n    - sha256=01a461ad68d11b5b5096f45eb54df9ba62c5af413fa9eb544eacb598373a26bc\n    - https://summit.fireeye.com/content/dam/fireeye-www/summit/cds-2018/presentations/cds18-technical-s05-att&cking-fin7.pdf\ntags:\n    - attack.defense_evasion\n    - attack.t1036\n    - FIN7\n    - car.2013-05-009\ndate: 2019/04/17\nauthor: Jason Lynch \nfalsepositives:\n    - Unknown imphashes\nlevel: medium\nlogsource:\n    category: process_creation\n    product: windows\ndetection:\n    selection1:\n        Product:\n            - '*PAExec*'\n    selection2:\n        Imphash:\n            - 11D40A7B7876288F919AB819CC2D9802\n            - 6444f8a34e99b8f7d9647de66aabe516\n            - dfd6aa3f7b2b1035b76b718f1ddc689f\n            - 1a6cca4d5460b1710a12dea39e4a592c\n    filter1:\n        Image: '*paexec*'\n    condition: (selection1 and selection2) and not filter1\n", "object_marking_refs": ["marking-definition--0a872d70-1d05-45dd-a25f-031af547a102"], "created_by_ref": "identity--082ca4f0-d825-45b6-aa42-ab9afd1e5503", "type": "indicator", "spec_version": "2.1", "id": "indicator--e78f6b22-0a7b-4652-bae8-a17b098cac48", "modified": "2020-04-02T07:58:59.477Z"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--e67a2e8e-6c5f-42f8-8979-f9a213b8eafb", "created": "2020-04-02T07:58:59.487Z", "modified": "2020-04-02T07:58:59.487Z", "source_ref": "indicator--e78f6b22-0a7b-4652-bae8-a17b098cac48", "relationship_type": "indicates", "target_ref": "attack-pattern--42e8de7b-37b2-4258-905a-6897815e58e0"}, {"name": "Shadow Copies Creation Using Operating Systems Utilities", "description": "Shadow Copies creation using operating systems utilities, possible credential access", "created": "2019-10-22T00:00:00.000Z", "valid_from": "2019-10-22T00:00:00Z", "indicator_types": ["malicious-activity"], "pattern_type": "sigma", "pattern": "title: Shadow Copies Creation Using Operating Systems Utilities\nid: b17ea6f7-6e90-447e-a799-e6c0a493d6ce\ndescription: Shadow Copies creation using operating systems utilities, possible credential access\nauthor: Teymur Kheirkhabarov, Daniil Yugoslavskiy, oscd.community\ndate: 2019/10/22\nreferences:\n    - https://www.slideshare.net/heirhabarov/hunting-for-credentials-dumping-in-windows-environment\n    - https://www.trustwave.com/en-us/resources/blogs/spiderlabs-blog/tutorial-for-ntds-goodness-vssadmin-wmis-ntdsdit-system/\ntags:\n    - attack.credential_access\n    - attack.t1003\nlogsource:\n    category: process_creation\n    product: windows\ndetection:\n    selection:\n        NewProcessName|endswith:\n            - '\\powershell.exe'\n            - '\\wmic.exe'\n            - '\\vssadmin.exe'\n        CommandLine|contains|all:\n            - shadow\n            - create\n    condition: selection\nfalsepositives:\n    - Legitimate administrator working with shadow copies, access for backup purposes\nstatus: experimental\nlevel: medium\n", "object_marking_refs": ["marking-definition--0a872d70-1d05-45dd-a25f-031af547a102"], "created_by_ref": "identity--082ca4f0-d825-45b6-aa42-ab9afd1e5503", "type": "indicator", "spec_version": "2.1", "id": "indicator--0393e57d-3fe8-4643-aeae-8cefbfa4c56a", "modified": "2020-04-02T07:58:59.491Z"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--69909798-b7fd-46a9-a8d3-76cc74d9076a", "created": "2020-04-02T07:58:59.502Z", "modified": "2020-04-02T07:58:59.502Z", "source_ref": "indicator--0393e57d-3fe8-4643-aeae-8cefbfa4c56a", "relationship_type": "indicates", "target_ref": "attack-pattern--0a3ead4e-6d47-4ccb-854c-a6a4f9d96b22"}, {"name": "Mshta JavaScript Execution", "description": "Identifies suspicious mshta.exe commands", "created": "2019-10-24T00:00:00.000Z", "modified": "2019-11-11T00:00:00.000Z", "valid_from": "2019-10-24T00:00:00Z", "indicator_types": ["malicious-activity"], "pattern_type": "sigma", "pattern": "title: Mshta JavaScript Execution\nid: 67f113fa-e23d-4271-befa-30113b3e08b1\ndescription: Identifies suspicious mshta.exe commands\nstatus: experimental\nauthor: E.M. Anhaus (orignally from Atomic Blue Detections, Endgame), oscd.community\ndate: 2019/10/24\nmodified: 2019/11/11\nreferences:\n    - https://eqllib.readthedocs.io/en/latest/analytics/6bc283c4-21f2-4aed-a05c-a9a3ffa95dd4.html\n    - https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1170/T1170.yaml\ntags:\n    - attack.execution\n    - attack.defense_evasion\n    - attack.t1170\nlogsource:\n    category: process_creation\n    product: windows\ndetection:\n    selection:\n        Image|endswith: '\\mshta.exe'\n        CommandLine|contains: 'javascript'\n    condition: selection\nfields:\n    - ComputerName\n    - User\n    - CommandLine\nfalsepositives:\n    - unknown\nlevel: high\n## todo \u2014 add sysmon eid 3 for this rule\n", "object_marking_refs": ["marking-definition--0a872d70-1d05-45dd-a25f-031af547a102"], "created_by_ref": "identity--082ca4f0-d825-45b6-aa42-ab9afd1e5503", "type": "indicator", "spec_version": "2.1", "id": "indicator--1acf2830-50ed-4492-b2fc-a6b8ace4312c"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--16eb2f2a-abfe-4ad9-802b-c4c992ef94b1", "created": "2020-04-02T07:58:59.518Z", "modified": "2020-04-02T07:58:59.518Z", "source_ref": "indicator--1acf2830-50ed-4492-b2fc-a6b8ace4312c", "relationship_type": "indicates", "target_ref": "attack-pattern--a127c32c-cbb0-4f9d-be07-881a792408ec"}, {"name": "Control Panel Items", "description": "Detects the use of a control panel item (.cpl) outside of the System32 folder", "created": "2019-08-27T00:00:00.000Z", "valid_from": "2019-08-27T00:00:00Z", "indicator_types": ["malicious-activity"], "pattern_type": "sigma", "pattern": "title: Control Panel Items\nid: 0ba863e6-def5-4e50-9cea-4dd8c7dc46a4\nstatus: experimental\ndescription: Detects the use of a control panel item (.cpl) outside of the System32 folder\nreference:\n    - https://attack.mitre.org/techniques/T1196/\ntags:\n    - attack.execution\n    - attack.t1196\n    - attack.defense_evasion\nauthor: Kyaw Min Thein\ndate: 2019/08/27\nlevel: critical\nlogsource:\n    product: windows\n    category: process_creation\ndetection:\n    selection:\n        CommandLine: '*.cpl'\n    filter:\n        CommandLine:\n            - '*\\System32\\\\*'\n            - '*%System%*'\n    condition: selection and not filter\nfalsepositives:\n    - Unknown\n", "object_marking_refs": ["marking-definition--0a872d70-1d05-45dd-a25f-031af547a102"], "created_by_ref": "identity--082ca4f0-d825-45b6-aa42-ab9afd1e5503", "type": "indicator", "spec_version": "2.1", "id": "indicator--c3db29b3-73f3-409c-9c6f-1cd9f10bd2db", "modified": "2020-04-02T07:58:59.521Z"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--ca6df025-1ccd-451b-b233-2f68ef218132", "created": "2020-04-02T07:58:59.533Z", "modified": "2020-04-02T07:58:59.533Z", "source_ref": "indicator--c3db29b3-73f3-409c-9c6f-1cd9f10bd2db", "relationship_type": "indicates", "target_ref": "attack-pattern--8df54627-376c-487c-a09c-7d2b5620f56e"}, {"name": "MavInject Process Injection", "description": "Detects process injection using the signed Windows tool Mavinject32.exe", "created": "2018-12-12T00:00:00.000Z", "valid_from": "2018-12-12T00:00:00Z", "indicator_types": ["malicious-activity"], "pattern_type": "sigma", "pattern": "title: MavInject Process Injection\nid: 17eb8e57-9983-420d-ad8a-2c4976c22eb8\nstatus: experimental\ndescription: Detects process injection using the signed Windows tool Mavinject32.exe\nreferences:\n    - https://twitter.com/gN3mes1s/status/941315826107510784\n    - https://reaqta.com/2017/12/mavinject-microsoft-injector/\n    - https://twitter.com/Hexacorn/status/776122138063409152\nauthor: Florian Roth\ndate: 2018/12/12\ntags:\n    - attack.t1055\n    - attack.t1218\nlogsource:\n    category: process_creation\n    product: windows\ndetection:\n    selection:\n        CommandLine: '* /INJECTRUNNING *'\n    condition: selection\nfalsepositives:\n    - unknown\nlevel: critical\n", "object_marking_refs": ["marking-definition--0a872d70-1d05-45dd-a25f-031af547a102"], "created_by_ref": "identity--082ca4f0-d825-45b6-aa42-ab9afd1e5503", "type": "indicator", "spec_version": "2.1", "id": "indicator--6baf709e-26bf-4e24-b559-d72f85521120", "modified": "2020-04-02T07:58:59.536Z"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--01cf23d1-7d6b-486a-809a-2661835179e1", "created": "2020-04-02T07:58:59.548Z", "modified": "2020-04-02T07:58:59.548Z", "source_ref": "indicator--6baf709e-26bf-4e24-b559-d72f85521120", "relationship_type": "indicates", "target_ref": "attack-pattern--43e7dc91-05b2-474c-b9ac-2ed4fe101f4d"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--8c38f417-b091-44db-894e-d635f23f2911", "created": "2020-04-02T07:58:59.559Z", "modified": "2020-04-02T07:58:59.559Z", "source_ref": "indicator--6baf709e-26bf-4e24-b559-d72f85521120", "relationship_type": "indicates", "target_ref": "attack-pattern--457c7820-d331-465a-915e-42f85500ccc4"}, {"name": "Suspicious Csc.exe Source File Folder", "description": "Detects a suspicious execution of csc.exe, which uses a source in a suspicious folder (e.g. AppData)", "created": "2019-08-24T00:00:00.000Z", "modified": "2019-12-17T00:00:00.000Z", "valid_from": "2019-08-24T00:00:00Z", "indicator_types": ["malicious-activity"], "pattern_type": "sigma", "pattern": "title: Suspicious Csc.exe Source File Folder\nid: dcaa3f04-70c3-427a-80b4-b870d73c94c4\ndescription: Detects a suspicious execution of csc.exe, which uses a source in a suspicious folder (e.g. AppData)\nstatus: experimental\nreferences:\n    - https://securityboulevard.com/2019/08/agent-tesla-evading-edr-by-removing-api-hooks/\n    - https://www.clearskysec.com/wp-content/uploads/2018/11/MuddyWater-Operations-in-Lebanon-and-Oman.pdf\n    - https://app.any.run/tasks/c6993447-d1d8-414e-b856-675325e5aa09/\n    - https://twitter.com/gN3mes1s/status/1206874118282448897\nauthor: Florian Roth\ndate: 2019/08/24\nmodified: 2019/12/17\ntags:\n    - attack.defense_evasion\n    - attack.t1500\nlogsource:\n    category: process_creation\n    product: windows\ndetection:\n    selection:\n        Image: '*\\csc.exe'\n        CommandLine: \n            - '*\\AppData\\\\*'\n            - '*\\Windows\\Temp\\\\*'\n    filter:\n        ParentImage: \n            - 'C:\\Program Files*'  # https://twitter.com/gN3mes1s/status/1206874118282448897\n            - '*\\sdiagnhost.exe'  # https://twitter.com/gN3mes1s/status/1206874118282448897\n            - '*\\w3wp.exe'  # https://twitter.com/gabriele_pippi/status/1206907900268072962\n    condition: selection and not filter\nfalsepositives:\n    - https://twitter.com/gN3mes1s/status/1206874118282448897\n    - https://twitter.com/gabriele_pippi/status/1206907900268072962\nlevel: high\n", "object_marking_refs": ["marking-definition--0a872d70-1d05-45dd-a25f-031af547a102"], "created_by_ref": "identity--082ca4f0-d825-45b6-aa42-ab9afd1e5503", "type": "indicator", "spec_version": "2.1", "id": "indicator--98dea92e-5d28-4cf3-8f15-88b15ad30e64"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--e8e9d54f-355f-413f-96b3-c5d60f55f3d2", "created": "2020-04-02T07:58:59.576Z", "modified": "2020-04-02T07:58:59.576Z", "source_ref": "indicator--98dea92e-5d28-4cf3-8f15-88b15ad30e64", "relationship_type": "indicates", "target_ref": "attack-pattern--cf7b3a06-8b42-4c33-bbe9-012120027925"}, {"name": "Suspicious Program Location Process Starts", "description": "Detects programs running in suspicious files system locations", "created": "2019-01-15T00:00:00.000Z", "valid_from": "2019-01-15T00:00:00Z", "indicator_types": ["malicious-activity"], "pattern_type": "sigma", "pattern": "title: Suspicious Program Location Process Starts\nid: f50bfd8b-e2a3-4c15-9373-7900b5a4c6d5\nstatus: experimental\ndescription: Detects programs running in suspicious files system locations\nreferences:\n    - https://docs.google.com/spreadsheets/d/17pSTDNpa0sf6pHeRhusvWG6rThciE8CsXTSlDUAZDyo\ntags:\n    - attack.defense_evasion\n    - attack.t1036\nauthor: Florian Roth\ndate: 2019/01/15\nlogsource:\n    category: process_creation\n    product: windows\ndetection:\n    selection:\n        Image:\n            - '*\\$Recycle.bin'\n            - '*\\Users\\Public\\\\*'\n            - 'C:\\Perflogs\\\\*'\n            - '*\\Windows\\Fonts\\\\*'\n            - '*\\Windows\\IME\\\\*'\n            - '*\\Windows\\addins\\\\*'\n            - '*\\Windows\\debug\\\\*'\n    condition: selection\nfalsepositives:\n    - unknown\nlevel: high\n", "object_marking_refs": ["marking-definition--0a872d70-1d05-45dd-a25f-031af547a102"], "created_by_ref": "identity--082ca4f0-d825-45b6-aa42-ab9afd1e5503", "type": "indicator", "spec_version": "2.1", "id": "indicator--e19365da-2963-437d-ad86-f2501f08219a", "modified": "2020-04-02T07:58:59.579Z"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--981562dd-f3de-48ce-812f-0b7c55e4dd4c", "created": "2020-04-02T07:58:59.590Z", "modified": "2020-04-02T07:58:59.590Z", "source_ref": "indicator--e19365da-2963-437d-ad86-f2501f08219a", "relationship_type": "indicates", "target_ref": "attack-pattern--42e8de7b-37b2-4258-905a-6897815e58e0"}, {"name": "Suspicious TSCON Start", "description": "Detects a tscon.exe start as LOCAL SYSTEM", "created": "2018-03-17T00:00:00.000Z", "valid_from": "2018-03-17T00:00:00Z", "indicator_types": ["malicious-activity"], "pattern_type": "sigma", "pattern": "title: Suspicious TSCON Start\nid: 9847f263-4a81-424f-970c-875dab15b79b\nstatus: experimental\ndescription: Detects a tscon.exe start as LOCAL SYSTEM\nreferences:\n    - http://www.korznikov.com/2017/03/0-day-or-feature-privilege-escalation.html\n    - https://medium.com/@networksecurity/rdp-hijacking-how-to-hijack-rds-and-remoteapp-sessions-transparently-to-move-through-an-da2a1e73a5f6\nauthor: Florian Roth\ndate: 2018/03/17\ntags:\n    - attack.command_and_control\n    - attack.t1219\nlogsource:\n    category: process_creation\n    product: windows\ndetection:\n    selection:\n        User: NT AUTHORITY\\SYSTEM\n        Image: '*\\tscon.exe'\n    condition: selection\nfalsepositives:\n    - Unknown\nlevel: high\n", "object_marking_refs": ["marking-definition--0a872d70-1d05-45dd-a25f-031af547a102"], "created_by_ref": "identity--082ca4f0-d825-45b6-aa42-ab9afd1e5503", "type": "indicator", "spec_version": "2.1", "id": "indicator--0d40b5b5-c26a-412f-b64b-ef28e2a022bf", "modified": "2020-04-02T07:58:59.594Z"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--f37fcfc9-eec5-4679-b79a-c8996bf67593", "created": "2020-04-02T07:58:59.605Z", "modified": "2020-04-02T07:58:59.605Z", "source_ref": "indicator--0d40b5b5-c26a-412f-b64b-ef28e2a022bf", "relationship_type": "indicates", "target_ref": "attack-pattern--4061e78c-1284-44b4-9116-73e4ac3912f7"}, {"name": "CMSTP UAC Bypass via COM Object Access", "description": "Detects UAC Bypass Attempt Using Microsoft Connection Manager Profile Installer Autoelevate-capable COM Objects", "created": "2019-01-16T00:00:00.000Z", "modified": "2019-07-31T00:00:00.000Z", "valid_from": "2019-01-16T00:00:00Z", "indicator_types": ["malicious-activity"], "pattern_type": "sigma", "pattern": "title: CMSTP UAC Bypass via COM Object Access\nid: 4b60e6f2-bf39-47b4-b4ea-398e33cfe253\nstatus: stable\ndescription: Detects UAC Bypass Attempt Using Microsoft Connection Manager Profile Installer Autoelevate-capable COM Objects\ntags:\n    - attack.defense_evasion\n    - attack.privilege_escalation\n    - attack.execution\n    - attack.t1088\n    - attack.t1191\n    - attack.g0069\n    - car.2019-04-001\nauthor: Nik Seetharaman\nmodified: 2019/07/31\ndate: 2019/01/16\nreferences:\n    - http://www.endurant.io/cmstp/detecting-cmstp-enabled-code-execution-and-uac-bypass-with-sysmon/\n    - https://twitter.com/hFireF0X/status/897640081053364225\nlogsource:\n    category: process_creation\n    product: windows\ndetection:\n    selection1:\n        ParentCommandLine: '*\\DllHost.exe'\n    selection2:\n        ParentCommandLine:\n            - '*{3E5FC7F9-9A51-4367-9063-A120244FBEC7}'\n            - '*{3E000D72-A845-4CD9-BD83-80C07C3B881F}'\n    condition: selection1 and selection2\nfields:\n    - CommandLine\n    - ParentCommandLine\n    - Hashes\nfalsepositives:\n    - Legitimate CMSTP use (unlikely in modern enterprise environments)\nlevel: high\n", "object_marking_refs": ["marking-definition--0a872d70-1d05-45dd-a25f-031af547a102"], "created_by_ref": "identity--082ca4f0-d825-45b6-aa42-ab9afd1e5503", "type": "indicator", "spec_version": "2.1", "id": "indicator--f3611ed3-6765-4b12-8933-7d30be9c9279"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--759c903f-3f43-4817-9720-e805b3c61c4a", "created": "2020-04-02T07:58:59.625Z", "modified": "2020-04-02T07:58:59.625Z", "source_ref": "indicator--f3611ed3-6765-4b12-8933-7d30be9c9279", "relationship_type": "indicates", "target_ref": "attack-pattern--ca1a3f50-5ebd-41f8-8320-2c7d6a6e88be"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--1f1d0ff0-14ff-4f75-943c-70e99d8e52d6", "created": "2020-04-02T07:58:59.636Z", "modified": "2020-04-02T07:58:59.636Z", "source_ref": "indicator--f3611ed3-6765-4b12-8933-7d30be9c9279", "relationship_type": "indicates", "target_ref": "attack-pattern--7d6f590f-544b-45b4-9a42-e0805f342af3"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--487c7332-ed56-4b3b-b924-de9f360adcbd", "created": "2020-04-02T07:58:59.646Z", "modified": "2020-04-02T07:58:59.646Z", "source_ref": "indicator--f3611ed3-6765-4b12-8933-7d30be9c9279", "relationship_type": "indicates", "target_ref": "intrusion-set--269e8108-68c6-4f99-b911-14b2e765dec2"}, {"name": "Possible Privilege Escalation via Weak Service Permissions", "description": "Detection of sc.exe utility spawning by user with Medium integrity level to change service ImagePath or FailureCommand", "created": "2019-10-26T00:00:00.000Z", "modified": "2019-11-11T00:00:00.000Z", "valid_from": "2019-10-26T00:00:00Z", "indicator_types": ["malicious-activity"], "pattern_type": "sigma", "pattern": "title: Possible Privilege Escalation via Weak Service Permissions\nid: d937b75f-a665-4480-88a5-2f20e9f9b22a\ndescription: Detection of sc.exe utility spawning by user with Medium integrity level to change service ImagePath or FailureCommand\nreferences:\n    - https://speakerdeck.com/heirhabarov/hunting-for-privilege-escalation-in-windows-environment\n    - https://pentestlab.blog/2017/03/30/weak-service-permissions/\ntags:\n    - attack.privilege_escalation\n    - attack.t1134\nstatus: experimental\nauthor: Teymur Kheirkhabarov\ndate: 2019/10/26\nmodified: 2019/11/11\nlogsource:\n    category: process_creation\n    product: windows\ndetection:\n    scbynonadmin:\n        Image|endswith: '\\sc.exe'\n        IntegrityLevel: 'Medium'\n    binpath:\n        CommandLine|contains|all:\n            - 'config'\n            - 'binPath'\n    failurecommand:\n        CommandLine|contains|all: \n            - 'failure'\n            - 'command'\n    condition: scbynonadmin and (binpath or failurecommand)\nfalsepositives:\n    - Unknown\nlevel: high\n", "object_marking_refs": ["marking-definition--0a872d70-1d05-45dd-a25f-031af547a102"], "created_by_ref": "identity--082ca4f0-d825-45b6-aa42-ab9afd1e5503", "type": "indicator", "spec_version": "2.1", "id": "indicator--5323f4a4-fc83-48b2-949f-a97fcd4b93aa"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--b44c9e08-e5a9-49f9-a120-432cd61a327f", "created": "2020-04-02T07:58:59.662Z", "modified": "2020-04-02T07:58:59.662Z", "source_ref": "indicator--5323f4a4-fc83-48b2-949f-a97fcd4b93aa", "relationship_type": "indicates", "target_ref": "attack-pattern--dcaa092b-7de9-4a21-977f-7fcb77e89c48"}, {"name": "Invocation of Active Directory Diagnostic Tool (ntdsutil.exe)", "description": "Detects execution of ntdsutil.exe, which can be used for various attacks against the NTDS database (NTDS.DIT)", "created": "2019-01-16T00:00:00.000Z", "valid_from": "2019-01-16T00:00:00Z", "indicator_types": ["malicious-activity"], "pattern_type": "sigma", "pattern": "title: Invocation of Active Directory Diagnostic Tool (ntdsutil.exe)\nid: 2afafd61-6aae-4df4-baed-139fa1f4c345\ndescription: Detects execution of ntdsutil.exe, which can be used for various attacks against the NTDS database (NTDS.DIT)\nstatus: experimental\nreferences:\n    - https://jpcertcc.github.io/ToolAnalysisResultSheet/details/ntdsutil.htm\nauthor: Thomas Patzke\ndate: 2019/01/16\ntags:\n    - attack.credential_access\n    - attack.t1003\nlogsource:\n    category: process_creation\n    product: windows\ndetection:\n    selection:\n        CommandLine: '*\\ntdsutil*'\n    condition: selection\nfalsepositives:\n    - NTDS maintenance\nlevel: high\n", "object_marking_refs": ["marking-definition--0a872d70-1d05-45dd-a25f-031af547a102"], "created_by_ref": "identity--082ca4f0-d825-45b6-aa42-ab9afd1e5503", "type": "indicator", "spec_version": "2.1", "id": "indicator--73031ea5-340f-40df-b673-33e034d67e39", "modified": "2020-04-02T07:58:59.665Z"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--bdd7f878-7d21-473b-8a12-e7db3ce75024", "created": "2020-04-02T07:58:59.676Z", "modified": "2020-04-02T07:58:59.676Z", "source_ref": "indicator--73031ea5-340f-40df-b673-33e034d67e39", "relationship_type": "indicates", "target_ref": "attack-pattern--0a3ead4e-6d47-4ccb-854c-a6a4f9d96b22"}, {"name": "New Service Creation", "description": "Detects creation if a new service", "created": "2019-10-21T00:00:00.000Z", "modified": "2019-11-04T00:00:00.000Z", "valid_from": "2019-10-21T00:00:00Z", "indicator_types": ["malicious-activity"], "pattern_type": "sigma", "pattern": "title: New Service Creation\nid: 7fe71fc9-de3b-432a-8d57-8c809efc10ab\nstatus: experimental\ndescription: Detects creation if a new service\nauthor: Timur Zinniatullin, Daniil Yugoslavskiy, oscd.community\ndate: 2019/10/21\nmodified: 2019/11/04\ntags:\n    - attack.persistence\n    - attack.privilege_escalation\n    - attack.t1050\nreferences:\n    - https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1050/T1050.yaml\nlogsource:\n    category: process_creation\n    product: windows\ndetection:\n    selection:\n      - Image|endswith: '\\sc.exe'\n        CommandLine|contains|all:\n            - 'create'\n            - 'binpath'\n      - Image|endswith: '\\powershell.exe'\n        CommandLine|contains: 'new-service'\n    condition: selection\nfalsepositives:\n    - Legitimate administrator or user creates a service for legitimate reason\nlevel: low\n", "object_marking_refs": ["marking-definition--0a872d70-1d05-45dd-a25f-031af547a102"], "created_by_ref": "identity--082ca4f0-d825-45b6-aa42-ab9afd1e5503", "type": "indicator", "spec_version": "2.1", "id": "indicator--9af8003d-cbad-45ba-ab8b-5699d4d443f2"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--87674eea-fa12-4264-86ec-9d4fc871318c", "created": "2020-04-02T07:58:59.696Z", "modified": "2020-04-02T07:58:59.696Z", "source_ref": "indicator--9af8003d-cbad-45ba-ab8b-5699d4d443f2", "relationship_type": "indicates", "target_ref": "attack-pattern--478aa214-2ca7-4ec0-9978-18798e514790"}, {"name": "Encoded IEX", "description": "Detects a base64 encoded IEX command string in a process command line", "created": "2019-08-23T00:00:00.000Z", "valid_from": "2019-08-23T00:00:00Z", "indicator_types": ["malicious-activity"], "pattern_type": "sigma", "pattern": "title: Encoded IEX\nid: 88f680b8-070e-402c-ae11-d2914f2257f1\nstatus: experimental\ndescription: Detects a base64 encoded IEX command string in a process command line\nauthor: Florian Roth\ndate: 2019/08/23\ntags:\n    - attack.t1086\n    - attack.t1140\n    - attack.execution\nlogsource:\n    category: process_creation\n    product: windows\ndetection:\n    selection:\n        CommandLine|base64offset|contains: \n          - 'IEX (['\n          - 'iex (['\n          - 'iex (New'\n          - 'IEX (New'\n    condition: selection\nfields:\n    - CommandLine\n    - ParentCommandLine\nfalsepositives:\n    - unknown\nlevel: critical\n", "object_marking_refs": ["marking-definition--0a872d70-1d05-45dd-a25f-031af547a102"], "created_by_ref": "identity--082ca4f0-d825-45b6-aa42-ab9afd1e5503", "type": "indicator", "spec_version": "2.1", "id": "indicator--e8ef8499-9e20-4f7e-b649-8b7eadd0dd62", "modified": "2020-04-02T07:58:59.700Z"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--a210d9fc-aa62-4a4f-87c6-ec99cb51a855", "created": "2020-04-02T07:58:59.710Z", "modified": "2020-04-02T07:58:59.710Z", "source_ref": "indicator--e8ef8499-9e20-4f7e-b649-8b7eadd0dd62", "relationship_type": "indicates", "target_ref": "attack-pattern--f4882e23-8aa7-4b12-b28a-b349c12ee9e0"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--a5e30cf6-63b3-432e-a339-f6230f24cf56", "created": "2020-04-02T07:58:59.727Z", "modified": "2020-04-02T07:58:59.727Z", "source_ref": "indicator--e8ef8499-9e20-4f7e-b649-8b7eadd0dd62", "relationship_type": "indicates", "target_ref": "attack-pattern--3ccef7ae-cb5e-48f6-8302-897105fbf55c"}, {"name": "GALLIUM Artefacts", "description": "Detects artefacts associated with activity group GALLIUM - Microsoft Threat Intelligence Center indicators released in December 2019.", "created": "2020-02-07T00:00:00.000Z", "valid_from": "2020-02-07T00:00:00Z", "indicator_types": ["malicious-activity"], "pattern_type": "sigma", "pattern": "action: global\ntitle: GALLIUM Artefacts\nid: 440a56bf-7873-4439-940a-1c8a671073c2\nstatus: experimental\ndescription: Detects artefacts associated with activity group GALLIUM - Microsoft Threat Intelligence Center indicators released in December 2019.\nauthor: Tim Burrell\ndate: 2020/02/07\nreferences:\n    - https://www.microsoft.com/security/blog/2019/12/12/gallium-targeting-global-telecom/\n    - https://docs.microsoft.com/en-us/previous-versions/windows/it-pro/windows-server-2012-R2-and-2012/dn800669(v=ws.11)\ntags:\n    - attack.credential_access\n    - attack.command_and_control\nfalsepositives:\n    - unknown\nlevel: high\n", "object_marking_refs": ["marking-definition--0a872d70-1d05-45dd-a25f-031af547a102"], "created_by_ref": "identity--082ca4f0-d825-45b6-aa42-ab9afd1e5503", "type": "indicator", "spec_version": "2.1", "id": "indicator--f1cca7af-ea58-4567-b26e-dbbb6d7821e6", "modified": "2020-04-02T07:58:59.730Z"}, {"name": "Suspicious Commandline Escape", "description": "Detects suspicious process that use escape characters", "created": "2018-12-11T00:00:00.000Z", "modified": "2020-03-14T00:00:00.000Z", "valid_from": "2018-12-11T00:00:00Z", "indicator_types": ["malicious-activity"], "pattern_type": "sigma", "pattern": "title: Suspicious Commandline Escape\nid: f0cdd048-82dc-4f7a-8a7a-b87a52b6d0fd\ndescription: Detects suspicious process that use escape characters\nstatus: experimental\nreferences:\n    - https://twitter.com/vysecurity/status/885545634958385153\n    - https://twitter.com/Hexacorn/status/885553465417756673\n    - https://twitter.com/Hexacorn/status/885570278637678592\n    - https://www.fireeye.com/blog/threat-research/2017/06/obfuscation-in-the-wild.html\n    - http://www.windowsinspired.com/understanding-the-command-line-string-and-arguments-received-by-a-windows-program/\nauthor: juju4\ndate: 2018/12/11\nmodified: 2020/03/14\ntags:\n    - attack.defense_evasion\n    - attack.t1140\nlogsource:\n    category: process_creation\n    product: windows\ndetection:\n    selection:\n        CommandLine:\n            # - <TAB>   # no TAB modifier in sigmac yet, so this matches <TAB> (or TAB in elasticsearch backends without DSL queries)\n            - '*h^t^t^p*'\n            - '*h\"t\"t\"p*'\n    condition: selection\nfalsepositives:\n    - False positives depend on scripts and administrative tools used in the monitored environment\nlevel: low\n", "object_marking_refs": ["marking-definition--0a872d70-1d05-45dd-a25f-031af547a102"], "created_by_ref": "identity--082ca4f0-d825-45b6-aa42-ab9afd1e5503", "type": "indicator", "spec_version": "2.1", "id": "indicator--2fdb54f6-1e4e-4e9c-971a-1924964eb37f"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--8703d8bd-514e-49df-8bc3-ff45da0d10c1", "created": "2020-04-02T07:58:59.752Z", "modified": "2020-04-02T07:58:59.752Z", "source_ref": "indicator--2fdb54f6-1e4e-4e9c-971a-1924964eb37f", "relationship_type": "indicates", "target_ref": "attack-pattern--3ccef7ae-cb5e-48f6-8302-897105fbf55c"}, {"name": "SquiblyTwo", "description": "Detects WMI SquiblyTwo Attack with possible renamed WMI by looking for imphash", "created": "2019-01-16T00:00:00.000Z", "valid_from": "2019-01-16T00:00:00Z", "indicator_types": ["malicious-activity"], "pattern_type": "sigma", "pattern": "title: SquiblyTwo\nid: 8d63dadf-b91b-4187-87b6-34a1114577ea\nstatus: experimental\ndescription: Detects WMI SquiblyTwo Attack with possible renamed WMI by looking for imphash\nreferences:\n    - https://subt0x11.blogspot.ch/2018/04/wmicexe-whitelisting-bypass-hacking.html\n    - https://twitter.com/mattifestation/status/986280382042595328\ntags:\n    - attack.defense_evasion\n    - attack.t1047\nauthor: Markus Neis / Florian Roth\ndate: 2019/01/16\nfalsepositives:\n    - Unknown\nlevel: medium\nlogsource:\n    category: process_creation\n    product: windows\ndetection:\n    selection1:\n        Image:\n            - '*\\wmic.exe'\n        CommandLine:\n            - wmic * *format:\\\"http*\n            - wmic * /format:'http\n            - wmic * /format:http*\n    selection2:\n        Imphash:\n            - 1B1A3F43BF37B5BFE60751F2EE2F326E\n            - 37777A96245A3C74EB217308F3546F4C\n            - 9D87C9D67CE724033C0B40CC4CA1B206\n        CommandLine:\n            - '* *format:\\\"http*'\n            - '* /format:''http'\n            - '* /format:http*'\n    condition: 1 of them\n", "object_marking_refs": ["marking-definition--0a872d70-1d05-45dd-a25f-031af547a102"], "created_by_ref": "identity--082ca4f0-d825-45b6-aa42-ab9afd1e5503", "type": "indicator", "spec_version": "2.1", "id": "indicator--13a63be5-b638-4f64-9977-22ed51c87b5b", "modified": "2020-04-02T07:58:59.757Z"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--97fc8dd3-b1bc-4d6e-b774-fb13d3e06185", "created": "2020-04-02T07:58:59.770Z", "modified": "2020-04-02T07:58:59.770Z", "source_ref": "indicator--13a63be5-b638-4f64-9977-22ed51c87b5b", "relationship_type": "indicates", "target_ref": "attack-pattern--01a5a209-b94c-450b-b7f9-946497d91055"}, {"name": "Equation Group DLL_U Load", "description": "Detects a specific tool and export used by EquationGroup", "created": "2019-03-04T00:00:00.000Z", "valid_from": "2019-03-04T00:00:00Z", "indicator_types": ["malicious-activity"], "pattern_type": "sigma", "pattern": "title: Equation Group DLL_U Load\nid: d465d1d8-27a2-4cca-9621-a800f37cf72e\nauthor: Florian Roth\ndate: 2019/03/04\ndescription: Detects a specific tool and export used by EquationGroup\nreferences:\n    - https://github.com/adamcaudill/EquationGroupLeak/search?utf8=%E2%9C%93&q=dll_u&type=\n    - https://securelist.com/apt-slingshot/84312/\n    - https://twitter.com/cyb3rops/status/972186477512839170\ntags:\n    - attack.execution\n    - attack.g0020\n    - attack.t1059\n    - attack.defense_evasion\n    - attack.t1085\nlogsource:\n    category: process_creation\n    product: windows\ndetection:\n    selection1:\n        Image: '*\\rundll32.exe'\n        CommandLine: '*,dll_u'\n    selection2:\n        CommandLine: '* -export dll_u *'\n    condition: 1 of them\nfalsepositives:\n    - Unknown\nlevel: critical\n", "object_marking_refs": ["marking-definition--0a872d70-1d05-45dd-a25f-031af547a102"], "created_by_ref": "identity--082ca4f0-d825-45b6-aa42-ab9afd1e5503", "type": "indicator", "spec_version": "2.1", "id": "indicator--fd5da33c-0dd5-4e63-ab47-fce2a36b936d", "modified": "2020-04-02T07:58:59.774Z"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--e898381b-2166-4bb3-996c-c102cda30693", "created": "2020-04-02T07:58:59.787Z", "modified": "2020-04-02T07:58:59.787Z", "source_ref": "indicator--fd5da33c-0dd5-4e63-ab47-fce2a36b936d", "relationship_type": "indicates", "target_ref": "intrusion-set--96e239be-ad99-49eb-b127-3007b8c1bec9"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--808e16e8-a541-457a-845f-9c91c01cfe58", "created": "2020-04-02T07:58:59.801Z", "modified": "2020-04-02T07:58:59.801Z", "source_ref": "indicator--fd5da33c-0dd5-4e63-ab47-fce2a36b936d", "relationship_type": "indicates", "target_ref": "attack-pattern--7385dfaf-6886-4229-9ecd-6fd678040830"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--728b7137-f600-4950-a02a-b3d4bc034708", "created": "2020-04-02T07:58:59.815Z", "modified": "2020-04-02T07:58:59.815Z", "source_ref": "indicator--fd5da33c-0dd5-4e63-ab47-fce2a36b936d", "relationship_type": "indicates", "target_ref": "attack-pattern--62b8c999-dcc0-4755-bd69-09442d9359f5"}, {"name": "Exploit for CVE-2017-0261", "description": "Detects Winword starting uncommon sub process FLTLDR.exe as used in exploits for CVE-2017-0261 and CVE-2017-0262", "created": "2018-02-22T00:00:00.000Z", "valid_from": "2018-02-22T00:00:00Z", "indicator_types": ["malicious-activity"], "pattern_type": "sigma", "pattern": "title: Exploit for CVE-2017-0261\nid: 864403a1-36c9-40a2-a982-4c9a45f7d833\nstatus: experimental\ndescription: Detects Winword starting uncommon sub process FLTLDR.exe as used in exploits for CVE-2017-0261 and CVE-2017-0262\nreferences:\n    - https://www.fireeye.com/blog/threat-research/2017/05/eps-processing-zero-days.html\nauthor: Florian Roth\ndate: 2018/02/22\ntags:\n  - attack.defense_evasion\n  - attack.privilege_escalation\n  - attack.t1055\nlogsource:\n    category: process_creation\n    product: windows\ndetection:\n    selection:\n        ParentImage: '*\\WINWORD.EXE'\n        Image: '*\\FLTLDR.exe*'\n    condition: selection\nfalsepositives:\n    - Several false positives identified, check for suspicious file names or locations (e.g. Temp folders)\nlevel: medium\n", "object_marking_refs": ["marking-definition--0a872d70-1d05-45dd-a25f-031af547a102"], "created_by_ref": "identity--082ca4f0-d825-45b6-aa42-ab9afd1e5503", "type": "indicator", "spec_version": "2.1", "id": "indicator--46a7aa27-c36b-4899-992f-b5320c8d2cf9", "modified": "2020-04-02T07:58:59.819Z"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--f48cdfcf-8d52-4ca6-a22f-d7d96d313166", "created": "2020-04-02T07:58:59.831Z", "modified": "2020-04-02T07:58:59.831Z", "source_ref": "indicator--46a7aa27-c36b-4899-992f-b5320c8d2cf9", "relationship_type": "indicates", "target_ref": "attack-pattern--43e7dc91-05b2-474c-b9ac-2ed4fe101f4d"}, {"name": "Suspicious Reconnaissance Activity", "description": "Detects suspicious command line activity on Windows systems", "created": "2019-01-16T00:00:00.000Z", "valid_from": "2019-01-16T00:00:00Z", "indicator_types": ["malicious-activity"], "pattern_type": "sigma", "pattern": "title: Suspicious Reconnaissance Activity\nid: d95de845-b83c-4a9a-8a6a-4fc802ebf6c0\nstatus: experimental\ndescription: Detects suspicious command line activity on Windows systems\nauthor: Florian Roth\ndate: 2019/01/16\ntags:\n    - attack.discovery\n    - attack.t1087\nlogsource:\n    category: process_creation\n    product: windows\ndetection:\n    selection:\n        CommandLine:\n            - net group \"domain admins\" /domain\n            - net localgroup administrators\n    condition: selection\nfields:\n    - CommandLine\n    - ParentCommandLine\nfalsepositives:\n    - Inventory tool runs\n    - Penetration tests\n    - Administrative activity\nanalysis:\n    recommendation: Check if the user that executed the commands is suspicious (e.g. service accounts, LOCAL_SYSTEM)\nlevel: medium\n", "object_marking_refs": ["marking-definition--0a872d70-1d05-45dd-a25f-031af547a102"], "created_by_ref": "identity--082ca4f0-d825-45b6-aa42-ab9afd1e5503", "type": "indicator", "spec_version": "2.1", "id": "indicator--c12b29e4-b116-43d6-96dd-7761de277438", "modified": "2020-04-02T07:58:59.836Z"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--08c22c2e-9a77-403d-bae9-101a270db58f", "created": "2020-04-02T07:58:59.846Z", "modified": "2020-04-02T07:58:59.846Z", "source_ref": "indicator--c12b29e4-b116-43d6-96dd-7761de277438", "relationship_type": "indicates", "target_ref": "attack-pattern--72b74d71-8169-42aa-92e0-e7b04b9f5a08"}, {"name": "WMI Backdoor Exchange Transport Agent", "description": "Detects a WMi backdoor in Exchange Transport Agents via WMi event filters", "created": "2019-10-11T00:00:00.000Z", "valid_from": "2019-10-11T00:00:00Z", "indicator_types": ["malicious-activity"], "pattern_type": "sigma", "pattern": "title: WMI Backdoor Exchange Transport Agent\nid: 797011dc-44f4-4e6f-9f10-a8ceefbe566b\nstatus: experimental\ndescription: Detects a WMi backdoor in Exchange Transport Agents via WMi event filters\nauthor: Florian Roth\ndate: 2019/10/11\nreferences:\n    - https://twitter.com/cglyer/status/1182389676876980224\n    - https://twitter.com/cglyer/status/1182391019633029120\nlogsource:\n    category: process_creation\n    product: windows\ntags:\n    - attack.persistence\n    - attack.t1084\ndetection:\n    selection: \n        ParentImage: '*\\EdgeTransport.exe'\n    condition: selection\nfalsepositives:\n    - Unknown\nlevel: critical\n\n", "object_marking_refs": ["marking-definition--0a872d70-1d05-45dd-a25f-031af547a102"], "created_by_ref": "identity--082ca4f0-d825-45b6-aa42-ab9afd1e5503", "type": "indicator", "spec_version": "2.1", "id": "indicator--3581169f-a706-40d8-b2c0-6397119393ac", "modified": "2020-04-02T07:58:59.850Z"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--23b1afa3-858d-46bb-984a-c54eaf9276f4", "created": "2020-04-02T07:58:59.861Z", "modified": "2020-04-02T07:58:59.861Z", "source_ref": "indicator--3581169f-a706-40d8-b2c0-6397119393ac", "relationship_type": "indicates", "target_ref": "attack-pattern--e906ae4d-1d3a-4675-be23-22f7311c0da4"}, {"name": "Possible Ransomware or Unauthorized MBR Modifications", "description": "Detects, possibly, malicious unauthorized usage of bcdedit.exe", "created": "2019-02-07T00:00:00.000Z", "valid_from": "2019-02-07T00:00:00Z", "indicator_types": ["malicious-activity"], "pattern_type": "sigma", "pattern": "title: Possible Ransomware or Unauthorized MBR Modifications\nid: c9fbe8e9-119d-40a6-9b59-dd58a5d84429\nstatus: experimental\ndescription: Detects, possibly, malicious unauthorized usage of bcdedit.exe\nreferences:\n    - https://docs.microsoft.com/en-us/windows-hardware/drivers/devtest/bcdedit--set\nauthor: '@neu5ron'\ndate: 2019/02/07\ntags:\n    - attack.defense_evasion\n    - attack.t1070\n    - attack.persistence\n    - attack.t1067\nlogsource:\n    category: process_creation\n    product: windows\ndetection:\n    selection:\n        NewProcessName: '*\\bcdedit.exe'\n        ProcessCommandLine:\n            - '*delete*'\n            - '*deletevalue*'\n            - '*import*'\n    condition: selection\nlevel: medium\n", "object_marking_refs": ["marking-definition--0a872d70-1d05-45dd-a25f-031af547a102"], "created_by_ref": "identity--082ca4f0-d825-45b6-aa42-ab9afd1e5503", "type": "indicator", "spec_version": "2.1", "id": "indicator--e7eae403-4f43-414f-a65f-fdb083dfb255", "modified": "2020-04-02T07:58:59.865Z"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--d449f5b2-fdd7-4e2e-9966-28e14ad8d50b", "created": "2020-04-02T07:58:59.881Z", "modified": "2020-04-02T07:58:59.881Z", "source_ref": "indicator--e7eae403-4f43-414f-a65f-fdb083dfb255", "relationship_type": "indicates", "target_ref": "attack-pattern--799ace7f-e227-4411-baa0-8868704f2a69"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--21e1b6ca-a27e-4f10-b72d-42ae2d77a7b3", "created": "2020-04-02T07:58:59.895Z", "modified": "2020-04-02T07:58:59.895Z", "source_ref": "indicator--e7eae403-4f43-414f-a65f-fdb083dfb255", "relationship_type": "indicates", "target_ref": "attack-pattern--02fefddc-fb1b-423f-a76b-7552dd211d4d"}, {"name": "Detection of Possible Rotten Potato", "description": "Detection of child processes spawned with SYSTEM privileges by parents with LOCAL SERVICE or NETWORK SERVICE privileges", "created": "2019-10-26T00:00:00.000Z", "modified": "2019-11-11T00:00:00.000Z", "valid_from": "2019-10-26T00:00:00Z", "indicator_types": ["malicious-activity"], "pattern_type": "sigma", "pattern": "title: Detection of Possible Rotten Potato\nid: 6c5808ee-85a2-4e56-8137-72e5876a5096\ndescription: Detection of child processes spawned with SYSTEM privileges by parents with LOCAL SERVICE or NETWORK SERVICE privileges\nreferences:\n    - https://speakerdeck.com/heirhabarov/hunting-for-privilege-escalation-in-windows-environment\n    - https://foxglovesecurity.com/2016/09/26/rotten-potato-privilege-escalation-from-service-accounts-to-system/\ntags:\n    - attack.privilege_escalation\n    - attack.t1134\nstatus: experimental\nauthor: Teymur Kheirkhabarov\ndate: 2019/10/26\nmodified: 2019/11/11\nlogsource:\n    category: process_creation\n    product: windows\ndetection:\n    selection:\n        ParentUser:\n            - 'NT AUTHORITY\\NETWORK SERVICE'\n            - 'NT AUTHORITY\\LOCAL SERVICE'\n        User: 'NT AUTHORITY\\SYSTEM'\n    rundllexception:\n        Image|endswith: '\\rundll32.exe'\n        CommandLine|contains: 'DavSetCookie'\n    condition: selection and not rundllexception\nfalsepositives:\n    - Unknown\nlevel: high\nenrichment:\n    - EN_0001_cache_sysmon_event_id_1_info                # http://bit.ly/314zc6x\n    - EN_0002_enrich_sysmon_event_id_1_with_parent_info   # http://bit.ly/2KmSC0l\n", "object_marking_refs": ["marking-definition--0a872d70-1d05-45dd-a25f-031af547a102"], "created_by_ref": "identity--082ca4f0-d825-45b6-aa42-ab9afd1e5503", "type": "indicator", "spec_version": "2.1", "id": "indicator--1a2cf021-d925-4430-936c-0367a875ad2f"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--728e024b-ecb1-478d-ac2c-e83bda47d2a3", "created": "2020-04-02T07:58:59.917Z", "modified": "2020-04-02T07:58:59.917Z", "source_ref": "indicator--1a2cf021-d925-4430-936c-0367a875ad2f", "relationship_type": "indicates", "target_ref": "attack-pattern--dcaa092b-7de9-4a21-977f-7fcb77e89c48"}, {"name": "Judgement Panda Exfil Activity", "description": "Detects Judgement Panda activity as described in Global Threat Report 2019 by Crowdstrike", "created": "2019-02-21T00:00:00.000Z", "valid_from": "2019-02-21T00:00:00Z", "indicator_types": ["malicious-activity"], "pattern_type": "sigma", "pattern": "title: Judgement Panda Exfil Activity\nid: 03e2746e-2b31-42f1-ab7a-eb39365b2422\ndescription: Detects Judgement Panda activity as described in Global Threat Report 2019 by Crowdstrike\nreferences:\n    - https://www.crowdstrike.com/resources/reports/2019-crowdstrike-global-threat-report/\nauthor: Florian Roth\ndate: 2019/02/21\ntags:\n    - attack.lateral_movement\n    - attack.g0010\n    - attack.credential_access\n    - attack.t1098\n    - attack.exfiltration\n    - attack.t1002\nlogsource:\n    category: process_creation\n    product: windows\ndetection:\n    selection1:\n        CommandLine:\n            - '*\\ldifde.exe -f -n *'\n            - '*\\7za.exe a 1.7z *'\n            - '* eprod.ldf'\n            - '*\\aaaa\\procdump64.exe*'\n            - '*\\aaaa\\netsess.exe*'\n            - '*\\aaaa\\7za.exe*'\n            - '*copy .\\1.7z \\\\*'\n            - '*copy \\\\client\\c$\\aaaa\\\\*'\n    selection2:\n        Image: C:\\Users\\Public\\7za.exe\n    condition: selection1 or selection2\nfalsepositives:\n    - unknown\nlevel: critical\n", "object_marking_refs": ["marking-definition--0a872d70-1d05-45dd-a25f-031af547a102"], "created_by_ref": "identity--082ca4f0-d825-45b6-aa42-ab9afd1e5503", "type": "indicator", "spec_version": "2.1", "id": "indicator--4ea7e72f-eeac-4894-9c6c-263b617d5a75", "modified": "2020-04-02T07:58:59.922Z"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--f83afac7-9fa8-46af-b7ec-f59abf87b95d", "created": "2020-04-02T07:58:59.933Z", "modified": "2020-04-02T07:58:59.933Z", "source_ref": "indicator--4ea7e72f-eeac-4894-9c6c-263b617d5a75", "relationship_type": "indicates", "target_ref": "intrusion-set--7a19ecb1-3c65-4de3-a230-993516aed6a6"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--e081d045-f216-4b52-88e7-e2e4ae31af8f", "created": "2020-04-02T07:58:59.946Z", "modified": "2020-04-02T07:58:59.946Z", "source_ref": "indicator--4ea7e72f-eeac-4894-9c6c-263b617d5a75", "relationship_type": "indicates", "target_ref": "attack-pattern--a10641f4-87b4-45a3-a906-92a149cb2c27"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--980b6e29-f6a3-4c6c-98ad-7072c3b68f29", "created": "2020-04-02T07:58:59.958Z", "modified": "2020-04-02T07:58:59.958Z", "source_ref": "indicator--4ea7e72f-eeac-4894-9c6c-263b617d5a75", "relationship_type": "indicates", "target_ref": "attack-pattern--b9f5dbe2-4c55-4fc5-af2e-d42c1d182ec4"}, {"name": "Ping Hex IP", "description": "Detects a ping command that uses a hex encoded IP address", "created": "2018-03-23T00:00:00.000Z", "valid_from": "2018-03-23T00:00:00Z", "indicator_types": ["malicious-activity"], "pattern_type": "sigma", "pattern": "title: Ping Hex IP\nid: 1a0d4aba-7668-4365-9ce4-6d79ab088dfd\ndescription: Detects a ping command that uses a hex encoded IP address\nreferences:\n    - https://github.com/vysec/Aggressor-VYSEC/blob/master/ping.cna\n    - https://twitter.com/vysecurity/status/977198418354491392\nauthor: Florian Roth\ndate: 2018/03/23\ntags:\n    - attack.defense_evasion\n    - attack.t1140\n    - attack.t1027\nlogsource:\n    category: process_creation\n    product: windows\ndetection:\n    selection:\n        CommandLine:\n            - '*\\ping.exe 0x*'\n            - '*\\ping 0x*'\n    condition: selection\nfields:\n    - ParentCommandLine\nfalsepositives:\n    - Unlikely, because no sane admin pings IP addresses in a hexadecimal form\nlevel: high\n", "object_marking_refs": ["marking-definition--0a872d70-1d05-45dd-a25f-031af547a102"], "created_by_ref": "identity--082ca4f0-d825-45b6-aa42-ab9afd1e5503", "type": "indicator", "spec_version": "2.1", "id": "indicator--b4792d7b-a3d1-4d1e-bd84-97ec13402449", "modified": "2020-04-02T07:58:59.962Z"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--6c078348-e6e3-4bcb-b8ad-8a58eae78c7a", "created": "2020-04-02T07:58:59.975Z", "modified": "2020-04-02T07:58:59.975Z", "source_ref": "indicator--b4792d7b-a3d1-4d1e-bd84-97ec13402449", "relationship_type": "indicates", "target_ref": "attack-pattern--3ccef7ae-cb5e-48f6-8302-897105fbf55c"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--8d7d996b-d868-4d19-9fab-760c172a1250", "created": "2020-04-02T07:58:59.988Z", "modified": "2020-04-02T07:58:59.988Z", "source_ref": "indicator--b4792d7b-a3d1-4d1e-bd84-97ec13402449", "relationship_type": "indicates", "target_ref": "attack-pattern--b3d682b6-98f2-4fb0-aa3b-b4df007ca70a"}, {"name": "Meterpreter or Cobalt Strike Getsystem Service Start", "description": "Detects the use of getsystem Meterpreter/Cobalt Strike command by detecting a specific service starting", "created": "2019-10-26T00:00:00.000Z", "modified": "2019-11-11T00:00:00.000Z", "valid_from": "2019-10-26T00:00:00Z", "indicator_types": ["malicious-activity"], "pattern_type": "sigma", "pattern": "title: Meterpreter or Cobalt Strike Getsystem Service Start\nid: 15619216-e993-4721-b590-4c520615a67d\ndescription: Detects the use of getsystem Meterpreter/Cobalt Strike command by detecting a specific service starting\nauthor: Teymur Kheirkhabarov\ndate: 2019/10/26\nmodified: 2019/11/11\nreferences:\n    - https://speakerdeck.com/heirhabarov/hunting-for-privilege-escalation-in-windows-environment\n    - https://blog.cobaltstrike.com/2014/04/02/what-happens-when-i-type-getsystem/\ntags:\n    - attack.privilege_escalation\n    - attack.t1134\nlogsource:\n    category: process_creation\n    product: windows\ndetection:\n    selection_1:\n        ParentImage|endswith: '\\services.exe'\n    selection_2:    \n        - CommandLine|contains:\n            - 'cmd'\n            - 'comspec'\n        # meterpreter getsystem technique 1: cmd.exe /c echo 559891bb017 > \\\\.\\pipe\\5e120a\n        - CommandLine|contains|all:\n            - 'cmd'\n            - '/c'\n            - 'echo'\n            - '\\pipe\\'\n        # cobaltstrike getsystem technique 1: %COMSPEC% /c echo 559891bb017 > \\\\.\\pipe\\5e120a\n        - CommandLine|contains|all:\n            - '%COMSPEC%'\n            - '/c'\n            - 'echo'\n            - '\\pipe\\'\n        # meterpreter getsystem technique 2: rundll32.exe C:\\Users\\test\\AppData\\Local\\Temp\\tmexsn.dll,a /p:tmexsn\n        - CommandLine|contains|all:\n            - 'rundll32'\n            - '.dll,a'\n            - '/p:'\n    filter1:\n        CommandLine|contains: 'MpCmdRun'\n    condition: selection_1 and selection_2 and not filter1\nfields:\n    - ComputerName\n    - User\n    - CommandLine\nfalsepositives:\n    - Commandlines containing components like cmd accidentally\n    - Jobs and services started with cmd\nlevel: high\n", "object_marking_refs": ["marking-definition--0a872d70-1d05-45dd-a25f-031af547a102"], "created_by_ref": "identity--082ca4f0-d825-45b6-aa42-ab9afd1e5503", "type": "indicator", "spec_version": "2.1", "id": "indicator--3ca40427-2b82-4d32-8d03-d77dff3d158f"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--755a2da4-2b76-4cc7-a22b-d9bfd4f979e4", "created": "2020-04-02T07:59:00.010Z", "modified": "2020-04-02T07:59:00.010Z", "source_ref": "indicator--3ca40427-2b82-4d32-8d03-d77dff3d158f", "relationship_type": "indicates", "target_ref": "attack-pattern--dcaa092b-7de9-4a21-977f-7fcb77e89c48"}, {"name": "Taskmgr as Parent", "description": "Detects the creation of a process from Windows task manager", "created": "2018-03-13T00:00:00.000Z", "valid_from": "2018-03-13T00:00:00Z", "indicator_types": ["malicious-activity"], "pattern_type": "sigma", "pattern": "title: Taskmgr as Parent\nid: 3d7679bd-0c00-440c-97b0-3f204273e6c7\nstatus: experimental\ndescription: Detects the creation of a process from Windows task manager\ntags:\n    - attack.defense_evasion\n    - attack.t1036\nauthor: Florian Roth\ndate: 2018/03/13\nlogsource:\n    category: process_creation\n    product: windows\ndetection:\n    selection:\n        ParentImage: '*\\taskmgr.exe'\n    filter:\n        Image:\n            - '*\\resmon.exe'\n            - '*\\mmc.exe'\n            - '*\\taskmgr.exe'\n    condition: selection and not filter\nfields:\n    - Image\n    - CommandLine\n    - ParentCommandLine\nfalsepositives:\n    - Administrative activity\nlevel: low\n", "object_marking_refs": ["marking-definition--0a872d70-1d05-45dd-a25f-031af547a102"], "created_by_ref": "identity--082ca4f0-d825-45b6-aa42-ab9afd1e5503", "type": "indicator", "spec_version": "2.1", "id": "indicator--2e18d759-dc1b-4d89-925b-db22c747cee5", "modified": "2020-04-02T07:59:00.014Z"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--d60d5617-e755-4669-8d8c-abe8649c142b", "created": "2020-04-02T07:59:00.027Z", "modified": "2020-04-02T07:59:00.027Z", "source_ref": "indicator--2e18d759-dc1b-4d89-925b-db22c747cee5", "relationship_type": "indicates", "target_ref": "attack-pattern--42e8de7b-37b2-4258-905a-6897815e58e0"}, {"name": "Windows Shell Spawning Suspicious Program", "description": "Detects a suspicious child process of a Windows shell", "created": "2018-04-06T00:00:00.000Z", "modified": "2019-02-05T00:00:00.000Z", "valid_from": "2018-04-06T00:00:00Z", "indicator_types": ["malicious-activity"], "pattern_type": "sigma", "pattern": "title: Windows Shell Spawning Suspicious Program\nid: 3a6586ad-127a-4d3b-a677-1e6eacdf8fde\nstatus: experimental\ndescription: Detects a suspicious child process of a Windows shell\nreferences:\n    - https://mgreen27.github.io/posts/2018/04/02/DownloadCradle.html\nauthor: Florian Roth\ndate: 2018/04/06\nmodified: 2019/02/05\ntags:\n    - attack.execution\n    - attack.defense_evasion\n    - attack.t1064\nlogsource:\n    category: process_creation\n    product: windows\ndetection:\n    selection:\n        ParentImage:\n            - '*\\mshta.exe'\n            - '*\\powershell.exe'\n            # - '*\\cmd.exe'  # too many false positives\n            - '*\\rundll32.exe'\n            - '*\\cscript.exe'\n            - '*\\wscript.exe'\n            - '*\\wmiprvse.exe'\n        Image:\n            - '*\\schtasks.exe'\n            - '*\\nslookup.exe'\n            - '*\\certutil.exe'\n            - '*\\bitsadmin.exe'\n            - '*\\mshta.exe'\n    falsepositives:\n        CurrentDirectory: '*\\ccmcache\\\\*'\n    condition: selection and not falsepositives\nfields:\n    - CommandLine\n    - ParentCommandLine\nfalsepositives:\n    - Administrative scripts\n    - Microsoft SCCM\nlevel: high\n", "object_marking_refs": ["marking-definition--0a872d70-1d05-45dd-a25f-031af547a102"], "created_by_ref": "identity--082ca4f0-d825-45b6-aa42-ab9afd1e5503", "type": "indicator", "spec_version": "2.1", "id": "indicator--56759028-f512-485c-8fa8-4b666ea2b917"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--d1ec4801-44af-4dc4-9f01-a4ba19f4bd90", "created": "2020-04-02T07:59:00.044Z", "modified": "2020-04-02T07:59:00.044Z", "source_ref": "indicator--56759028-f512-485c-8fa8-4b666ea2b917", "relationship_type": "indicates", "target_ref": "attack-pattern--7fd87010-3a00-4da3-b905-410525e8ec44"}, {"name": "Capture a Network Trace with netsh.exe", "description": "Detects capture a network trace via netsh.exe trace functionality", "created": "2019-10-24T00:00:00.000Z", "valid_from": "2019-10-24T00:00:00Z", "indicator_types": ["malicious-activity"], "pattern_type": "sigma", "pattern": "title: Capture a Network Trace with netsh.exe\nid: d3c3861d-c504-4c77-ba55-224ba82d0118\nstatus: experimental\ndescription: Detects capture a network trace via netsh.exe trace functionality\nreferences:\n    - https://blogs.msdn.microsoft.com/canberrapfe/2012/03/30/capture-a-network-trace-without-installing-anything-capture-a-network-trace-of-a-reboot/\nauthor: Kutepov Anton, oscd.community\ndate: 2019/10/24\ntags:\n    - attack.discovery\n    - attack.t1040\nlogsource:\n    category: process_creation\n    product: windows\ndetection:\n    selection:\n        CommandLine|contains|all: \n            - netsh\n            - trace\n            - start\n    condition: selection    \nfalsepositives: \n    - Legitimate administrator or user uses netsh.exe trace functionality for legitimate reason\nlevel: medium\n", "object_marking_refs": ["marking-definition--0a872d70-1d05-45dd-a25f-031af547a102"], "created_by_ref": "identity--082ca4f0-d825-45b6-aa42-ab9afd1e5503", "type": "indicator", "spec_version": "2.1", "id": "indicator--973a506f-826b-4fc0-94a4-7313a791d4a5", "modified": "2020-04-02T07:59:00.048Z"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--425d3136-d725-42a3-8b98-ee9da170ea46", "created": "2020-04-02T07:59:00.060Z", "modified": "2020-04-02T07:59:00.060Z", "source_ref": "indicator--973a506f-826b-4fc0-94a4-7313a791d4a5", "relationship_type": "indicates", "target_ref": "attack-pattern--3257eb21-f9a7-4430-8de1-d8b6e288f529"}, {"name": "Executable Used by PlugX in Uncommon Location", "description": "Detects the execution of an executable that is typically used by PlugX for DLL side loading started from an uncommon location", "created": "2017-06-12T00:00:00.000Z", "valid_from": "2017-06-12T00:00:00Z", "indicator_types": ["malicious-activity"], "pattern_type": "sigma", "pattern": "title: Executable Used by PlugX in Uncommon Location\nid: aeab5ec5-be14-471a-80e8-e344418305c2\nstatus: experimental\ndescription: Detects the execution of an executable that is typically used by PlugX for DLL side loading started from an uncommon location\nreferences:\n    - http://www.hexacorn.com/blog/2016/03/10/beyond-good-ol-run-key-part-36/\n    - https://countuponsecurity.com/2017/06/07/threat-hunting-in-the-enterprise-with-appcompatprocessor/\nauthor: Florian Roth\ndate: 2017/06/12\ntags:\n    - attack.s0013\n    - attack.defense_evasion\n    - attack.t1073\nlogsource:\n    category: process_creation\n    product: windows\ndetection:\n    selection_cammute:\n        Image: '*\\CamMute.exe'\n    filter_cammute:\n        Image: '*\\Lenovo\\Communication Utility\\\\*'\n    selection_chrome_frame:\n        Image: '*\\chrome_frame_helper.exe'\n    filter_chrome_frame:\n        Image: '*\\Google\\Chrome\\application\\\\*'\n    selection_devemu:\n        Image: '*\\dvcemumanager.exe'\n    filter_devemu:\n        Image: '*\\Microsoft Device Emulator\\\\*'\n    selection_gadget:\n        Image: '*\\Gadget.exe'\n    filter_gadget:\n        Image: '*\\Windows Media Player\\\\*'\n    selection_hcc:\n        Image: '*\\hcc.exe'\n    filter_hcc:\n        Image: '*\\HTML Help Workshop\\\\*'\n    selection_hkcmd:\n        Image: '*\\hkcmd.exe'\n    filter_hkcmd:\n        Image:\n            - '*\\System32\\\\*'\n            - '*\\SysNative\\\\*'\n            - '*\\SysWowo64\\\\*'\n    selection_mc:\n        Image: '*\\Mc.exe'\n    filter_mc:\n        Image:\n            - '*\\Microsoft Visual Studio*'\n            - '*\\Microsoft SDK*'\n            - '*\\Windows Kit*'\n    selection_msmpeng:\n        Image: '*\\MsMpEng.exe'\n    filter_msmpeng:\n        Image:\n            - '*\\Microsoft Security Client\\\\*'\n            - '*\\Windows Defender\\\\*'\n            - '*\\AntiMalware\\\\*'\n    selection_msseces:\n        Image: '*\\msseces.exe'\n    filter_msseces:\n        Image:\n            - '*\\Microsoft Security Center\\\\*'\n            - '*\\Microsoft Security Client\\\\*'\n            - '*\\Microsoft Security Essentials\\\\*'\n    selection_oinfo:\n        Image: '*\\OInfoP11.exe'\n    filter_oinfo:\n        Image: '*\\Common Files\\Microsoft Shared\\\\*'\n    selection_oleview:\n        Image: '*\\OleView.exe'\n    filter_oleview:\n        Image:\n            - '*\\Microsoft Visual Studio*'\n            - '*\\Microsoft SDK*'\n            - '*\\Windows Kit*'\n            - '*\\Windows Resource Kit\\\\*'\n    selection_rc:\n        Image: '*\\rc.exe'\n    filter_rc:\n        Image:\n            - '*\\Microsoft Visual Studio*'\n            - '*\\Microsoft SDK*'\n            - '*\\Windows Kit*'\n            - '*\\Windows Resource Kit\\\\*'\n            - '*\\Microsoft.NET\\\\*'\n    condition: ( selection_cammute and not filter_cammute ) or ( selection_chrome_frame and not filter_chrome_frame ) or ( selection_devemu and not filter_devemu )\n        or ( selection_gadget and not filter_gadget ) or ( selection_hcc and not filter_hcc ) or ( selection_hkcmd and not filter_hkcmd ) or ( selection_mc and not filter_mc\n        ) or ( selection_msmpeng and not filter_msmpeng ) or ( selection_msseces and not filter_msseces ) or ( selection_oinfo and not filter_oinfo ) or ( selection_oleview\n        and not filter_oleview ) or ( selection_rc and not filter_rc )\nfields:\n    - CommandLine\n    - ParentCommandLine\nfalsepositives:\n    - Unknown\nlevel: high\n", "object_marking_refs": ["marking-definition--0a872d70-1d05-45dd-a25f-031af547a102"], "created_by_ref": "identity--082ca4f0-d825-45b6-aa42-ab9afd1e5503", "type": "indicator", "spec_version": "2.1", "id": "indicator--9a30f4b1-45c0-4877-8b5e-802953af001f", "modified": "2020-04-02T07:59:00.078Z"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--11b8593c-243f-4a48-956b-599e90529c4e", "created": "2020-04-02T07:59:00.087Z", "modified": "2020-04-02T07:59:00.087Z", "source_ref": "indicator--9a30f4b1-45c0-4877-8b5e-802953af001f", "relationship_type": "indicates", "target_ref": "malware--64fa0de0-6240-41f4-8638-f4ca7ed528fd"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--8af53924-70f9-43b6-9362-a304e3377b54", "created": "2020-04-02T07:59:00.095Z", "modified": "2020-04-02T07:59:00.095Z", "source_ref": "indicator--9a30f4b1-45c0-4877-8b5e-802953af001f", "relationship_type": "indicates", "target_ref": "attack-pattern--b2001907-166b-4d71-bb3c-9d26c871de09"}, {"name": "MSHTA Spawning Windows Shell", "description": "Detects a Windows command line executable started from MSHTA.", "created": "2019-01-16T00:00:00.000Z", "valid_from": "2019-01-16T00:00:00Z", "indicator_types": ["malicious-activity"], "pattern_type": "sigma", "pattern": "title: MSHTA Spawning Windows Shell\nid: 03cc0c25-389f-4bf8-b48d-11878079f1ca\nstatus: experimental\ndescription: Detects a Windows command line executable started from MSHTA.\nreferences:\n    - https://www.trustedsec.com/july-2015/malicious-htas/\nauthor: Michael Haag\ndate: 2019/01/16\nlogsource:\n    category: process_creation\n    product: windows\ndetection:\n    selection:\n        ParentImage: '*\\mshta.exe'\n        Image:\n            - '*\\cmd.exe'\n            - '*\\powershell.exe'\n            - '*\\wscript.exe'\n            - '*\\cscript.exe'\n            - '*\\sh.exe'\n            - '*\\bash.exe'\n            - '*\\reg.exe'\n            - '*\\regsvr32.exe'\n            - '*\\BITSADMIN*'\n    condition: selection\nfields:\n    - CommandLine\n    - ParentCommandLine\ntags:\n    - attack.defense_evasion\n    - attack.execution\n    - attack.t1170\n    - car.2013-02-003\n    - car.2013-03-001\n    - car.2014-04-003\nfalsepositives:\n    - Printer software / driver installations\n    - HP software\nlevel: high\n", "object_marking_refs": ["marking-definition--0a872d70-1d05-45dd-a25f-031af547a102"], "created_by_ref": "identity--082ca4f0-d825-45b6-aa42-ab9afd1e5503", "type": "indicator", "spec_version": "2.1", "id": "indicator--cdf3a63b-8232-4bfa-b675-117fec8c1bb3", "modified": "2020-04-02T07:59:00.099Z"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--04b04a55-4e06-40e8-a6b6-e77cd503392e", "created": "2020-04-02T07:59:00.110Z", "modified": "2020-04-02T07:59:00.110Z", "source_ref": "indicator--cdf3a63b-8232-4bfa-b675-117fec8c1bb3", "relationship_type": "indicates", "target_ref": "attack-pattern--a127c32c-cbb0-4f9d-be07-881a792408ec"}, {"name": "MSHTA Spwaned by SVCHOST", "description": "Detects MSHTA.EXE spwaned by SVCHOST as seen in LethalHTA and described in report", "created": "2018-06-07T00:00:00.000Z", "valid_from": "2018-06-07T00:00:00Z", "indicator_types": ["malicious-activity"], "pattern_type": "sigma", "pattern": "title: MSHTA Spwaned by SVCHOST\nid: ed5d72a6-f8f4-479d-ba79-02f6a80d7471\nstatus: experimental\ndescription: Detects MSHTA.EXE spwaned by SVCHOST as seen in LethalHTA and described in report\nreferences:\n    - https://codewhitesec.blogspot.com/2018/07/lethalhta.html\ntags:\n    - attack.defense_evasion\n    - attack.execution\n    - attack.t1170\nauthor: Markus Neis\ndate: 2018/06/07\nlogsource:\n    category: process_creation\n    product: windows\ndetection:\n    selection:\n        ParentImage: '*\\svchost.exe'\n        Image: '*\\mshta.exe'\n    condition: selection\nfalsepositives:\n    - Unknown\nlevel: high\n", "object_marking_refs": ["marking-definition--0a872d70-1d05-45dd-a25f-031af547a102"], "created_by_ref": "identity--082ca4f0-d825-45b6-aa42-ab9afd1e5503", "type": "indicator", "spec_version": "2.1", "id": "indicator--be729093-8618-45fd-bae6-1dde313cc817", "modified": "2020-04-02T07:59:00.114Z"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--65c0f977-6d96-442b-b907-1ed2913190b6", "created": "2020-04-02T07:59:00.125Z", "modified": "2020-04-02T07:59:00.125Z", "source_ref": "indicator--be729093-8618-45fd-bae6-1dde313cc817", "relationship_type": "indicates", "target_ref": "attack-pattern--a127c32c-cbb0-4f9d-be07-881a792408ec"}, {"name": "CreateMiniDump Hacktool", "description": "Detects the use of CreateMiniDump hack tool used to dump the LSASS process memory for credential extraction on the attacker's machine", "created": "2019-12-22T00:00:00.000Z", "valid_from": "2019-12-22T00:00:00Z", "indicator_types": ["malicious-activity"], "pattern_type": "sigma", "pattern": "action: global\ntitle: CreateMiniDump Hacktool\nid: 36d88494-1d43-4dc0-b3fa-35c8fea0ca9d\ndescription: Detects the use of CreateMiniDump hack tool used to dump the LSASS process memory for credential extraction on the attacker's machine\nauthor: Florian Roth\nreferences:\n    - https://ired.team/offensive-security/credential-access-and-credential-dumping/dumping-lsass-passwords-without-mimikatz-minidumpwritedump-av-signature-bypass\ndate: 2019/12/22\ntags:\n    - attack.credential_access\n    - attack.t1003\nfalsepositives:\n    - Unknown\nlevel: high\n", "object_marking_refs": ["marking-definition--0a872d70-1d05-45dd-a25f-031af547a102"], "created_by_ref": "identity--082ca4f0-d825-45b6-aa42-ab9afd1e5503", "type": "indicator", "spec_version": "2.1", "id": "indicator--0f265eee-3567-4ceb-9c7e-c744b046efb7", "modified": "2020-04-02T07:59:00.127Z"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--537d1a8d-0ed7-4c61-a9da-550b298bdf59", "created": "2020-04-02T07:59:00.139Z", "modified": "2020-04-02T07:59:00.139Z", "source_ref": "indicator--0f265eee-3567-4ceb-9c7e-c744b046efb7", "relationship_type": "indicates", "target_ref": "attack-pattern--0a3ead4e-6d47-4ccb-854c-a6a4f9d96b22"}, {"name": "Command Line Execution with Suspicious URL and AppData Strings", "description": "Detects a suspicious command line execution that includes an URL and AppData string in the command line parameters as used by several droppers (js/vbs > powershell)", "created": "2019-01-16T00:00:00.000Z", "valid_from": "2019-01-16T00:00:00Z", "indicator_types": ["malicious-activity"], "pattern_type": "sigma", "pattern": "title: Command Line Execution with Suspicious URL and AppData Strings\nid: 1ac8666b-046f-4201-8aba-1951aaec03a3\nstatus: experimental\ndescription: Detects a suspicious command line execution that includes an URL and AppData string in the command line parameters as used by several droppers (js/vbs\n    > powershell)\nreferences:\n    - https://www.hybrid-analysis.com/sample/3a1f01206684410dbe8f1900bbeaaa543adfcd07368ba646b499fa5274b9edf6?environmentId=100\n    - https://www.hybrid-analysis.com/sample/f16c729aad5c74f19784a24257236a8bbe27f7cdc4a89806031ec7f1bebbd475?environmentId=100\nauthor: Florian Roth\ndate: 2019/01/16\ntags:\n    - attack.execution\n    - attack.t1059\nlogsource:\n    category: process_creation\n    product: windows\ndetection:\n    selection:\n        CommandLine:\n            - cmd.exe /c *http://*%AppData%\n            - cmd.exe /c *https://*%AppData%\n    condition: selection\nfields:\n    - CommandLine\n    - ParentCommandLine\nfalsepositives:\n    - High\nlevel: medium\n", "object_marking_refs": ["marking-definition--0a872d70-1d05-45dd-a25f-031af547a102"], "created_by_ref": "identity--082ca4f0-d825-45b6-aa42-ab9afd1e5503", "type": "indicator", "spec_version": "2.1", "id": "indicator--66e32d7c-8a80-4ffe-9f31-3a8fa948e02c", "modified": "2020-04-02T07:59:00.146Z"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--38263afb-539f-4843-abe7-a81af676a9a1", "created": "2020-04-02T07:59:00.156Z", "modified": "2020-04-02T07:59:00.156Z", "source_ref": "indicator--66e32d7c-8a80-4ffe-9f31-3a8fa948e02c", "relationship_type": "indicates", "target_ref": "attack-pattern--7385dfaf-6886-4229-9ecd-6fd678040830"}, {"name": "Adwind RAT / JRAT", "description": "Detects javaw.exe in AppData folder as used by Adwind / JRAT", "created": "2017-11-10T00:00:00.000Z", "modified": "2018-12-11T00:00:00.000Z", "valid_from": "2017-11-10T00:00:00Z", "indicator_types": ["malicious-activity"], "pattern_type": "sigma", "pattern": "action: global\ntitle: Adwind RAT / JRAT\nid: 1fac1481-2dbc-48b2-9096-753c49b4ec71\nstatus: experimental\ndescription: Detects javaw.exe in AppData folder as used by Adwind / JRAT\nreferences:\n    - https://www.hybrid-analysis.com/sample/ba86fa0d4b6af2db0656a88b1dd29f36fe362473ae8ad04255c4e52f214a541c?environmentId=100\n    - https://www.first.org/resources/papers/conf2017/Advanced-Incident-Detection-and-Threat-Hunting-using-Sysmon-and-Splunk.pdf\nauthor: Florian Roth, Tom Ueltschi\ndate: 2017/11/10\nmodified: 2018/12/11\ntags:\n    - attack.execution\n    - attack.t1064\ndetection:\n    condition: selection\nlevel: high\n", "object_marking_refs": ["marking-definition--0a872d70-1d05-45dd-a25f-031af547a102"], "created_by_ref": "identity--082ca4f0-d825-45b6-aa42-ab9afd1e5503", "type": "indicator", "spec_version": "2.1", "id": "indicator--88bb3dea-a943-470b-9da8-474521c96d09"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--33ebf4be-0828-419e-bec5-35cd68c96ce0", "created": "2020-04-02T07:59:00.170Z", "modified": "2020-04-02T07:59:00.170Z", "source_ref": "indicator--88bb3dea-a943-470b-9da8-474521c96d09", "relationship_type": "indicates", "target_ref": "attack-pattern--7fd87010-3a00-4da3-b905-410525e8ec44"}, {"name": "File or Folder Permissions Modifications", "description": "Detects a file or folder permissions modifications", "created": "2019-10-23T00:00:00.000Z", "modified": "2019-11-08T00:00:00.000Z", "valid_from": "2019-10-23T00:00:00Z", "indicator_types": ["malicious-activity"], "pattern_type": "sigma", "pattern": "title: File or Folder Permissions Modifications\nid: 37ae075c-271b-459b-8d7b-55ad5f993dd8\nstatus: experimental\ndescription: Detects a file or folder permissions modifications\nreferences:\n    - https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1222/T1222.yaml\nauthor: Jakob Weinzettl, oscd.community\ndate: 2019/10/23\nmodified: 2019/11/08\ntags:\n    - attack.defense_evasion\n    - attack.t1222\nlogsource:\n    category: process_creation\n    product: windows\ndetection:\n    selection:\n      - Image|endswith: \n          - '\\takeown.exe'\n          - '\\cacls.exe'\n          - '\\icacls.exe'\n        CommandLine|contains: '/grant'\n      - Image|endswith: '\\attrib.exe'\n        CommandLine|contains: '-r'\n    condition: selection\nfields:\n    - ComputerName\n    - User\n    - CommandLine\nfalsepositives:\n    - Users interacting with the files on their own (unlikely unless power users)\nlevel: medium\n", "object_marking_refs": ["marking-definition--0a872d70-1d05-45dd-a25f-031af547a102"], "created_by_ref": "identity--082ca4f0-d825-45b6-aa42-ab9afd1e5503", "type": "indicator", "spec_version": "2.1", "id": "indicator--c5be2279-3ace-41d3-aef8-aaf254197470"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--240a1904-931a-4136-b423-b6ae6f11cb7e", "created": "2020-04-02T07:59:00.188Z", "modified": "2020-04-02T07:59:00.188Z", "source_ref": "indicator--c5be2279-3ace-41d3-aef8-aaf254197470", "relationship_type": "indicates", "target_ref": "attack-pattern--65917ae0-b854-4139-83fe-bf2441cf0196"}, {"name": "Suspicious RDP Redirect Using TSCON", "description": "Detects a suspicious RDP session redirect using tscon.exe", "created": "2018-03-17T00:00:00.000Z", "modified": "2018-12-11T00:00:00.000Z", "valid_from": "2018-03-17T00:00:00Z", "indicator_types": ["malicious-activity"], "pattern_type": "sigma", "pattern": "title: Suspicious RDP Redirect Using TSCON\nid: f72aa3e8-49f9-4c7d-bd74-f8ab84ff9bbb\nstatus: experimental\ndescription: Detects a suspicious RDP session redirect using tscon.exe\nreferences:\n    - http://www.korznikov.com/2017/03/0-day-or-feature-privilege-escalation.html\n    - https://medium.com/@networksecurity/rdp-hijacking-how-to-hijack-rds-and-remoteapp-sessions-transparently-to-move-through-an-da2a1e73a5f6\ntags:\n    - attack.lateral_movement\n    - attack.privilege_escalation\n    - attack.t1076\n    - car.2013-07-002\nauthor: Florian Roth\ndate: 2018/03/17\nmodified: 2018/12/11\nlogsource:\n    category: process_creation\n    product: windows\ndetection:\n    selection:\n        CommandLine: '* /dest:rdp-tcp:*'\n    condition: selection\nfalsepositives:\n    - Unknown\nlevel: high\n", "object_marking_refs": ["marking-definition--0a872d70-1d05-45dd-a25f-031af547a102"], "created_by_ref": "identity--082ca4f0-d825-45b6-aa42-ab9afd1e5503", "type": "indicator", "spec_version": "2.1", "id": "indicator--1b6c84ba-249f-481f-bea5-bb56ab97171c"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--7039dc87-c46e-42e4-9489-1a5af2f162eb", "created": "2020-04-02T07:59:00.201Z", "modified": "2020-04-02T07:59:00.201Z", "source_ref": "indicator--1b6c84ba-249f-481f-bea5-bb56ab97171c", "relationship_type": "indicates", "target_ref": "attack-pattern--51dea151-0898-4a45-967c-3ebee0420484"}, {"name": "Domain Trust Discovery", "description": "Detects a discovery of domain trusts", "created": "2019-10-23T00:00:00.000Z", "modified": "2019-11-08T00:00:00.000Z", "valid_from": "2019-10-23T00:00:00Z", "indicator_types": ["malicious-activity"], "pattern_type": "sigma", "pattern": "title: Domain Trust Discovery\nid: 77815820-246c-47b8-9741-e0def3f57308\nstatus: experimental\ndescription: Detects a discovery of domain trusts\nreferences:\n    - https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1482/T1482.yaml\nauthor: Jakob Weinzettl, oscd.community\ndate: 2019/10/23\nmodified: 2019/11/08\ntags:\n    - attack.discovery\n    - attack.t1482\nlogsource:\n    category: process_creation\n    product: windows\ndetection:\n    selection:\n      - Image|endswith: '\\dsquery.exe'\n        CommandLine|contains|all:\n            - '-filter'\n            - 'trustedDomain'\n      - Image|endswith: '\\nltest.exe'\n        CommandLine|contains: 'domain_trusts'\n    condition: selection\nfalsepositives:\n    - Administration of systems\nlevel: medium\n", "object_marking_refs": ["marking-definition--0a872d70-1d05-45dd-a25f-031af547a102"], "created_by_ref": "identity--082ca4f0-d825-45b6-aa42-ab9afd1e5503", "type": "indicator", "spec_version": "2.1", "id": "indicator--510c0637-df1d-42b7-9963-5d6eae1d35fa"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--1cbad2cb-dff3-4a34-84a3-46bbc60e660e", "created": "2020-04-02T07:59:00.215Z", "modified": "2020-04-02T07:59:00.215Z", "source_ref": "indicator--510c0637-df1d-42b7-9963-5d6eae1d35fa", "relationship_type": "indicates", "target_ref": "attack-pattern--767dbf9e-df3f-45cb-8998-4903ab5f80c0"}, {"name": "ZxShell Malware", "description": "Detects a ZxShell start by the called and well-known function name", "created": "2017-07-20T00:00:00.000Z", "valid_from": "2017-07-20T00:00:00Z", "indicator_types": ["malicious-activity"], "pattern_type": "sigma", "pattern": "title: ZxShell Malware\nid: f0b70adb-0075-43b0-9745-e82a1c608fcc\ndescription: Detects a ZxShell start by the called and well-known function name\nauthor: Florian Roth\ndate: 2017/07/20\nreferences:\n    - https://www.hybrid-analysis.com/sample/5d2a4cde9fa7c2fdbf39b2e2ffd23378d0c50701a3095d1e91e3cf922d7b0b16?environmentId=100\ntags:\n    - attack.g0001\n    - attack.execution\n    - attack.t1059\n    - attack.defense_evasion\n    - attack.t1085\nlogsource:\n    category: process_creation\n    product: windows\ndetection:\n    selection:\n        Command:\n            - 'rundll32.exe *,zxFunction*'\n            - 'rundll32.exe *,RemoteDiskXXXXX'\n    condition: selection\nfields:\n    - CommandLine\n    - ParentCommandLine\nfalsepositives:\n    - Unlikely\nlevel: critical\n", "object_marking_refs": ["marking-definition--0a872d70-1d05-45dd-a25f-031af547a102"], "created_by_ref": "identity--082ca4f0-d825-45b6-aa42-ab9afd1e5503", "type": "indicator", "spec_version": "2.1", "id": "indicator--d14c467b-2a5b-4f9b-949f-967c6a175a51", "modified": "2020-04-02T07:59:00.218Z"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--5e521679-fc1f-45c6-a5f3-f55aceddba5e", "created": "2020-04-02T07:59:00.228Z", "modified": "2020-04-02T07:59:00.228Z", "source_ref": "indicator--d14c467b-2a5b-4f9b-949f-967c6a175a51", "relationship_type": "indicates", "target_ref": "intrusion-set--a0cb9370-e39b-44d5-9f50-ef78e412b973"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--b76d0c10-0dd1-436d-9b1a-ac0216b9eb14", "created": "2020-04-02T07:59:00.237Z", "modified": "2020-04-02T07:59:00.237Z", "source_ref": "indicator--d14c467b-2a5b-4f9b-949f-967c6a175a51", "relationship_type": "indicates", "target_ref": "attack-pattern--7385dfaf-6886-4229-9ecd-6fd678040830"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--92c1c576-6bfb-49d0-852e-acdb9588a5a8", "created": "2020-04-02T07:59:00.247Z", "modified": "2020-04-02T07:59:00.247Z", "source_ref": "indicator--d14c467b-2a5b-4f9b-949f-967c6a175a51", "relationship_type": "indicates", "target_ref": "attack-pattern--62b8c999-dcc0-4755-bd69-09442d9359f5"}, {"name": "Suspicious MsiExec Directory", "description": "Detects suspicious msiexec process starts in an uncommon directory", "created": "2019-11-14T00:00:00.000Z", "valid_from": "2019-11-14T00:00:00Z", "indicator_types": ["malicious-activity"], "pattern_type": "sigma", "pattern": "title: Suspicious MsiExec Directory\nid: e22a6eb2-f8a5-44b5-8b44-a2dbd47b1144\nstatus: experimental\ndescription: Detects suspicious msiexec process starts in an uncommon directory\nreferences:\n    - https://twitter.com/200_okay_/status/1194765831911215104\ntags:\n    - attack.defense_evasion\n    - attack.t1036\nauthor: Florian Roth\ndate: 2019/11/14\nlogsource:\n    category: process_creation\n    product: windows\ndetection:\n    selection:\n        Image: '*\\msiexec.exe'\n    filter:\n        Image: \n            - 'C:\\Windows\\System32\\\\*'\n            - 'C:\\Windows\\SysWOW64\\\\*'\n            - 'C:\\Windows\\WinSxS\\\\*' \n    condition: selection and not filter\nfalsepositives:\n    - Unknown\nlevel: high\n", "object_marking_refs": ["marking-definition--0a872d70-1d05-45dd-a25f-031af547a102"], "created_by_ref": "identity--082ca4f0-d825-45b6-aa42-ab9afd1e5503", "type": "indicator", "spec_version": "2.1", "id": "indicator--fe21b8b1-3f3c-4117-ac19-fc11f7eff478", "modified": "2020-04-02T07:59:00.252Z"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--cfb0184a-1740-4457-a5e2-ae0fbd9abc69", "created": "2020-04-02T07:59:00.265Z", "modified": "2020-04-02T07:59:00.265Z", "source_ref": "indicator--fe21b8b1-3f3c-4117-ac19-fc11f7eff478", "relationship_type": "indicates", "target_ref": "attack-pattern--42e8de7b-37b2-4258-905a-6897815e58e0"}, {"name": "Firewall Disabled via Netsh", "description": "Detects netsh commands that turns off the Windows firewall", "created": "2019-11-01T00:00:00.000Z", "valid_from": "2019-11-01T00:00:00Z", "indicator_types": ["malicious-activity"], "pattern_type": "sigma", "pattern": "title: Firewall Disabled via Netsh\nid: 57c4bf16-227f-4394-8ec7-1b745ee061c3\ndescription: Detects netsh commands that turns off the Windows firewall\nreferences:\n    - https://www.winhelponline.com/blog/enable-and-disable-windows-firewall-quickly-using-command-line/\n    - https://app.any.run/tasks/210244b9-0b6b-4a2c-83a3-04bd3175d017/\ndate: 2019/11/01\nstatus: experimental\nauthor: Fatih Sirin\ntags:\n    - attack.defense_evasion\nlogsource:\n    category: process_creation\n    product: windows\ndetection:\n    selection:\n        CommandLine:\n            - netsh firewall set opmode mode=disable\n            - netsh advfirewall set * state off\n    condition: selection\nfalsepositives:\n    - Legitimate administration\nlevel: medium\n", "object_marking_refs": ["marking-definition--0a872d70-1d05-45dd-a25f-031af547a102"], "created_by_ref": "identity--082ca4f0-d825-45b6-aa42-ab9afd1e5503", "type": "indicator", "spec_version": "2.1", "id": "indicator--5372bed4-c586-48cb-b597-bbb7f597cbf3", "modified": "2020-04-02T07:59:00.269Z"}, {"name": "Suspicious Double Extension", "description": "Detects suspicious use of an .exe extension after a non-executable file extension like .pdf.exe, a set of spaces or underlines to cloak the executable file in spear phishing campaigns", "created": "2019-06-26T00:00:00.000Z", "valid_from": "2019-06-26T00:00:00Z", "indicator_types": ["malicious-activity"], "pattern_type": "sigma", "pattern": "title: Suspicious Double Extension\nid: 1cdd9a09-06c9-4769-99ff-626e2b3991b8\ndescription: Detects suspicious use of an .exe extension after a non-executable file extension like .pdf.exe, a set of spaces or underlines to cloak the executable\n    file in spear phishing campaigns\nreferences:\n    - https://blu3-team.blogspot.com/2019/06/misleading-extensions-xlsexe-docexe.html\n    - https://twitter.com/blackorbird/status/1140519090961825792\nauthor: Florian Roth (rule), @blu3_team (idea)\ndate: 2019/06/26\ntags:\n    - attack.initial_access\n    - attack.t1193\nlogsource:\n    category: process_creation\n    product: windows\ndetection:\n    selection:\n        Image: \n            - '*.doc.exe'\n            - '*.docx.exe'\n            - '*.xls.exe'\n            - '*.xlsx.exe'\n            - '*.ppt.exe'\n            - '*.pptx.exe'\n            - '*.rtf.exe'\n            - '*.pdf.exe'\n            - '*.txt.exe'\n            - '*      .exe'\n            - '*______.exe'\n    condition: selection\nfalsepositives: \n    - Unknown\nlevel: critical\n", "object_marking_refs": ["marking-definition--0a872d70-1d05-45dd-a25f-031af547a102"], "created_by_ref": "identity--082ca4f0-d825-45b6-aa42-ab9afd1e5503", "type": "indicator", "spec_version": "2.1", "id": "indicator--3eb6b961-e4e1-4729-a5b2-e08e5546b757", "modified": "2020-04-02T07:59:00.275Z"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--7b29bdb3-7d39-4432-b0cf-f903ae34652d", "created": "2020-04-02T07:59:00.286Z", "modified": "2020-04-02T07:59:00.286Z", "source_ref": "indicator--3eb6b961-e4e1-4729-a5b2-e08e5546b757", "relationship_type": "indicates", "target_ref": "attack-pattern--6aac77c4-eaf2-4366-8c13-ce50ab951f38"}, {"name": "Domain Trust Discovery", "description": "Identifies execution of nltest.exe and dsquery.exe for domain trust discovery. This technique is used by attackers to enumerate Active Directory trusts.", "created": "2019-10-24T00:00:00.000Z", "modified": "2019-11-11T00:00:00.000Z", "valid_from": "2019-10-24T00:00:00Z", "indicator_types": ["malicious-activity"], "pattern_type": "sigma", "pattern": "title: Domain Trust Discovery\nid: 3bad990e-4848-4a78-9530-b427d854aac0\ndescription: Identifies execution of nltest.exe and dsquery.exe for domain trust discovery. This technique is used by attackers to enumerate Active Directory trusts.\nstatus: experimental\nauthor: E.M. Anhaus (orignally from Atomic Blue Detections, Tony Lambert), oscd.community\ndate: 2019/10/24\nmodified: 2019/11/11\nreferences:\n    - https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1482/T1482.md\n    - https://eqllib.readthedocs.io/en/latest/analytics/03e231a6-74bc-467a-acb1-e5676b0fb55e.html\ntags:\n    - attack.discovery\n    - attack.t1482\nlogsource:\n    category: process_creation\n    product: windows\ndetection:\n    selection:\n      - Image|endswith: '\\nltest.exe'\n        CommandLine|contains: 'domain_trusts'\n      - Image|endswith: '\\dsquery.exe'\n        CommandLine|contains: 'trustedDomain'\n    condition: selection\nfalsepositives:\n    - Legitimate use of the utilities by legitimate user for legitimate reason\nlevel: medium\n", "object_marking_refs": ["marking-definition--0a872d70-1d05-45dd-a25f-031af547a102"], "created_by_ref": "identity--082ca4f0-d825-45b6-aa42-ab9afd1e5503", "type": "indicator", "spec_version": "2.1", "id": "indicator--0a5d7316-a047-4b3a-a0e6-360d70c7792f"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--1c674a96-55a7-45e2-9797-df2e1b09eb9c", "created": "2020-04-02T07:59:00.301Z", "modified": "2020-04-02T07:59:00.301Z", "source_ref": "indicator--0a5d7316-a047-4b3a-a0e6-360d70c7792f", "relationship_type": "indicates", "target_ref": "attack-pattern--767dbf9e-df3f-45cb-8998-4903ab5f80c0"}, {"name": "Highly Relevant Renamed Binary", "description": "Detects the execution of a renamed binary often used by attackers or malware leveraging new Sysmon OriginalFileName datapoint.", "created": "2019-06-15T00:00:00.000Z", "valid_from": "2019-06-15T00:00:00Z", "indicator_types": ["malicious-activity"], "pattern_type": "sigma", "pattern": "title: Highly Relevant Renamed Binary\nid: 0ba1da6d-b6ce-4366-828c-18826c9de23e\nstatus: experimental\ndescription: Detects the execution of a renamed binary often used by attackers or malware leveraging new Sysmon OriginalFileName datapoint.\nauthor: Matthew Green - @mgreen27, Florian Roth\ndate: 2019/06/15\nreferences:\n    - https://attack.mitre.org/techniques/T1036/\n    - https://mgreen27.github.io/posts/2019/05/12/BinaryRename.html\n    - https://mgreen27.github.io/posts/2019/05/29/BinaryRename2.html\ntags:\n    - attack.t1036\n    - attack.defense_evasion\nlogsource:\n    category: process_creation\n    product: windows\ndetection:\n    selection:\n        OriginalFileName:\n            - \"powershell.exe\"\n            - \"powershell_ise.exe\"\n            - \"psexec.exe\"\n            - \"psexec.c\"  # old versions of psexec (2016 seen)\n            - \"cscript.exe\"\n            - \"wscript.exe\"\n            - \"mshta.exe\"\n            - \"regsvr32.exe\"\n            - \"wmic.exe\"\n            - \"certutil.exe\"\n            - \"rundll32.exe\"\n            - \"cmstp.exe\"\n            - \"msiexec.exe\"\n    filter:\n        Image:\n            - '*\\powershell.exe'\n            - '*\\powershell_ise.exe'\n            - '*\\psexec.exe'\n            - '*\\psexec64.exe'\n            - '*\\cscript.exe'\n            - '*\\wscript.exe'\n            - '*\\mshta.exe'\n            - '*\\regsvr32.exe'\n            - '*\\wmic.exe'\n            - '*\\certutil.exe'\n            - '*\\rundll32.exe'\n            - '*\\cmstp.exe'\n            - '*\\msiexec.exe'\n    condition: selection and not filter\nfalsepositives:\n    - Custom applications use renamed binaries adding slight change to binary name. Typically this is easy to spot and add to whitelist\nlevel: high\n", "object_marking_refs": ["marking-definition--0a872d70-1d05-45dd-a25f-031af547a102"], "created_by_ref": "identity--082ca4f0-d825-45b6-aa42-ab9afd1e5503", "type": "indicator", "spec_version": "2.1", "id": "indicator--4e144d7e-0287-4290-8f9d-9646e7013ee4", "modified": "2020-04-02T07:59:00.308Z"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--396a42e7-4fbc-4a65-93ac-20b5c9bd30e1", "created": "2020-04-02T07:59:00.320Z", "modified": "2020-04-02T07:59:00.320Z", "source_ref": "indicator--4e144d7e-0287-4290-8f9d-9646e7013ee4", "relationship_type": "indicates", "target_ref": "attack-pattern--42e8de7b-37b2-4258-905a-6897815e58e0"}, {"name": "Query Registry", "description": "Adversaries may interact with the Windows Registry to gather information about the system, configuration, and installed software.", "created": "2019-10-21T00:00:00.000Z", "modified": "2019-11-04T00:00:00.000Z", "valid_from": "2019-10-21T00:00:00Z", "indicator_types": ["malicious-activity"], "pattern_type": "sigma", "pattern": "title: Query Registry\nid: 970007b7-ce32-49d0-a4a4-fbef016950bd\nstatus: experimental\ndescription: Adversaries may interact with the Windows Registry to gather information about the system, configuration, and installed software.\nauthor: Timur Zinniatullin, oscd.community\ndate: 2019/10/21\nmodified: 2019/11/04\nreferences:\n    - https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1012/T1012.yaml\nlogsource:\n    category: process_creation\n    product: windows\ndetection:\n    selection_1:\n        Image|endswith: '\\reg.exe'\n        CommandLine|contains: \n            - 'query'\n            - 'save'\n            - 'export'\n    selection_2:\n        CommandLine|contains:\n            - 'currentVersion\\windows'\n            - 'currentVersion\\runServicesOnce'\n            - 'currentVersion\\runServices'\n            - 'winlogon\\'\n            - 'currentVersion\\shellServiceObjectDelayLoad'\n            - 'currentVersion\\runOnce'\n            - 'currentVersion\\runOnceEx'\n            - 'currentVersion\\run'\n            - 'currentVersion\\policies\\explorer\\run'\n            - 'currentcontrolset\\services'\n    condition: selection_1 and selection_2\nfields:\n    - Image\n    - CommandLine\n    - User\n    - LogonGuid\n    - Hashes\n    - ParentProcessGuid\n    - ParentCommandLine\nlevel: low\ntags:\n    - attack.discovery\n    - attack.t1012\n    - attack.t1007\n", "object_marking_refs": ["marking-definition--0a872d70-1d05-45dd-a25f-031af547a102"], "created_by_ref": "identity--082ca4f0-d825-45b6-aa42-ab9afd1e5503", "type": "indicator", "spec_version": "2.1", "id": "indicator--5f61a4a8-d49b-4a78-a6a2-3204532249ae"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--5cd780f7-081f-47bb-9eb6-9bff4f9ed2a9", "created": "2020-04-02T07:59:00.338Z", "modified": "2020-04-02T07:59:00.338Z", "source_ref": "indicator--5f61a4a8-d49b-4a78-a6a2-3204532249ae", "relationship_type": "indicates", "target_ref": "attack-pattern--c32f7008-9fea-41f7-8366-5eb9b74bd896"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--a8a6cb2c-8b4e-4b5c-aa8a-575755adf146", "created": "2020-04-02T07:59:00.348Z", "modified": "2020-04-02T07:59:00.348Z", "source_ref": "indicator--5f61a4a8-d49b-4a78-a6a2-3204532249ae", "relationship_type": "indicates", "target_ref": "attack-pattern--322bad5a-1c49-4d23-ab79-76d641794afa"}, {"name": "Application Whitelisting Bypass via DLL Loaded by odbcconf.exe", "description": "Detects defence evasion attempt via odbcconf.exe execution to load DLL", "created": "2019-10-25T00:00:00.000Z", "modified": "2019-11-07T00:00:00.000Z", "valid_from": "2019-10-25T00:00:00Z", "indicator_types": ["malicious-activity"], "pattern_type": "sigma", "pattern": "title: Application Whitelisting Bypass via DLL Loaded by odbcconf.exe\nid: 65d2be45-8600-4042-b4c0-577a1ff8a60e\ndescription: Detects defence evasion attempt via odbcconf.exe execution to load DLL\nstatus: experimental\nreferences:\n    - https://github.com/LOLBAS-Project/LOLBAS/blob/master/yml/OSBinaries/Odbcconf.yml\n    - https://twitter.com/Hexacorn/status/1187143326673330176\nauthor: Kirill Kiryanov, Beyu Denis, Daniil Yugoslavskiy, oscd.community\ndate: 2019/10/25\nmodified: 2019/11/07\ntags:\n    - attack.defense_evasion\n    - attack.execution\n    - attack.t1218\nlogsource:\n    category: process_creation\n    product: windows\ndetection:\n    selection_1:\n        Image|endswith: '\\odbcconf.exe'\n        CommandLine|contains:\n            - '-f'\n            - 'regsvr'\n    selection_2:\n        ParentImage|endswith: '\\odbcconf.exe'\n        Image|endswith: '\\rundll32.exe'\n    condition: selection_1 or selection_2\nlevel: medium\nfalsepositives:\n    - Legitimate use of odbcconf.exe by legitimate user\n", "object_marking_refs": ["marking-definition--0a872d70-1d05-45dd-a25f-031af547a102"], "created_by_ref": "identity--082ca4f0-d825-45b6-aa42-ab9afd1e5503", "type": "indicator", "spec_version": "2.1", "id": "indicator--0151bd30-137d-42f2-9767-3c28afa9317a"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--3ce1f179-468b-4153-acf0-52ab755c0e08", "created": "2020-04-02T07:59:00.364Z", "modified": "2020-04-02T07:59:00.364Z", "source_ref": "indicator--0151bd30-137d-42f2-9767-3c28afa9317a", "relationship_type": "indicates", "target_ref": "attack-pattern--457c7820-d331-465a-915e-42f85500ccc4"}, {"name": "Indirect Command Execution", "description": "Detect indirect command execution via Program Compatibility Assistant pcalua.exe or forfiles.exe", "created": "2019-10-24T00:00:00.000Z", "modified": "2019-11-11T00:00:00.000Z", "valid_from": "2019-10-24T00:00:00Z", "indicator_types": ["malicious-activity"], "pattern_type": "sigma", "pattern": "title: Indirect Command Execution\nid: fa47597e-90e9-41cd-ab72-c3b74cfb0d02\ndescription: Detect indirect command execution via Program Compatibility Assistant pcalua.exe or forfiles.exe\nstatus: experimental\nauthor: E.M. Anhaus (orignally from Atomic Blue Detections, Endgame), oscd.community\nreferences:\n    - https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1202/T1202.yaml\n    - https://eqllib.readthedocs.io/en/latest/analytics/884a7ccd-7305-4130-82d0-d4f90bc118b6.html\ndate: 2019/10/24\nmodified: 2019/11/11\ntags:\n    - attack.defense_evasion\n    - attack.t1202\nlogsource:\n    category: process_creation\n    product: windows\ndetection:\n    selection:\n        ParentImage|endswith:\n            - '\\pcalua.exe'\n            - '\\forfiles.exe'\n    condition: selection\nfields:\n    - ComputerName\n    - User\n    - ParentCommandLine\n    - CommandLine\nfalsepositives:\n    - Need to use extra processing with 'unique_count' / 'filter' to focus on outliers as opposed to commonly seen artifacts\n    - Legit usage of scripts\nlevel: low\n", "object_marking_refs": ["marking-definition--0a872d70-1d05-45dd-a25f-031af547a102"], "created_by_ref": "identity--082ca4f0-d825-45b6-aa42-ab9afd1e5503", "type": "indicator", "spec_version": "2.1", "id": "indicator--8b58b43b-9e2e-4238-87c1-0c29aa22b0a5"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--c0a4bae7-c71e-45f8-b110-328fbf1bcfdd", "created": "2020-04-02T07:59:00.381Z", "modified": "2020-04-02T07:59:00.381Z", "source_ref": "indicator--8b58b43b-9e2e-4238-87c1-0c29aa22b0a5", "relationship_type": "indicates", "target_ref": "attack-pattern--3b0e52ce-517a-4614-a523-1bd5deef6c5e"}, {"name": "Remote PowerShell Session", "description": "Detects remote PowerShell sections by monitoring for wsmprovhost as a parent or child process (sign of an active ps remote session)", "created": "2019-09-12T00:00:00.000Z", "modified": "2019-11-10T00:00:00.000Z", "valid_from": "2019-09-12T00:00:00Z", "indicator_types": ["malicious-activity"], "pattern_type": "sigma", "pattern": "title: Remote PowerShell Session\nid: 734f8d9b-42b8-41b2-bcf5-abaf49d5a3c8\ndescription: Detects remote PowerShell sections by monitoring for wsmprovhost as a parent or child process (sign of an active ps remote session)\nstatus: experimental\ndate: 2019/09/12\nmodified: 2019/11/10\nauthor: Roberto Rodriguez @Cyb3rWard0g\nreferences:\n    - https://github.com/Cyb3rWard0g/ThreatHunter-Playbook/tree/master/playbooks/windows/02_execution/T1086_powershell/powershell_remote_session.md\ntags:\n    - attack.execution\n    - attack.t1086\nlogsource:\n    category: process_creation\n    product: windows\ndetection:\n    selection:\n        - Image|endswith: '\\wsmprovhost.exe'\n        - ParentImage|endswith: '\\wsmprovhost.exe'\n    condition: selection\nfields:\n    - ComputerName\n    - User\n    - CommandLine\nfalsepositives:\n    - Legitimate usage of remote Powershell, e.g. for monitoring purposes\nlevel: medium\n", "object_marking_refs": ["marking-definition--0a872d70-1d05-45dd-a25f-031af547a102"], "created_by_ref": "identity--082ca4f0-d825-45b6-aa42-ab9afd1e5503", "type": "indicator", "spec_version": "2.1", "id": "indicator--5c60a83d-7377-4e33-96f0-f72931a056a4"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--8f229336-7afa-4e4d-93bd-61c9295b7580", "created": "2020-04-02T07:59:00.396Z", "modified": "2020-04-02T07:59:00.396Z", "source_ref": "indicator--5c60a83d-7377-4e33-96f0-f72931a056a4", "relationship_type": "indicates", "target_ref": "attack-pattern--f4882e23-8aa7-4b12-b28a-b349c12ee9e0"}, {"name": "Suspect Svchost Activity", "description": "It is extremely abnormal for svchost.exe to spawn without any CLI arguments and is normally observed when a malicious process spawns the process and injects code into the process memory space.", "created": "2019-12-28T00:00:00.000Z", "valid_from": "2019-12-28T00:00:00Z", "indicator_types": ["malicious-activity"], "pattern_type": "sigma", "pattern": "title: Suspect Svchost Activity\nid: 16c37b52-b141-42a5-a3ea-bbe098444397\nstatus: experimental\ndescription: It is extremely abnormal for svchost.exe to spawn without any CLI arguments and is normally observed when a malicious process spawns the process and injects code into the process memory space.\nreferences:\n    - https://securitybytes.io/blue-team-fundamentals-part-two-windows-processes-759fe15965e2\nauthor: David Burkett\ndate: 2019/12/28\ntags:\n    - attack.t1055\nlogsource:\n    category: process_creation\n    product: windows\ndetection:\n    selection1:\n        CommandLine: null\n    selection2:\n        Image: '*\\svchost.exe'\n    filter:\n        ParentImage:\n            - '*\\rpcnet.exe'\n            - '*\\rpcnetp.exe'\n    condition: (selection1 and selection2) and not filter\nfields:\n    - CommandLine\n    - ParentCommandLine\nfalsepositives:\n    - rpcnet.exe / rpcnetp.exe which is a lojack style software. https://www.blackhat.com/docs/us-14/materials/us-14-Kamlyuk-Kamluk-Computrace-Backdoor-Revisited.pdf\nlevel: critical\n", "object_marking_refs": ["marking-definition--0a872d70-1d05-45dd-a25f-031af547a102"], "created_by_ref": "identity--082ca4f0-d825-45b6-aa42-ab9afd1e5503", "type": "indicator", "spec_version": "2.1", "id": "indicator--b2c8c90d-f8e9-4e07-9549-542ef13e961a", "modified": "2020-04-02T07:59:00.401Z"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--0db549bb-0606-4f17-a535-ad6c84ecdec4", "created": "2020-04-02T07:59:00.414Z", "modified": "2020-04-02T07:59:00.414Z", "source_ref": "indicator--b2c8c90d-f8e9-4e07-9549-542ef13e961a", "relationship_type": "indicates", "target_ref": "attack-pattern--43e7dc91-05b2-474c-b9ac-2ed4fe101f4d"}, {"name": "Detection of PowerShell Execution via DLL", "description": "Detects PowerShell Strings applied to rundllas seen in PowerShdll.dll", "created": "2018-08-25T00:00:00.000Z", "valid_from": "2018-08-25T00:00:00Z", "indicator_types": ["malicious-activity"], "pattern_type": "sigma", "pattern": "title: Detection of PowerShell Execution via DLL\nid: 6812a10b-60ea-420c-832f-dfcc33b646ba\nstatus: experimental\ndescription: Detects PowerShell Strings applied to rundllas seen in PowerShdll.dll\nreferences:\n    - https://github.com/p3nt4/PowerShdll/blob/master/README.md\ntags:\n    - attack.execution\n    - attack.t1086\n    - car.2014-04-003\nauthor: Markus Neis\ndate: 2018/08/25\nlogsource:\n    category: process_creation\n    product: windows\ndetection:\n    selection1:\n        Image:\n            - '*\\rundll32.exe'\n    selection2:\n        Description:\n            - '*Windows-Hostprozess (Rundll32)*'\n    selection3:\n        CommandLine:\n            - '*Default.GetString*'\n            - '*FromBase64String*'\n    condition: (selection1 or selection2) and selection3\nfalsepositives:\n    - Unknown\nlevel: high\n", "object_marking_refs": ["marking-definition--0a872d70-1d05-45dd-a25f-031af547a102"], "created_by_ref": "identity--082ca4f0-d825-45b6-aa42-ab9afd1e5503", "type": "indicator", "spec_version": "2.1", "id": "indicator--bfe3a85a-50db-47f4-88b5-9f7823f2d30a", "modified": "2020-04-02T07:59:00.418Z"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--4618b3e6-e1d4-4321-a4f5-9206885b3423", "created": "2020-04-02T07:59:00.430Z", "modified": "2020-04-02T07:59:00.430Z", "source_ref": "indicator--bfe3a85a-50db-47f4-88b5-9f7823f2d30a", "relationship_type": "indicates", "target_ref": "attack-pattern--f4882e23-8aa7-4b12-b28a-b349c12ee9e0"}, {"name": "Devtoolslauncher.exe Executes Specified Binary", "description": "The Devtoolslauncher.exe executes other binary", "created": "2019-10-12T00:00:00.000Z", "modified": "2019-11-04T00:00:00.000Z", "valid_from": "2019-10-12T00:00:00Z", "indicator_types": ["malicious-activity"], "pattern_type": "sigma", "pattern": "title: Devtoolslauncher.exe Executes Specified Binary\nid: cc268ac1-42d9-40fd-9ed3-8c4e1a5b87e6\nstatus: experimental\ndescription: The Devtoolslauncher.exe executes other binary\nreferences:\n    - https://github.com/LOLBAS-Project/LOLBAS/blob/master/yml/OtherMSBinaries/Devtoolslauncher.yml\n    - https://twitter.com/_felamos/status/1179811992841797632\nauthor: Beyu Denis, oscd.community (rule), @_felamos (idea)\ndate: 2019/10/12\nmodified: 2019/11/04\ntags:\n    - attack.defense_evasion\n    - attack.execution\n    - attack.t1218\nlevel: critical\nlogsource:\n    category: process_creation\n    product: windows\ndetection:\n    selection:\n        Image|endswith: '\\devtoolslauncher.exe'\n        CommandLine|contains: 'LaunchForDeploy'\n    condition: selection\nfalsepositives:\n    - Legitimate use of devtoolslauncher.exe by legitimate user\n", "object_marking_refs": ["marking-definition--0a872d70-1d05-45dd-a25f-031af547a102"], "created_by_ref": "identity--082ca4f0-d825-45b6-aa42-ab9afd1e5503", "type": "indicator", "spec_version": "2.1", "id": "indicator--ff13787b-41f4-45ef-9435-cfd43a0e43f1"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--a1a3d215-9246-44f9-9e53-8efe1f854a37", "created": "2020-04-02T07:59:00.447Z", "modified": "2020-04-02T07:59:00.447Z", "source_ref": "indicator--ff13787b-41f4-45ef-9435-cfd43a0e43f1", "relationship_type": "indicates", "target_ref": "attack-pattern--457c7820-d331-465a-915e-42f85500ccc4"}, {"name": "Netsh RDP Port Forwarding", "description": "Detects netsh commands that configure a port forwarding of port 3389 used for RDP", "created": "2019-01-29T00:00:00.000Z", "valid_from": "2019-01-29T00:00:00Z", "indicator_types": ["malicious-activity"], "pattern_type": "sigma", "pattern": "title: Netsh RDP Port Forwarding\nid: 782d6f3e-4c5d-4b8c-92a3-1d05fed72e63\ndescription: Detects netsh commands that configure a port forwarding of port 3389 used for RDP\nreferences:\n    - https://www.fireeye.com/blog/threat-research/2019/01/bypassing-network-restrictions-through-rdp-tunneling.html\ndate: 2019/01/29\ntags:\n    - attack.lateral_movement\n    - attack.t1021\n    - car.2013-07-002\nstatus: experimental\nauthor: Florian Roth\nlogsource:\n    category: process_creation\n    product: windows\ndetection:\n    selection:\n        CommandLine:\n            - netsh i* p*=3389 c*\n    condition: selection\nfalsepositives:\n    - Legitimate administration\nlevel: high\n", "object_marking_refs": ["marking-definition--0a872d70-1d05-45dd-a25f-031af547a102"], "created_by_ref": "identity--082ca4f0-d825-45b6-aa42-ab9afd1e5503", "type": "indicator", "spec_version": "2.1", "id": "indicator--4f2b01ed-388d-4503-b92a-130f766c5c34", "modified": "2020-04-02T07:59:00.451Z"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--fe3d6660-6b16-478c-9958-7be4309cdd1b", "created": "2020-04-02T07:59:00.462Z", "modified": "2020-04-02T07:59:00.462Z", "source_ref": "indicator--4f2b01ed-388d-4503-b92a-130f766c5c34", "relationship_type": "indicates", "target_ref": "attack-pattern--54a649ff-439a-41a4-9856-8d144a2551ba"}, {"name": "Exploited CVE-2020-10189 Zoho ManageEngine", "description": "Detects the exploitation of Zoho ManageEngine Desktop Central Java Deserialization vulnerability reported as CVE-2020-10189", "created": "2020-03-25T00:00:00.000Z", "valid_from": "2020-03-25T00:00:00Z", "indicator_types": ["malicious-activity"], "pattern_type": "sigma", "pattern": "title: Exploited CVE-2020-10189 Zoho ManageEngine\nid: 846b866e-2a57-46ee-8e16-85fa92759be7\nstatus: experimental\ndescription: Detects the exploitation of Zoho ManageEngine Desktop Central Java Deserialization vulnerability reported as CVE-2020-10189\nreferences:\n    - https://www.fireeye.com/blog/threat-research/2020/03/apt41-initiates-global-intrusion-campaign-using-multiple-exploits.html\n    - https://nvd.nist.gov/vuln/detail/CVE-2020-10189\n    - https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2020-10189\n    - https://vulmon.com/exploitdetails?qidtp=exploitdb&qid=48224\nauthor: Florian Roth\ndate: 2020/03/25\ntags:\n    - attack.initial_access\n    - attack.t1190\nlogsource:\n    category: process_creation\n    product: windows\ndetection:\n    selection:\n        ParentImage|endswith: 'DesktopCentral_Server\\jre\\bin\\java.exe'\n        Image|endswith: \n            - '*\\cmd.exe'\n            - '*\\powershell.exe'\n            - '*\\bitsadmin.exe'\n    condition: selection\nfalsepositives:\n    - Unknown\nlevel: critical\n", "object_marking_refs": ["marking-definition--0a872d70-1d05-45dd-a25f-031af547a102"], "created_by_ref": "identity--082ca4f0-d825-45b6-aa42-ab9afd1e5503", "type": "indicator", "spec_version": "2.1", "id": "indicator--5ac8f5d1-4013-4bfd-b7d8-4fd42bfd8b87", "modified": "2020-04-02T07:59:00.466Z"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--5cd767d7-6b75-4178-9af4-653fcb9f08fd", "created": "2020-04-02T07:59:00.476Z", "modified": "2020-04-02T07:59:00.476Z", "source_ref": "indicator--5ac8f5d1-4013-4bfd-b7d8-4fd42bfd8b87", "relationship_type": "indicates", "target_ref": "attack-pattern--3f886f2a-874f-4333-b794-aa6075009b1c"}, {"name": "Suspicious RASdial Activity", "description": "Detects suspicious process related to rasdial.exe", "created": "2019-01-16T00:00:00.000Z", "valid_from": "2019-01-16T00:00:00Z", "indicator_types": ["malicious-activity"], "pattern_type": "sigma", "pattern": "title: Suspicious RASdial Activity\nid: 6bba49bf-7f8c-47d6-a1bb-6b4dece4640e\ndescription: Detects suspicious process related to rasdial.exe\nstatus: experimental\nreferences:\n    - https://twitter.com/subTee/status/891298217907830785\nauthor: juju4\ndate: 2019/01/16\ntags:\n    - attack.defense_evasion\n    - attack.execution\n    - attack.t1064\nlogsource:\n    category: process_creation\n    product: windows\ndetection:\n    selection:\n        CommandLine:\n            - rasdial\n    condition: selection\nfalsepositives:\n    - False positives depend on scripts and administrative tools used in the monitored environment\nlevel: medium\n", "object_marking_refs": ["marking-definition--0a872d70-1d05-45dd-a25f-031af547a102"], "created_by_ref": "identity--082ca4f0-d825-45b6-aa42-ab9afd1e5503", "type": "indicator", "spec_version": "2.1", "id": "indicator--d9857e1e-365c-4210-b89b-586e069bfda1", "modified": "2020-04-02T07:59:00.480Z"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--6347fc56-65e4-470c-b1bb-1fe753c2352b", "created": "2020-04-02T07:59:00.489Z", "modified": "2020-04-02T07:59:00.489Z", "source_ref": "indicator--d9857e1e-365c-4210-b89b-586e069bfda1", "relationship_type": "indicates", "target_ref": "attack-pattern--7fd87010-3a00-4da3-b905-410525e8ec44"}, {"name": "Suspicious Rundll32 Activity", "description": "Detects suspicious process related to rundll32 based on arguments", "created": "2019-01-16T00:00:00.000Z", "valid_from": "2019-01-16T00:00:00Z", "indicator_types": ["malicious-activity"], "pattern_type": "sigma", "pattern": "title: Suspicious Rundll32 Activity\nid: e593cf51-88db-4ee1-b920-37e89012a3c9\ndescription: Detects suspicious process related to rundll32 based on arguments\nstatus: experimental\nreferences:\n    - http://www.hexacorn.com/blog/2017/05/01/running-programs-via-proxy-jumping-on-a-edr-bypass-trampoline/\n    - https://twitter.com/Hexacorn/status/885258886428725250\n    - https://gist.github.com/ryhanson/227229866af52e2d963cf941af135a52\ntags:\n    - attack.defense_evasion\n    - attack.execution\n    - attack.t1085\nauthor: juju4\ndate: 2019/01/16\nlogsource:\n    category: process_creation\n    product: windows\ndetection:\n    selection:\n        CommandLine:\n            - '*\\rundll32.exe* url.dll,*OpenURL *'\n            - '*\\rundll32.exe* url.dll,*OpenURLA *'\n            - '*\\rundll32.exe* url.dll,*FileProtocolHandler *'\n            - '*\\rundll32.exe* zipfldr.dll,*RouteTheCall *'\n            - '*\\rundll32.exe* Shell32.dll,*Control_RunDLL *'\n            - '*\\rundll32.exe javascript:*'\n            - '* url.dll,*OpenURL *'\n            - '* url.dll,*OpenURLA *'\n            - '* url.dll,*FileProtocolHandler *'\n            - '* zipfldr.dll,*RouteTheCall *'\n            - '* Shell32.dll,*Control_RunDLL *'\n            - '* javascript:*'\n            - '*.RegisterXLL*'\n    condition: selection\nfalsepositives:\n    - False positives depend on scripts and administrative tools used in the monitored environment\nlevel: medium\n", "object_marking_refs": ["marking-definition--0a872d70-1d05-45dd-a25f-031af547a102"], "created_by_ref": "identity--082ca4f0-d825-45b6-aa42-ab9afd1e5503", "type": "indicator", "spec_version": "2.1", "id": "indicator--ab1c4a62-0b77-48cb-b46b-86e3adbfb4ad", "modified": "2020-04-02T07:59:00.495Z"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--fe468b7b-0680-468a-a507-de0f6e605c84", "created": "2020-04-02T07:59:00.504Z", "modified": "2020-04-02T07:59:00.504Z", "source_ref": "indicator--ab1c4a62-0b77-48cb-b46b-86e3adbfb4ad", "relationship_type": "indicates", "target_ref": "attack-pattern--62b8c999-dcc0-4755-bd69-09442d9359f5"}, {"name": "Sticky Key Like Backdoor Usage", "description": "Detects the usage and installation of a backdoor that uses an option to register a malicious debugger for built-in tools that are accessible in the login screen", "created": "2018-03-15T00:00:00.000Z", "valid_from": "2018-03-15T00:00:00Z", "indicator_types": ["malicious-activity"], "pattern_type": "sigma", "pattern": "action: global\ntitle: Sticky Key Like Backdoor Usage\nid: baca5663-583c-45f9-b5dc-ea96a22ce542\ndescription: Detects the usage and installation of a backdoor that uses an option to register a malicious debugger for built-in tools that are accessible in the login\n    screen\nreferences:\n    - https://blogs.technet.microsoft.com/jonathantrull/2016/10/03/detecting-sticky-key-backdoors/\ntags:\n    - attack.privilege_escalation\n    - attack.persistence\n    - attack.t1015\n    - car.2014-11-003\n    - car.2014-11-008\nauthor: Florian Roth, @twjackomo\ndate: 2018/03/15\ndetection:\n    condition: 1 of them\nfalsepositives:\n    - Unlikely\nlevel: critical\n", "object_marking_refs": ["marking-definition--0a872d70-1d05-45dd-a25f-031af547a102"], "created_by_ref": "identity--082ca4f0-d825-45b6-aa42-ab9afd1e5503", "type": "indicator", "spec_version": "2.1", "id": "indicator--9666cbe7-0012-44ef-90cb-63aef4520a92", "modified": "2020-04-02T07:59:00.506Z"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--c295ce6e-38a2-41a7-95eb-c87655060458", "created": "2020-04-02T07:59:00.516Z", "modified": "2020-04-02T07:59:00.516Z", "source_ref": "indicator--9666cbe7-0012-44ef-90cb-63aef4520a92", "relationship_type": "indicates", "target_ref": "attack-pattern--9b99b83a-1aac-4e29-b975-b374950551a3"}, {"name": "CMSTP Execution", "description": "Detects various indicators of Microsoft Connection Manager Profile Installer execution", "created": "2018-07-16T00:00:00.000Z", "valid_from": "2018-07-16T00:00:00Z", "indicator_types": ["malicious-activity"], "pattern_type": "sigma", "pattern": "action: global\ntitle: CMSTP Execution\nid: 9d26fede-b526-4413-b069-6e24b6d07167\nstatus: stable\ndescription: Detects various indicators of Microsoft Connection Manager Profile Installer execution\ntags:\n    - attack.defense_evasion\n    - attack.execution\n    - attack.t1191\n    - attack.g0069\n    - car.2019-04-001\nauthor: Nik Seetharaman\ndate: 2018/07/16\nreferences:\n    - http://www.endurant.io/cmstp/detecting-cmstp-enabled-code-execution-and-uac-bypass-with-sysmon/\ndetection:\n    condition: 1 of them\nfields:\n    - CommandLine\n    - ParentCommandLine\n    - Details\nfalsepositives:\n    - Legitimate CMSTP use (unlikely in modern enterprise environments)\nlevel: high\n", "object_marking_refs": ["marking-definition--0a872d70-1d05-45dd-a25f-031af547a102"], "created_by_ref": "identity--082ca4f0-d825-45b6-aa42-ab9afd1e5503", "type": "indicator", "spec_version": "2.1", "id": "indicator--51d35684-be45-4df8-9f69-3d12dc07de93", "modified": "2020-04-02T07:59:00.523Z"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--6d516ee4-85d6-4070-963f-936c3afb124d", "created": "2020-04-02T07:59:00.533Z", "modified": "2020-04-02T07:59:00.533Z", "source_ref": "indicator--51d35684-be45-4df8-9f69-3d12dc07de93", "relationship_type": "indicates", "target_ref": "attack-pattern--7d6f590f-544b-45b4-9a42-e0805f342af3"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--a53a45f8-6b48-4992-b0ed-a4d982a7c290", "created": "2020-04-02T07:59:00.541Z", "modified": "2020-04-02T07:59:00.541Z", "source_ref": "indicator--51d35684-be45-4df8-9f69-3d12dc07de93", "relationship_type": "indicates", "target_ref": "intrusion-set--269e8108-68c6-4f99-b911-14b2e765dec2"}, {"name": "Suspicious Outbound RDP Connections", "description": "Detects Non-Standard Tools Connecting to TCP port 3389 indicating possible lateral movement", "created": "2019-05-15T00:00:00.000Z", "valid_from": "2019-05-15T00:00:00Z", "indicator_types": ["malicious-activity"], "pattern_type": "sigma", "pattern": "title: Suspicious Outbound RDP Connections\nid: ed74fe75-7594-4b4b-ae38-e38e3fd2eb23\nstatus: experimental\ndescription: Detects Non-Standard Tools Connecting to TCP port 3389 indicating possible lateral movement\nreferences:\n    - https://portal.msrc.microsoft.com/en-US/security-guidance/advisory/CVE-2019-0708\nauthor: Markus Neis - Swisscom\ndate: 2019/05/15\ntags:\n    - attack.lateral_movement\n    - attack.t1210\n    - car.2013-07-002\nlogsource:\n    product: windows\n    service: sysmon\ndetection:\n    selection:\n        EventID: 3\n        DestinationPort: 3389\n        Initiated: 'true'\n    filter:\n        Image:\n            - '*\\mstsc.exe'\n            - '*\\RTSApp.exe'\n            - '*\\RTS2App.exe'\n            - '*\\RDCMan.exe'\n            - '*\\ws_TunnelService.exe'\n            - '*\\RSSensor.exe'\n            - '*\\RemoteDesktopManagerFree.exe'\n            - '*\\RemoteDesktopManager.exe'\n            - '*\\RemoteDesktopManager64.exe'\n            - '*\\mRemoteNG.exe'\n            - '*\\mRemote.exe'\n            - '*\\Terminals.exe'\n            - '*\\spiceworks-finder.exe'\n            - '*\\FSDiscovery.exe'\n            - '*\\FSAssessment.exe'\n            - '*\\MobaRTE.exe'\n            - '*\\chrome.exe'\n            - '*\\thor.exe'\n            - '*\\thor64.exe'\n    condition: selection and not filter \nfalsepositives:\n    - Other Remote Desktop RDP tools\nlevel: high\n", "object_marking_refs": ["marking-definition--0a872d70-1d05-45dd-a25f-031af547a102"], "created_by_ref": "identity--082ca4f0-d825-45b6-aa42-ab9afd1e5503", "type": "indicator", "spec_version": "2.1", "id": "indicator--fecbf172-2c28-4c59-99dd-8b145a368e39", "modified": "2020-04-02T07:59:00.550Z"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--3f80aeef-7bcc-4e72-9f52-ad739cd5bcec", "created": "2020-04-02T07:59:00.560Z", "modified": "2020-04-02T07:59:00.560Z", "source_ref": "indicator--fecbf172-2c28-4c59-99dd-8b145a368e39", "relationship_type": "indicates", "target_ref": "attack-pattern--9db0cf3a-a3c9-4012-8268-123b9db6fd82"}, {"name": "Disable Security Events Logging Adding Reg Key MiniNt", "description": "Detects the addition of a key 'MiniNt' to the registry. Upon a reboot, Windows Event Log service will stopped write events.", "created": "2019-10-25T00:00:00.000Z", "modified": "2019-11-13T00:00:00.000Z", "valid_from": "2019-10-25T00:00:00Z", "indicator_types": ["malicious-activity"], "pattern_type": "sigma", "pattern": "title: Disable Security Events Logging Adding Reg Key MiniNt\nid: 919f2ef0-be2d-4a7a-b635-eb2b41fde044\nstatus: experimental\ndescription: Detects the addition of a key 'MiniNt' to the registry. Upon a reboot, Windows Event Log service will stopped write events.\nreferences:\n    - https://twitter.com/0gtweet/status/1182516740955226112\ntags:\n    - attack.defense_evasion\n    - attack.t1089\nauthor: Ilyas Ochkov, oscd.community\ndate: 2019/10/25\nmodified: 2019/11/13\nlogsource:\n    product: windows\n    service: sysmon\ndetection:\n    selection:\n      - EventID: 12 # key create\n        # Sysmon gives us HKLM\\SYSTEM\\CurrentControlSet\\.. if ControlSetXX is the selected one\n        TargetObject: 'HKLM\\SYSTEM\\CurrentControlSet\\Control\\MiniNt'\n      - EventID: 14  # key rename\n        NewName: 'HKLM\\SYSTEM\\CurrentControlSet\\Control\\MiniNt'\n    condition: selection\nfields:\n    - EventID\n    - Image\n    - TargetObject\n    - NewName\nfalsepositives:\n    - Unkown\nlevel: high\n", "object_marking_refs": ["marking-definition--0a872d70-1d05-45dd-a25f-031af547a102"], "created_by_ref": "identity--082ca4f0-d825-45b6-aa42-ab9afd1e5503", "type": "indicator", "spec_version": "2.1", "id": "indicator--bc41bc40-6a69-4d17-9fe3-a3dbda94284a"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--264df332-4f4b-45ec-b649-55ba695c6747", "created": "2020-04-02T07:59:00.574Z", "modified": "2020-04-02T07:59:00.574Z", "source_ref": "indicator--bc41bc40-6a69-4d17-9fe3-a3dbda94284a", "relationship_type": "indicates", "target_ref": "attack-pattern--2e0dd10b-676d-4964-acd0-8a404c92b044"}, {"name": "Malware Shellcode in Verclsid Target Process", "description": "Detects a process access to verclsid.exe that injects shellcode from a Microsoft Office application / VBA macro", "created": "2017-03-04T00:00:00.000Z", "valid_from": "2017-03-04T00:00:00Z", "indicator_types": ["malicious-activity"], "pattern_type": "sigma", "pattern": "title: Malware Shellcode in Verclsid Target Process\nid: b7967e22-3d7e-409b-9ed5-cdae3f9243a1\nstatus: experimental\ndescription: Detects a process access to verclsid.exe that injects shellcode from a Microsoft Office application / VBA macro\nreferences:\n    - https://twitter.com/JohnLaTwC/status/837743453039534080\ntags:\n    - attack.defense_evasion\n    - attack.privilege_escalation\n    - attack.t1055\nauthor: John Lambert (tech), Florian Roth (rule)\ndate: 2017/03/04\nlogsource:\n    product: windows\n    service: sysmon\n    definition: 'Use the following config to generate the necessary Event ID 10 Process Access events: <ProcessAccess onmatch=\"include\"><CallTrace condition=\"contains\">VBE7.DLL</CallTrace></ProcessAccess><ProcessAccess onmatch=\"exclude\"><CallTrace condition=\"excludes\">UNKNOWN</CallTrace></ProcessAccess>'\ndetection:\n    selection:\n        EventID: 10\n        TargetImage: '*\\verclsid.exe'\n        GrantedAccess: '0x1FFFFF'\n    combination1:\n        CallTrace: '*|UNKNOWN(*VBE7.DLL*'\n    combination2:\n        SourceImage: '*\\Microsoft Office\\\\*'\n        CallTrace: '*|UNKNOWN*'\n    condition: selection and 1 of combination*\nfalsepositives:\n    - unknown\nlevel: high\n\n\n", "object_marking_refs": ["marking-definition--0a872d70-1d05-45dd-a25f-031af547a102"], "created_by_ref": "identity--082ca4f0-d825-45b6-aa42-ab9afd1e5503", "type": "indicator", "spec_version": "2.1", "id": "indicator--47174e7c-e070-4f84-8bb5-85e60d1218d7", "modified": "2020-04-02T07:59:00.579Z"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--0ba6869e-77cf-4c03-81ae-81f34df84b59", "created": "2020-04-02T07:59:00.591Z", "modified": "2020-04-02T07:59:00.591Z", "source_ref": "indicator--47174e7c-e070-4f84-8bb5-85e60d1218d7", "relationship_type": "indicates", "target_ref": "attack-pattern--43e7dc91-05b2-474c-b9ac-2ed4fe101f4d"}, {"name": "Suspicious In-Memory Module Execution", "description": "Detects the access to processes by other suspicious processes which have reflectively loaded libraries in their memory space. An example is SilentTrinity C2 behaviour. Generally speaking, when Sysmon EventID 10 cannot reference a stack call to a dll loaded from disk (the standard way), it will display \"UNKNOWN\" as the module name. Usually this means the stack call points to a module that was reflectively loaded in memory. Adding to this, it is not common to see such few calls in the stack (ntdll.dll --> kernelbase.dll --> unknown) which essentially means that most of the functions required by the process to execute certain routines are already present in memory, not requiring any calls to external libraries. The latter should also be considered suspicious.", "created": "2019-10-27T00:00:00.000Z", "valid_from": "2019-10-27T00:00:00Z", "indicator_types": ["malicious-activity"], "pattern_type": "sigma", "pattern": "title: Suspicious In-Memory Module Execution\nid: 5f113a8f-8b61-41ca-b90f-d374fa7e4a39\ndescription: Detects the access to processes by other suspicious processes which have reflectively loaded libraries in their memory space. An example is SilentTrinity\n    C2 behaviour. Generally speaking, when Sysmon EventID 10 cannot reference a stack call to a dll loaded from disk (the standard way), it will display \"UNKNOWN\"\n    as the module name. Usually this means the stack call points to a module that was reflectively loaded in memory. Adding to this, it is not common to see such\n    few calls in the stack (ntdll.dll --> kernelbase.dll --> unknown) which essentially means that most of the functions required by the process to execute certain\n    routines are already present in memory, not requiring any calls to external libraries. The latter should also be considered suspicious.\nstatus: experimental\ndate: 2019/10/27\nauthor: Perez Diego (@darkquassar), oscd.community\nreferences:\n    - https://azure.microsoft.com/en-ca/blog/detecting-in-memory-attacks-with-sysmon-and-azure-security-center/\ntags:\n    - attack.privilege_escalation\n    - attack.t1055\nlogsource:\n    product: windows\n    service: sysmon\ndetection:\n    selection_01: \n        EventID: 10\n        CallTrace: \n            - \"C:\\\\Windows\\\\SYSTEM32\\\\ntdll.dll+*|C:\\\\Windows\\\\System32\\\\KERNELBASE.dll+*|UNKNOWN(*)\"\n            - \"*UNKNOWN(*)|UNKNOWN(*)\"\n    selection_02: \n        EventID: 10\n        CallTrace: \"*UNKNOWN*\"\n    granted_access:\n        GrantedAccess:\n            - \"0x1F0FFF\"\n            - \"0x1F1FFF\"\n            - \"0x143A\"\n            - \"0x1410\"\n            - \"0x1010\"\n            - \"0x1F2FFF\"\n            - \"0x1F3FFF\"\n            - \"0x1FFFFF\"\n    condition: selection_01 OR (selection_02 AND granted_access)\nfields:\n    - ComputerName\n    - User\n    - SourceImage\n    - TargetImage\n    - CallTrace\nlevel: critical\nfalsepositives:\n    - Low\n", "object_marking_refs": ["marking-definition--0a872d70-1d05-45dd-a25f-031af547a102"], "created_by_ref": "identity--082ca4f0-d825-45b6-aa42-ab9afd1e5503", "type": "indicator", "spec_version": "2.1", "id": "indicator--64b0d998-64cb-419b-9f0a-248e3391ace6", "modified": "2020-04-02T07:59:00.597Z"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--e66b875e-7021-471f-9f60-3e179a5b4a8a", "created": "2020-04-02T07:59:00.610Z", "modified": "2020-04-02T07:59:00.610Z", "source_ref": "indicator--64b0d998-64cb-419b-9f0a-248e3391ace6", "relationship_type": "indicates", "target_ref": "attack-pattern--43e7dc91-05b2-474c-b9ac-2ed4fe101f4d"}, {"name": "PowerShell Rundll32 Remote Thread Creation", "description": "Detects PowerShell remote thread creation in Rundll32.exe", "created": "2018-06-25T00:00:00.000Z", "valid_from": "2018-06-25T00:00:00Z", "indicator_types": ["malicious-activity"], "pattern_type": "sigma", "pattern": "title: PowerShell Rundll32 Remote Thread Creation\nid: 99b97608-3e21-4bfe-8217-2a127c396a0e\nstatus: experimental\ndescription: Detects PowerShell remote thread creation in Rundll32.exe\nauthor: Florian Roth\nreferences:\n    - https://www.fireeye.com/blog/threat-research/2018/06/bring-your-own-land-novel-red-teaming-technique.html\ndate: 2018/06/25\nlogsource:\n    product: windows\n    service: sysmon\ndetection:\n    selection:\n        EventID: 8\n        SourceImage: '*\\powershell.exe'\n        TargetImage: '*\\rundll32.exe'\n    condition: selection\ntags:\n    - attack.defense_evasion\n    - attack.execution\n    - attack.t1085\n    - attack.t1086\nfalsepositives:\n    - Unkown\nlevel: high\n", "object_marking_refs": ["marking-definition--0a872d70-1d05-45dd-a25f-031af547a102"], "created_by_ref": "identity--082ca4f0-d825-45b6-aa42-ab9afd1e5503", "type": "indicator", "spec_version": "2.1", "id": "indicator--eb20cf75-0ec3-445b-acc2-14367cc389df", "modified": "2020-04-02T07:59:00.614Z"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--46d0b7db-6c24-4e10-a33e-1288e48c266e", "created": "2020-04-02T07:59:00.627Z", "modified": "2020-04-02T07:59:00.627Z", "source_ref": "indicator--eb20cf75-0ec3-445b-acc2-14367cc389df", "relationship_type": "indicates", "target_ref": "attack-pattern--62b8c999-dcc0-4755-bd69-09442d9359f5"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--0f714080-14de-4d8c-b423-4de4df1a3d6a", "created": "2020-04-02T07:59:00.638Z", "modified": "2020-04-02T07:59:00.638Z", "source_ref": "indicator--eb20cf75-0ec3-445b-acc2-14367cc389df", "relationship_type": "indicates", "target_ref": "attack-pattern--f4882e23-8aa7-4b12-b28a-b349c12ee9e0"}, {"name": "Mimikatz In-Memory", "description": "Detects certain DLL loads when Mimikatz gets executed", "created": "2017-03-13T00:00:00.000Z", "valid_from": "2017-03-13T00:00:00Z", "indicator_types": ["malicious-activity"], "pattern_type": "sigma", "pattern": "title: Mimikatz In-Memory\nid: c0478ead-5336-46c2-bd5e-b4c84bc3a36e\nstatus: experimental\ndescription: Detects certain DLL loads when Mimikatz gets executed\nreferences:\n    - https://securityriskadvisors.com/blog/post/detecting-in-memory-mimikatz/\ntags:\n    - attack.s0002\n    - attack.t1003\n    - attack.lateral_movement\n    - attack.credential_access\n    - car.2019-04-004\nlogsource:\n    product: windows\n    service: sysmon\ndate: 2017/03/13\ndetection:\n    selector:\n        EventID: 7\n        Image: 'C:\\Windows\\System32\\rundll32.exe'\n    dllload1:\n        ImageLoaded: '*\\vaultcli.dll'\n    dllload2:\n        ImageLoaded: '*\\wlanapi.dll'\n    exclusion:\n        ImageLoaded:\n            - 'ntdsapi.dll'\n            - 'netapi32.dll'\n            - 'imm32.dll'\n            - 'samlib.dll'\n            - 'combase.dll'\n            - 'srvcli.dll'\n            - 'shcore.dll'\n            - 'ntasn1.dll'\n            - 'cryptdll.dll'\n            - 'logoncli.dll'\n    timeframe: 30s\n    condition: selector | near dllload1 and dllload2 and not exclusion\nfalsepositives:\n    - unknown\nlevel: medium\n", "object_marking_refs": ["marking-definition--0a872d70-1d05-45dd-a25f-031af547a102"], "created_by_ref": "identity--082ca4f0-d825-45b6-aa42-ab9afd1e5503", "type": "indicator", "spec_version": "2.1", "id": "indicator--3039b3a4-9225-45a0-98db-591d59eff781", "modified": "2020-04-02T07:59:00.642Z"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--8f562d26-ae89-45ff-a455-1c32096e3822", "created": "2020-04-02T07:59:00.653Z", "modified": "2020-04-02T07:59:00.653Z", "source_ref": "indicator--3039b3a4-9225-45a0-98db-591d59eff781", "relationship_type": "indicates", "target_ref": "tool--afc079f3-c0ea-4096-b75d-3f05338b7f60"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--d67a8ad7-8bcc-4e46-ade2-94b06f0c15c1", "created": "2020-04-02T07:59:00.662Z", "modified": "2020-04-02T07:59:00.662Z", "source_ref": "indicator--3039b3a4-9225-45a0-98db-591d59eff781", "relationship_type": "indicates", "target_ref": "attack-pattern--0a3ead4e-6d47-4ccb-854c-a6a4f9d96b22"}, {"name": "Renamed jusched.exe", "description": "Detects renamed jusched.exe used by cobalt group", "created": "2019-06-04T00:00:00.000Z", "valid_from": "2019-06-04T00:00:00Z", "indicator_types": ["malicious-activity"], "pattern_type": "sigma", "pattern": "title: Renamed jusched.exe \nstatus: experimental\nid: edd8a48c-1b9f-4ba1-83aa-490338cd1ccb\ndescription: Detects renamed jusched.exe used by cobalt group \nreferences:\n    - https://www.bitdefender.com/files/News/CaseStudies/study/262/Bitdefender-WhitePaper-An-APT-Blueprint-Gaining-New-Visibility-into-Financial-Threats-interactive.pdf\ntags:\n    - attack.t1036 \n    - attack.execution\nauthor: Markus Neis, Swisscom\ndate: 2019/06/04\nlogsource:\n    category: process_creation\n    product: windows\ndetection:\n    selection1:\n        Description: Java Update Scheduler\n    selection2:\n        Description: Java(TM) Update Scheduler\n    filter:\n        Image|endswith:\n            - '\\jusched.exe'\n    condition: (selection1 or selection2) and not filter\nfalsepositives:\n    - penetration tests, red teaming\nlevel: high\n", "object_marking_refs": ["marking-definition--0a872d70-1d05-45dd-a25f-031af547a102"], "created_by_ref": "identity--082ca4f0-d825-45b6-aa42-ab9afd1e5503", "type": "indicator", "spec_version": "2.1", "id": "indicator--97a60c9e-7908-47a8-8651-e3c839c5f7ac", "modified": "2020-04-02T07:59:00.666Z"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--efe9059e-c42e-4606-ab14-e7709f1b1fdf", "created": "2020-04-02T07:59:00.677Z", "modified": "2020-04-02T07:59:00.677Z", "source_ref": "indicator--97a60c9e-7908-47a8-8651-e3c839c5f7ac", "relationship_type": "indicates", "target_ref": "attack-pattern--42e8de7b-37b2-4258-905a-6897815e58e0"}, {"name": "Active Directory Kerberos DLL Loaded Via Office Applications", "description": "Detects Kerberos DLL being loaded by an Office Product", "created": "2020-02-19T00:00:00.000Z", "valid_from": "2020-02-19T00:00:00Z", "indicator_types": ["malicious-activity"], "pattern_type": "sigma", "pattern": "title: Active Directory Kerberos DLL Loaded Via Office Applications\nid: 7417e29e-c2e7-4cf6-a2e8-767228c64837\nstatus: experimental\ndescription: Detects Kerberos DLL being loaded by an Office Product\nreferences:\n    - https://medium.com/threatpunter/detecting-adversary-tradecraft-with-image-load-event-logging-and-eql-8de93338c16\nauthor: Antonlovesdnb\ndate: 2020/02/19\ntags:\n    - attack.initial_access\n    - attack.t1193\nlogsource:\n    product: windows\n    service: sysmon\ndetection:\n    selection:\n        EventID: 7\n        Image:\n            - '*\\winword.exe*'\n            - '*\\powerpnt.exe*'\n            - '*\\excel.exe*'\n            - '*\\outlook.exe*'\n        ImageLoaded:\n            - '*\\kerberos.dll*'\n    condition: selection\nfalsepositives:\n    - Alerts on legitimate macro usage as well, will need to filter as appropriate\nlevel: high\n", "object_marking_refs": ["marking-definition--0a872d70-1d05-45dd-a25f-031af547a102"], "created_by_ref": "identity--082ca4f0-d825-45b6-aa42-ab9afd1e5503", "type": "indicator", "spec_version": "2.1", "id": "indicator--a23412e5-0563-4883-a72a-c282d2210364", "modified": "2020-04-02T07:59:00.680Z"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--d39c14ec-e38d-49c5-be6c-cfd4456fa562", "created": "2020-04-02T07:59:00.691Z", "modified": "2020-04-02T07:59:00.691Z", "source_ref": "indicator--a23412e5-0563-4883-a72a-c282d2210364", "relationship_type": "indicates", "target_ref": "attack-pattern--6aac77c4-eaf2-4366-8c13-ce50ab951f38"}, {"name": "Detection of SafetyKatz", "description": "Detects possible SafetyKatz Behaviour", "created": "2018-07-24T00:00:00.000Z", "valid_from": "2018-07-24T00:00:00Z", "indicator_types": ["malicious-activity"], "pattern_type": "sigma", "pattern": "title: Detection of SafetyKatz\nid: e074832a-eada-4fd7-94a1-10642b130e16\nstatus: experimental\ndescription: Detects possible SafetyKatz Behaviour\nreferences:\n    - https://github.com/GhostPack/SafetyKatz\ntags:\n    - attack.credential_access\n    - attack.t1003\nauthor: Markus Neis\ndate: 2018/07/24\nlogsource:\n    product: windows\n    service: sysmon\ndetection:\n    selection:\n        EventID: 11\n        TargetFilename: '*\\Temp\\debug.bin'\n    condition: selection\nfalsepositives:\n    - Unknown\nlevel: high\n", "object_marking_refs": ["marking-definition--0a872d70-1d05-45dd-a25f-031af547a102"], "created_by_ref": "identity--082ca4f0-d825-45b6-aa42-ab9afd1e5503", "type": "indicator", "spec_version": "2.1", "id": "indicator--3046d0e7-a87c-41d5-9a86-20f59d2a6a42", "modified": "2020-04-02T07:59:00.694Z"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--4b1ad444-dd96-4795-a559-a5a6de160ec7", "created": "2020-04-02T07:59:00.708Z", "modified": "2020-04-02T07:59:00.708Z", "source_ref": "indicator--3046d0e7-a87c-41d5-9a86-20f59d2a6a42", "relationship_type": "indicates", "target_ref": "attack-pattern--0a3ead4e-6d47-4ccb-854c-a6a4f9d96b22"}, {"name": "New DLL Added to AppInit_DLLs Registry Key", "description": "DLLs that are specified in the AppInit_DLLs value in the Registry key HKLM\\Software\\Microsoft\\Windows NT\\CurrentVersion\\Windows are loaded by user32.dll into every process that loads user32.dll", "created": "2019-10-25T00:00:00.000Z", "modified": "2019-11-13T00:00:00.000Z", "valid_from": "2019-10-25T00:00:00Z", "indicator_types": ["malicious-activity"], "pattern_type": "sigma", "pattern": "title: New DLL Added to AppInit_DLLs Registry Key\nid: 4f84b697-c9ed-4420-8ab5-e09af5b2345d\nstatus: experimental\ndescription: DLLs that are specified in the AppInit_DLLs value in the Registry key HKLM\\Software\\Microsoft\\Windows NT\\CurrentVersion\\Windows are loaded by user32.dll\n    into every process that loads user32.dll\nreferences:\n    - https://eqllib.readthedocs.io/en/latest/analytics/822dc4c5-b355-4df8-bd37-29c458997b8f.html\ntags:\n    - attack.persistence\n    - attack.t1103\nauthor: Ilyas Ochkov, oscd.community\ndate: 2019/10/25\nmodified: 2019/11/13\nlogsource:\n    product: windows\n    service: sysmon\ndetection:\n    selection:\n      - EventID: \n            - 12 # key create\n            - 13 # value set\n        TargetObject:\n                - '*\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Windows\\AppInit_Dlls'\n                - '*\\SOFTWARE\\Wow6432Node\\Microsoft\\Windows NT\\CurrentVersion\\Windows\\AppInit_Dlls'\n      - EventID: 14 # key rename\n        NewName:\n                - '*\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Windows\\AppInit_Dlls'\n                - '*\\SOFTWARE\\Wow6432Node\\Microsoft\\Windows NT\\CurrentVersion\\Windows\\AppInit_Dlls'\n    condition: selection\nfields:\n    - EventID\n    - Image\n    - TargetObject\n    - NewName\nfalsepositives:\n    - Unkown\nlevel: medium\n", "object_marking_refs": ["marking-definition--0a872d70-1d05-45dd-a25f-031af547a102"], "created_by_ref": "identity--082ca4f0-d825-45b6-aa42-ab9afd1e5503", "type": "indicator", "spec_version": "2.1", "id": "indicator--8fb6ac0b-4a6d-45d3-9b4d-3e920a51dd7d"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--aa891a03-3dfd-4d72-b555-30716a05632b", "created": "2020-04-02T07:59:00.724Z", "modified": "2020-04-02T07:59:00.724Z", "source_ref": "indicator--8fb6ac0b-4a6d-45d3-9b4d-3e920a51dd7d", "relationship_type": "indicates", "target_ref": "attack-pattern--317fefa6-46c7-4062-adb6-2008cf6bcb41"}, {"name": "Alternate PowerShell Hosts Pipe", "description": "Detects alternate PowerShell hosts potentially bypassing detections looking for powershell.exe", "created": "2019-09-12T00:00:00.000Z", "modified": "2019-11-10T00:00:00.000Z", "valid_from": "2019-09-12T00:00:00Z", "indicator_types": ["malicious-activity"], "pattern_type": "sigma", "pattern": "title: Alternate PowerShell Hosts Pipe\nid: 58cb02d5-78ce-4692-b3e1-dce850aae41a\ndescription: Detects alternate PowerShell hosts potentially bypassing detections looking for powershell.exe\nstatus: experimental\ndate: 2019/09/12\nmodified: 2019/11/10\nauthor: Roberto Rodriguez @Cyb3rWard0g\nreferences:\n    - https://github.com/Cyb3rWard0g/ThreatHunter-Playbook/tree/master/playbooks/windows/02_execution/T1086_powershell/alternate_signed_powershell_hosts.md\ntags:\n    - attack.execution\n    - attack.t1086\nlogsource:\n    product: windows\n    service: sysmon\ndetection:\n    selection: \n        EventID: 17\n        PipeName|startswith: '\\PSHost'\n    filter:\n        Image|endswith: '\\powershell.exe'\n    condition: selection and not filter\nfields:\n    - ComputerName\n    - User\n    - Image\n    - PipeName\nfalsepositives:\n    - Programs using PowerShell directly without invocation of a dedicated interpreter.\nlevel: medium\n", "object_marking_refs": ["marking-definition--0a872d70-1d05-45dd-a25f-031af547a102"], "created_by_ref": "identity--082ca4f0-d825-45b6-aa42-ab9afd1e5503", "type": "indicator", "spec_version": "2.1", "id": "indicator--f9dca71d-5d85-49b9-917b-b4cf9152ec7d"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--28a7cd0c-a44d-4a15-b3b7-0b69b57b6224", "created": "2020-04-02T07:59:00.745Z", "modified": "2020-04-02T07:59:00.745Z", "source_ref": "indicator--f9dca71d-5d85-49b9-917b-b4cf9152ec7d", "relationship_type": "indicates", "target_ref": "attack-pattern--f4882e23-8aa7-4b12-b28a-b349c12ee9e0"}, {"name": "Renamed ProcDump", "description": "Detects the execution of a renamed ProcDump executable often used by attackers or malware", "created": "2019-11-18T00:00:00.000Z", "valid_from": "2019-11-18T00:00:00Z", "indicator_types": ["malicious-activity"], "pattern_type": "sigma", "pattern": "title: Renamed ProcDump\nid: 4a0b2c7e-7cb2-495d-8b63-5f268e7bfd67\nstatus: experimental\ndescription: Detects the execution of a renamed ProcDump executable often used by attackers or malware\nreferences:\n    - https://docs.microsoft.com/en-us/sysinternals/downloads/procdump\nauthor: Florian Roth\ndate: 2019/11/18\ntags:\n    - attack.defense_evasion\n    - attack.t1036\nlogsource:\n    product: windows\n    service: sysmon\ndetection:\n    selection:\n        OriginalFileName: 'procdump'\n    filter:\n        Image: \n            - '*\\procdump.exe'\n            - '*\\procdump64.exe'\n    condition: selection and not filter\nfalsepositives:\n    - Procdump illegaly bundled with legitimate software\n    - Weird admins who renamed binaries\nlevel: critical\n", "object_marking_refs": ["marking-definition--0a872d70-1d05-45dd-a25f-031af547a102"], "created_by_ref": "identity--082ca4f0-d825-45b6-aa42-ab9afd1e5503", "type": "indicator", "spec_version": "2.1", "id": "indicator--56b3f11d-d86e-4b6e-9c30-9202ce593bf5", "modified": "2020-04-02T07:59:00.749Z"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--b9e6666d-b327-42c5-baa5-719b3e76a3ba", "created": "2020-04-02T07:59:00.763Z", "modified": "2020-04-02T07:59:00.763Z", "source_ref": "indicator--56b3f11d-d86e-4b6e-9c30-9202ce593bf5", "relationship_type": "indicates", "target_ref": "attack-pattern--42e8de7b-37b2-4258-905a-6897815e58e0"}, {"name": "Windows Credential Editor", "description": "Detects the use of Windows Credential Editor (WCE)", "created": "2019-12-31T00:00:00.000Z", "valid_from": "2019-12-31T00:00:00Z", "indicator_types": ["malicious-activity"], "pattern_type": "sigma", "pattern": "action: global\ntitle: Windows Credential Editor\nid: 7aa7009a-28b9-4344-8c1f-159489a390df\ndescription: Detects the use of Windows Credential Editor (WCE)\nauthor: Florian Roth\nreferences:\n    - https://www.ampliasecurity.com/research/windows-credentials-editor/\ndate: 2019/12/31\ntags:\n    - attack.credential_access\n    - attack.t1003\n    - attack.s0005\nfalsepositives:\n    - 'Another service that uses a single -s command line switch'\nlevel: critical\n", "object_marking_refs": ["marking-definition--0a872d70-1d05-45dd-a25f-031af547a102"], "created_by_ref": "identity--082ca4f0-d825-45b6-aa42-ab9afd1e5503", "type": "indicator", "spec_version": "2.1", "id": "indicator--d38a619e-6c01-438e-a688-cdbb34497dd7", "modified": "2020-04-02T07:59:00.765Z"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--3b00bfdc-3449-4210-87e3-4fbcbfcb3016", "created": "2020-04-02T07:59:00.776Z", "modified": "2020-04-02T07:59:00.776Z", "source_ref": "indicator--d38a619e-6c01-438e-a688-cdbb34497dd7", "relationship_type": "indicates", "target_ref": "attack-pattern--0a3ead4e-6d47-4ccb-854c-a6a4f9d96b22"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--f3bf816b-23eb-450e-a6a6-23a1a80d653d", "created": "2020-04-02T07:59:00.784Z", "modified": "2020-04-02T07:59:00.784Z", "source_ref": "indicator--d38a619e-6c01-438e-a688-cdbb34497dd7", "relationship_type": "indicates", "target_ref": "tool--242f3da3-4425-4d11-8f5c-b842886da966"}, {"name": "Suspicious Scripting in a WMI Consumer", "description": "Detects suspicious scripting in WMI Event Consumers", "created": "2019-04-15T00:00:00.000Z", "valid_from": "2019-04-15T00:00:00Z", "indicator_types": ["malicious-activity"], "pattern_type": "sigma", "pattern": "title: Suspicious Scripting in a WMI Consumer\nid: fe21810c-2a8c-478f-8dd3-5a287fb2a0e0\nstatus: experimental\ndescription: Detects suspicious scripting in WMI Event Consumers\nauthor: Florian Roth\nreferences:\n    - https://in.security/an-intro-into-abusing-and-identifying-wmi-event-subscriptions-for-persistence/\n    - https://github.com/Neo23x0/signature-base/blob/master/yara/gen_susp_lnk_files.yar#L19\ndate: 2019/04/15\ntags:\n    - attack.t1086\n    - attack.execution\nlogsource:\n   product: windows\n   service: sysmon\ndetection:\n    selection:\n        EventID: 20\n        Destination:\n            - '*new-object system.net.webclient).downloadstring(*'\n            - '*new-object system.net.webclient).downloadfile(*'\n            - '*new-object net.webclient).downloadstring(*'\n            - '*new-object net.webclient).downloadfile(*'\n            - '* iex(*'\n            - '*WScript.shell*'\n            - '* -nop *'\n            - '* -noprofile *'\n            - '* -decode *'\n            - '* -enc *'\n    condition: selection\nfields:\n    - CommandLine\n    - ParentCommandLine\nfalsepositives:\n    - Administrative scripts\nlevel: high\n", "object_marking_refs": ["marking-definition--0a872d70-1d05-45dd-a25f-031af547a102"], "created_by_ref": "identity--082ca4f0-d825-45b6-aa42-ab9afd1e5503", "type": "indicator", "spec_version": "2.1", "id": "indicator--383cfcf2-230a-4c06-8603-eaee6198f8d8", "modified": "2020-04-02T07:59:00.796Z"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--bd331946-cfb5-41bc-a6cf-98b93ac1b898", "created": "2020-04-02T07:59:00.807Z", "modified": "2020-04-02T07:59:00.807Z", "source_ref": "indicator--383cfcf2-230a-4c06-8603-eaee6198f8d8", "relationship_type": "indicates", "target_ref": "attack-pattern--f4882e23-8aa7-4b12-b28a-b349c12ee9e0"}, {"name": "Suspect Svchost Memory Asccess", "description": "Detects suspect access to svchost process memory such as that used by Invoke-Phantom to kill the winRM windows event logging service.", "created": "2020-01-02T00:00:00.000Z", "valid_from": "2020-01-02T00:00:00Z", "indicator_types": ["malicious-activity"], "pattern_type": "sigma", "pattern": "title: Suspect Svchost Memory Asccess\nid: 166e9c50-8cd9-44af-815d-d1f0c0e90dde\nstatus: experimental\ndescription: Detects suspect access to svchost process memory such as that used by Invoke-Phantom to kill the winRM windows event logging service.\nauthor: Tim Burrell\ndate: 2020/01/02\nreferences:\n    - https://github.com/hlldz/Invoke-Phant0m\n    - https://twitter.com/timbmsft/status/900724491076214784\ntags:\n    - attack.t1089\n    - attack.defense_evasion\nlogsource:\n    product: windows\n    service: sysmon\ndetection:\n    selection:\n        EventID: 10\n        TargetImage: '*\\windows\\system32\\svchost.exe'\n        GrantedAccess: '0x1f3fff'\n        CallTrace:\n         - '*unknown*'\n    condition: selection\nfalsepositives:\n    - unknown\nlevel: high\n", "object_marking_refs": ["marking-definition--0a872d70-1d05-45dd-a25f-031af547a102"], "created_by_ref": "identity--082ca4f0-d825-45b6-aa42-ab9afd1e5503", "type": "indicator", "spec_version": "2.1", "id": "indicator--0991b4ba-9cd2-4c99-938c-757b2159b00a", "modified": "2020-04-02T07:59:00.811Z"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--3ec760da-4b57-410b-93e7-86053825ab8d", "created": "2020-04-02T07:59:00.822Z", "modified": "2020-04-02T07:59:00.822Z", "source_ref": "indicator--0991b4ba-9cd2-4c99-938c-757b2159b00a", "relationship_type": "indicates", "target_ref": "attack-pattern--2e0dd10b-676d-4964-acd0-8a404c92b044"}, {"name": "CLR DLL Loaded Via Office Applications", "description": "Detects CLR DLL being loaded by an Office Product", "created": "2020-02-19T00:00:00.000Z", "valid_from": "2020-02-19T00:00:00Z", "indicator_types": ["malicious-activity"], "pattern_type": "sigma", "pattern": "title: CLR DLL Loaded Via Office Applications\nid: d13c43f0-f66b-4279-8b2c-5912077c1780\nstatus: experimental\ndescription: Detects CLR DLL being loaded by an Office Product\nreferences:\n    - https://medium.com/threatpunter/detecting-adversary-tradecraft-with-image-load-event-logging-and-eql-8de93338c16\nauthor: Antonlovesdnb\ndate: 2020/02/19\ntags:\n    - attack.initial_access\n    - attack.t1193\nlogsource:\n    product: windows\n    service: sysmon\ndetection:\n    selection:\n        EventID: 7\n        Image:\n            - '*\\winword.exe'\n            - '*\\powerpnt.exe'\n            - '*\\excel.exe'\n            - '*\\outlook.exe'\n        ImageLoaded:\n            - '*\\clr.dll*'\n    condition: selection\nfalsepositives:\n    - Alerts on legitimate macro usage as well, will need to filter as appropriate\nlevel: high\n", "object_marking_refs": ["marking-definition--0a872d70-1d05-45dd-a25f-031af547a102"], "created_by_ref": "identity--082ca4f0-d825-45b6-aa42-ab9afd1e5503", "type": "indicator", "spec_version": "2.1", "id": "indicator--c13d8e8a-6c16-4921-a93e-7457feffeb5f", "modified": "2020-04-02T07:59:00.826Z"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--1b9a2ddd-7695-4e7c-8464-fcf039252319", "created": "2020-04-02T07:59:00.837Z", "modified": "2020-04-02T07:59:00.837Z", "source_ref": "indicator--c13d8e8a-6c16-4921-a93e-7457feffeb5f", "relationship_type": "indicates", "target_ref": "attack-pattern--6aac77c4-eaf2-4366-8c13-ce50ab951f38"}, {"name": "Registry Persistence Mechanisms", "description": "Detects persistence registry keys", "created": "2018-04-11T00:00:00.000Z", "valid_from": "2018-04-11T00:00:00Z", "indicator_types": ["malicious-activity"], "pattern_type": "sigma", "pattern": "title: Registry Persistence Mechanisms\nid: 36803969-5421-41ec-b92f-8500f79c23b0\ndescription: Detects persistence registry keys\nreferences:\n    - https://oddvar.moe/2018/04/10/persistence-using-globalflags-in-image-file-execution-options-hidden-from-autoruns-exe/\ndate: 2018/04/11\nauthor: Karneades\nlogsource:\n    product: windows\n    service: sysmon\ndetection:\n    selection_reg1:\n        EventID: 13\n        TargetObject:\n            - '*\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Image File Execution Options\\\\*\\GlobalFlag'\n            - '*\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\SilentProcessExit\\\\*\\ReportingMode'\n            - '*\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\SilentProcessExit\\\\*\\MonitorProcess'\n        EventType: SetValue\n    condition: selection_reg1\ntags:\n    - attack.privilege_escalation\n    - attack.persistence\n    - attack.defense_evasion\n    - attack.t1183\n    - car.2013-01-002\nfalsepositives:\n    - unknown\nlevel: critical\n", "object_marking_refs": ["marking-definition--0a872d70-1d05-45dd-a25f-031af547a102"], "created_by_ref": "identity--082ca4f0-d825-45b6-aa42-ab9afd1e5503", "type": "indicator", "spec_version": "2.1", "id": "indicator--ef4e5d94-8541-4f0a-84d9-232b4494a3ab", "modified": "2020-04-02T07:59:00.841Z"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--0bb44186-e1c5-4b4c-a4da-fed45d1511e0", "created": "2020-04-02T07:59:00.850Z", "modified": "2020-04-02T07:59:00.850Z", "source_ref": "indicator--ef4e5d94-8541-4f0a-84d9-232b4494a3ab", "relationship_type": "indicates", "target_ref": "attack-pattern--62166220-e498-410f-a90a-19d4339d4e99"}, {"name": "Possible DNS Rebinding", "description": "Detects several different DNS-answers by one domain with IPs from internal and external networks. Normally, DNS-answer contain TTL >100. (DNS-record will saved in host cache for a while TTL).", "created": "2019-10-25T00:00:00.000Z", "modified": "2019-11-13T00:00:00.000Z", "valid_from": "2019-10-25T00:00:00Z", "indicator_types": ["malicious-activity"], "pattern_type": "sigma", "pattern": "title: Possible DNS Rebinding\nid: eb07e747-2552-44cd-af36-b659ae0958e4\nstatus: experimental\ndescription: Detects several different DNS-answers by one domain with IPs from internal and external networks. Normally, DNS-answer contain TTL >100. (DNS-record\n    will saved in host cache for a while TTL).\ndate: 2019/10/25\nmodified: 2019/11/13\nauthor: Ilyas Ochkov, oscd.community\nreferences:\n    - https://medium.com/@brannondorsey/attacking-private-networks-from-the-internet-with-dns-rebinding-ea7098a2d325\ntags:\n    - attack.command_and_control\n    - attack.t1043\nlogsource:\n    product: windows\n    service: sysmon\ndetection:\n    dns_answer:\n        EventID: 22\n        QueryName: '*'\n        QueryStatus: '0' \n    filter_int_ip:\n        QueryResults|startswith: \n            - '(::ffff:)?10.'\n            - '(::ffff:)?192.168.'\n            - '(::ffff:)?172.16.'\n            - '(::ffff:)?172.17.'\n            - '(::ffff:)?172.18.'\n            - '(::ffff:)?172.19.'\n            - '(::ffff:)?172.20.'\n            - '(::ffff:)?172.21.'\n            - '(::ffff:)?172.22.'\n            - '(::ffff:)?172.23.'\n            - '(::ffff:)?172.24.'\n            - '(::ffff:)?172.25.'\n            - '(::ffff:)?172.26.'\n            - '(::ffff:)?172.27.'\n            - '(::ffff:)?172.28.'\n            - '(::ffff:)?172.29.'\n            - '(::ffff:)?172.30.'\n            - '(::ffff:)?172.31.'\n            - '(::ffff:)?127.'        \n    timeframe: 30s\n    condition: (dns_answer and filter_int_ip) and (dns_answer and not filter_int_ip) | count(QueryName) by ComputerName > 3\nlevel: medium\n", "object_marking_refs": ["marking-definition--0a872d70-1d05-45dd-a25f-031af547a102"], "created_by_ref": "identity--082ca4f0-d825-45b6-aa42-ab9afd1e5503", "type": "indicator", "spec_version": "2.1", "id": "indicator--9704ad2f-2aaf-4c06-a093-c7ebd3fb2197"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--324bd368-dc1b-4ab6-8a37-9bad746e1613", "created": "2020-04-02T07:59:00.866Z", "modified": "2020-04-02T07:59:00.866Z", "source_ref": "indicator--9704ad2f-2aaf-4c06-a093-c7ebd3fb2197", "relationship_type": "indicates", "target_ref": "attack-pattern--f879d51c-5476-431c-aedf-f14d207e4d1e"}, {"name": "PowerShell Network Connections", "description": "Detects a Powershell process that opens network connections - check for suspicious target ports and target systems - adjust to your environment (e.g. extend filters with company's ip range')", "created": "2017-03-13T00:00:00.000Z", "valid_from": "2017-03-13T00:00:00Z", "indicator_types": ["malicious-activity"], "pattern_type": "sigma", "pattern": "title: PowerShell Network Connections\nid: 1f21ec3f-810d-4b0e-8045-322202e22b4b\nstatus: experimental\ndescription: Detects a Powershell process that opens network connections - check for suspicious target ports and target systems - adjust to your environment (e.g.\n    extend filters with company's ip range')\nauthor: Florian Roth\ndate: 2017/03/13\nreferences:\n    - https://www.youtube.com/watch?v=DLtJTxMWZ2o\ntags:\n    - attack.execution\n    - attack.t1086\nlogsource:\n    product: windows\n    service: sysmon\ndetection:\n    selection:\n        EventID: 3\n        Image: '*\\powershell.exe'\n        Initiated: 'true'\n    filter:\n        DestinationIp:\n            - '10.*'\n            - '192.168.*'\n            - '172.16.*'\n            - '172.17.*'\n            - '172.18.*'\n            - '172.19.*'\n            - '172.20.*'\n            - '172.21.*'\n            - '172.22.*'\n            - '172.23.*'\n            - '172.24.*'\n            - '172.25.*'\n            - '172.26.*'\n            - '172.27.*'\n            - '172.28.*'\n            - '172.29.*'\n            - '172.30.*'\n            - '172.31.*'\n            - '127.0.0.1'\n        DestinationIsIpv6: 'false'\n        User: 'NT AUTHORITY\\SYSTEM'\n    condition: selection and not filter\nfalsepositives:\n    - Administrative scripts\nlevel: low\n", "object_marking_refs": ["marking-definition--0a872d70-1d05-45dd-a25f-031af547a102"], "created_by_ref": "identity--082ca4f0-d825-45b6-aa42-ab9afd1e5503", "type": "indicator", "spec_version": "2.1", "id": "indicator--197e3919-455a-44fd-86a8-ce0dc144e71b", "modified": "2020-04-02T07:59:00.872Z"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--e0c2997f-1cde-4c09-806a-b99723773d3c", "created": "2020-04-02T07:59:00.882Z", "modified": "2020-04-02T07:59:00.882Z", "source_ref": "indicator--197e3919-455a-44fd-86a8-ce0dc144e71b", "relationship_type": "indicates", "target_ref": "attack-pattern--f4882e23-8aa7-4b12-b28a-b349c12ee9e0"}, {"name": "CobaltStrike Process Injection", "description": "Detects a possible remote threat creation with certain characteristics which are typical for Cobalt Strike beacons", "created": "2018-11-30T00:00:00.000Z", "modified": "2019-11-08T00:00:00.000Z", "valid_from": "2018-11-30T00:00:00Z", "indicator_types": ["malicious-activity"], "pattern_type": "sigma", "pattern": "title: CobaltStrike Process Injection\nid: 6309645e-122d-4c5b-bb2b-22e4f9c2fa42\ndescription: Detects a possible remote threat creation with certain characteristics which are typical for Cobalt Strike beacons\nreferences:\n    - https://medium.com/@olafhartong/cobalt-strike-remote-threads-detection-206372d11d0f\n    - https://blog.cobaltstrike.com/2018/04/09/cobalt-strike-3-11-the-snake-that-eats-its-tail/\ntags:\n    - attack.defense_evasion\n    - attack.t1055\nstatus: experimental\nauthor: Olaf Hartong, Florian Roth, Aleksey Potapov, oscd.community\ndate: 2018/11/30\nmodified: 2019/11/08\nlogsource:\n    product: windows\n    service: sysmon\ndetection:\n    selection:\n        EventID: 8\n        TargetProcessAddress|endswith: \n            - '0B80'\n            - '0C7C'\n            - '0C88'\n    condition: selection\nfalsepositives:\n    - unknown\nlevel: high\n\n", "object_marking_refs": ["marking-definition--0a872d70-1d05-45dd-a25f-031af547a102"], "created_by_ref": "identity--082ca4f0-d825-45b6-aa42-ab9afd1e5503", "type": "indicator", "spec_version": "2.1", "id": "indicator--6c4f7ec4-a18d-4758-8deb-74bc0fea44cc"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--d0f2918b-35fc-4dea-8bbb-05c549beb865", "created": "2020-04-02T07:59:00.900Z", "modified": "2020-04-02T07:59:00.900Z", "source_ref": "indicator--6c4f7ec4-a18d-4758-8deb-74bc0fea44cc", "relationship_type": "indicates", "target_ref": "attack-pattern--43e7dc91-05b2-474c-b9ac-2ed4fe101f4d"}, {"name": "Renamed PsExec", "description": "Detects the execution of a renamed PsExec often used by attackers or malware", "created": "2019-05-21T00:00:00.000Z", "valid_from": "2019-05-21T00:00:00Z", "indicator_types": ["malicious-activity"], "pattern_type": "sigma", "pattern": "title: Renamed PsExec\nid: a7a7e0e5-1d57-49df-9c58-9fe5bc0346a2\nstatus: experimental\ndescription: Detects the execution of a renamed PsExec often used by attackers or malware\nreferences:\n    - https://www.trendmicro.com/vinfo/hk-en/security/news/cybercrime-and-digital-threats/megacortex-ransomware-spotted-attacking-enterprise-networks\nauthor: Florian Roth\ndate: 2019/05/21\ntags:\n    - car.2013-05-009\nlogsource:\n    product: windows\n    service: sysmon\ndetection:\n    selection:\n        Description: 'Execute processes remotely'\n        Product: 'Sysinternals PsExec'\n    filter:\n        Image:\n           - '*\\PsExec.exe'\n           - '*\\PsExec64.exe'\n    condition: selection and not filter\nfalsepositives:\n    - Software that illegaly integrates PsExec in a renamed form\n    - Administrators that have renamed PsExec and no one knows why\nlevel: high\n", "object_marking_refs": ["marking-definition--0a872d70-1d05-45dd-a25f-031af547a102"], "created_by_ref": "identity--082ca4f0-d825-45b6-aa42-ab9afd1e5503", "type": "indicator", "spec_version": "2.1", "id": "indicator--64f8dbe4-48ea-4164-8ef5-8c728f003783", "modified": "2020-04-02T07:59:00.905Z"}, {"name": "OceanLotus Registry Activity", "description": "Detects registry keys created in OceanLotus (also known as APT32) attacks", "created": "2019-04-14T00:00:00.000Z", "valid_from": "2019-04-14T00:00:00Z", "indicator_types": ["malicious-activity"], "pattern_type": "sigma", "pattern": "title: OceanLotus Registry Activity\nid: 4ac5fc44-a601-4c06-955b-309df8c4e9d4\nstatus: experimental\ndescription: Detects registry keys created in OceanLotus (also known as APT32) attacks\nreferences:\n    - https://www.welivesecurity.com/2019/03/20/fake-or-fake-keeping-up-with-oceanlotus-decoys/\ntags:\n    - attack.t1112\nauthor: megan201296\ndate: 2019/04/14\nlogsource:\n    product: windows\n    service: sysmon\ndetection:\n    selection:\n        EventID: 13\n        TargetObject: \n            - 'HKCR\\CLSID\\{E08A0F4B-1F65-4D4D-9A09-BD4625B9C5A1}\\Model'\n            - 'HKU\\\\*_Classes\\CLSID\\{E08A0F4B-1F65-4D4D-9A09-BD4625B9C5A1}\\Model'\n              # covers HKU\\* and HKLM..\n            - '*\\SOFTWARE\\App\\AppXbf13d4ea2945444d8b13e2121cb6b663\\Application'\n            - '*\\SOFTWARE\\App\\AppXbf13d4ea2945444d8b13e2121cb6b663\\DefaultIcon'\n            - '*\\SOFTWARE\\App\\AppX70162486c7554f7f80f481985d67586d\\Application'\n            - '*\\SOFTWARE\\App\\AppX70162486c7554f7f80f481985d67586d\\DefaultIcon'\n            - '*\\SOFTWARE\\App\\AppX37cc7fdccd644b4f85f4b22d5a3f105a\\Application'\n            - '*\\SOFTWARE\\App\\AppX37cc7fdccd644b4f85f4b22d5a3f105a\\DefaultIcon'\n            # HKCU\\SOFTWARE\\Classes\\AppXc52346ec40fb4061ad96be0e6cb7d16a\\\n            - 'HKU\\\\*_Classes\\AppXc52346ec40fb4061ad96be0e6cb7d16a\\\\*'\n            # HKCU\\SOFTWARE\\Classes\\AppX3bbba44c6cae4d9695755183472171e2\\\n            - 'HKU\\\\*_Classes\\AppX3bbba44c6cae4d9695755183472171e2\\\\*'\n            # HKCU\\SOFTWARE\\Classes\\CLSID\\{E3517E26-8E93-458D-A6DF-8030BC80528B}\\\n            - 'HKU\\\\*_Classes\\CLSID\\{E3517E26-8E93-458D-A6DF-8030BC80528B}\\\\*'\n    condition: selection\nfalsepositives:\n    - Unknown\nlevel: critical\n", "object_marking_refs": ["marking-definition--0a872d70-1d05-45dd-a25f-031af547a102"], "created_by_ref": "identity--082ca4f0-d825-45b6-aa42-ab9afd1e5503", "type": "indicator", "spec_version": "2.1", "id": "indicator--eefb090e-ee8a-46d8-9723-6d9a43d7924c", "modified": "2020-04-02T07:59:00.910Z"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--3a28cff4-e52a-40ca-9080-9fa0623e5589", "created": "2020-04-02T07:59:00.922Z", "modified": "2020-04-02T07:59:00.922Z", "source_ref": "indicator--eefb090e-ee8a-46d8-9723-6d9a43d7924c", "relationship_type": "indicates", "target_ref": "attack-pattern--57340c81-c025-4189-8fa0-fc7ede51bae4"}, {"name": "Pandemic Registry Key", "description": "Detects Pandemic Windows Implant", "created": "2017-06-01T00:00:00.000Z", "valid_from": "2017-06-01T00:00:00Z", "indicator_types": ["malicious-activity"], "pattern_type": "sigma", "pattern": "action: global\ntitle: Pandemic Registry Key\nid: 47e0852a-cf81-4494-a8e6-31864f8c86ed\nstatus: experimental\ndescription: Detects Pandemic Windows Implant\nreferences:\n    - https://wikileaks.org/vault7/#Pandemic\n    - https://twitter.com/MalwareJake/status/870349480356454401\ntags:\n    - attack.lateral_movement\n    - attack.t1105\nauthor: Florian Roth\ndate: 2017/06/01\ndetection:\n    condition: 1 of them\nfields:\n    - EventID\n    - CommandLine\n    - ParentCommandLine\n    - Image\n    - User\n    - TargetObject\nfalsepositives:\n    - unknown\nlevel: critical\n", "object_marking_refs": ["marking-definition--0a872d70-1d05-45dd-a25f-031af547a102"], "created_by_ref": "identity--082ca4f0-d825-45b6-aa42-ab9afd1e5503", "type": "indicator", "spec_version": "2.1", "id": "indicator--bf1eb47c-3f56-4655-9e96-2b1de1c12fc3", "modified": "2020-04-02T07:59:00.926Z"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--c089a0dd-ed4a-4b12-9146-6840c40907eb", "created": "2020-04-02T07:59:00.938Z", "modified": "2020-04-02T07:59:00.938Z", "source_ref": "indicator--bf1eb47c-3f56-4655-9e96-2b1de1c12fc3", "relationship_type": "indicates", "target_ref": "attack-pattern--e6919abc-99f9-4c6c-95a5-14761e7b2add"}, {"name": "Suspicious Driver Load from Temp", "description": "Detects a driver load from a temporary directory", "created": "2017-02-12T00:00:00.000Z", "valid_from": "2017-02-12T00:00:00Z", "indicator_types": ["malicious-activity"], "pattern_type": "sigma", "pattern": "title: Suspicious Driver Load from Temp\nid: 2c4523d5-d481-4ed0-8ec3-7fbf0cb41a75\ndescription: Detects a driver load from a temporary directory\nauthor: Florian Roth\ndate: 2017/02/12\ntags:\n    - attack.persistence\n    - attack.t1050\nlogsource:\n    product: windows\n    service: sysmon\ndetection:\n    selection:\n        EventID: 6\n        ImageLoaded: '*\\Temp\\\\*'\n    condition: selection\nfalsepositives:\n    - there is a relevant set of false positives depending on applications in the environment\nlevel: medium\n", "object_marking_refs": ["marking-definition--0a872d70-1d05-45dd-a25f-031af547a102"], "created_by_ref": "identity--082ca4f0-d825-45b6-aa42-ab9afd1e5503", "type": "indicator", "spec_version": "2.1", "id": "indicator--e4dfcf8e-8857-4748-8449-05707188faee", "modified": "2020-04-02T07:59:00.943Z"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--4f7c2751-b449-4701-a650-e29a57f4e338", "created": "2020-04-02T07:59:00.952Z", "modified": "2020-04-02T07:59:00.952Z", "source_ref": "indicator--e4dfcf8e-8857-4748-8449-05707188faee", "relationship_type": "indicates", "target_ref": "attack-pattern--478aa214-2ca7-4ec0-9978-18798e514790"}, {"name": "Logon Scripts (UserInitMprLogonScript)", "description": "Detects creation or execution of UserInitMprLogonScript persistence method", "created": "2019-01-12T00:00:00.000Z", "valid_from": "2019-01-12T00:00:00Z", "indicator_types": ["malicious-activity"], "pattern_type": "sigma", "pattern": "action: global\ntitle: Logon Scripts (UserInitMprLogonScript)\nid: 0a98a10c-685d-4ab0-bddc-b6bdd1d48458\nstatus: experimental\ndescription: Detects creation or execution of UserInitMprLogonScript persistence method\nreferences:\n    - https://attack.mitre.org/techniques/T1037/\ntags:\n    - attack.t1037\n    - attack.persistence\n    - attack.lateral_movement\nauthor: Tom Ueltschi (@c_APT_ure)\ndate: 2019/01/12\nfalsepositives:\n    - exclude legitimate logon scripts\n    - penetration tests, red teaming\nlevel: high\n", "object_marking_refs": ["marking-definition--0a872d70-1d05-45dd-a25f-031af547a102"], "created_by_ref": "identity--082ca4f0-d825-45b6-aa42-ab9afd1e5503", "type": "indicator", "spec_version": "2.1", "id": "indicator--fc45f141-3574-466b-b11b-72079f861a42", "modified": "2020-04-02T07:59:00.955Z"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--9eefb2e2-1bea-40fb-ba6e-d0b4f9a61aae", "created": "2020-04-02T07:59:00.962Z", "modified": "2020-04-02T07:59:00.962Z", "source_ref": "indicator--fc45f141-3574-466b-b11b-72079f861a42", "relationship_type": "indicates", "target_ref": "attack-pattern--03259939-0b57-482f-8eb5-87c0e0d54334"}, {"name": "WMI Persistence - Command Line Event Consumer", "description": "Detects WMI command line event consumers", "created": "2018-03-07T00:00:00.000Z", "valid_from": "2018-03-07T00:00:00Z", "indicator_types": ["malicious-activity"], "pattern_type": "sigma", "pattern": "title: WMI Persistence - Command Line Event Consumer\nid: 05936ce2-ee05-4dae-9d03-9a391cf2d2c6\nstatus: experimental\ndescription: Detects WMI command line event consumers\nreferences:\n    - https://www.eideon.com/2018-03-02-THL03-WMIBackdoors/\nauthor: Thomas Patzke\ndate: 2018/03/07\ntags:\n    - attack.t1084\n    - attack.persistence\nlogsource:\n    product: windows\n    service: sysmon\ndetection:\n    selection:\n        EventID: 7\n        Image: 'C:\\Windows\\System32\\wbem\\WmiPrvSE.exe'\n        ImageLoaded: 'wbemcons.dll'\n    condition: selection\nfalsepositives: \n    - Unknown (data set is too small; further testing needed)\nlevel: high\n", "object_marking_refs": ["marking-definition--0a872d70-1d05-45dd-a25f-031af547a102"], "created_by_ref": "identity--082ca4f0-d825-45b6-aa42-ab9afd1e5503", "type": "indicator", "spec_version": "2.1", "id": "indicator--ddf2752d-b661-493d-a54d-268909b3a2cb", "modified": "2020-04-02T07:59:00.971Z"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--98c20a6d-cfdb-44aa-b4fe-77307d5aa4c8", "created": "2020-04-02T07:59:00.978Z", "modified": "2020-04-02T07:59:00.978Z", "source_ref": "indicator--ddf2752d-b661-493d-a54d-268909b3a2cb", "relationship_type": "indicates", "target_ref": "attack-pattern--e906ae4d-1d3a-4675-be23-22f7311c0da4"}, {"name": "Password Dumper Remote Thread in LSASS", "description": "Detects password dumper activity by monitoring remote thread creation EventID 8 in combination with the lsass.exe process as TargetImage. The process in field Process is the malicious program. A single execution can lead to hundreds of events.", "created": "2017-02-19T00:00:00.000Z", "valid_from": "2017-02-19T00:00:00Z", "indicator_types": ["malicious-activity"], "pattern_type": "sigma", "pattern": "title: Password Dumper Remote Thread in LSASS\nid: f239b326-2f41-4d6b-9dfa-c846a60ef505\ndescription: Detects password dumper activity by monitoring remote thread creation EventID 8 in combination with the lsass.exe process as TargetImage. The process\n    in field Process is the malicious program. A single execution can lead to hundreds of events.\nreferences:\n    - https://jpcertcc.github.io/ToolAnalysisResultSheet/details/WCE.htm\nstatus: stable\nauthor: Thomas Patzke\ndate: 2017/02/19\nlogsource:\n    product: windows\n    service: sysmon\ndetection:\n    selection:\n        EventID: 8\n        TargetImage: 'C:\\Windows\\System32\\lsass.exe'\n        StartModule: null\n    condition: selection\ntags:\n    - attack.credential_access\n    - attack.t1003\n    - attack.s0005\nfalsepositives:\n    - unknown\nlevel: high\n", "object_marking_refs": ["marking-definition--0a872d70-1d05-45dd-a25f-031af547a102"], "created_by_ref": "identity--082ca4f0-d825-45b6-aa42-ab9afd1e5503", "type": "indicator", "spec_version": "2.1", "id": "indicator--d1f58e7e-a901-405e-af9e-e1faddb126bd", "modified": "2020-04-02T07:59:00.982Z"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--eca430e5-3c11-4d04-a533-4f004cea8ee8", "created": "2020-04-02T07:59:00.991Z", "modified": "2020-04-02T07:59:00.991Z", "source_ref": "indicator--d1f58e7e-a901-405e-af9e-e1faddb126bd", "relationship_type": "indicates", "target_ref": "attack-pattern--0a3ead4e-6d47-4ccb-854c-a6a4f9d96b22"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--71f502fa-3dab-4ed9-9aab-761eb338b91e", "created": "2020-04-02T07:59:00.998Z", "modified": "2020-04-02T07:59:00.998Z", "source_ref": "indicator--d1f58e7e-a901-405e-af9e-e1faddb126bd", "relationship_type": "indicates", "target_ref": "tool--242f3da3-4425-4d11-8f5c-b842886da966"}, {"name": "Cred Dump-Tools Named Pipes", "description": "Detects well-known credential dumping tools execution via specific named pipes", "created": "2019-11-01T00:00:00.000Z", "valid_from": "2019-11-01T00:00:00Z", "indicator_types": ["malicious-activity"], "pattern_type": "sigma", "pattern": "title: Cred Dump-Tools Named Pipes\nid: 961d0ba2-3eea-4303-a930-2cf78bbfcc5e\ndescription: Detects well-known credential dumping tools execution via specific named pipes\nauthor: Teymur Kheirkhabarov, oscd.community\ndate: 2019/11/01\nreferences:\n    - https://www.slideshare.net/heirhabarov/hunting-for-credentials-dumping-in-windows-environment\ntags:\n    - attack.credential_access\n    - attack.t1003\nlogsource:\n    product: windows\n    service: sysmon\ndetection:\n    selection:\n        EventID: 17\n        PipeName|contains:\n            - '\\lsadump'\n            - '\\cachedump'\n            - '\\wceservicepipe'\n    condition: selection\nfalsepositives:\n    - Legitimate Administrator using tool for password recovery\nlevel: critical\nstatus: experimental\n", "object_marking_refs": ["marking-definition--0a872d70-1d05-45dd-a25f-031af547a102"], "created_by_ref": "identity--082ca4f0-d825-45b6-aa42-ab9afd1e5503", "type": "indicator", "spec_version": "2.1", "id": "indicator--f23af6f2-a188-4ebd-9fa4-5ba866abf69c", "modified": "2020-04-02T07:59:01.002Z"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--a423690e-a33c-43b3-85a3-cfcd716f4383", "created": "2020-04-02T07:59:01.012Z", "modified": "2020-04-02T07:59:01.012Z", "source_ref": "indicator--f23af6f2-a188-4ebd-9fa4-5ba866abf69c", "relationship_type": "indicates", "target_ref": "attack-pattern--0a3ead4e-6d47-4ccb-854c-a6a4f9d96b22"}, {"name": "Narrator's Feedback-Hub Persistence", "description": "Detects abusing Windows 10 Narrator's Feedback-Hub", "created": "2019-10-25T00:00:00.000Z", "modified": "2019-11-10T00:00:00.000Z", "valid_from": "2019-10-25T00:00:00Z", "indicator_types": ["malicious-activity"], "pattern_type": "sigma", "pattern": "title: Narrator's Feedback-Hub Persistence\nid: f663a6d9-9d1b-49b8-b2b1-0637914d199a\ndescription: Detects abusing Windows 10 Narrator's Feedback-Hub\nreferences:\n    - https://giuliocomi.blogspot.com/2019/10/abusing-windows-10-narrators-feedback.html\ntags:\n    - attack.persistence\n    - attack.t1060\nauthor: Dmitriy Lifanov, oscd.community\nstatus: experimental\ndate: 2019/10/25\nmodified: 2019/11/10\nlogsource:\n    product: windows\n    service: sysmon\ndetection:\n    selection1:\n        EventID: 12\n        EventType: DeleteValue\n        TargetObject|endswith: '\\AppXypsaf9f1qserqevf0sws76dx4k9a5206\\Shell\\open\\command\\DelegateExecute'\n    selection2:\n        EventID: 13\n        TargetObject|endswith: '\\AppXypsaf9f1qserqevf0sws76dx4k9a5206\\Shell\\open\\command\\(Default)'\n    condition: 1 of them\nfalsepositives:\n    - unknown\nlevel: high\n", "object_marking_refs": ["marking-definition--0a872d70-1d05-45dd-a25f-031af547a102"], "created_by_ref": "identity--082ca4f0-d825-45b6-aa42-ab9afd1e5503", "type": "indicator", "spec_version": "2.1", "id": "indicator--e2ce01e3-c0fd-418e-9870-92022e57f963"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--236674a2-b8e7-4066-bc38-5b502ae0f1bd", "created": "2020-04-02T07:59:01.027Z", "modified": "2020-04-02T07:59:01.027Z", "source_ref": "indicator--e2ce01e3-c0fd-418e-9870-92022e57f963", "relationship_type": "indicates", "target_ref": "attack-pattern--9422fc14-1c43-410d-ab0f-a709b76c72dc"}, {"name": "Active Directory Parsing DLL Loaded Via Office Applications", "description": "Detects DSParse DLL being loaded by an Office Product", "created": "2020-02-19T00:00:00.000Z", "valid_from": "2020-02-19T00:00:00Z", "indicator_types": ["malicious-activity"], "pattern_type": "sigma", "pattern": "title: Active Directory Parsing DLL Loaded Via Office Applications\nid: a2a3b925-7bb0-433b-b508-db9003263cc4\nstatus: experimental\ndescription: Detects DSParse DLL being loaded by an Office Product\nreferences:\n    - https://medium.com/threatpunter/detecting-adversary-tradecraft-with-image-load-event-logging-and-eql-8de93338c16\nauthor: Antonlovesdnb\ndate: 2020/02/19\ntags:\n    - attack.initial_access\n    - attack.t1193\nlogsource:\n    product: windows\n    service: sysmon\ndetection:\n    selection:\n        EventID: 7\n        Image:\n            - '*\\winword.exe'\n            - '*\\powerpnt.exe'\n            - '*\\excel.exe'\n            - '*\\outlook.exe'\n        ImageLoaded:\n            - '*\\dsparse.dll*'\n    condition: selection\nfalsepositives:\n    - Alerts on legitimate macro usage as well, will need to filter as appropriate\nlevel: high\n", "object_marking_refs": ["marking-definition--0a872d70-1d05-45dd-a25f-031af547a102"], "created_by_ref": "identity--082ca4f0-d825-45b6-aa42-ab9afd1e5503", "type": "indicator", "spec_version": "2.1", "id": "indicator--382f1842-6432-4c32-8133-e539dbb43faa", "modified": "2020-04-02T07:59:01.031Z"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--caa9ed83-5a18-4709-89fe-eb2156926f74", "created": "2020-04-02T07:59:01.040Z", "modified": "2020-04-02T07:59:01.040Z", "source_ref": "indicator--382f1842-6432-4c32-8133-e539dbb43faa", "relationship_type": "indicates", "target_ref": "attack-pattern--6aac77c4-eaf2-4366-8c13-ce50ab951f38"}, {"name": "dotNET DLL Loaded Via Office Applications", "description": "Detects any assembly DLL being loaded by an Office Product", "created": "2020-02-19T00:00:00.000Z", "valid_from": "2020-02-19T00:00:00Z", "indicator_types": ["malicious-activity"], "pattern_type": "sigma", "pattern": "title: dotNET DLL Loaded Via Office Applications\nid: ff0f2b05-09db-4095-b96d-1b75ca24894a\nstatus: experimental\ndescription: Detects any assembly DLL being loaded by an Office Product\nreferences:\n    - https://medium.com/threatpunter/detecting-adversary-tradecraft-with-image-load-event-logging-and-eql-8de93338c16\nauthor: Antonlovesdnb\ndate: 2020/02/19\ntags:\n    - attack.initial_access\n    - attack.t1193\nlogsource:\n    product: windows\n    service: sysmon\ndetection:\n    selection:\n        EventID: 7\n        Image:\n            - '*\\winword.exe*'\n            - '*\\powerpnt.exe*'\n            - '*\\excel.exe*'\n            - '*\\outlook.exe*'\n        ImageLoaded:\n            - '*C:\\Windows\\assembly\\*'\n    condition: selection\nfalsepositives:\n    - Alerts on legitimate macro usage as well, will need to filter as appropriate\nlevel: high\n", "object_marking_refs": ["marking-definition--0a872d70-1d05-45dd-a25f-031af547a102"], "created_by_ref": "identity--082ca4f0-d825-45b6-aa42-ab9afd1e5503", "type": "indicator", "spec_version": "2.1", "id": "indicator--9df6889e-9fb9-46f1-9b7b-0f938883c1cf", "modified": "2020-04-02T07:59:01.044Z"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--6c5de771-140d-46cd-9124-35cb22e467e0", "created": "2020-04-02T07:59:01.052Z", "modified": "2020-04-02T07:59:01.052Z", "source_ref": "indicator--9df6889e-9fb9-46f1-9b7b-0f938883c1cf", "relationship_type": "indicates", "target_ref": "attack-pattern--6aac77c4-eaf2-4366-8c13-ce50ab951f38"}, {"name": "In-memory PowerShell", "description": "Detects loading of essential DLL used by PowerShell, but not by the process powershell.exe. Detects meterpreter's \"load powershell\" extension.", "created": "2019-11-14T00:00:00.000Z", "modified": "2019-11-30T00:00:00.000Z", "valid_from": "2019-11-14T00:00:00Z", "indicator_types": ["malicious-activity"], "pattern_type": "sigma", "pattern": "title: In-memory PowerShell\nid: 092bc4b9-3d1d-43b4-a6b4-8c8acd83522f\nstatus: experimental\ndescription: Detects loading of essential DLL used by PowerShell, but not by the process powershell.exe. Detects meterpreter's \"load powershell\" extension.\nauthor: Tom Kern, oscd.community\ndate: 2019/11/14\nmodified: 2019/11/30\nreferences:\n    - https://adsecurity.org/?p=2921\n    - https://github.com/p3nt4/PowerShdll\ntags:\n    - attack.t1086\n    - attack.execution\nlogsource:\n    product: windows\n    service: sysmon\ndetection:\n    selection:\n        EventID: 7\n        ImageLoaded|endswith:\n            - '\\System.Management.Automation.Dll'\n            - '\\System.Management.Automation.ni.Dll'\n    filter:\n        Image|endswith:\n            - '\\powershell.exe'\n            - '\\WINDOWS\\System32\\sdiagnhost.exe'\n        User: 'NT AUTHORITY\\SYSTEM'\n    condition: selection and not filter\nfalsepositives:\n    - Used by some .NET binaries, minimal on user workstation.\nlevel: high\nenrichment:\n    - EN_0001_cache_sysmon_event_id_1_info                      # http://bit.ly/314zc6x\n    - EN_0003_enrich_other_sysmon_events_with_event_id_1_data   # http://bit.ly/2ojW7fw\n", "object_marking_refs": ["marking-definition--0a872d70-1d05-45dd-a25f-031af547a102"], "created_by_ref": "identity--082ca4f0-d825-45b6-aa42-ab9afd1e5503", "type": "indicator", "spec_version": "2.1", "id": "indicator--84ecaa48-b9fb-47d9-b308-3c93946276aa"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--384b4810-79c0-4672-b7f6-730550c3d932", "created": "2020-04-02T07:59:01.064Z", "modified": "2020-04-02T07:59:01.064Z", "source_ref": "indicator--84ecaa48-b9fb-47d9-b308-3c93946276aa", "relationship_type": "indicates", "target_ref": "attack-pattern--f4882e23-8aa7-4b12-b28a-b349c12ee9e0"}, {"name": "VBA DLL Loaded Via Microsoft Word", "description": "Detects DLL's Loaded Via Word Containing VBA Macros", "created": "2020-02-19T00:00:00.000Z", "valid_from": "2020-02-19T00:00:00Z", "indicator_types": ["malicious-activity"], "pattern_type": "sigma", "pattern": "title: VBA DLL Loaded Via Microsoft Word\nid: e6ce8457-68b1-485b-9bdd-3c2b5d679aa9\nstatus: experimental\ndescription: Detects DLL's Loaded Via Word Containing VBA Macros\nreferences:\n    - https://medium.com/threatpunter/detecting-adversary-tradecraft-with-image-load-event-logging-and-eql-8de93338c16\nauthor: Antonlovesdnb\ndate: 2020/02/19\ntags:\n    - attack.initial_access\n    - attack.t1193\nlogsource:\n    product: windows\n    service: sysmon\ndetection:\n    selection:\n        EventID: 7\n        Image:\n            - '*\\winword.exe*'\n            - '*\\powerpnt.exe*'\n            - '*\\excel.exe*'\n            - '*\\outlook.exe*'\n        ImageLoaded:\n            - '*\\VBE7.DLL*'\n            - '*\\VBEUI.DLL*'\n            - '*\\VBE7INTL.DLL*'\n    condition: selection\nfalsepositives:\n    - Alerts on legitimate macro usage as well, will need to filter as appropriate\nlevel: high\n", "object_marking_refs": ["marking-definition--0a872d70-1d05-45dd-a25f-031af547a102"], "created_by_ref": "identity--082ca4f0-d825-45b6-aa42-ab9afd1e5503", "type": "indicator", "spec_version": "2.1", "id": "indicator--66065088-2ed5-424e-843b-7981af230d51", "modified": "2020-04-02T07:59:01.068Z"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--32e7482c-c911-4dbb-8c64-a9fbe7e99777", "created": "2020-04-02T07:59:01.076Z", "modified": "2020-04-02T07:59:01.076Z", "source_ref": "indicator--66065088-2ed5-424e-843b-7981af230d51", "relationship_type": "indicates", "target_ref": "attack-pattern--6aac77c4-eaf2-4366-8c13-ce50ab951f38"}, {"name": "Regsvr32 Network Activity", "description": "Detects network connections and DNS queries initiated by Regsvr32.exe", "created": "2019-10-25T00:00:00.000Z", "modified": "2019-11-10T00:00:00.000Z", "valid_from": "2019-10-25T00:00:00Z", "indicator_types": ["malicious-activity"], "pattern_type": "sigma", "pattern": "title: Regsvr32 Network Activity\nid: c7e91a02-d771-4a6d-a700-42587e0b1095\ndescription: Detects network connections and DNS queries initiated by Regsvr32.exe\nreferences:\n    - https://pentestlab.blog/2017/05/11/applocker-bypass-regsvr32/\n    - https://oddvar.moe/2017/12/13/applocker-case-study-how-insecure-is-it-really-part-1/\n    - https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1117/T1117.md\ntags:\n    - attack.execution\n    - attack.defense_evasion\n    - attack.t1117\nauthor: Dmitriy Lifanov, oscd.community\nstatus: experimental\ndate: 2019/10/25\nmodified: 2019/11/10\nlogsource:\n    product: windows\n    service: sysmon\ndetection:\n    selection:\n        EventID:\n         - 3\n         - 22\n        Image|endswith: '\\regsvr32.exe'\n    condition: selection\nfields:\n    - ComputerName\n    - User\n    - Image\n    - DestinationIp\n    - DestinationPort\nfalsepositives:\n    - unknown\nlevel: high\n", "object_marking_refs": ["marking-definition--0a872d70-1d05-45dd-a25f-031af547a102"], "created_by_ref": "identity--082ca4f0-d825-45b6-aa42-ab9afd1e5503", "type": "indicator", "spec_version": "2.1", "id": "indicator--c59da89b-6587-4769-a01e-c23654d4d7be"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--b789e6a8-d08b-4e18-8224-049492a5d3e6", "created": "2020-04-02T07:59:01.090Z", "modified": "2020-04-02T07:59:01.090Z", "source_ref": "indicator--c59da89b-6587-4769-a01e-c23654d4d7be", "relationship_type": "indicates", "target_ref": "attack-pattern--68f7e3a1-f09f-4164-9a62-16b648a0dd5a"}, {"name": "LSASS Memory Dump", "description": "Detects process LSASS memory dump using procdump or taskmgr based on the CallTrace pointing to dbghelp.dll or dbgcore.dll for win10", "created": "2019-04-03T00:00:00.000Z", "valid_from": "2019-04-03T00:00:00Z", "indicator_types": ["malicious-activity"], "pattern_type": "sigma", "pattern": "title: LSASS Memory Dump\nid: 5ef9853e-4d0e-4a70-846f-a9ca37d876da\nstatus: experimental\ndescription: Detects process LSASS memory dump using procdump or taskmgr based on the CallTrace pointing to dbghelp.dll or dbgcore.dll for win10\nauthor: Samir Bousseaden\ndate: 2019/04/03\nreferences:\n    - https://blog.menasec.net/2019/02/threat-hunting-21-procdump-or-taskmgr.html\ntags:\n    - attack.t1003\n    - attack.s0002\n    - attack.credential_access\nlogsource:\n    product: windows\n    service: sysmon\ndetection:\n    selection:\n        EventID: 10\n        TargetImage: 'C:\\windows\\system32\\lsass.exe'\n        GrantedAccess: '0x1fffff'\n        CallTrace:\n         - '*dbghelp.dll*'\n         - '*dbgcore.dll*'\n    condition: selection\nfalsepositives:\n    - unknown\nlevel: high\n", "object_marking_refs": ["marking-definition--0a872d70-1d05-45dd-a25f-031af547a102"], "created_by_ref": "identity--082ca4f0-d825-45b6-aa42-ab9afd1e5503", "type": "indicator", "spec_version": "2.1", "id": "indicator--8bde2c19-d78e-4924-8a30-42a136422975", "modified": "2020-04-02T07:59:01.093Z"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--2bb5db57-58bc-4f6c-9874-b38710f9582c", "created": "2020-04-02T07:59:01.105Z", "modified": "2020-04-02T07:59:01.105Z", "source_ref": "indicator--8bde2c19-d78e-4924-8a30-42a136422975", "relationship_type": "indicates", "target_ref": "attack-pattern--0a3ead4e-6d47-4ccb-854c-a6a4f9d96b22"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--91c7a67e-de86-47ad-92f0-8dd449ae6089", "created": "2020-04-02T07:59:01.113Z", "modified": "2020-04-02T07:59:01.113Z", "source_ref": "indicator--8bde2c19-d78e-4924-8a30-42a136422975", "relationship_type": "indicates", "target_ref": "tool--afc079f3-c0ea-4096-b75d-3f05338b7f60"}, {"name": "Remote PowerShell Session", "description": "Detects remote PowerShell connections by monitoring network outbount connections to ports 5985 or 5986 from not network service account", "created": "2019-09-12T00:00:00.000Z", "valid_from": "2019-09-12T00:00:00Z", "indicator_types": ["malicious-activity"], "pattern_type": "sigma", "pattern": "title: Remote PowerShell Session\nid: c539afac-c12a-46ed-b1bd-5a5567c9f045\ndescription: Detects remote PowerShell connections by monitoring network outbount connections to ports 5985 or 5986 from not network service account\nstatus: experimental\ndate: 2019/09/12\nauthor: Roberto Rodriguez @Cyb3rWard0g\nreferences:\n    - https://github.com/Cyb3rWard0g/ThreatHunter-Playbook/tree/master/playbooks/windows/02_execution/T1086_powershell/powershell_remote_session.md\ntags:\n    - attack.execution\n    - attack.t1086\nlogsource:\n    product: windows\n    service: sysmon\ndetection:\n    selection: \n        EventID: 3\n        DestinationPort:\n            - 5985\n            - 5986\n    filter:\n        User: 'NT AUTHORITY\\NETWORK SERVICE'\n    condition: selection and not filter\nfalsepositives:\n    - Leigitmate usage of remote PowerShell, e.g. remote administration and monitoring.\nlevel: high\n", "object_marking_refs": ["marking-definition--0a872d70-1d05-45dd-a25f-031af547a102"], "created_by_ref": "identity--082ca4f0-d825-45b6-aa42-ab9afd1e5503", "type": "indicator", "spec_version": "2.1", "id": "indicator--6c4ad84e-7e1b-4eb5-905d-55a9ef377e99", "modified": "2020-04-02T07:59:01.116Z"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--fedfcdab-9219-4e98-a8f2-531bdd9ce7bb", "created": "2020-04-02T07:59:01.129Z", "modified": "2020-04-02T07:59:01.129Z", "source_ref": "indicator--6c4ad84e-7e1b-4eb5-905d-55a9ef377e99", "relationship_type": "indicates", "target_ref": "attack-pattern--f4882e23-8aa7-4b12-b28a-b349c12ee9e0"}, {"name": "Dumpert Process Dumper", "description": "Detects the use of Dumpert process dumper, which dumps the lsass.exe process memory", "created": "2020-02-04T00:00:00.000Z", "valid_from": "2020-02-04T00:00:00Z", "indicator_types": ["malicious-activity"], "pattern_type": "sigma", "pattern": "action: global\ntitle: Dumpert Process Dumper\nid: 2704ab9e-afe2-4854-a3b1-0c0706d03578\ndescription: Detects the use of Dumpert process dumper, which dumps the lsass.exe process memory\nauthor: Florian Roth\nreferences:\n    - https://github.com/outflanknl/Dumpert\n    - https://unit42.paloaltonetworks.com/actors-still-exploiting-sharepoint-vulnerability/\ndate: 2020/02/04\ntags:\n    - attack.credential_access\n    - attack.t1003\nlogsource:\n    product: windows\n    service: sysmon\nfalsepositives:\n    - Very unlikely\nlevel: critical\n", "object_marking_refs": ["marking-definition--0a872d70-1d05-45dd-a25f-031af547a102"], "created_by_ref": "identity--082ca4f0-d825-45b6-aa42-ab9afd1e5503", "type": "indicator", "spec_version": "2.1", "id": "indicator--35383f57-7a86-43ed-a513-c41cce5ae767", "modified": "2020-04-02T07:59:01.132Z"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--349a3b98-7ef2-47ca-9d33-9a171706314b", "created": "2020-04-02T07:59:01.144Z", "modified": "2020-04-02T07:59:01.144Z", "source_ref": "indicator--35383f57-7a86-43ed-a513-c41cce5ae767", "relationship_type": "indicates", "target_ref": "attack-pattern--0a3ead4e-6d47-4ccb-854c-a6a4f9d96b22"}, {"name": "DNS ServerLevelPluginDll Install", "description": "Detects the installation of a plugin DLL via ServerLevelPluginDll parameter in Registry, which can be used to execute code in context of the DNS server (restart required)", "created": "2017-05-08T00:00:00.000Z", "valid_from": "2017-05-08T00:00:00Z", "indicator_types": ["malicious-activity"], "pattern_type": "sigma", "pattern": "action: global\ntitle: DNS ServerLevelPluginDll Install\nid: e61e8a88-59a9-451c-874e-70fcc9740d67\nstatus: experimental\ndescription: Detects the installation of a plugin DLL via ServerLevelPluginDll parameter in Registry, which can be used to execute code in context of the DNS server\n    (restart required)\nreferences:\n    - https://medium.com/@esnesenon/feature-not-bug-dnsadmin-to-dc-compromise-in-one-line-a0f779b8dc83\ndate: 2017/05/08\nauthor: Florian Roth\ntags:\n    - attack.defense_evasion\n    - attack.t1073\ndetection:\n    condition: 1 of them\nfields:\n    - EventID\n    - CommandLine\n    - ParentCommandLine\n    - Image\n    - User\n    - TargetObject\nfalsepositives:\n    - unknown\nlevel: high\n", "object_marking_refs": ["marking-definition--0a872d70-1d05-45dd-a25f-031af547a102"], "created_by_ref": "identity--082ca4f0-d825-45b6-aa42-ab9afd1e5503", "type": "indicator", "spec_version": "2.1", "id": "indicator--33643184-5cfd-4e4f-a1e1-8757c645505c", "modified": "2020-04-02T07:59:01.149Z"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--8f3c68bf-f24a-4928-8f57-ba638bd64e8d", "created": "2020-04-02T07:59:01.158Z", "modified": "2020-04-02T07:59:01.158Z", "source_ref": "indicator--33643184-5cfd-4e4f-a1e1-8757c645505c", "relationship_type": "indicates", "target_ref": "attack-pattern--b2001907-166b-4d71-bb3c-9d26c871de09"}, {"name": "Suspicious File Characteristics Due to Missing Fields", "description": "Detects Executables without FileVersion,Description,Product,Company likely created with py2exe", "created": "2018-11-22T00:00:00.000Z", "modified": "2019-11-09T00:00:00.000Z", "valid_from": "2018-11-22T00:00:00Z", "indicator_types": ["malicious-activity"], "pattern_type": "sigma", "pattern": "title: Suspicious File Characteristics Due to Missing Fields\nid: 9637e8a5-7131-4f7f-bdc7-2b05d8670c43\ndescription: Detects Executables without FileVersion,Description,Product,Company likely created with py2exe\nstatus: experimental\nreferences:\n    - https://securelist.com/muddywater/88059/\n    - https://www.virustotal.com/#/file/276a765a10f98cda1a38d3a31e7483585ca3722ecad19d784441293acf1b7beb/detection\nauthor: Markus Neis\ndate: 2018/11/22\nmodified: 2019/11/09\ntags:\n    - attack.defense_evasion\n    - attack.execution\n    - attack.t1064\nlogsource:\n    product: windows\n    service: sysmon\ndetection:\n    selection1:\n        Description: '\\?'\n        FileVersion: '\\?'\n    selection2:\n        Description: '\\?'\n        Product: '\\?'\n    selection3:\n        Description: '\\?'\n        Company: '\\?'\n    condition: 1 of them\nfields:\n    - CommandLine\n    - ParentCommandLine\nfalsepositives:\n    - Unknown\nlevel: medium\n", "object_marking_refs": ["marking-definition--0a872d70-1d05-45dd-a25f-031af547a102"], "created_by_ref": "identity--082ca4f0-d825-45b6-aa42-ab9afd1e5503", "type": "indicator", "spec_version": "2.1", "id": "indicator--2e03ffca-8412-4ee9-888b-029d186a5f91"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--5b359f35-e2c2-435b-a8e7-3df4e91a5976", "created": "2020-04-02T07:59:01.173Z", "modified": "2020-04-02T07:59:01.173Z", "source_ref": "indicator--2e03ffca-8412-4ee9-888b-029d186a5f91", "relationship_type": "indicates", "target_ref": "attack-pattern--7fd87010-3a00-4da3-b905-410525e8ec44"}, {"name": "Executable in ADS", "description": "Detects the creation of an ADS data stream that contains an executable (non-empty imphash)", "created": "2018-06-03T00:00:00.000Z", "valid_from": "2018-06-03T00:00:00Z", "indicator_types": ["malicious-activity"], "pattern_type": "sigma", "pattern": "title: Executable in ADS\nid: b69888d4-380c-45ce-9cf9-d9ce46e67821\nstatus: experimental\ndescription: Detects the creation of an ADS data stream that contains an executable (non-empty imphash)\nreferences:\n    - https://twitter.com/0xrawsec/status/1002478725605273600?s=21\ntags:\n    - attack.defense_evasion\n    - attack.t1027\n    - attack.s0139\nauthor: Florian Roth, @0xrawsec\ndate: 2018/06/03\nlogsource:\n    product: windows\n    service: sysmon\n    definition: 'Requirements: Sysmon config with Imphash logging activated'\ndetection:\n    selection:\n        EventID: 15\n    filter:\n        Imphash: \n            - '00000000000000000000000000000000'\n            - null\n    condition: selection and not filter\nfields:\n    - TargetFilename\n    - Image\nfalsepositives:\n    - unknown\nlevel: critical\n\n", "object_marking_refs": ["marking-definition--0a872d70-1d05-45dd-a25f-031af547a102"], "created_by_ref": "identity--082ca4f0-d825-45b6-aa42-ab9afd1e5503", "type": "indicator", "spec_version": "2.1", "id": "indicator--84826a06-9fab-40b3-b864-46f465594d3a", "modified": "2020-04-02T07:59:01.177Z"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--fda95ef4-e8e4-40bf-96d4-e8abce5243c9", "created": "2020-04-02T07:59:01.185Z", "modified": "2020-04-02T07:59:01.185Z", "source_ref": "indicator--84826a06-9fab-40b3-b864-46f465594d3a", "relationship_type": "indicates", "target_ref": "attack-pattern--b3d682b6-98f2-4fb0-aa3b-b4df007ca70a"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--11fed5ac-7f94-410e-a1c0-c841ddf1f5e1", "created": "2020-04-02T07:59:01.193Z", "modified": "2020-04-02T07:59:01.193Z", "source_ref": "indicator--84826a06-9fab-40b3-b864-46f465594d3a", "relationship_type": "indicates", "target_ref": "malware--00c3bfcb-99bd-4767-8c03-b08f585f5c8a"}, {"name": "Suspicious desktop.ini Action", "description": "Detects unusual processes accessing desktop.ini, which can be leveraged to alter how Explorer displays a folder's content (i.e. renaming files) without changing them on disk.", "created": "2020-03-19T00:00:00.000Z", "valid_from": "2020-03-19T00:00:00Z", "indicator_types": ["malicious-activity"], "pattern_type": "sigma", "pattern": "title: Suspicious desktop.ini Action\nid: 81315b50-6b60-4d8f-9928-3466e1022515\nstatus: experimental\ndescription: Detects unusual processes accessing desktop.ini, which can be leveraged to alter how Explorer displays a folder's content (i.e. renaming files) without changing them on disk.\nreferences:\n    - https://isc.sans.edu/forums/diary/Desktopini+as+a+postexploitation+tool/25912/\nauthor: Maxime Thiebaut (@0xThiebaut)\ndate: 2020/03/19\ntags:\n    - attack.persistence\n    - attack.t1023\nlogsource:\n    product: windows\n    service: sysmon\ndetection:\n    filter:\n        Image:\n            - 'C:\\Windows\\explorer.exe'\n            - 'C:\\Windows\\System32\\msiexec.exe'\n            - 'C:\\Windows\\System32\\mmc.exe'\n    selection:\n        EventID: 11\n        TargetFilename|endswith: '\\desktop.ini'\n    condition: selection and not filter\nfalsepositives:\n    - Operations performed through Windows SCCM or equivalent\nlevel: medium\n", "object_marking_refs": ["marking-definition--0a872d70-1d05-45dd-a25f-031af547a102"], "created_by_ref": "identity--082ca4f0-d825-45b6-aa42-ab9afd1e5503", "type": "indicator", "spec_version": "2.1", "id": "indicator--447bb8cf-fb85-4e43-8716-ed9cf98069c2", "modified": "2020-04-02T07:59:01.196Z"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--d00993c8-8c92-4b92-bd8e-917aa711a96c", "created": "2020-04-02T07:59:01.205Z", "modified": "2020-04-02T07:59:01.205Z", "source_ref": "indicator--447bb8cf-fb85-4e43-8716-ed9cf98069c2", "relationship_type": "indicates", "target_ref": "attack-pattern--970cdb5c-02fb-4c38-b17e-d6327cf3c810"}, {"name": "QuarksPwDump Dump File", "description": "Detects a dump file written by QuarksPwDump password dumper", "created": "2018-02-10T00:00:00.000Z", "valid_from": "2018-02-10T00:00:00Z", "indicator_types": ["malicious-activity"], "pattern_type": "sigma", "pattern": "title: QuarksPwDump Dump File\nid: 847def9e-924d-4e90-b7c4-5f581395a2b4\nstatus: experimental\ndescription: Detects a dump file written by QuarksPwDump password dumper\nreferences:\n    - https://jpcertcc.github.io/ToolAnalysisResultSheet/details/QuarksPWDump.htm\nauthor: Florian Roth\ndate: 2018/02/10\ntags:\n  - attack.credential_access\n  - attack.t1003\nlevel: critical\nlogsource:\n    product: windows\n    service: sysmon\ndetection:\n    selection:\n        # Sysmon: File Creation (ID 11)\n        EventID: 11\n        TargetFilename: '*\\AppData\\Local\\Temp\\SAM-*.dmp*'\n    condition: selection\nfalsepositives:\n    - Unknown\n\n", "object_marking_refs": ["marking-definition--0a872d70-1d05-45dd-a25f-031af547a102"], "created_by_ref": "identity--082ca4f0-d825-45b6-aa42-ab9afd1e5503", "type": "indicator", "spec_version": "2.1", "id": "indicator--31e0aa39-a90c-486a-97e7-f71754445b6f", "modified": "2020-04-02T07:59:01.208Z"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--6ce9d0db-4908-479b-9e3f-a7fd11af8e35", "created": "2020-04-02T07:59:01.216Z", "modified": "2020-04-02T07:59:01.216Z", "source_ref": "indicator--31e0aa39-a90c-486a-97e7-f71754445b6f", "relationship_type": "indicates", "target_ref": "attack-pattern--0a3ead4e-6d47-4ccb-854c-a6a4f9d96b22"}, {"name": "UAC Bypass via Sdclt", "description": "Detects changes to HKCU:\\Software\\Classes\\exefile\\shell\\runas\\command\\isolatedCommand", "created": "2017-03-17T00:00:00.000Z", "valid_from": "2017-03-17T00:00:00Z", "indicator_types": ["malicious-activity"], "pattern_type": "sigma", "pattern": "title: UAC Bypass via Sdclt\nid: 5b872a46-3b90-45c1-8419-f675db8053aa\nstatus: experimental\ndescription: Detects changes to HKCU:\\Software\\Classes\\exefile\\shell\\runas\\command\\isolatedCommand\nreferences:\n    - https://enigma0x3.net/2017/03/17/fileless-uac-bypass-using-sdclt-exe/\nauthor: Omer Yampel\ndate: 2017/03/17\nlogsource:\n    product: windows\n    service: sysmon\ndetection:\n    selection:\n        EventID: 13\n        # usrclass.dat is mounted on HKU\\USERSID_Classes\\...\n        TargetObject: 'HKU\\\\*_Classes\\exefile\\shell\\runas\\command\\isolatedCommand'\n    condition: selection\ntags:\n    - attack.defense_evasion\n    - attack.privilege_escalation\n    - attack.t1088\n    - car.2019-04-001\nfalsepositives:\n    - unknown\nlevel: high\n", "object_marking_refs": ["marking-definition--0a872d70-1d05-45dd-a25f-031af547a102"], "created_by_ref": "identity--082ca4f0-d825-45b6-aa42-ab9afd1e5503", "type": "indicator", "spec_version": "2.1", "id": "indicator--f20d2f0e-5456-436b-8b64-181918754dbf", "modified": "2020-04-02T07:59:01.219Z"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--191ba633-c910-4620-adef-0fad41ffe2bb", "created": "2020-04-02T07:59:01.227Z", "modified": "2020-04-02T07:59:01.227Z", "source_ref": "indicator--f20d2f0e-5456-436b-8b64-181918754dbf", "relationship_type": "indicates", "target_ref": "attack-pattern--ca1a3f50-5ebd-41f8-8320-2c7d6a6e88be"}, {"name": "Raw Disk Access Using Illegitimate Tools", "description": "Raw disk access using illegitimate tools, possible defence evasion", "created": "2019-10-22T00:00:00.000Z", "valid_from": "2019-10-22T00:00:00Z", "indicator_types": ["malicious-activity"], "pattern_type": "sigma", "pattern": "title: Raw Disk Access Using Illegitimate Tools\nid: db809f10-56ce-4420-8c86-d6a7d793c79c\ndescription: Raw disk access using illegitimate tools, possible defence evasion\nauthor: Teymur Kheirkhabarov, oscd.community\ndate: 2019/10/22\nreferences:\n    - https://www.slideshare.net/heirhabarov/hunting-for-credentials-dumping-in-windows-environment\ntags:\n    - attack.defense_evasion\n    - attack.t1006\nlogsource:\n    product: windows\n    service: sysmon\ndetection:\n    selection:\n        EventID: 9\n    filter_1:\n        Device|contains: floppy\n    filter_2:\n      - Image|endswith:             # easy to bypass. requires extra rule to support this one\n            - '\\wmiprvse.exe'\n            - '\\sdiagnhost.exe'\n            - '\\searchindexer.exe'\n            - '\\csrss.exe'\n            - '\\defrag.exe'\n            - '\\smss.exe'\n            - '\\vssvc.exe'\n            - '\\compattelrunner.exe'\n            - '\\wininit.exe'\n            - '\\autochk.exe'\n            - '\\taskhost.exe'\n            - '\\dfsrs.exe'\n            - '\\vds.exe'\n            - '\\lsass.exe'\n    condition: selection and not filter_1 and not filter_2\nfields:\n    - ComputerName\n    - Image\n    - ProcessID\n    - Device\nfalsepositives:\n    - Legitimate Administrator using tool for raw access or ongoing forensic investigation\nlevel: medium\nstatus: experimental\n", "object_marking_refs": ["marking-definition--0a872d70-1d05-45dd-a25f-031af547a102"], "created_by_ref": "identity--082ca4f0-d825-45b6-aa42-ab9afd1e5503", "type": "indicator", "spec_version": "2.1", "id": "indicator--eeef54b8-4304-4113-96c6-82b29273b60a", "modified": "2020-04-02T07:59:01.232Z"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--0671a0f0-6e07-490c-82e3-30037196c1d5", "created": "2020-04-02T07:59:01.242Z", "modified": "2020-04-02T07:59:01.242Z", "source_ref": "indicator--eeef54b8-4304-4113-96c6-82b29273b60a", "relationship_type": "indicates", "target_ref": "attack-pattern--0c8ab3eb-df48-4b9c-ace7-beacaac81cc5"}, {"name": "CACTUSTORCH Remote Thread Creation", "description": "Detects remote thread creation from CACTUSTORCH as described in references.", "created": "2019-02-01T00:00:00.000Z", "valid_from": "2019-02-01T00:00:00Z", "indicator_types": ["malicious-activity"], "pattern_type": "sigma", "pattern": "title: CACTUSTORCH Remote Thread Creation\nid: 2e4e488a-6164-4811-9ea1-f960c7359c40\ndescription: Detects remote thread creation from CACTUSTORCH as described in references.\nreferences:\n    - https://twitter.com/SBousseaden/status/1090588499517079552\n    - https://github.com/mdsecactivebreach/CACTUSTORCH\nstatus: experimental\nauthor: '@SBousseaden (detection), Thomas Patzke (rule)'\ndate: 2019/02/01\nlogsource:\n    product: windows\n    service: sysmon\ndetection:\n    selection:\n        EventID: 8\n        SourceImage:\n            - '*\\System32\\cscript.exe'\n            - '*\\System32\\wscript.exe'\n            - '*\\System32\\mshta.exe'\n            - '*\\winword.exe'\n            - '*\\excel.exe'\n        TargetImage: '*\\SysWOW64\\\\*'\n        StartModule: null\n    condition: selection\ntags:\n    - attack.execution\n    - attack.t1055\n    - attack.t1064\nfalsepositives:\n    - unknown\nlevel: high\n", "object_marking_refs": ["marking-definition--0a872d70-1d05-45dd-a25f-031af547a102"], "created_by_ref": "identity--082ca4f0-d825-45b6-aa42-ab9afd1e5503", "type": "indicator", "spec_version": "2.1", "id": "indicator--8c22b985-9a37-4b3e-9a66-20860eb9169c", "modified": "2020-04-02T07:59:01.246Z"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--81f54570-e855-4cd2-bbaf-34632cca9f6a", "created": "2020-04-02T07:59:01.260Z", "modified": "2020-04-02T07:59:01.260Z", "source_ref": "indicator--8c22b985-9a37-4b3e-9a66-20860eb9169c", "relationship_type": "indicates", "target_ref": "attack-pattern--43e7dc91-05b2-474c-b9ac-2ed4fe101f4d"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--7ebde971-fc01-46b5-a2c5-c2876bfe648c", "created": "2020-04-02T07:59:01.275Z", "modified": "2020-04-02T07:59:01.275Z", "source_ref": "indicator--8c22b985-9a37-4b3e-9a66-20860eb9169c", "relationship_type": "indicates", "target_ref": "attack-pattern--7fd87010-3a00-4da3-b905-410525e8ec44"}, {"name": "Microsoft Binary Suspicious Communication Endpoint", "description": "Detects an executable in the Windows folder accessing suspicious domains", "created": "2018-08-30T00:00:00.000Z", "valid_from": "2018-08-30T00:00:00Z", "indicator_types": ["malicious-activity"], "pattern_type": "sigma", "pattern": "title: Microsoft Binary Suspicious Communication Endpoint\nid: e0f8ab85-0ac9-423b-a73a-81b3c7b1aa97\nstatus: experimental\ndescription: Detects an executable in the Windows folder accessing suspicious domains\nreferences:\n    - https://twitter.com/M_haggis/status/900741347035889665\n    - https://twitter.com/M_haggis/status/1032799638213066752\nauthor: Florian Roth\ndate: 2018/08/30\ntags:\n    - attack.lateral_movement\n    - attack.t1105\nlogsource:\n    product: windows\n    service: sysmon\ndetection:\n    selection:\n        EventID: 3\n        Initiated: 'true'\n        DestinationHostname: \n            - '*dl.dropboxusercontent.com'\n            - '*.pastebin.com'\n            - '*.githubusercontent.com' # includes both gists and github repositories\n        Image: 'C:\\Windows\\\\*'\n    condition: selection\nfalsepositives:\n    - 'Unknown'\nlevel: high\n\n", "object_marking_refs": ["marking-definition--0a872d70-1d05-45dd-a25f-031af547a102"], "created_by_ref": "identity--082ca4f0-d825-45b6-aa42-ab9afd1e5503", "type": "indicator", "spec_version": "2.1", "id": "indicator--2f44fb1e-05eb-4be3-b772-46f6c5327d2c", "modified": "2020-04-02T07:59:01.280Z"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--947bd07d-fb74-44ed-afdc-b94782ae79a2", "created": "2020-04-02T07:59:01.290Z", "modified": "2020-04-02T07:59:01.290Z", "source_ref": "indicator--2f44fb1e-05eb-4be3-b772-46f6c5327d2c", "relationship_type": "indicates", "target_ref": "attack-pattern--e6919abc-99f9-4c6c-95a5-14761e7b2add"}, {"name": "Cred Dump Tools Dropped Files", "description": "Files with well-known filenames (parts of credential dump software or files produced by them) creation", "created": "2019-11-01T00:00:00.000Z", "modified": "2019-11-13T00:00:00.000Z", "valid_from": "2019-11-01T00:00:00Z", "indicator_types": ["malicious-activity"], "pattern_type": "sigma", "pattern": "title: Cred Dump Tools Dropped Files\nid: 8fbf3271-1ef6-4e94-8210-03c2317947f6\ndescription: Files with well-known filenames (parts of credential dump software or files produced by them) creation\nauthor: Teymur Kheirkhabarov, oscd.community\ndate: 2019/11/01\nmodified: 2019/11/13\nreferences:\n    - https://www.slideshare.net/heirhabarov/hunting-for-credentials-dumping-in-windows-environment\ntags:\n    - attack.credential_access\n    - attack.t1003\nlogsource:\n    product: windows\n    service: sysmon\ndetection:\n    selection:\n        EventID: 11\n        TargetFilename|contains: \n            - '\\pwdump'\n            - '\\kirbi'\n            - '\\pwhashes'\n            - '\\wce_ccache'\n            - '\\wce_krbtkts'\n            - '\\fgdump-log'\n        TargetFilename|endswith: \n            - '\\test.pwd'\n            - '\\lsremora64.dll'\n            - '\\lsremora.dll'\n            - '\\fgexec.exe'\n            - '\\wceaux.dll'\n            - '\\SAM.out'\n            - '\\SECURITY.out'\n            - '\\SYSTEM.out'\n            - '\\NTDS.out'\n            - '\\DumpExt.dll'\n            - '\\DumpSvc.exe'\n            - '\\cachedump64.exe'\n            - '\\cachedump.exe'\n            - '\\pstgdump.exe'\n            - '\\servpw.exe'\n            - '\\servpw64.exe'\n            - '\\pwdump.exe'\n            - '\\procdump64.exe'\n    condition: selection\nfalsepositives:\n    - Legitimate Administrator using tool for password recovery\nlevel: high\nstatus: experimental\n", "object_marking_refs": ["marking-definition--0a872d70-1d05-45dd-a25f-031af547a102"], "created_by_ref": "identity--082ca4f0-d825-45b6-aa42-ab9afd1e5503", "type": "indicator", "spec_version": "2.1", "id": "indicator--2de8fde2-6891-42f0-8965-fd4fc1b52f99"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--025ffd96-2b6e-4a6b-9627-3d2ff07485b2", "created": "2020-04-02T07:59:01.310Z", "modified": "2020-04-02T07:59:01.310Z", "source_ref": "indicator--2de8fde2-6891-42f0-8965-fd4fc1b52f99", "relationship_type": "indicates", "target_ref": "attack-pattern--0a3ead4e-6d47-4ccb-854c-a6a4f9d96b22"}, {"name": "Microsoft Binary Github Communication", "description": "Detects an executable in the Windows folder accessing github.com", "created": "2017-08-24T00:00:00.000Z", "valid_from": "2017-08-24T00:00:00Z", "indicator_types": ["malicious-activity"], "pattern_type": "sigma", "pattern": "title: Microsoft Binary Github Communication\nid: 635dbb88-67b3-4b41-9ea5-a3af2dd88153\nstatus: experimental\ndescription: Detects an executable in the Windows folder accessing github.com\nreferences:\n    - https://twitter.com/M_haggis/status/900741347035889665\n    - https://twitter.com/M_haggis/status/1032799638213066752\nauthor: Michael Haag (idea), Florian Roth (rule)\ndate: 2017/08/24\ntags:\n    - attack.lateral_movement\n    - attack.t1105\nlogsource:\n    product: windows\n    service: sysmon\ndetection:\n    selection:\n        EventID: 3\n        Initiated: 'true'\n        DestinationHostname:\n            - '*.github.com'\n            - '*.githubusercontent.com'\n        Image: 'C:\\Windows\\\\*'\n    condition: selection\nfalsepositives:\n    - 'Unknown'\n    - '@subTee in your network'\nlevel: high\n", "object_marking_refs": ["marking-definition--0a872d70-1d05-45dd-a25f-031af547a102"], "created_by_ref": "identity--082ca4f0-d825-45b6-aa42-ab9afd1e5503", "type": "indicator", "spec_version": "2.1", "id": "indicator--8c933760-d4af-4fd4-ad71-8572a5dabe52", "modified": "2020-04-02T07:59:01.314Z"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--f0132864-bae6-418a-8830-0c1352b1d36c", "created": "2020-04-02T07:59:01.321Z", "modified": "2020-04-02T07:59:01.321Z", "source_ref": "indicator--8c933760-d4af-4fd4-ad71-8572a5dabe52", "relationship_type": "indicates", "target_ref": "attack-pattern--e6919abc-99f9-4c6c-95a5-14761e7b2add"}, {"name": "Suspicious Typical Malware Back Connect Ports", "description": "Detects programs that connect to typical malware back connect ports based on statistical analysis from two different sandbox system databases", "created": "2017-03-19T00:00:00.000Z", "valid_from": "2017-03-19T00:00:00Z", "indicator_types": ["malicious-activity"], "pattern_type": "sigma", "pattern": "title: Suspicious Typical Malware Back Connect Ports\nid: 4b89abaa-99fe-4232-afdd-8f9aa4d20382\nstatus: experimental\ndescription: Detects programs that connect to typical malware back connect ports based on statistical analysis from two different sandbox system databases\nreferences:\n    - https://docs.google.com/spreadsheets/d/17pSTDNpa0sf6pHeRhusvWG6rThciE8CsXTSlDUAZDyo\nauthor: Florian Roth\ndate: 2017/03/19\ntags:\n    - attack.command_and_control\n    - attack.t1043\nlogsource:\n    product: windows\n    service: sysmon\n    definition: 'Use the following config to generate the necessary Event ID 10 Process Access events: <ProcessAccess onmatch=\"include\"><CallTrace condition=\"contains\">VBE7.DLL</CallTrace></ProcessAccess><ProcessAccess onmatch=\"exclude\"><CallTrace condition=\"excludes\">UNKNOWN</CallTrace></ProcessAccess>'\ndetection:\n    selection:\n        EventID: 3\n        Initiated: 'true'\n        DestinationPort:\n            - '4443'\n            - '2448'\n            - '8143'\n            - '1777'\n            - '1443'\n            - '243'\n            - '65535'\n            - '13506'\n            - '3360'\n            - '200'\n            - '198'\n            - '49180'\n            - '13507'\n            - '6625'\n            - '4444'\n            - '4438'\n            - '1904'\n            - '13505'\n            - '13504'\n            - '12102'\n            - '9631'\n            - '5445'\n            - '2443'\n            - '777'\n            - '13394'\n            - '13145'\n            - '12103'\n            - '5552'\n            - '3939'\n            - '3675'\n            - '666'\n            - '473'\n            - '5649'\n            - '4455'\n            - '4433'\n            - '1817'\n            - '100'\n            - '65520'\n            - '1960'\n            - '1515'\n            - '743'\n            - '700'\n            - '14154'\n            - '14103'\n            - '14102'\n            - '12322'\n            - '10101'\n            - '7210'\n            - '4040'\n            - '9943'\n    filter1:\n        Image: '*\\Program Files*'\n    filter2:\n        DestinationIp: \n            - '10.*'\n            - '192.168.*'\n            - '172.16.*'\n            - '172.17.*'\n            - '172.18.*'\n            - '172.19.*'\n            - '172.20.*'\n            - '172.21.*'\n            - '172.22.*'\n            - '172.23.*'\n            - '172.24.*'\n            - '172.25.*'\n            - '172.26.*'\n            - '172.27.*'\n            - '172.28.*'\n            - '172.29.*'\n            - '172.30.*'\n            - '172.31.*'\n            - '127.*'\n        DestinationIsIpv6: 'false'\n    condition: selection and not ( filter1 or filter2 )\nfalsepositives:\n    - unknown\nlevel: medium\n", "object_marking_refs": ["marking-definition--0a872d70-1d05-45dd-a25f-031af547a102"], "created_by_ref": "identity--082ca4f0-d825-45b6-aa42-ab9afd1e5503", "type": "indicator", "spec_version": "2.1", "id": "indicator--eecd4c33-4944-48ca-9781-4b976aad3ea0", "modified": "2020-04-02T07:59:01.331Z"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--88adbc89-9d2a-41f0-95f0-125f666de6ab", "created": "2020-04-02T07:59:01.342Z", "modified": "2020-04-02T07:59:01.342Z", "source_ref": "indicator--eecd4c33-4944-48ca-9781-4b976aad3ea0", "relationship_type": "indicates", "target_ref": "attack-pattern--f879d51c-5476-431c-aedf-f14d207e4d1e"}, {"name": "GAC DLL Loaded Via Office Applications", "description": "Detects any GAC DLL being loaded by an Office Product", "created": "2020-02-19T00:00:00.000Z", "valid_from": "2020-02-19T00:00:00Z", "indicator_types": ["malicious-activity"], "pattern_type": "sigma", "pattern": "title: GAC DLL Loaded Via Office Applications\nid: 90217a70-13fc-48e4-b3db-0d836c5824ac\nstatus: experimental\ndescription: Detects any GAC DLL being loaded by an Office Product\nreferences:\n    - https://medium.com/threatpunter/detecting-adversary-tradecraft-with-image-load-event-logging-and-eql-8de93338c16\nauthor: Antonlovesdnb\ndate: 2020/02/19\ntags:\n    - attack.initial_access\n    - attack.t1193\nlogsource:\n    product: windows\n    service: sysmon\ndetection:\n    selection:\n        EventID: 7\n        Image:\n            - '*\\winword.exe*'\n            - '*\\powerpnt.exe*'\n            - '*\\excel.exe*'\n            - '*\\outlook.exe*'\n        ImageLoaded:\n            - '*C:\\Windows\\Microsoft.NET\\assembly\\GAC_MSIL*'\n    condition: selection\nfalsepositives:\n    - Alerts on legitimate macro usage as well, will need to filter as appropriate\nlevel: high\n", "object_marking_refs": ["marking-definition--0a872d70-1d05-45dd-a25f-031af547a102"], "created_by_ref": "identity--082ca4f0-d825-45b6-aa42-ab9afd1e5503", "type": "indicator", "spec_version": "2.1", "id": "indicator--e5ad4f8b-596f-417e-acdc-c0213a193745", "modified": "2020-04-02T07:59:01.346Z"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--00dc36b0-7fe9-47a0-b3e4-93e42b8643b9", "created": "2020-04-02T07:59:01.354Z", "modified": "2020-04-02T07:59:01.354Z", "source_ref": "indicator--e5ad4f8b-596f-417e-acdc-c0213a193745", "relationship_type": "indicates", "target_ref": "attack-pattern--6aac77c4-eaf2-4366-8c13-ce50ab951f38"}, {"name": "WMI Event Subscription", "description": "Detects creation of WMI event subscription persistence method", "created": "2019-01-12T00:00:00.000Z", "valid_from": "2019-01-12T00:00:00Z", "indicator_types": ["malicious-activity"], "pattern_type": "sigma", "pattern": "title: WMI Event Subscription\nid: 0f06a3a5-6a09-413f-8743-e6cf35561297\nstatus: experimental\ndescription: Detects creation of WMI event subscription persistence method\nreferences:\n    - https://attack.mitre.org/techniques/T1084/\ntags:\n    - attack.t1084\n    - attack.persistence\nauthor: Tom Ueltschi (@c_APT_ure)\ndate: 2019/01/12\nlogsource:\n    product: windows\n    service: sysmon\ndetection:\n    selector:\n        EventID:\n            - 19\n            - 20\n            - 21\n    condition: selector\nfalsepositives:\n    - exclude legitimate (vetted) use of WMI event subscription in your network\nlevel: high\n", "object_marking_refs": ["marking-definition--0a872d70-1d05-45dd-a25f-031af547a102"], "created_by_ref": "identity--082ca4f0-d825-45b6-aa42-ab9afd1e5503", "type": "indicator", "spec_version": "2.1", "id": "indicator--a1c2bcd3-10d9-49fd-b05e-be9c5513275d", "modified": "2020-04-02T07:59:01.357Z"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--7f7f0649-e6aa-4952-b36e-3a28f5612def", "created": "2020-04-02T07:59:01.365Z", "modified": "2020-04-02T07:59:01.365Z", "source_ref": "indicator--a1c2bcd3-10d9-49fd-b05e-be9c5513275d", "relationship_type": "indicates", "target_ref": "attack-pattern--e906ae4d-1d3a-4675-be23-22f7311c0da4"}, {"name": "Autorun Keys Modification", "description": "Detects modification of autostart extensibility point (ASEP) in registry", "created": "2019-10-21T00:00:00.000Z", "modified": "2019-11-10T00:00:00.000Z", "valid_from": "2019-10-21T00:00:00Z", "indicator_types": ["malicious-activity"], "pattern_type": "sigma", "pattern": "title: Autorun Keys Modification\nid: 17f878b8-9968-4578-b814-c4217fc5768c\ndescription: Detects modification of autostart extensibility point (ASEP) in registry\nstatus: experimental\nreferences:\n    - https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1060/T1060.yaml\ntags:\n    - attack.persistence\n    - attack.t1060\ndate: 2019/10/21\nmodified: 2019/11/10\nauthor: Victor Sergeev, Daniil Yugoslavskiy, oscd.community\nlogsource:\n    product: windows\n    service: sysmon\ndetection:\n    selection:\n        EventID: 13\n        TargetObject|contains:\n            - '\\software\\Microsoft\\Windows\\CurrentVersion\\Run'\n            - '\\software\\Microsoft\\Windows\\CurrentVersion\\RunOnce'\n            - '\\software\\Microsoft\\Windows\\CurrentVersion\\RunOnceEx'\n            - '\\software\\Microsoft\\Windows\\CurrentVersion\\RunServices'\n            - '\\software\\Microsoft\\Windows\\CurrentVersion\\RunServicesOnce'\n            - '\\software\\Microsoft\\Windows NT\\CurrentVersion\\Winlogon\\Userinit'\n            - '\\software\\Microsoft\\Windows NT\\CurrentVersion\\Winlogon\\Shell'\n            - '\\software\\Microsoft\\Windows NT\\CurrentVersion\\Windows'\n            - '\\software\\Microsoft\\Windows\\CurrentVersion\\Explorer\\User Shell Folders'\n    condition: selection\nfalsepositives:\n    - Legitimate software automatically (mostly, during installation) sets up autorun keys for legitimate reason\n    - Legitimate administrator sets up autorun keys for legitimate reason\nlevel: medium\n", "object_marking_refs": ["marking-definition--0a872d70-1d05-45dd-a25f-031af547a102"], "created_by_ref": "identity--082ca4f0-d825-45b6-aa42-ab9afd1e5503", "type": "indicator", "spec_version": "2.1", "id": "indicator--54d3c984-e92a-42d4-aa8d-715d9014f8f0"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--23d482e8-7284-403e-b68b-e7076223f0fe", "created": "2020-04-02T07:59:01.380Z", "modified": "2020-04-02T07:59:01.380Z", "source_ref": "indicator--54d3c984-e92a-42d4-aa8d-715d9014f8f0", "relationship_type": "indicates", "target_ref": "attack-pattern--9422fc14-1c43-410d-ab0f-a709b76c72dc"}, {"name": "WMI Persistence - Script Event Consumer File Write", "description": "Detects file writes of WMI script event consumer", "created": "2018-03-07T00:00:00.000Z", "valid_from": "2018-03-07T00:00:00Z", "indicator_types": ["malicious-activity"], "pattern_type": "sigma", "pattern": "title: WMI Persistence - Script Event Consumer File Write\nid: 33f41cdd-35ac-4ba8-814b-c6a4244a1ad4\nstatus: experimental\ndescription: Detects file writes of WMI script event consumer\nreferences:\n    - https://www.eideon.com/2018-03-02-THL03-WMIBackdoors/\nauthor: Thomas Patzke\ndate: 2018/03/07\ntags:\n    - attack.t1084\n    - attack.persistence\nlogsource:\n    product: windows\n    service: sysmon\ndetection:\n    selection:\n        EventID: 11\n        Image: 'C:\\WINDOWS\\system32\\wbem\\scrcons.exe'\n    condition: selection\nfalsepositives: \n    - Unknown (data set is too small; further testing needed)\nlevel: high\n", "object_marking_refs": ["marking-definition--0a872d70-1d05-45dd-a25f-031af547a102"], "created_by_ref": "identity--082ca4f0-d825-45b6-aa42-ab9afd1e5503", "type": "indicator", "spec_version": "2.1", "id": "indicator--8bdf3483-8f88-4a7c-8fcd-bbcbbdc69832", "modified": "2020-04-02T07:59:01.383Z"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--6b5edf4e-aeef-4bc8-aa1e-fa3e8a6c7d2d", "created": "2020-04-02T07:59:01.391Z", "modified": "2020-04-02T07:59:01.391Z", "source_ref": "indicator--8bdf3483-8f88-4a7c-8fcd-bbcbbdc69832", "relationship_type": "indicates", "target_ref": "attack-pattern--e906ae4d-1d3a-4675-be23-22f7311c0da4"}, {"name": "Rundll32 Internet Connection", "description": "Detects a rundll32 that communicates with public IP addresses", "created": "2017-11-04T00:00:00.000Z", "valid_from": "2017-11-04T00:00:00Z", "indicator_types": ["malicious-activity"], "pattern_type": "sigma", "pattern": "title: Rundll32 Internet Connection\nid: cdc8da7d-c303-42f8-b08c-b4ab47230263\nstatus: experimental\ndescription: Detects a rundll32 that communicates with public IP addresses\nreferences:\n    - https://www.hybrid-analysis.com/sample/759fb4c0091a78c5ee035715afe3084686a8493f39014aea72dae36869de9ff6?environmentId=100\nauthor: Florian Roth\ndate: 2017/11/04\ntags:\n    - attack.t1085\n    - attack.defense_evasion\n    - attack.execution\nlogsource:\n    product: windows\n    service: sysmon\ndetection:\n    selection:\n        EventID: 3\n        Image: '*\\rundll32.exe'\n        Initiated: 'true'\n    filter:\n        DestinationIp: \n            - '10.*'\n            - '192.168.*'\n            - '172.16.*'\n            - '172.17.*'\n            - '172.18.*'\n            - '172.19.*'\n            - '172.20.*'\n            - '172.21.*'\n            - '172.22.*'\n            - '172.23.*'\n            - '172.24.*'\n            - '172.25.*'\n            - '172.26.*'\n            - '172.27.*'\n            - '172.28.*'\n            - '172.29.*'\n            - '172.30.*'\n            - '172.31.*'\n            - '127.*'\n    condition: selection and not filter\nfalsepositives:\n    - Communication to other corporate systems that use IP addresses from public address spaces\nlevel: medium\n", "object_marking_refs": ["marking-definition--0a872d70-1d05-45dd-a25f-031af547a102"], "created_by_ref": "identity--082ca4f0-d825-45b6-aa42-ab9afd1e5503", "type": "indicator", "spec_version": "2.1", "id": "indicator--dd3eec5e-f951-4d7b-aabf-b88fb6198892", "modified": "2020-04-02T07:59:01.395Z"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--c636494b-8d34-420f-9cb9-030cc9e45e2f", "created": "2020-04-02T07:59:01.406Z", "modified": "2020-04-02T07:59:01.406Z", "source_ref": "indicator--dd3eec5e-f951-4d7b-aabf-b88fb6198892", "relationship_type": "indicates", "target_ref": "attack-pattern--62b8c999-dcc0-4755-bd69-09442d9359f5"}, {"name": "Svchost DLL Search Order Hijack", "description": "IKEEXT and SessionEnv service, as they call LoadLibrary on files that do not exist within C:\\Windows\\System32\\ by default. An attacker can place their malicious logic within the PROCESS_ATTACH block of their library and restart the aforementioned services \"svchost.exe -k netsvcs\" to gain code execution on a remote machine.", "created": "2019-10-28T00:00:00.000Z", "valid_from": "2019-10-28T00:00:00Z", "indicator_types": ["malicious-activity"], "pattern_type": "sigma", "pattern": "title: Svchost DLL Search Order Hijack\nid: 602a1f13-c640-4d73-b053-be9a2fa58b77\nstatus: experimental\ndescription: IKEEXT and SessionEnv service, as they call LoadLibrary on files that do not exist within C:\\Windows\\System32\\ by default. An attacker can place their\n    malicious logic within the PROCESS_ATTACH block of their library and restart the aforementioned services \"svchost.exe -k netsvcs\" to gain code execution on a\n    remote machine.\nreferences:\n    - https://posts.specterops.io/lateral-movement-scm-and-dll-hijacking-primer-d2f61e8ab992\nauthor: SBousseaden\ndate: 2019/10/28\ntags:\n    - attack.persistence\n    - attack.defense_evasion\n    - attack.t1073\n    - attack.t1038\n    - attack.t1112\nlogsource:\n    product: windows\n    service: sysmon\ndetection:\n    selection:\n        EventID: 7\n        Image:\n            - '*\\svchost.exe'\n        ImageLoaded:\n            - '*\\tsmsisrv.dll'\n            - '*\\tsvipsrv.dll'\n            - '*\\wlbsctrl.dll'\n    filter:\n        EventID: 7\n        Image:\n            - '*\\svchost.exe'\n        ImageLoaded:\n            - 'C:\\Windows\\WinSxS\\*'        \n    condition: selection and not filter\nfalsepositives:\n    - Pentest\nlevel: high", "object_marking_refs": ["marking-definition--0a872d70-1d05-45dd-a25f-031af547a102"], "created_by_ref": "identity--082ca4f0-d825-45b6-aa42-ab9afd1e5503", "type": "indicator", "spec_version": "2.1", "id": "indicator--b514938d-0819-47f9-b21a-c593f2f654e1", "modified": "2020-04-02T07:59:01.411Z"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--4b03d492-fa82-4666-9a22-9f56fb7939fd", "created": "2020-04-02T07:59:01.419Z", "modified": "2020-04-02T07:59:01.419Z", "source_ref": "indicator--b514938d-0819-47f9-b21a-c593f2f654e1", "relationship_type": "indicates", "target_ref": "attack-pattern--b2001907-166b-4d71-bb3c-9d26c871de09"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--f3328be7-4081-4b03-9cdc-6476ce387ea3", "created": "2020-04-02T07:59:01.427Z", "modified": "2020-04-02T07:59:01.427Z", "source_ref": "indicator--b514938d-0819-47f9-b21a-c593f2f654e1", "relationship_type": "indicates", "target_ref": "attack-pattern--46944654-fcc1-4f63-9dad-628102376586"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--3f89cb08-43b3-428a-84ea-db21b17ed6a0", "created": "2020-04-02T07:59:01.437Z", "modified": "2020-04-02T07:59:01.437Z", "source_ref": "indicator--b514938d-0819-47f9-b21a-c593f2f654e1", "relationship_type": "indicates", "target_ref": "attack-pattern--57340c81-c025-4189-8fa0-fc7ede51bae4"}, {"name": "Malicious Named Pipe", "description": "Detects the creation of a named pipe used by known APT malware", "created": "2017-11-06T00:00:00.000Z", "valid_from": "2017-11-06T00:00:00Z", "indicator_types": ["malicious-activity"], "pattern_type": "sigma", "pattern": "title: Malicious Named Pipe\nid: fe3ac066-98bb-432a-b1e7-a5229cb39d4a\nstatus: experimental\ndescription: Detects the creation of a named pipe used by known APT malware\nreferences:\n    - Various sources\ndate: 2017/11/06\nauthor: Florian Roth\nlogsource:\n   product: windows\n   service: sysmon\n   definition: 'Note that you have to configure logging for PipeEvents in Symson config'\ndetection:\n   selection:\n      EventID: \n         - 17\n         - 18\n      PipeName: \n         - '\\isapi_http'  # Uroburos Malware Named Pipe\n         - '\\isapi_dg'  # Uroburos Malware Named Pipe\n         - '\\isapi_dg2'  # Uroburos Malware Named Pipe\n         - '\\sdlrpc'  # Cobra Trojan Named Pipe http://goo.gl/8rOZUX\n         - '\\ahexec'  # Sofacy group malware\n         - '\\winsession'  # Wild Neutron APT malware https://goo.gl/pivRZJ\n         - '\\lsassw'  # Wild Neutron APT malware https://goo.gl/pivRZJ\n         - '\\46a676ab7f179e511e30dd2dc41bd388'  # Project Sauron https://goo.gl/eFoP4A\n         - '\\9f81f59bc58452127884ce513865ed20'  # Project Sauron https://goo.gl/eFoP4A\n         - '\\e710f28d59aa529d6792ca6ff0ca1b34'  # Project Sauron https://goo.gl/eFoP4A\n         - '\\rpchlp_3'  # Project Sauron https://goo.gl/eFoP4A - Technical Analysis Input\n         - '\\NamePipe_MoreWindows'  # Cloud Hopper Annex B https://www.pwc.co.uk/cyber-security/pdf/cloud-hopper-annex-b-final.pdf, US-CERT Alert - RedLeaves https://www.us-cert.gov/ncas/alerts/TA17-117A\n         - '\\pcheap_reuse'  # Pipe used by Equation Group malware 77486bb828dba77099785feda0ca1d4f33ad0d39b672190079c508b3feb21fb0\n         - '\\msagent_*'  # CS default named pipes https://github.com/Neo23x0/sigma/issues/253\n         - '\\gruntsvc' # Covenant default named pipe\n         # - '\\status_*'  # CS default named pipes https://github.com/Neo23x0/sigma/issues/253\n   condition: selection\ntags:\n    - attack.defense_evasion\n    - attack.privilege_escalation\n    - attack.t1055\nfalsepositives:\n   - Unkown\nlevel: critical\n", "object_marking_refs": ["marking-definition--0a872d70-1d05-45dd-a25f-031af547a102"], "created_by_ref": "identity--082ca4f0-d825-45b6-aa42-ab9afd1e5503", "type": "indicator", "spec_version": "2.1", "id": "indicator--c4814dda-1d53-42a0-966b-360aae76a4f1", "modified": "2020-04-02T07:59:01.445Z"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--f8d7d634-0d8d-455c-a431-5a46deda432c", "created": "2020-04-02T07:59:01.454Z", "modified": "2020-04-02T07:59:01.454Z", "source_ref": "indicator--c4814dda-1d53-42a0-966b-360aae76a4f1", "relationship_type": "indicates", "target_ref": "attack-pattern--43e7dc91-05b2-474c-b9ac-2ed4fe101f4d"}, {"name": "PowerShell Execution", "description": "Detects execution of PowerShell", "created": "2019-09-12T00:00:00.000Z", "modified": "2019-11-10T00:00:00.000Z", "valid_from": "2019-09-12T00:00:00Z", "indicator_types": ["malicious-activity"], "pattern_type": "sigma", "pattern": "title: PowerShell Execution\nid: 867613fb-fa60-4497-a017-a82df74a172c\ndescription: Detects execution of PowerShell\nstatus: experimental\ndate: 2019/09/12\nmodified: 2019/11/10\nauthor: Roberto Rodriguez @Cyb3rWard0g\nreferences:\n    - https://github.com/hunters-forge/ThreatHunter-Playbook/blob/8869b7a58dba1cff63bae1d7ab923974b8c0539b/playbooks/WIN-190410151110.yaml\nlogsource:\n    product: windows\n    service: sysmon\ntags:\n    - attack.execution\n    - attack.t1086\ndetection:\n    selection: \n        EventID: 7\n        Description: 'system.management.automation'\n        ImageLoaded|contains: 'system.management.automation'\n    condition: selection\nfields:\n    - ComputerName\n    - Image\n    - ProcessID\n    - ImageLoaded\nfalsepositives:\n    - Unknown\nlevel: medium\n", "object_marking_refs": ["marking-definition--0a872d70-1d05-45dd-a25f-031af547a102"], "created_by_ref": "identity--082ca4f0-d825-45b6-aa42-ab9afd1e5503", "type": "indicator", "spec_version": "2.1", "id": "indicator--3b9b9c8d-b9af-44fc-ad98-cb6d04119ed4"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--d5681bc9-859f-4073-b09b-4706bb95e625", "created": "2020-04-02T07:59:01.467Z", "modified": "2020-04-02T07:59:01.467Z", "source_ref": "indicator--3b9b9c8d-b9af-44fc-ad98-cb6d04119ed4", "relationship_type": "indicates", "target_ref": "attack-pattern--f4882e23-8aa7-4b12-b28a-b349c12ee9e0"}, {"name": "CreateRemoteThread API and LoadLibrary", "description": "Detects potential use of CreateRemoteThread api and LoadLibrary function to inject DLL into a process", "created": "2019-08-11T00:00:00.000Z", "modified": "2019-11-10T00:00:00.000Z", "valid_from": "2019-08-11T00:00:00Z", "indicator_types": ["malicious-activity"], "pattern_type": "sigma", "pattern": "title: CreateRemoteThread API and LoadLibrary\nid: 052ec6f6-1adc-41e6-907a-f1c813478bee\ndescription: Detects potential use of CreateRemoteThread api and LoadLibrary function to inject DLL into a process\nstatus: experimental\ndate: 2019/08/11\nmodified: 2019/11/10\nauthor: Roberto Rodriguez @Cyb3rWard0g\nreferences:\n    - https://github.com/Cyb3rWard0g/ThreatHunter-Playbook/tree/master/playbooks/windows/05_defense_evasion/T1055_process_injection/dll_injection_createremotethread_loadlibrary.md\ntags:\n    - attack.defense_evasion\n    - attack.t1055\nlogsource:\n    product: windows\n    service: sysmon\ndetection:\n    selection: \n        EventID: 8\n        StartModule|endswith: '\\kernel32.dll'\n        StartFunction: 'LoadLibraryA'\n    condition: selection\nfalsepositives:\n    - Unknown\nlevel: critical\n", "object_marking_refs": ["marking-definition--0a872d70-1d05-45dd-a25f-031af547a102"], "created_by_ref": "identity--082ca4f0-d825-45b6-aa42-ab9afd1e5503", "type": "indicator", "spec_version": "2.1", "id": "indicator--4716bd24-195a-44ca-817e-7895ee4a4538"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--39221865-87e6-41b5-99ce-b1bfb4e4a952", "created": "2020-04-02T07:59:01.483Z", "modified": "2020-04-02T07:59:01.483Z", "source_ref": "indicator--4716bd24-195a-44ca-817e-7895ee4a4538", "relationship_type": "indicates", "target_ref": "attack-pattern--43e7dc91-05b2-474c-b9ac-2ed4fe101f4d"}, {"name": "Windows Registry Persistence COM Key Linking", "description": "Detects COM object hijacking via TreatAs subkey", "created": "2019-10-23T00:00:00.000Z", "modified": "2019-11-07T00:00:00.000Z", "valid_from": "2019-10-23T00:00:00Z", "indicator_types": ["malicious-activity"], "pattern_type": "sigma", "pattern": "title: Windows Registry Persistence COM Key Linking\nid: 9b0f8a61-91b2-464f-aceb-0527e0a45020\nstatus: experimental\ndescription: Detects COM object hijacking via TreatAs subkey\nreferences:\n    - https://bohops.com/2018/08/18/abusing-the-com-registry-structure-part-2-loading-techniques-for-evasion-and-persistence/\nauthor: Kutepov Anton, oscd.community\ndate: 2019/10/23\nmodified: 2019/11/07\ntags:\n    - attack.persistence\n    - attack.t1122\nlogsource:\n    product: windows\n    service: sysmon\ndetection:\n    selection:\n        EventID: 12\n        TargetObject: 'HKU\\\\*_Classes\\CLSID\\\\*\\TreatAs'\n    condition: selection\nfalsepositives:\n    - Maybe some system utilities in rare cases use linking keys for backward compability\nlevel: medium\n", "object_marking_refs": ["marking-definition--0a872d70-1d05-45dd-a25f-031af547a102"], "created_by_ref": "identity--082ca4f0-d825-45b6-aa42-ab9afd1e5503", "type": "indicator", "spec_version": "2.1", "id": "indicator--8f0bc82c-1e25-42ba-a734-94052bf08ea5"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--c2953039-0197-453e-82a7-b0e966a49c38", "created": "2020-04-02T07:59:01.507Z", "modified": "2020-04-02T07:59:01.507Z", "source_ref": "indicator--8f0bc82c-1e25-42ba-a734-94052bf08ea5", "relationship_type": "indicates", "target_ref": "attack-pattern--9b52fca7-1a36-4da0-b62d-da5bd83b4d69"}, {"name": "Credentials Dumping Tools Accessing LSASS Memory", "description": "Detects process access LSASS memory which is typical for credentials dumping tools", "created": "2017-02-16T00:00:00.000Z", "modified": "2019-11-08T00:00:00.000Z", "valid_from": "2017-02-16T00:00:00Z", "indicator_types": ["malicious-activity"], "pattern_type": "sigma", "pattern": "title: Credentials Dumping Tools Accessing LSASS Memory\nid: 32d0d3e2-e58d-4d41-926b-18b520b2b32d\nstatus: experimental\ndescription: Detects process access LSASS memory which is typical for credentials dumping tools\nauthor: Florian Roth, Roberto Rodriguez, Dimitrios Slamaris, Mark Russinovich, Thomas Patzke, Teymur Kheirkhabarov, Sherif Eldeeb, James Dickenson, Aleksey Potapov,\n    oscd.community (update)\ndate: 2017/02/16\nmodified: 2019/11/08\nreferences:\n    - https://onedrive.live.com/view.aspx?resid=D026B4699190F1E6!2843&ithint=file%2cpptx&app=PowerPoint&authkey=!AMvCRTKB_V1J5ow\n    - https://cyberwardog.blogspot.com/2017/03/chronicles-of-threat-hunter-hunting-for_22.html\n    - https://www.slideshare.net/heirhabarov/hunting-for-credentials-dumping-in-windows-environment\n    - http://security-research.dyndns.org/pub/slides/FIRST2017/FIRST-2017_Tom-Ueltschi_Sysmon_FINAL_notes.pdf\ntags:\n    - attack.t1003\n    - attack.s0002\n    - attack.credential_access\n    - car.2019-04-004\nlogsource:\n    product: windows\n    service: sysmon\ndetection:\n    selection:\n        EventID: 10\n        TargetImage|endswith: '\\lsass.exe'\n        GrantedAccess|contains:\n            - '0x40'\n            - '0x1000'\n            - '0x1400'\n            - '0x100000'\n            - '0x1410'    # car.2019-04-004\n            - '0x1010'    # car.2019-04-004\n            - '0x1438'    # car.2019-04-004\n            - '0x143a'    # car.2019-04-004\n            - '0x1418'    # car.2019-04-004\n            - '0x1f0fff'\n            - '0x1f1fff'\n            - '0x1f2fff'\n            - '0x1f3fff'\n    filter:\n        ProcessName|endswith: # easy to bypass. need to implement supportive rule to detect bypass attempts\n            - '\\wmiprvse.exe'\n            - '\\taskmgr.exe'\n            - '\\procexp64.exe'\n            - '\\procexp.exe'\n            - '\\lsm.exe'\n            - '\\csrss.exe'\n            - '\\wininit.exe'\n            - '\\vmtoolsd.exe'\n    condition: selection and not filter\nfields:\n    - ComputerName\n    - User\n    - SourceImage\nfalsepositives:\n    - Legitimate software accessing LSASS process for legitimate reason; update the whitelist with it\nlevel: high\n", "object_marking_refs": ["marking-definition--0a872d70-1d05-45dd-a25f-031af547a102"], "created_by_ref": "identity--082ca4f0-d825-45b6-aa42-ab9afd1e5503", "type": "indicator", "spec_version": "2.1", "id": "indicator--8c147669-a2a9-492e-848f-1f78c62601c5"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--ad9b3e38-9191-440a-a996-a445d098fc73", "created": "2020-04-02T07:59:01.534Z", "modified": "2020-04-02T07:59:01.534Z", "source_ref": "indicator--8c147669-a2a9-492e-848f-1f78c62601c5", "relationship_type": "indicates", "target_ref": "attack-pattern--0a3ead4e-6d47-4ccb-854c-a6a4f9d96b22"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--ad81c2d2-2faf-4351-b413-2025f0b34c19", "created": "2020-04-02T07:59:01.552Z", "modified": "2020-04-02T07:59:01.552Z", "source_ref": "indicator--8c147669-a2a9-492e-848f-1f78c62601c5", "relationship_type": "indicates", "target_ref": "tool--afc079f3-c0ea-4096-b75d-3f05338b7f60"}, {"name": "Registry Persistence via Explorer Run Key", "description": "Detects a possible persistence mechanism using RUN key for Windows Explorer and pointing to a suspicious folder", "created": "2018-07-18T00:00:00.000Z", "valid_from": "2018-07-18T00:00:00Z", "indicator_types": ["malicious-activity"], "pattern_type": "sigma", "pattern": "title: Registry Persistence via Explorer Run Key\nid: b7916c2a-fa2f-4795-9477-32b731f70f11\nstatus: experimental\ndescription: Detects a possible persistence mechanism using RUN key for Windows Explorer and pointing to a suspicious folder\nauthor: Florian Roth\ndate: 2018/07/18\nreferences:\n    - https://researchcenter.paloaltonetworks.com/2018/07/unit42-upatre-continues-evolve-new-anti-analysis-techniques/\nlogsource:\n    product: windows\n    service: sysmon\ndetection:\n    selection:\n        EventID: 13\n        TargetObject: '*\\Microsoft\\Windows\\CurrentVersion\\Policies\\Explorer\\Run'\n        Details: \n            - 'C:\\Windows\\Temp\\\\*'\n            - 'C:\\ProgramData\\\\*'\n            - '*\\AppData\\\\*'\n            - 'C:\\$Recycle.bin\\\\*'\n            - 'C:\\Temp\\\\*'\n            - 'C:\\Users\\Public\\\\*'\n            - 'C:\\Users\\Default\\\\*'\n    condition: selection\ntags:\n    - attack.persistence\n    - attack.t1060\n    - capec.270\nfields:\n    - Image\n    - ParentImage\nfalsepositives:\n    - Unknown\nlevel: high\n\n", "object_marking_refs": ["marking-definition--0a872d70-1d05-45dd-a25f-031af547a102"], "created_by_ref": "identity--082ca4f0-d825-45b6-aa42-ab9afd1e5503", "type": "indicator", "spec_version": "2.1", "id": "indicator--c28857cd-dfd1-479f-8a0a-b6241ab19860", "modified": "2020-04-02T07:59:01.559Z"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--92bcc8ed-64a0-4ff9-ac1c-0d386704a592", "created": "2020-04-02T07:59:01.576Z", "modified": "2020-04-02T07:59:01.576Z", "source_ref": "indicator--c28857cd-dfd1-479f-8a0a-b6241ab19860", "relationship_type": "indicates", "target_ref": "attack-pattern--9422fc14-1c43-410d-ab0f-a709b76c72dc"}, {"name": "Alternate PowerShell Hosts Module Load", "description": "Detects alternate PowerShell hosts potentially bypassing detections looking for powershell.exe", "created": "2019-09-12T00:00:00.000Z", "modified": "2019-11-10T00:00:00.000Z", "valid_from": "2019-09-12T00:00:00Z", "indicator_types": ["malicious-activity"], "pattern_type": "sigma", "pattern": "title: Alternate PowerShell Hosts Module Load\nid: f67f6c57-257d-4919-a416-69cd31f9aac3\ndescription: Detects alternate PowerShell hosts potentially bypassing detections looking for powershell.exe\nstatus: experimental\ndate: 2019/09/12\nmodified: 2019/11/10\nauthor: Roberto Rodriguez @Cyb3rWard0g\nreferences:\n    - https://github.com/Cyb3rWard0g/ThreatHunter-Playbook/tree/master/playbooks/windows/02_execution/T1086_powershell/alternate_signed_powershell_hosts.md\ntags:\n    - attack.execution\n    - attack.t1086\nlogsource:\n    product: windows\n    service: sysmon\ndetection:\n    selection: \n        EventID: 7\n        Description: 'system.management.automation'\n        ImageLoaded|contains: 'system.management.automation'\n    filter:\n        Image|endswith: '\\powershell.exe'\n    condition: selection and not filter\nfalsepositives:\n    - Programs using PowerShell directly without invocation of a dedicated interpreter.\nlevel: high\n", "object_marking_refs": ["marking-definition--0a872d70-1d05-45dd-a25f-031af547a102"], "created_by_ref": "identity--082ca4f0-d825-45b6-aa42-ab9afd1e5503", "type": "indicator", "spec_version": "2.1", "id": "indicator--fcd65c88-649d-4986-997b-cc9ab9d85811"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--65afc7c8-2061-498e-8c4d-ee7ba39e87ad", "created": "2020-04-02T07:59:01.598Z", "modified": "2020-04-02T07:59:01.598Z", "source_ref": "indicator--fcd65c88-649d-4986-997b-cc9ab9d85811", "relationship_type": "indicates", "target_ref": "attack-pattern--f4882e23-8aa7-4b12-b28a-b349c12ee9e0"}, {"name": "Windows Mangement Instrumentation DLL Loaded Via Microsoft Word", "description": "Detects DLL's Loaded Via Word Containing VBA Macros Executing WMI Commands", "created": "2019-12-26T00:00:00.000Z", "valid_from": "2019-12-26T00:00:00Z", "indicator_types": ["malicious-activity"], "pattern_type": "sigma", "pattern": "title: Windows Mangement Instrumentation DLL Loaded Via Microsoft Word\nid: a457f232-7df9-491d-898f-b5aabd2cbe2f\nstatus: experimental\ndescription: Detects DLL's Loaded Via Word Containing VBA Macros Executing WMI Commands\nreferences:\n    - https://medium.com/threatpunter/detecting-adversary-tradecraft-with-image-load-event-logging-and-eql-8de93338c16\n    - https://www.carbonblack.com/2019/04/24/cb-tau-threat-intelligence-notification-emotet-utilizing-wmi-to-launch-powershell-encoded-code/\n    - https://media.cert.europa.eu/static/SecurityAdvisories/2019/CERT-EU-SA2019-021.pdf\nauthor: Michael R. (@nahamike01)\ndate: 2019/12/26\ntags:\n    - attack.execution\n    - attack.t1047\nlogsource:\n    product: windows\n    service: sysmon\ndetection:\n    selection:\n        EventID: 7\n        Image:\n            - '*\\winword.exe'\n            - '*\\powerpnt.exe'\n            - '*\\excel.exe'\n            - '*\\outlook.exe'\n        ImageLoaded:\n            - '*\\wmiutils.dll'\n            - '*\\wbemcomn.dll'\n            - '*\\wbemprox.dll'\n            - '*\\wbemdisp.dll'\n            - '*\\wbemsvc.dll'\n    condition: selection\nfalsepositives:\n    - Possible. Requires further testing.\nlevel: high\n", "object_marking_refs": ["marking-definition--0a872d70-1d05-45dd-a25f-031af547a102"], "created_by_ref": "identity--082ca4f0-d825-45b6-aa42-ab9afd1e5503", "type": "indicator", "spec_version": "2.1", "id": "indicator--0ce4d6b8-e1d3-4a7b-954c-9d213d4decac", "modified": "2020-04-02T07:59:01.611Z"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--56e2dc3a-391c-4f65-a972-b140ae9b3c7f", "created": "2020-04-02T07:59:01.625Z", "modified": "2020-04-02T07:59:01.625Z", "source_ref": "indicator--0ce4d6b8-e1d3-4a7b-954c-9d213d4decac", "relationship_type": "indicates", "target_ref": "attack-pattern--01a5a209-b94c-450b-b7f9-946497d91055"}, {"name": "Possible Process Hollowing Image Loading", "description": "Detects Loading of samlib.dll, WinSCard.dll from untypical process e.g. through process hollowing by Mimikatz", "created": "2018-01-07T00:00:00.000Z", "valid_from": "2018-01-07T00:00:00Z", "indicator_types": ["malicious-activity"], "pattern_type": "sigma", "pattern": "title: Possible Process Hollowing Image Loading\nid: e32ce4f5-46c6-4c47-ba69-5de3c9193cd7\nstatus: experimental\ndescription: Detects Loading of samlib.dll, WinSCard.dll from untypical process e.g. through process hollowing by Mimikatz\nreferences:\n    - https://cyberwardog.blogspot.com/2017/03/chronicles-of-threat-hunter-hunting-for.html\nauthor: Markus Neis\ndate: 2018/01/07\ntags:\n    - attack.defense_evasion\n    - attack.t1073\nlogsource:\n    product: windows\n    service: sysmon\ndetection:\n    selection:\n        EventID: 7\n        Image:\n            - '*\\notepad.exe'\n        ImageLoaded:\n            - '*\\samlib.dll'\n            - '*\\WinSCard.dll'\n    condition: selection\nfalsepositives:\n    - Very likely, needs more tuning\nlevel: high\n", "object_marking_refs": ["marking-definition--0a872d70-1d05-45dd-a25f-031af547a102"], "created_by_ref": "identity--082ca4f0-d825-45b6-aa42-ab9afd1e5503", "type": "indicator", "spec_version": "2.1", "id": "indicator--139d6fbe-f5fb-4d3d-ab1e-7a45fc6813ca", "modified": "2020-04-02T07:59:01.629Z"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--49b72c3f-13cd-4c6a-9ed8-0ffd27a0805e", "created": "2020-04-02T07:59:01.641Z", "modified": "2020-04-02T07:59:01.641Z", "source_ref": "indicator--139d6fbe-f5fb-4d3d-ab1e-7a45fc6813ca", "relationship_type": "indicates", "target_ref": "attack-pattern--b2001907-166b-4d71-bb3c-9d26c871de09"}, {"name": "Unsigned Image Loaded Into LSASS Process", "description": "Loading unsigned image (DLL, EXE) into LSASS process", "created": "2019-10-22T00:00:00.000Z", "modified": "2019-11-13T00:00:00.000Z", "valid_from": "2019-10-22T00:00:00Z", "indicator_types": ["malicious-activity"], "pattern_type": "sigma", "pattern": "title: Unsigned Image Loaded Into LSASS Process\nid: 857c8db3-c89b-42fb-882b-f681c7cf4da2\ndescription: Loading unsigned image (DLL, EXE) into LSASS process\nauthor: Teymur Kheirkhabarov, oscd.community\ndate: 2019/10/22\nmodified: 2019/11/13\nreferences:\n    - https://www.slideshare.net/heirhabarov/hunting-for-credentials-dumping-in-windows-environment\ntags:\n    - attack.credential_access\n    - attack.t1003\nlogsource:\n    product: windows\n    service: sysmon\ndetection:\n    selection:\n        EventID: 7\n        Image|endswith: '\\lsass.exe'\n        Signed: 'false'\n    condition: selection\nfalsepositives:\n    - Valid user connecting using RDP\nstatus: experimental\nlevel: medium\n", "object_marking_refs": ["marking-definition--0a872d70-1d05-45dd-a25f-031af547a102"], "created_by_ref": "identity--082ca4f0-d825-45b6-aa42-ab9afd1e5503", "type": "indicator", "spec_version": "2.1", "id": "indicator--249a8e2f-8504-4728-8094-cfd2169c3fd7"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--40da899f-a56e-424c-9c4c-1e31d394cd2a", "created": "2020-04-02T07:59:01.656Z", "modified": "2020-04-02T07:59:01.656Z", "source_ref": "indicator--249a8e2f-8504-4728-8094-cfd2169c3fd7", "relationship_type": "indicates", "target_ref": "attack-pattern--0a3ead4e-6d47-4ccb-854c-a6a4f9d96b22"}, {"name": "Suspicious RUN Key from Download", "description": "Detects the suspicious RUN keys created by software located in Download or temporary Outlook/Internet Explorer directories", "created": "2019-10-01T00:00:00.000Z", "valid_from": "2019-10-01T00:00:00Z", "indicator_types": ["malicious-activity"], "pattern_type": "sigma", "pattern": "title: Suspicious RUN Key from Download\nid: 9c5037d1-c568-49b3-88c7-9846a5bdc2be\nstatus: experimental\ndescription: Detects the suspicious RUN keys created by software located in Download or temporary Outlook/Internet Explorer directories\nreferences:\n    - https://app.any.run/tasks/c5bef5b7-f484-4c43-9cf3-d5c5c7839def/\nauthor: Florian Roth\ndate: 2019/10/01\ntags:\n    - attack.persistence\n    - attack.t1060\nlogsource:\n    product: windows\n    service: sysmon\ndetection:\n    selection:\n        EventID: 13\n        Image: \n            - '*\\Downloads\\\\*'\n            - '*\\Temporary Internet Files\\Content.Outlook\\\\*'\n            - '*\\Local Settings\\Temporary Internet Files\\\\*'\n        TargetObject: '*\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run\\\\*'\n    condition: selection\nfalsepositives:\n    - Software installers downloaded and used by users\nlevel: high", "object_marking_refs": ["marking-definition--0a872d70-1d05-45dd-a25f-031af547a102"], "created_by_ref": "identity--082ca4f0-d825-45b6-aa42-ab9afd1e5503", "type": "indicator", "spec_version": "2.1", "id": "indicator--4a840397-55a0-4bb0-bb0b-ed507985049a", "modified": "2020-04-02T07:59:01.665Z"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--8bc1876b-6e75-4546-ac84-8446ad8575b1", "created": "2020-04-02T07:59:01.678Z", "modified": "2020-04-02T07:59:01.678Z", "source_ref": "indicator--4a840397-55a0-4bb0-bb0b-ed507985049a", "relationship_type": "indicates", "target_ref": "attack-pattern--9422fc14-1c43-410d-ab0f-a709b76c72dc"}, {"name": "Suspicious Remote Thread Created", "description": "Offensive tradecraft is switching away from using APIs like \"CreateRemoteThread\", however, this is still largely observed in the wild. This rule aims to detect suspicious processes (those we would not expect to behave in this way like word.exe or outlook.exe) creating remote threads on other processes. It is a generalistic rule, but it should have a low FP ratio due to the selected range of processes.", "created": "2019-10-27T00:00:00.000Z", "modified": "2019-11-13T00:00:00.000Z", "valid_from": "2019-10-27T00:00:00Z", "indicator_types": ["malicious-activity"], "pattern_type": "sigma", "pattern": "title: Suspicious Remote Thread Created\nid: 66d31e5f-52d6-40a4-9615-002d3789a119\ndescription: Offensive tradecraft is switching away from using APIs like \"CreateRemoteThread\", however, this is still largely observed in the wild. This rule aims\n    to detect suspicious processes (those we would not expect to behave in this way like word.exe or outlook.exe) creating remote threads on other processes. It is\n    a generalistic rule, but it should have a low FP ratio due to the selected range of processes.\nnotes:\n    - MonitoringHost.exe is a process that loads .NET CLR by default and thus a favorite for process injection for .NET in-memory offensive tools.\nstatus: experimental\ndate: 2019/10/27\nmodified: 2019/11/13\nauthor: Perez Diego (@darkquassar), oscd.community\nreferences:\n    - Personal research, statistical analysis\n    - https://lolbas-project.github.io\nlogsource:\n    product: windows\n    service: sysmon\ntags:\n    - attack.privilege_escalation\n    - attack.t1055\ndetection:\n    selection: \n        EventID: 8\n        SourceImage|endswith:\n            - '\\bash.exe'\n            - '\\cvtres.exe'\n            - '\\defrag.exe'\n            - '\\dnx.exe'\n            - '\\esentutl.exe'\n            - '\\excel.exe'\n            - '\\expand.exe'\n            - '\\explorer.exe'\n            - '\\find.exe'\n            - '\\findstr.exe'\n            - '\\forfiles.exe'\n            - '\\git.exe'\n            - '\\gpupdate.exe'\n            - '\\hh.exe'\n            - '\\iexplore.exe'\n            - '\\installutil.exe'\n            - '\\lync.exe'\n            - '\\makecab.exe'\n            - '\\mDNSResponder.exe'\n            - '\\monitoringhost.exe'\n            - '\\msbuild.exe'\n            - '\\mshta.exe'\n            - '\\msiexec.exe'\n            - '\\mspaint.exe'\n            - '\\outlook.exe'\n            - '\\ping.exe'\n            - '\\powerpnt.exe'\n            - '\\powershell.exe'\n            - '\\provtool.exe'\n            - '\\python.exe'\n            - '\\regsvr32.exe'\n            - '\\robocopy.exe'\n            - '\\runonce.exe'\n            - '\\sapcimc.exe'\n            - '\\schtasks.exe'\n            - '\\smartscreen.exe'\n            - '\\spoolsv.exe'\n            # - '\\taskhost.exe'  # disabled due to false positives\n            - '\\tstheme.exe'\n            - '\\userinit.exe'\n            - '\\vssadmin.exe'\n            - '\\vssvc.exe'\n            - '\\w3wp.exe*'       \n            - '\\winlogon.exe'\n            - '\\winscp.exe'\n            - '\\wmic.exe'\n            - '\\word.exe'\n            - '\\wscript.exe'\n    filter:\n        SourceImage|contains: 'Visual Studio'\n    condition: selection AND NOT filter\nfields:\n    - ComputerName\n    - User\n    - SourceImage\n    - TargetImage\nlevel: high\nfalsepositives:\n    - Unknown\n", "object_marking_refs": ["marking-definition--0a872d70-1d05-45dd-a25f-031af547a102"], "created_by_ref": "identity--082ca4f0-d825-45b6-aa42-ab9afd1e5503", "type": "indicator", "spec_version": "2.1", "id": "indicator--f0348c0f-bbe2-4dca-848c-51e5016e64d2"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--e276f3cd-695e-439b-accd-32fe96b96f07", "created": "2020-04-02T07:59:01.699Z", "modified": "2020-04-02T07:59:01.699Z", "source_ref": "indicator--f0348c0f-bbe2-4dca-848c-51e5016e64d2", "relationship_type": "indicates", "target_ref": "attack-pattern--43e7dc91-05b2-474c-b9ac-2ed4fe101f4d"}, {"name": "DLL Load via LSASS", "description": "Detects a method to load DLL via LSASS process using an undocumented Registry key", "created": "2019-10-16T00:00:00.000Z", "valid_from": "2019-10-16T00:00:00Z", "indicator_types": ["malicious-activity"], "pattern_type": "sigma", "pattern": "title: DLL Load via LSASS\nid: b3503044-60ce-4bf4-bbcb-e3db98788823\nstatus: experimental\ndescription: Detects a method to load DLL via LSASS process using an undocumented Registry key\nauthor: Florian Roth\ndate: 2019/10/16\nreferences:\n    - https://blog.xpnsec.com/exploring-mimikatz-part-1/\n    - https://twitter.com/SBousseaden/status/1183745981189427200\nlogsource:\n    product: windows\n    service: sysmon\ndetection:\n    selection:\n        EventID:\n            - 12 \n            - 13\n        TargetObject: \n            - '*\\CurrentControlSet\\Services\\NTDS\\DirectoryServiceExtPt*'\n            - '*\\CurrentControlSet\\Services\\NTDS\\LsaDbExtPt*'\n    condition: selection\ntags:\n    - attack.execution\n    - attack.t1177\nfalsepositives:\n    - Unknown\nlevel: high\n\n", "object_marking_refs": ["marking-definition--0a872d70-1d05-45dd-a25f-031af547a102"], "created_by_ref": "identity--082ca4f0-d825-45b6-aa42-ab9afd1e5503", "type": "indicator", "spec_version": "2.1", "id": "indicator--f2ba32c7-439f-41ed-85ac-d8a33b7d333f", "modified": "2020-04-02T07:59:01.704Z"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--d4616e71-cd72-467b-b543-e734a20133fe", "created": "2020-04-02T07:59:01.714Z", "modified": "2020-04-02T07:59:01.714Z", "source_ref": "indicator--f2ba32c7-439f-41ed-85ac-d8a33b7d333f", "relationship_type": "indicates", "target_ref": "attack-pattern--6e6845c2-347a-4a6f-a2d1-b74a18ebd352"}, {"name": "RDP Registry Modification", "description": "Detects potential malicious modification of the property value of fDenyTSConnections and UserAuthentication to enable remote desktop connections.", "created": "2019-09-12T00:00:00.000Z", "modified": "2019-11-10T00:00:00.000Z", "valid_from": "2019-09-12T00:00:00Z", "indicator_types": ["malicious-activity"], "pattern_type": "sigma", "pattern": "title: RDP Registry Modification\nid: 41904ebe-d56c-4904-b9ad-7a77bdf154b3\ndescription: Detects potential malicious modification of the property value of fDenyTSConnections and UserAuthentication to enable remote desktop connections.\nstatus: experimental\ndate: 2019/09/12\nmodified: 2019/11/10\nauthor: Roberto Rodriguez @Cyb3rWard0g\nreferences:\n    - https://github.com/Cyb3rWard0g/ThreatHunter-Playbook/tree/master/playbooks/windows/05_defense_evasion/T1112_Modify_Registry/enable_rdp_registry.md\ntags:\n    - attack.defense_evasion\n    - attack.t1112\nlogsource:\n    product: windows\n    service: sysmon\ndetection:\n    selection:\n        EventID: 13\n        TargetObject|endswith:\n            - '\\CurrentControlSet\\Control\\Terminal Server\\WinStations\\RDP-Tcp\\UserAuthentication'\n            - '\\CurrentControlSet\\Control\\Terminal Server\\fDenyTSConnections'\n        Details: 'DWORD (0x00000000)'\n    condition: selection\nfields:\n    - ComputerName\n    - Image\n    - EventType\n    - TargetObject\nfalsepositives:\n    - Unknown\nlevel: high\n", "object_marking_refs": ["marking-definition--0a872d70-1d05-45dd-a25f-031af547a102"], "created_by_ref": "identity--082ca4f0-d825-45b6-aa42-ab9afd1e5503", "type": "indicator", "spec_version": "2.1", "id": "indicator--1a8cfdfd-9634-490b-b92a-a26c1c72a2d5"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--17fbb661-6466-4ab7-95a8-f2ed8b0409de", "created": "2020-04-02T07:59:01.730Z", "modified": "2020-04-02T07:59:01.730Z", "source_ref": "indicator--1a8cfdfd-9634-490b-b92a-a26c1c72a2d5", "relationship_type": "indicates", "target_ref": "attack-pattern--57340c81-c025-4189-8fa0-fc7ede51bae4"}, {"name": "Windows Webshell Creation", "description": "Possible webshell file creation on a static web site", "created": "2019-10-22T00:00:00.000Z", "modified": "2019-11-04T00:00:00.000Z", "valid_from": "2019-10-22T00:00:00Z", "indicator_types": ["malicious-activity"], "pattern_type": "sigma", "pattern": "title: Windows Webshell Creation\nid: 39f1f9f2-9636-45de-98f6-a4046aa8e4b9\nstatus: experimental\ndescription: Possible webshell file creation on a static web site\nreferences:\n    - PT ESC rule and personal experience\nauthor: Beyu Denis, oscd.community\ndate: 2019/10/22\nmodified: 2019/11/04\ntags:\n    - attack.persistence\n    - attack.t1100\nlevel: critical\nlogsource:\n    product: windows\n    service: sysmon\ndetection:\n    selection_1:\n        EventID: 11\n    selection_2:\n        TargetFilename|contains: '\\inetpub\\wwwroot\\'\n    selection_3:\n        TargetFilename|contains:\n            - '.asp'\n            - '.ashx'\n            - '.ph'\n    selection_4:\n        TargetFilename|contains:\n            - '\\www\\'\n            - '\\htdocs\\'\n            - '\\html\\'\n    selection_5:\n        TargetFilename|contains: '.ph'\n    selection_6:\n        - TargetFilename|endswith: '.jsp'\n        - TargetFilename|contains|all:\n            - '\\cgi-bin\\'\n            - '.pl'\n    condition: selection_1 and ( selection_2 and selection_3 ) or\n               selection_1 and ( selection_4 and selection_5 ) or\n               selection_1 and selection_6\nfalsepositives:\n    - Legitimate administrator or developer creating legitimate executable files in a web application folder\n", "object_marking_refs": ["marking-definition--0a872d70-1d05-45dd-a25f-031af547a102"], "created_by_ref": "identity--082ca4f0-d825-45b6-aa42-ab9afd1e5503", "type": "indicator", "spec_version": "2.1", "id": "indicator--1bf073d7-1fbe-43d4-b1e2-8cb46004f99d"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--d342acf1-42aa-4b18-ac5c-c1ed2103b8ff", "created": "2020-04-02T07:59:01.751Z", "modified": "2020-04-02T07:59:01.751Z", "source_ref": "indicator--1bf073d7-1fbe-43d4-b1e2-8cb46004f99d", "relationship_type": "indicates", "target_ref": "attack-pattern--c16e5409-ee53-4d79-afdc-4099dc9292df"}, {"name": "Malicious PowerShell Commandlet Names", "description": "Detects the creation of known powershell scripts for exploitation", "created": "2018-04-07T00:00:00.000Z", "valid_from": "2018-04-07T00:00:00Z", "indicator_types": ["malicious-activity"], "pattern_type": "sigma", "pattern": "title: Malicious PowerShell Commandlet Names\nid: f331aa1f-8c53-4fc3-b083-cc159bc971cb\nstatus: experimental\ndescription: Detects the creation of known powershell scripts for exploitation\nreferences:\n    - https://raw.githubusercontent.com/Neo23x0/sigma/f35c50049fa896dff91ff545cb199319172701e8/rules/windows/powershell/powershell_malicious_commandlets.yml\ntags:\n    - attack.execution\n    - attack.t1086\nauthor: Markus Neis\ndate: 2018/04/07\nlogsource:\n    product: windows\n    service: sysmon\ndetection:\n    selection:\n        EventID: 11\n        TargetFilename:\n            - '*\\Invoke-DllInjection.ps1'   \n            - '*\\Invoke-WmiCommand.ps1'\n            - '*\\Get-GPPPassword.ps1'\n            - '*\\Get-Keystrokes.ps1'\n            - '*\\Get-VaultCredential.ps1'\n            - '*\\Invoke-CredentialInjection.ps1'\n            - '*\\Invoke-Mimikatz.ps1'\n            - '*\\Invoke-NinjaCopy.ps1'\n            - '*\\Invoke-TokenManipulation.ps1'\n            - '*\\Out-Minidump.ps1'\n            - '*\\VolumeShadowCopyTools.ps1'\n            - '*\\Invoke-ReflectivePEInjection.ps1'\n            - '*\\Get-TimedScreenshot.ps1'\n            - '*\\Invoke-UserHunter.ps1'\n            - '*\\Find-GPOLocation.ps1'\n            - '*\\Invoke-ACLScanner.ps1'\n            - '*\\Invoke-DowngradeAccount.ps1'\n            - '*\\Get-ServiceUnquoted.ps1'\n            - '*\\Get-ServiceFilePermission.ps1'\n            - '*\\Get-ServicePermission.ps1'\n            - '*\\Invoke-ServiceAbuse.ps1'\n            - '*\\Install-ServiceBinary.ps1'\n            - '*\\Get-RegAutoLogon.ps1'\n            - '*\\Get-VulnAutoRun.ps1'\n            - '*\\Get-VulnSchTask.ps1'\n            - '*\\Get-UnattendedInstallFile.ps1'\n            - '*\\Get-WebConfig.ps1'\n            - '*\\Get-ApplicationHost.ps1'\n            - '*\\Get-RegAlwaysInstallElevated.ps1'\n            - '*\\Get-Unconstrained.ps1'\n            - '*\\Add-RegBackdoor.ps1'\n            - '*\\Add-ScrnSaveBackdoor.ps1'\n            - '*\\Gupt-Backdoor.ps1'\n            - '*\\Invoke-ADSBackdoor.ps1'\n            - '*\\Enabled-DuplicateToken.ps1'\n            - '*\\Invoke-PsUaCme.ps1'\n            - '*\\Remove-Update.ps1'\n            - '*\\Check-VM.ps1'\n            - '*\\Get-LSASecret.ps1'\n            - '*\\Get-PassHashes.ps1'\n            - '*\\Show-TargetScreen.ps1'\n            - '*\\Port-Scan.ps1'\n            - '*\\Invoke-PoshRatHttp.ps1'\n            - '*\\Invoke-PowerShellTCP.ps1'\n            - '*\\Invoke-PowerShellWMI.ps1'\n            - '*\\Add-Exfiltration.ps1'\n            - '*\\Add-Persistence.ps1'\n            - '*\\Do-Exfiltration.ps1'\n            - '*\\Start-CaptureServer.ps1'\n            - '*\\Invoke-ShellCode.ps1'\n            - '*\\Get-ChromeDump.ps1'\n            - '*\\Get-ClipboardContents.ps1'\n            - '*\\Get-FoxDump.ps1'\n            - '*\\Get-IndexedItem.ps1'\n            - '*\\Get-Screenshot.ps1'\n            - '*\\Invoke-Inveigh.ps1'\n            - '*\\Invoke-NetRipper.ps1'\n            - '*\\Invoke-EgressCheck.ps1'\n            - '*\\Invoke-PostExfil.ps1'\n            - '*\\Invoke-PSInject.ps1'\n            - '*\\Invoke-RunAs.ps1'\n            - '*\\MailRaider.ps1'\n            - '*\\New-HoneyHash.ps1'\n            - '*\\Set-MacAttribute.ps1'\n            - '*\\Invoke-DCSync.ps1'\n            - '*\\Invoke-PowerDump.ps1'\n            - '*\\Exploit-Jboss.ps1'\n            - '*\\Invoke-ThunderStruck.ps1'\n            - '*\\Invoke-VoiceTroll.ps1'\n            - '*\\Set-Wallpaper.ps1'\n            - '*\\Invoke-InveighRelay.ps1'\n            - '*\\Invoke-PsExec.ps1'\n            - '*\\Invoke-SSHCommand.ps1'\n            - '*\\Get-SecurityPackages.ps1'\n            - '*\\Install-SSP.ps1'\n            - '*\\Invoke-BackdoorLNK.ps1'\n            - '*\\PowerBreach.ps1'\n            - '*\\Get-SiteListPassword.ps1'\n            - '*\\Get-System.ps1'\n            - '*\\Invoke-BypassUAC.ps1'\n            - '*\\Invoke-Tater.ps1'\n            - '*\\Invoke-WScriptBypassUAC.ps1'\n            - '*\\PowerUp.ps1'\n            - '*\\PowerView.ps1'\n            - '*\\Get-RickAstley.ps1'\n            - '*\\Find-Fruit.ps1'\n            - '*\\HTTP-Login.ps1'\n            - '*\\Find-TrustedDocuments.ps1'\n            - '*\\Invoke-Paranoia.ps1'\n            - '*\\Invoke-WinEnum.ps1'\n            - '*\\Invoke-ARPScan.ps1'\n            - '*\\Invoke-PortScan.ps1'\n            - '*\\Invoke-ReverseDNSLookup.ps1'\n            - '*\\Invoke-SMBScanner.ps1'\n            - '*\\Invoke-Mimikittenz.ps1'\n    condition: selection\nfalsepositives:\n    - Penetration Tests\nlevel: high\n        \n", "object_marking_refs": ["marking-definition--0a872d70-1d05-45dd-a25f-031af547a102"], "created_by_ref": "identity--082ca4f0-d825-45b6-aa42-ab9afd1e5503", "type": "indicator", "spec_version": "2.1", "id": "indicator--21fe1365-0267-4658-9101-5321d2ab4b1c", "modified": "2020-04-02T07:59:01.767Z"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--e15b0bdf-bd5b-41cd-8556-e8f1a97edd9e", "created": "2020-04-02T07:59:01.783Z", "modified": "2020-04-02T07:59:01.783Z", "source_ref": "indicator--21fe1365-0267-4658-9101-5321d2ab4b1c", "relationship_type": "indicates", "target_ref": "attack-pattern--f4882e23-8aa7-4b12-b28a-b349c12ee9e0"}, {"name": "Renamed PowerShell", "description": "Detects the execution of a renamed PowerShell often used by attackers or malware", "created": "2019-08-22T00:00:00.000Z", "valid_from": "2019-08-22T00:00:00Z", "indicator_types": ["malicious-activity"], "pattern_type": "sigma", "pattern": "title: Renamed PowerShell\nid: d178a2d7-129a-4ba4-8ee6-d6e1fecd5d20\nstatus: experimental\ndescription: Detects the execution of a renamed PowerShell often used by attackers or malware\nreferences:\n    - https://twitter.com/christophetd/status/1164506034720952320\nauthor: Florian Roth\ndate: 2019/08/22\ntags:\n    - car.2013-05-009\nlogsource:\n    product: windows\n    service: sysmon\ndetection:\n    selection:\n        Description: 'Windows PowerShell'\n        Company: 'Microsoft Corporation'\n    filter:\n        Image: \n            - '*\\powershell.exe'\n            - '*\\powershell_ise.exe'\n    condition: selection and not filter\nfalsepositives:\n    - Unknown\nlevel: critical\n", "object_marking_refs": ["marking-definition--0a872d70-1d05-45dd-a25f-031af547a102"], "created_by_ref": "identity--082ca4f0-d825-45b6-aa42-ab9afd1e5503", "type": "indicator", "spec_version": "2.1", "id": "indicator--7357e71c-afd0-4211-af87-bb571bca076f", "modified": "2020-04-02T07:59:01.788Z"}, {"name": "WMI Modules Loaded", "description": "Detects non wmiprvse loading WMI modules", "created": "2019-08-10T00:00:00.000Z", "modified": "2019-11-10T00:00:00.000Z", "valid_from": "2019-08-10T00:00:00Z", "indicator_types": ["malicious-activity"], "pattern_type": "sigma", "pattern": "title: WMI Modules Loaded\nid: 671bb7e3-a020-4824-a00e-2ee5b55f385e\ndescription: Detects non wmiprvse loading WMI modules\nstatus: experimental\ndate: 2019/08/10\nmodified: 2019/11/10\nauthor: Roberto Rodriguez @Cyb3rWard0g\nreferences:\n    - https://github.com/Cyb3rWard0g/ThreatHunter-Playbook/tree/master/playbooks/windows/02_execution/T1047_windows_management_instrumentation/wmi_wmi_module_load.md\ntags:\n    - attack.execution\n    - attack.t1047\nlogsource:\n    product: windows\n    service: sysmon\ndetection:\n    selection: \n        EventID: 7\n        ImageLoaded|endswith:\n            - '\\wmiclnt.dll'\n            - '\\WmiApRpl.dll'\n            - '\\wmiprov.dll'\n            - '\\wmiutils.dll'\n            - '\\wbemcomn.dll'\n            - '\\wbemprox.dll'\n            - '\\WMINet_Utils.dll'\n            - '\\wbemsvc.dll'\n            - '\\fastprox.dll'\n    filter:\n        Image|endswith:\n            - '\\WmiPrvSe.exe'\n            - '\\WmiPrvSE.exe'\n            - '\\WmiAPsrv.exe'\n            - '\\svchost.exe'\n    condition: selection and not filter\nfields:\n    - ComputerName\n    - User\n    - Image\n    - ImageLoaded\nfalsepositives:\n    - Unknown\nlevel: high\n", "object_marking_refs": ["marking-definition--0a872d70-1d05-45dd-a25f-031af547a102"], "created_by_ref": "identity--082ca4f0-d825-45b6-aa42-ab9afd1e5503", "type": "indicator", "spec_version": "2.1", "id": "indicator--7c3e52db-1eab-4529-bc5a-54f8a38fcdb8"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--411cc4d3-42bc-4789-9772-fae95a5510a4", "created": "2020-04-02T07:59:01.805Z", "modified": "2020-04-02T07:59:01.805Z", "source_ref": "indicator--7c3e52db-1eab-4529-bc5a-54f8a38fcdb8", "relationship_type": "indicates", "target_ref": "attack-pattern--01a5a209-b94c-450b-b7f9-946497d91055"}, {"name": "RDP Over Reverse SSH Tunnel", "description": "Detects svchost hosting RDP termsvcs communicating with the loopback address and on TCP port 3389", "created": "2019-02-16T00:00:00.000Z", "valid_from": "2019-02-16T00:00:00Z", "indicator_types": ["malicious-activity"], "pattern_type": "sigma", "pattern": "title: RDP Over Reverse SSH Tunnel\nid: 5f699bc5-5446-4a4a-a0b7-5ef2885a3eb4\nstatus: experimental\ndescription: Detects svchost hosting RDP termsvcs communicating with the loopback address and on TCP port 3389\nreferences:\n    - https://twitter.com/SBousseaden/status/1096148422984384514\nauthor: Samir Bousseaden\ndate: 2019/02/16\ntags:\n    - attack.defense_evasion\n    - attack.command_and_control\n    - attack.t1076\n    - car.2013-07-002\nlogsource:\n    product: windows\n    service: sysmon\ndetection:\n    selection:\n        EventID: 3\n        Image: '*\\svchost.exe'\n        Initiated: 'true'\n        SourcePort: 3389\n        DestinationIp:\n            - '127.*'\n            - '::1'\n    condition: selection\nfalsepositives:\n    - unknown\nlevel: high\n", "object_marking_refs": ["marking-definition--0a872d70-1d05-45dd-a25f-031af547a102"], "created_by_ref": "identity--082ca4f0-d825-45b6-aa42-ab9afd1e5503", "type": "indicator", "spec_version": "2.1", "id": "indicator--067c2c42-abcd-46b3-8ea9-178a9d837e2d", "modified": "2020-04-02T07:59:01.810Z"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--38c14954-e424-4053-8523-aa04a85fbec8", "created": "2020-04-02T07:59:01.821Z", "modified": "2020-04-02T07:59:01.821Z", "source_ref": "indicator--067c2c42-abcd-46b3-8ea9-178a9d837e2d", "relationship_type": "indicates", "target_ref": "attack-pattern--51dea151-0898-4a45-967c-3ebee0420484"}, {"name": "Windows Registry Trust Record Modification", "description": "Alerts on trust record modification within the registry, indicating usage of macros", "created": "2020-02-19T00:00:00.000Z", "modified": "2020-02-19T00:00:00.000Z", "valid_from": "2020-02-19T00:00:00Z", "indicator_types": ["malicious-activity"], "pattern_type": "sigma", "pattern": "title: Windows Registry Trust Record Modification\nid: 295a59c1-7b79-4b47-a930-df12c15fc9c2\nstatus: experimental\ndescription: Alerts on trust record modification within the registry, indicating usage of macros\nreferences:\n    - https://outflank.nl/blog/2018/01/16/hunting-for-evil-detect-macros-being-executed/\n    - http://az4n6.blogspot.com/2016/02/more-on-trust-records-macros-and.html\nauthor: Antonlovesdnb\ndate: 2020/02/19\nmodified: 2020/02/19\ntags:\n    - attack.initial_access\n    - attack.t1193\nlogsource:\n    product: windows\n    service: sysmon\ndetection:\n    selection:\n        EventID: 12\n        TargetObject|contains: 'TrustRecords'\n    condition: selection\nfalsepositives:\n    - Alerts on legitimate macro usage as well, will need to filter as appropriate\nlevel: medium\n", "object_marking_refs": ["marking-definition--0a872d70-1d05-45dd-a25f-031af547a102"], "created_by_ref": "identity--082ca4f0-d825-45b6-aa42-ab9afd1e5503", "type": "indicator", "spec_version": "2.1", "id": "indicator--370198d6-76c1-445f-92c1-3ae18ebf2c38"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--eae8f9ad-bd33-4493-8d0b-3a3aec043016", "created": "2020-04-02T07:59:01.835Z", "modified": "2020-04-02T07:59:01.835Z", "source_ref": "indicator--370198d6-76c1-445f-92c1-3ae18ebf2c38", "relationship_type": "indicates", "target_ref": "attack-pattern--6aac77c4-eaf2-4366-8c13-ce50ab951f38"}, {"name": "UAC Bypass via Event Viewer", "description": "Detects UAC bypass method using Windows event viewer", "created": "2017-03-19T00:00:00.000Z", "valid_from": "2017-03-19T00:00:00Z", "indicator_types": ["malicious-activity"], "pattern_type": "sigma", "pattern": "title: UAC Bypass via Event Viewer\nid: 7c81fec3-1c1d-43b0-996a-46753041b1b6\nstatus: experimental\ndescription: Detects UAC bypass method using Windows event viewer\nreferences:\n    - https://enigma0x3.net/2016/08/15/fileless-uac-bypass-using-eventvwr-exe-and-registry-hijacking/\n    - https://www.hybrid-analysis.com/sample/e122bc8bf291f15cab182a5d2d27b8db1e7019e4e96bb5cdbd1dfe7446f3f51f?environmentId=100\nauthor: Florian Roth\ndate: 2017/03/19\nlogsource:\n    product: windows\n    service: sysmon\ndetection:\n    methregistry:\n        EventID: 13\n        TargetObject: 'HKU\\\\*\\mscfile\\shell\\open\\command'\n    methprocess:\n        EventID: 1 # Migration to process_creation requires multipart YAML\n        ParentImage: '*\\eventvwr.exe'\n    filterprocess:\n        Image: '*\\mmc.exe'\n    condition: methregistry or ( methprocess and not filterprocess )\nfields:\n    - CommandLine\n    - ParentCommandLine\ntags:\n    - attack.defense_evasion\n    - attack.privilege_escalation\n    - attack.t1088\n    - car.2019-04-001\nfalsepositives:\n    - unknown\nlevel: critical\n", "object_marking_refs": ["marking-definition--0a872d70-1d05-45dd-a25f-031af547a102"], "created_by_ref": "identity--082ca4f0-d825-45b6-aa42-ab9afd1e5503", "type": "indicator", "spec_version": "2.1", "id": "indicator--0af813d3-7d74-434c-a7ce-758e82cf8e0a", "modified": "2020-04-02T07:59:01.840Z"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--638b157f-3f0e-41fb-b56a-bca3713a5ca2", "created": "2020-04-02T07:59:01.850Z", "modified": "2020-04-02T07:59:01.850Z", "source_ref": "indicator--0af813d3-7d74-434c-a7ce-758e82cf8e0a", "relationship_type": "indicates", "target_ref": "attack-pattern--ca1a3f50-5ebd-41f8-8320-2c7d6a6e88be"}, {"name": "Dumping Lsass.exe Memory with MiniDumpWriteDump API", "description": "Detects the use of MiniDumpWriteDump API for dumping lsass.exe memory in a stealth way. Tools like ProcessHacker and some attacker tradecract use this API found in dbghelp.dll or dbgcore.dll. As an example, SilentTrynity C2 Framework has a module that leverages this API to dump the contents of Lsass.exe and transfer it over the network back to the attacker's machine.", "created": "2019-10-27T00:00:00.000Z", "modified": "2019-11-13T00:00:00.000Z", "valid_from": "2019-10-27T00:00:00Z", "indicator_types": ["malicious-activity"], "pattern_type": "sigma", "pattern": "title: Dumping Lsass.exe Memory with MiniDumpWriteDump API\nid: dd5ab153-beaa-4315-9647-65abc5f71541\nstatus: experimental\ndescription: Detects the use of MiniDumpWriteDump API for dumping lsass.exe memory in a stealth way. Tools like ProcessHacker and some attacker tradecract use this\n    API found in dbghelp.dll or dbgcore.dll. As an example, SilentTrynity C2 Framework has a module that leverages this API to dump the contents of Lsass.exe and\n    transfer it over the network back to the attacker's machine.\ndate: 2019/10/27\nmodified: 2019/11/13\nauthor: Perez Diego (@darkquassar), oscd.community\nreferences:\n    - https://docs.microsoft.com/en-us/windows/win32/api/minidumpapiset/nf-minidumpapiset-minidumpwritedump\n    - https://www.pinvoke.net/default.aspx/dbghelp/MiniDumpWriteDump.html\n    - https://medium.com/@fsx30/bypass-edrs-memory-protection-introduction-to-hooking-2efb21acffd6\ntags:\n    - attack.credential_access\n    - attack.t1003\nlogsource:\n    product: windows\n    service: sysmon\ndetection:\n    signedprocess:\n        EventID: 7\n        ImageLoaded|endswith:\n            - '\\dbghelp.dll'\n            - '\\dbgcore.dll'\n        Image|endswith: \n            - '\\msbuild.exe'\n            - '\\cmd.exe'\n            - '\\svchost.exe'\n            - '\\rundll32.exe'\n            - '\\powershell.exe'\n            - '\\word.exe'\n            - '\\excel.exe'\n            - '\\powerpnt.exe'\n            - '\\outlook.exe'\n            - '\\monitoringhost.exe'\n            - '\\wmic.exe'\n            - '\\msiexec.exe'\n            - '\\bash.exe'\n            - '\\wscript.exe'\n            - '\\cscript.exe'\n            - '\\mshta.exe'\n            - '\\regsvr32.exe'\n            - '\\schtasks.exe'\n            - '\\dnx.exe'\n            - '\\regsvcs.exe'\n            - '\\sc.exe'\n            - '\\scriptrunner.exe'\n    unsignedprocess:\n        EventID: 7\n        ImageLoaded|endswith:\n            - '\\dbghelp.dll'\n            - '\\dbgcore.dll'\n        Signed: \"FALSE\"\n    filter:\n        Image|contains: 'Visual Studio'\n    condition: (signedprocess AND NOT filter) OR (unsignedprocess AND NOT filter)\nfields:\n    - ComputerName\n    - User\n    - Image\n    - ImageLoaded\nfalsepositives:\n    - Penetration tests\nlevel: critical\n", "object_marking_refs": ["marking-definition--0a872d70-1d05-45dd-a25f-031af547a102"], "created_by_ref": "identity--082ca4f0-d825-45b6-aa42-ab9afd1e5503", "type": "indicator", "spec_version": "2.1", "id": "indicator--01fdaafe-4f03-434d-bab3-5844bf6006ae"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--12d06370-f1b9-48bf-b1b3-113309630808", "created": "2020-04-02T07:59:01.868Z", "modified": "2020-04-02T07:59:01.868Z", "source_ref": "indicator--01fdaafe-4f03-434d-bab3-5844bf6006ae", "relationship_type": "indicates", "target_ref": "attack-pattern--0a3ead4e-6d47-4ccb-854c-a6a4f9d96b22"}, {"name": "New DLL Added to AppCertDlls Registry Key", "description": "Dynamic-link libraries (DLLs) that are specified in the AppCertDLLs value in the Registry key can be abused to obtain persistence and privilege escalation by causing a malicious DLL to be loaded and run in the context of separate processes on the computer.", "created": "2019-10-25T00:00:00.000Z", "modified": "2019-11-13T00:00:00.000Z", "valid_from": "2019-10-25T00:00:00Z", "indicator_types": ["malicious-activity"], "pattern_type": "sigma", "pattern": "title: New DLL Added to AppCertDlls Registry Key\nid: 6aa1d992-5925-4e9f-a49b-845e51d1de01\nstatus: experimental\ndescription: Dynamic-link libraries (DLLs) that are specified in the AppCertDLLs value in the Registry key can be abused to obtain persistence and privilege escalation\n    by causing a malicious DLL to be loaded and run in the context of separate processes on the computer.\nreferences:\n    - http://www.hexacorn.com/blog/2013/01/19/beyond-good-ol-run-key-part-3/\n    - https://eqllib.readthedocs.io/en/latest/analytics/14f90406-10a0-4d36-a672-31cabe149f2f.html\ntags:\n    - attack.persistence\n    - attack.t1182\nauthor: Ilyas Ochkov, oscd.community\ndate: 2019/10/25\nmodified: 2019/11/13\nlogsource:\n    product: windows\n    service: sysmon\ndetection:\n    selection:\n      - EventID: \n            - 12  # key create\n            - 13  # value set\n        # Sysmon gives us HKLM\\SYSTEM\\CurrentControlSet\\.. if ControlSetXX is the selected one\n        TargetObject: 'HKLM\\SYSTEM\\CurrentControlSet\\Control\\Session Manager\\AppCertDlls'\n      - EventID: 14  # key rename\n        NewName: 'HKLM\\SYSTEM\\CurentControlSet\\Control\\Session Manager\\AppCertDlls'\n    condition: selection\nfields:\n    - EventID\n    - Image\n    - TargetObject\n    - NewName\nfalsepositives:\n    - Unkown\nlevel: medium\n", "object_marking_refs": ["marking-definition--0a872d70-1d05-45dd-a25f-031af547a102"], "created_by_ref": "identity--082ca4f0-d825-45b6-aa42-ab9afd1e5503", "type": "indicator", "spec_version": "2.1", "id": "indicator--d5a84954-8f53-4000-84ba-3ae9f4e3dad0"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--69482b2c-d934-4036-b395-3d3daa2bfe14", "created": "2020-04-02T07:59:01.885Z", "modified": "2020-04-02T07:59:01.885Z", "source_ref": "indicator--d5a84954-8f53-4000-84ba-3ae9f4e3dad0", "relationship_type": "indicates", "target_ref": "attack-pattern--4bf5845d-a814-4490-bc5c-ccdee6043025"}, {"name": "Security Support Provider (SSP) Added to LSA Configuration", "description": "Detects the addition of a SSP to the registry. Upon a reboot or API call, SSP DLLs gain access to encrypted and plaintext passwords stored in Windows.", "created": "2019-01-18T00:00:00.000Z", "valid_from": "2019-01-18T00:00:00Z", "indicator_types": ["malicious-activity"], "pattern_type": "sigma", "pattern": "title: Security Support Provider (SSP) Added to LSA Configuration\nid: eeb30123-9fbd-4ee8-aaa0-2e545bbed6dc\nstatus: experimental\ndescription: Detects the addition of a SSP to the registry. Upon a reboot or API call, SSP DLLs gain access to encrypted and plaintext passwords stored in Windows.\nreferences:\n    - https://attack.mitre.org/techniques/T1101/\n    - https://powersploit.readthedocs.io/en/latest/Persistence/Install-SSP/\ntags:\n    - attack.persistence\n    - attack.t1011\nauthor: iwillkeepwatch\ndate: 2019/01/18\nlogsource:\n    product: windows\n    service: sysmon\ndetection:\n    selection_registry:\n        EventID: 13\n        TargetObject:\n            - 'HKLM\\System\\CurrentControlSet\\Control\\Lsa\\Security Packages'\n            - 'HKLM\\System\\CurrentControlSet\\Control\\Lsa\\OSConfig\\Security Packages'\n    exclusion_images:\n        - Image: C:\\Windows\\system32\\msiexec.exe\n        - Image: C:\\Windows\\syswow64\\MsiExec.exe\n    condition: selection_registry and not exclusion_images\nfalsepositives:\n    - Unlikely\nlevel: critical\n", "object_marking_refs": ["marking-definition--0a872d70-1d05-45dd-a25f-031af547a102"], "created_by_ref": "identity--082ca4f0-d825-45b6-aa42-ab9afd1e5503", "type": "indicator", "spec_version": "2.1", "id": "indicator--3d9d39fe-a71e-498b-8894-8b4b217cb88a", "modified": "2020-04-02T07:59:01.890Z"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--c998afd7-9ed5-436c-b9dd-8deee57b3a80", "created": "2020-04-02T07:59:01.901Z", "modified": "2020-04-02T07:59:01.901Z", "source_ref": "indicator--3d9d39fe-a71e-498b-8894-8b4b217cb88a", "relationship_type": "indicates", "target_ref": "attack-pattern--51ea26b1-ff1e-4faa-b1a0-1114cd298c87"}, {"name": "New RUN Key Pointing to Suspicious Folder", "description": "Detects suspicious new RUN key element pointing to an executable in a suspicious folder", "created": "2018-08-25T00:00:00.000Z", "modified": "2020-02-26T00:00:00.000Z", "valid_from": "2018-08-25T00:00:00Z", "indicator_types": ["malicious-activity"], "pattern_type": "sigma", "pattern": "title: New RUN Key Pointing to Suspicious Folder\nid: 02ee49e2-e294-4d0f-9278-f5b3212fc588\nstatus: experimental\ndescription: Detects suspicious new RUN key element pointing to an executable in a suspicious folder\nreferences:\n    - https://www.fireeye.com/blog/threat-research/2018/08/fin7-pursuing-an-enigmatic-and-evasive-global-criminal-operation.html\nauthor: Florian Roth, Markus Neis\ntags:\n    - attack.persistence\n    - attack.t1060\ndate: 2018/08/25\nmodified: 2020/02/26\nlogsource:\n    product: windows\n    service: sysmon\ndetection:\n    selection:\n        EventID: 13\n        TargetObject: \n            - '*\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run\\\\*'\n            - '*\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\RunOnce\\\\*'\n        Details:\n            - '*C:\\Windows\\Temp\\\\*'\n            - '*\\AppData\\\\*'\n            - '%AppData%\\\\*'\n            - '*C:\\$Recycle.bin\\\\*'\n            - '*C:\\Temp\\\\*'\n            - '*C:\\Users\\Public\\\\*'\n            - '%Public%\\\\*'\n            - '*C:\\Users\\Default\\\\*'\n            - '*C:\\Users\\Desktop\\\\*'\n            - 'wscript*'\n            - 'cscript*'\n    filter:\n        Details|contains:\n          - '\\AppData\\Local\\Microsoft\\OneDrive\\'  # OneDrive False Positives\n    condition: selection and not filter\nfields:\n    - Image\nfalsepositives:\n    - Software using the AppData folders for updates\nlevel: high\n", "object_marking_refs": ["marking-definition--0a872d70-1d05-45dd-a25f-031af547a102"], "created_by_ref": "identity--082ca4f0-d825-45b6-aa42-ab9afd1e5503", "type": "indicator", "spec_version": "2.1", "id": "indicator--5f2a394d-2e60-43bd-8f43-b1ac7a7d05ec"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--4b94b4b7-2827-44ef-8d8c-e136cad77a62", "created": "2020-04-02T07:59:01.917Z", "modified": "2020-04-02T07:59:01.917Z", "source_ref": "indicator--5f2a394d-2e60-43bd-8f43-b1ac7a7d05ec", "relationship_type": "indicates", "target_ref": "attack-pattern--9422fc14-1c43-410d-ab0f-a709b76c72dc"}, {"name": "Possible Privilege Escalation via Service Permissions Weakness", "description": "Detect modification of services configuration (ImagePath, FailureCommand and ServiceDLL) in registry by processes with Medium integrity level", "created": "2019-10-26T00:00:00.000Z", "modified": "2019-11-11T00:00:00.000Z", "valid_from": "2019-10-26T00:00:00Z", "indicator_types": ["malicious-activity"], "pattern_type": "sigma", "pattern": "title: Possible Privilege Escalation via Service Permissions Weakness\nid: 0f9c21f1-6a73-4b0e-9809-cb562cb8d981\ndescription: Detect modification of services configuration (ImagePath, FailureCommand and ServiceDLL) in registry by processes with Medium integrity level\nreferences:\n    - https://speakerdeck.com/heirhabarov/hunting-for-privilege-escalation-in-windows-environment\n    - https://pentestlab.blog/2017/03/31/insecure-registry-permissions/\ntags:\n    - attack.privilege_escalation\n    - attack.t1058\nstatus: experimental\nauthor: Teymur Kheirkhabarov\ndate: 2019/10/26\nmodified: 2019/11/11\nlogsource:\n    product: windows\n    service: sysmon\ndetection:\n    selection:\n        EventID: 13\n        IntegrityLevel: 'Medium'\n        TargetObject|contains: '\\services\\'\n        TargetObject|endswith:\n            - '\\ImagePath'\n            - '\\FailureCommand'\n            - '\\Parameters\\ServiceDll'\n    condition: selection\nfalsepositives:\n    - Unknown\nlevel: high\nenrichment:\n    - EN_0001_cache_sysmon_event_id_1_info                      # http://bit.ly/314zc6x\n    - EN_0003_enrich_other_sysmon_events_with_event_id_1_data   # http://bit.ly/2ojW7fw\n", "object_marking_refs": ["marking-definition--0a872d70-1d05-45dd-a25f-031af547a102"], "created_by_ref": "identity--082ca4f0-d825-45b6-aa42-ab9afd1e5503", "type": "indicator", "spec_version": "2.1", "id": "indicator--cc078528-d857-48ec-9a0e-79b90d2cc954"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--b8013dd0-9b9b-42f4-af2f-5e18871c6137", "created": "2020-04-02T07:59:01.932Z", "modified": "2020-04-02T07:59:01.932Z", "source_ref": "indicator--cc078528-d857-48ec-9a0e-79b90d2cc954", "relationship_type": "indicates", "target_ref": "attack-pattern--39a130e1-6ab7-434a-8bd2-418e7d9d6427"}, {"name": "Suspicious ADSI-Cache Usage By Unknown Tool", "description": "detects the usage of ADSI (LDAP) operations by tools. This may also detect tools like LDAPFragger.", "created": "2019-03-24T00:00:00.000Z", "valid_from": "2019-03-24T00:00:00Z", "indicator_types": ["malicious-activity"], "pattern_type": "sigma", "pattern": "title: Suspicious ADSI-Cache Usage By Unknown Tool\nid: 75bf09fa-1dd7-4d18-9af9-dd9e492562eb\ndescription: detects the usage of ADSI (LDAP) operations by tools. This may also detect tools like LDAPFragger.\nstatus: experimental\ndate: 2019/03/24\nauthor: xknow @xknow_infosec\nreferences:\n    - https://medium.com/@ivecodoe/detecting-ldapfragger-a-newly-released-cobalt-strike-beacon-using-ldap-for-c2-communication-c274a7f00961\n    - https://blog.fox-it.com/2020/03/19/ldapfragger-command-and-control-over-ldap-attributes/\n    - https://github.com/fox-it/LDAPFragger\ntags:\n    - attack.t1041\n    - attack.persistence\nlogsource:\n    product: windows\n    service: sysmon\ndetection:\n    selection_1:\n        EventID: 11\n        TargetFilename: '*\\Local\\Microsoft\\Windows\\SchCache\\*.sch'\n    selection_2:\n        Image|contains:\n            - 'C:\\windows\\system32\\svchost.exe'\n            - 'C:\\windows\\system32\\dllhost.exe'\n            - 'C:\\windows\\system32\\mmc.exe'\n            - 'C:\\windows\\system32\\WindowsPowerShell\\v1.0\\powershell.exe'\n    condition: selection_1 and not selection_2\nfalsepositives:\n    - Other legimate tools, which do ADSI (LDAP) operations, e.g. any remoting activity by MMC, Powershell, Windows etc.\nlevel: high\n", "object_marking_refs": ["marking-definition--0a872d70-1d05-45dd-a25f-031af547a102"], "created_by_ref": "identity--082ca4f0-d825-45b6-aa42-ab9afd1e5503", "type": "indicator", "spec_version": "2.1", "id": "indicator--c5adc066-c126-4862-b6a6-9117367606d8", "modified": "2020-04-02T07:59:01.937Z"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--5aad7d12-430d-4a1d-bd0e-734167d03132", "created": "2020-04-02T07:59:01.949Z", "modified": "2020-04-02T07:59:01.949Z", "source_ref": "indicator--c5adc066-c126-4862-b6a6-9117367606d8", "relationship_type": "indicates", "target_ref": "attack-pattern--92d7da27-2d91-488e-a00c-059dc162766d"}, {"name": "LSASS Memory Dump File Creation", "description": "LSASS memory dump creation using operating systems utilities. Procdump will use process name in output file if no name is specified", "created": "2019-10-22T00:00:00.000Z", "modified": "2019-11-13T00:00:00.000Z", "valid_from": "2019-10-22T00:00:00Z", "indicator_types": ["malicious-activity"], "pattern_type": "sigma", "pattern": "title: LSASS Memory Dump File Creation\nid: 5e3d3601-0662-4af0-b1d2-36a05e90c40a\ndescription: LSASS memory dump creation using operating systems utilities. Procdump will use process name in output file if no name is specified\nauthor: Teymur Kheirkhabarov, oscd.community\nreferences:\n    - https://www.slideshare.net/heirhabarov/hunting-for-credentials-dumping-in-windows-environment\ndate: 2019/10/22\nmodified: 2019/11/13\ntags:\n    - attack.credential_access\n    - attack.t1003\nlogsource:\n    product: windows\n    service: sysmon\ndetection:\n    selection:\n        EventID: 11\n        TargetFilename|contains: 'lsass'\n        TargetFilename|endswith: 'dmp'\n    condition: selection\nfields:\n    - ComputerName\n    - TargetFileName\nfalsepositives:\n    - Dumping lsass memory for forensic investigation purposes by legitimate incident responder or forensic invetigator\nlevel: medium\nstatus: experimental\n", "object_marking_refs": ["marking-definition--0a872d70-1d05-45dd-a25f-031af547a102"], "created_by_ref": "identity--082ca4f0-d825-45b6-aa42-ab9afd1e5503", "type": "indicator", "spec_version": "2.1", "id": "indicator--fd8289f4-435f-416a-a255-53dc52875b16"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--9fe3f698-49a6-4362-9887-156bc7933c9f", "created": "2020-04-02T07:59:01.965Z", "modified": "2020-04-02T07:59:01.965Z", "source_ref": "indicator--fd8289f4-435f-416a-a255-53dc52875b16", "relationship_type": "indicates", "target_ref": "attack-pattern--0a3ead4e-6d47-4ccb-854c-a6a4f9d96b22"}, {"name": "DHCP Callout DLL Installation", "description": "Detects the installation of a Callout DLL via CalloutDlls and CalloutEnabled parameter in Registry, which can be used to execute code in context of the DHCP server (restart required)", "created": "2017-05-15T00:00:00.000Z", "valid_from": "2017-05-15T00:00:00Z", "indicator_types": ["malicious-activity"], "pattern_type": "sigma", "pattern": "title: DHCP Callout DLL Installation\nid: 9d3436ef-9476-4c43-acca-90ce06bdf33a\nstatus: experimental\ndescription: Detects the installation of a Callout DLL via CalloutDlls and CalloutEnabled parameter in Registry, which can be used to execute code in context of the\n    DHCP server (restart required)\nreferences:\n    - https://blog.3or.de/mimilib-dhcp-server-callout-dll-injection.html\n    - https://technet.microsoft.com/en-us/library/cc726884(v=ws.10).aspx\n    - https://msdn.microsoft.com/de-de/library/windows/desktop/aa363389(v=vs.85).aspx\ndate: 2017/05/15\nauthor: Dimitrios Slamaris\ntags:\n    - attack.defense_evasion\n    - attack.t1073\n    - attack.t1112\nlogsource:\n    product: windows\n    service: sysmon\ndetection:\n    selection:\n        EventID: 13\n        TargetObject:\n            - '*\\Services\\DHCPServer\\Parameters\\CalloutDlls'\n            - '*\\Services\\DHCPServer\\Parameters\\CalloutEnabled'\n    condition: selection\nfalsepositives:\n    - unknown\nlevel: high\n", "object_marking_refs": ["marking-definition--0a872d70-1d05-45dd-a25f-031af547a102"], "created_by_ref": "identity--082ca4f0-d825-45b6-aa42-ab9afd1e5503", "type": "indicator", "spec_version": "2.1", "id": "indicator--19a5a4fd-81dd-40ca-bb36-8a94a3f4649c", "modified": "2020-04-02T07:59:01.969Z"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--fde38b53-e46e-41e8-bdfb-470d298deba4", "created": "2020-04-02T07:59:01.980Z", "modified": "2020-04-02T07:59:01.980Z", "source_ref": "indicator--19a5a4fd-81dd-40ca-bb36-8a94a3f4649c", "relationship_type": "indicates", "target_ref": "attack-pattern--b2001907-166b-4d71-bb3c-9d26c871de09"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--c80b623a-990a-4c8a-96e8-ea30ecad54fe", "created": "2020-04-02T07:59:01.989Z", "modified": "2020-04-02T07:59:01.989Z", "source_ref": "indicator--19a5a4fd-81dd-40ca-bb36-8a94a3f4649c", "relationship_type": "indicates", "target_ref": "attack-pattern--57340c81-c025-4189-8fa0-fc7ede51bae4"}, {"name": "Suspicious Outbound Kerberos Connection", "description": "Detects suspicious outbound network activity via kerberos default port indicating possible lateral movement or first stage PrivEsc via delegation.", "created": "2019-10-24T00:00:00.000Z", "modified": "2019-11-13T00:00:00.000Z", "valid_from": "2019-10-24T00:00:00Z", "indicator_types": ["malicious-activity"], "pattern_type": "sigma", "pattern": "title: Suspicious Outbound Kerberos Connection\nid: e54979bd-c5f9-4d6c-967b-a04b19ac4c74\nstatus: experimental\ndescription: Detects suspicious outbound network activity via kerberos default port indicating possible lateral movement or first stage PrivEsc via delegation.\nreferences:\n    - https://github.com/GhostPack/Rubeus8\nauthor: Ilyas Ochkov, oscd.community\ndate: 2019/10/24\nmodified: 2019/11/13\ntags:\n    - attack.lateral_movement\n    - attack.t1208\nlogsource:\n    product: windows\n    service: sysmon\ndetection:\n    selection:\n        EventID: 3\n        DestinationPort: 88\n        Initiated: 'true'\n    filter:\n        Image|endswith:\n            - '\\lsass.exe'\n            - '\\opera.exe'\n            - '\\chrome.exe'\n            - '\\firefox.exe'\n    condition: selection and not filter \nfalsepositives:\n    - Other browsers\nlevel: high\n", "object_marking_refs": ["marking-definition--0a872d70-1d05-45dd-a25f-031af547a102"], "created_by_ref": "identity--082ca4f0-d825-45b6-aa42-ab9afd1e5503", "type": "indicator", "spec_version": "2.1", "id": "indicator--de131093-f2ee-40f9-a41e-426894c3e25e"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--f860bf26-8650-493e-b0bc-a87b506d3084", "created": "2020-04-02T07:59:02.004Z", "modified": "2020-04-02T07:59:02.004Z", "source_ref": "indicator--de131093-f2ee-40f9-a41e-426894c3e25e", "relationship_type": "indicates", "target_ref": "attack-pattern--b39d03cb-7b98-41c4-a878-c40c1a913dc0"}, {"name": "Mimikatz through Windows Remote Management", "description": "Detects usage of mimikatz through WinRM protocol by monitoring access to lsass process by wsmprovhost.exe.", "created": "2019-05-20T00:00:00.000Z", "valid_from": "2019-05-20T00:00:00Z", "indicator_types": ["malicious-activity"], "pattern_type": "sigma", "pattern": "title: Mimikatz through Windows Remote Management\nid: aa35a627-33fb-4d04-a165-d33b4afca3e8\ndescription: Detects usage of mimikatz through WinRM protocol by monitoring access to lsass process by wsmprovhost.exe.\nreferences:\n    - https://pentestlab.blog/2018/05/15/lateral-movement-winrm/\nstatus: stable\nauthor: Patryk Prauze - ING Tech\ndate: 2019/05/20\nlogsource:\n    product: windows\n    service: sysmon\ndetection:\n    selection:\n        EventID: 10\n        TargetImage: 'C:\\windows\\system32\\lsass.exe'\n        SourceImage: 'C:\\Windows\\system32\\wsmprovhost.exe'\n    condition: selection\ntags:\n    - attack.credential_access\n    - attack.execution\n    - attack.t1003\n    - attack.t1028\n    - attack.s0005\nfalsepositives:\n    - low\nlevel: high\n", "object_marking_refs": ["marking-definition--0a872d70-1d05-45dd-a25f-031af547a102"], "created_by_ref": "identity--082ca4f0-d825-45b6-aa42-ab9afd1e5503", "type": "indicator", "spec_version": "2.1", "id": "indicator--2b8e72a4-a328-4257-b62d-550a23cd03f4", "modified": "2020-04-02T07:59:02.008Z"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--8c9807b4-c6db-4687-9760-2482dcb7afa2", "created": "2020-04-02T07:59:02.023Z", "modified": "2020-04-02T07:59:02.023Z", "source_ref": "indicator--2b8e72a4-a328-4257-b62d-550a23cd03f4", "relationship_type": "indicates", "target_ref": "attack-pattern--0a3ead4e-6d47-4ccb-854c-a6a4f9d96b22"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--8dd0b3a4-70df-4202-b512-e0aae059c623", "created": "2020-04-02T07:59:02.040Z", "modified": "2020-04-02T07:59:02.040Z", "source_ref": "indicator--2b8e72a4-a328-4257-b62d-550a23cd03f4", "relationship_type": "indicates", "target_ref": "attack-pattern--c3bce4f4-9795-46c6-976e-8676300bbc39"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--55fd4be4-8309-49e4-95ba-fbb9e28f4b9f", "created": "2020-04-02T07:59:02.059Z", "modified": "2020-04-02T07:59:02.059Z", "source_ref": "indicator--2b8e72a4-a328-4257-b62d-550a23cd03f4", "relationship_type": "indicates", "target_ref": "tool--242f3da3-4425-4d11-8f5c-b842886da966"}, {"name": "Turla Group Named Pipes", "description": "Detects a named pipe used by Turla group samples", "created": "2017-11-06T00:00:00.000Z", "valid_from": "2017-11-06T00:00:00Z", "indicator_types": ["malicious-activity"], "pattern_type": "sigma", "pattern": "title: Turla Group Named Pipes\nid: 739915e4-1e70-4778-8b8a-17db02f66db1\nstatus: experimental\ndescription: Detects a named pipe used by Turla group samples\nreferences:\n    - Internal Research\ndate: 2017/11/06\ntags:\n    - attack.g0010\nauthor: Markus Neis\nlogsource:\n    product: windows\n    service: sysmon\n    definition: 'Note that you have to configure logging for PipeEvents in Symson config'\ndetection:\n    selection:\n        EventID: \n            - 17\n            - 18\n        PipeName: \n            - '\\atctl' # https://www.virustotal.com/#/file/a4ddb2664a6c87a1d3c5da5a5a32a5df9a0b0c8f2e951811bd1ec1d44d42ccf1/detection\n            - '\\userpipe' # ruag apt case\n            - '\\iehelper' # ruag apt case\n            - '\\sdlrpc' # project cobra https://www.gdatasoftware.com/blog/2015/01/23926-analysis-of-project-cobra\n            - '\\comnap' # https://www.gdatasoftware.com/blog/2015/01/23926-analysis-of-project-cobra\n            # - '\\rpc'  # may cause too many false positives : http://kb.palisade.com/index.php?pg=kb.page&id=483\n    condition: selection\nfalsepositives:\n    - Unkown\nlevel: critical\n\n", "object_marking_refs": ["marking-definition--0a872d70-1d05-45dd-a25f-031af547a102"], "created_by_ref": "identity--082ca4f0-d825-45b6-aa42-ab9afd1e5503", "type": "indicator", "spec_version": "2.1", "id": "indicator--232d17cf-4024-4ada-b1b4-10cec42af824", "modified": "2020-04-02T07:59:02.064Z"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--01b91fcc-7ea6-44a7-92f8-23e6c1e590fe", "created": "2020-04-02T07:59:02.081Z", "modified": "2020-04-02T07:59:02.081Z", "source_ref": "indicator--232d17cf-4024-4ada-b1b4-10cec42af824", "relationship_type": "indicates", "target_ref": "intrusion-set--7a19ecb1-3c65-4de3-a230-993516aed6a6"}, {"name": "RDP Sensitive Settings Changed", "description": "Detects changes to RDP terminal service sensitive settings", "created": "2019-04-03T00:00:00.000Z", "valid_from": "2019-04-03T00:00:00Z", "indicator_types": ["malicious-activity"], "pattern_type": "sigma", "pattern": "title: RDP Sensitive Settings Changed\nid: 171b67e1-74b4-460e-8d55-b331f3e32d67\ndescription: Detects changes to RDP terminal service sensitive settings\nreferences:\n    - https://blog.menasec.net/2019/02/threat-hunting-rdp-hijacking-via.html\ndate: 2019/04/03\nauthor: Samir Bousseaden\nlogsource:\n    product: windows\n    service: sysmon\ndetection:\n    selection_reg:\n        EventID: 13\n        TargetObject:\n            - '*\\services\\TermService\\Parameters\\ServiceDll*'\n            - '*\\Control\\Terminal Server\\fSingleSessionPerUser*'\n            - '*\\Control\\Terminal Server\\fDenyTSConnections*'\n    condition: selection_reg\ntags:\n    - attack.defense_evasion\nfalsepositives:\n    - unknown\nlevel: high\n", "object_marking_refs": ["marking-definition--0a872d70-1d05-45dd-a25f-031af547a102"], "created_by_ref": "identity--082ca4f0-d825-45b6-aa42-ab9afd1e5503", "type": "indicator", "spec_version": "2.1", "id": "indicator--8fe06b41-5134-4e07-99d0-00c750217590", "modified": "2020-04-02T07:59:02.085Z"}, {"name": "Reconnaissance Activity", "description": "Detects activity as \"net user administrator /domain\" and \"net group domain admins /domain\"", "created": "2017-03-07T00:00:00.000Z", "valid_from": "2017-03-07T00:00:00Z", "indicator_types": ["malicious-activity"], "pattern_type": "sigma", "pattern": "title: Reconnaissance Activity\nid: 968eef52-9cff-4454-8992-1e74b9cbad6c\nstatus: experimental\ndescription: Detects activity as \"net user administrator /domain\" and \"net group domain admins /domain\"\nreferences:\n    - https://findingbad.blogspot.de/2017/01/hunting-what-does-it-look-like.html\nauthor: Florian Roth (rule), Jack Croock (method)\ndate: 2017/03/07\ntags:\n    - attack.discovery\n    - attack.t1087\n    - attack.t1069\n    - attack.s0039\nlogsource:\n    product: windows\n    service: security\n    definition: The volume of Event ID 4661 is high on Domain Controllers and therefore \"Audit SAM\" and \"Audit Kernel Object\" advanced audit policy settings are not configured in the recommendations for server systems\ndetection:\n    selection:\n        - EventID: 4661\n          ObjectType: 'SAM_USER'\n          ObjectName: 'S-1-5-21-*-500'\n          AccessMask: '0x2d'\n        - EventID: 4661\n          ObjectType: 'SAM_GROUP'\n          ObjectName: 'S-1-5-21-*-512'\n          AccessMask: '0x2d'\n    condition: selection\nfalsepositives:\n    - Administrator activity\n    - Penetration tests\nlevel: high\n", "object_marking_refs": ["marking-definition--0a872d70-1d05-45dd-a25f-031af547a102"], "created_by_ref": "identity--082ca4f0-d825-45b6-aa42-ab9afd1e5503", "type": "indicator", "spec_version": "2.1", "id": "indicator--db6b75ab-ad1a-484f-a8bc-f2319d2d39df", "modified": "2020-04-02T07:59:02.096Z"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--c757f901-20dc-424d-8960-cc5c41c68607", "created": "2020-04-02T07:59:02.110Z", "modified": "2020-04-02T07:59:02.110Z", "source_ref": "indicator--db6b75ab-ad1a-484f-a8bc-f2319d2d39df", "relationship_type": "indicates", "target_ref": "attack-pattern--72b74d71-8169-42aa-92e0-e7b04b9f5a08"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--27d33472-207c-42f9-a4f3-c0f9eca82348", "created": "2020-04-02T07:59:02.117Z", "modified": "2020-04-02T07:59:02.117Z", "source_ref": "indicator--db6b75ab-ad1a-484f-a8bc-f2319d2d39df", "relationship_type": "indicates", "target_ref": "attack-pattern--15dbf668-795c-41e6-8219-f0447c0e64ce"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--0cdcb1e6-8d96-4cb2-bd0b-856db7c4765f", "created": "2020-04-02T07:59:02.124Z", "modified": "2020-04-02T07:59:02.124Z", "source_ref": "indicator--db6b75ab-ad1a-484f-a8bc-f2319d2d39df", "relationship_type": "indicates", "target_ref": "tool--03342581-f790-4f03-ba41-e82e67392e23"}, {"name": "Suspicious Kerberos RC4 Ticket Encryption", "description": "Detects service ticket requests using RC4 encryption type", "created": "2017-02-06T00:00:00.000Z", "valid_from": "2017-02-06T00:00:00Z", "indicator_types": ["malicious-activity"], "pattern_type": "sigma", "pattern": "title: Suspicious Kerberos RC4 Ticket Encryption\nid: 496a0e47-0a33-4dca-b009-9e6ca3591f39\nstatus: experimental\nreferences:\n    - https://adsecurity.org/?p=3458\n    - https://www.trimarcsecurity.com/single-post/TrimarcResearch/Detecting-Kerberoasting-Activity\ntags:\n    - attack.credential_access\n    - attack.t1208\ndescription: Detects service ticket requests using RC4 encryption type\nauthor: Florian Roth\ndate: 2017/02/06\nlogsource:\n    product: windows\n    service: security\ndetection:\n    selection:\n        EventID: 4769\n        TicketOptions: '0x40810000'\n        TicketEncryptionType: '0x17'\n    reduction:\n        - ServiceName: '$*'\n    condition: selection and not reduction\nfalsepositives:\n    - Service accounts used on legacy systems (e.g. NetApp)\n    - Windows Domains with DFL 2003 and legacy systems\nlevel: medium\n", "object_marking_refs": ["marking-definition--0a872d70-1d05-45dd-a25f-031af547a102"], "created_by_ref": "identity--082ca4f0-d825-45b6-aa42-ab9afd1e5503", "type": "indicator", "spec_version": "2.1", "id": "indicator--4da5075b-0bd4-4ca1-8f61-39638b88aedc", "modified": "2020-04-02T07:59:02.127Z"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--cd51f6ed-2eb8-43a8-a8ca-7c49e91c0097", "created": "2020-04-02T07:59:02.143Z", "modified": "2020-04-02T07:59:02.143Z", "source_ref": "indicator--4da5075b-0bd4-4ca1-8f61-39638b88aedc", "relationship_type": "indicates", "target_ref": "attack-pattern--b39d03cb-7b98-41c4-a878-c40c1a913dc0"}, {"name": "SAM Dump to AppData", "description": "Detects suspicious SAM dump activity as cause by QuarksPwDump and other password dumpers", "created": "2018-01-27T00:00:00.000Z", "valid_from": "2018-01-27T00:00:00Z", "indicator_types": ["malicious-activity"], "pattern_type": "sigma", "pattern": "title: SAM Dump to AppData\nid: 839dd1e8-eda8-4834-8145-01beeee33acd\nstatus: experimental\ndescription: Detects suspicious SAM dump activity as cause by QuarksPwDump and other password dumpers\ntags:\n    - attack.credential_access\n    - attack.t1003\nauthor: Florian Roth\ndate: 2018/01/27\nlogsource:\n    product: windows\n    service: system\n    definition: The source of this type of event is Kernel-General\ndetection:\n    selection:\n        EventID: 16\n        Message:\n            - '*\\AppData\\Local\\Temp\\SAM-*.dmp *'\n    condition: selection\nfalsepositives:\n    - Penetration testing\nlevel: high\n", "object_marking_refs": ["marking-definition--0a872d70-1d05-45dd-a25f-031af547a102"], "created_by_ref": "identity--082ca4f0-d825-45b6-aa42-ab9afd1e5503", "type": "indicator", "spec_version": "2.1", "id": "indicator--f6e483a7-5a76-4929-bb3e-21c1734ac566", "modified": "2020-04-02T07:59:02.146Z"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--6b1c6290-462b-4da5-83f8-623205b33dc4", "created": "2020-04-02T07:59:02.154Z", "modified": "2020-04-02T07:59:02.154Z", "source_ref": "indicator--f6e483a7-5a76-4929-bb3e-21c1734ac566", "relationship_type": "indicates", "target_ref": "attack-pattern--0a3ead4e-6d47-4ccb-854c-a6a4f9d96b22"}, {"name": "Unauthorized System Time Modification", "description": "Detect scenarios where a potentially unauthorized application or user is modifying the system time.", "created": "2019-02-05T00:00:00.000Z", "valid_from": "2019-02-05T00:00:00Z", "indicator_types": ["malicious-activity"], "pattern_type": "sigma", "pattern": "title: Unauthorized System Time Modification\nid: faa031b5-21ed-4e02-8881-2591f98d82ed\nstatus: experimental\ndescription: Detect scenarios where a potentially unauthorized application or user is modifying the system time.\nauthor: '@neu5ron'\nreferences:\n    - Private Cuckoo Sandbox (from many years ago, no longer have hash, NDA as well)\n    - Live environment caused by malware\ndate: 2019/02/05\nmidified: 2020/01/27\ntags:\n    - attack.defense_evasion\n    - attack.t1099\nlogsource:\n    product: windows\n    service: security\n    definition: 'Requirements: Audit Policy : System > Audit Security State Change, Group Policy : Computer Configuration\\Windows Settings\\Security Settings\\Advanced Audit Policy Configuration\\Audit Policies\\System\\Audit Security State Change'\ndetection:\n    selection:\n        EventID: 4616\n    filter1:\n        ProcessName: 'C:\\Program Files\\VMware\\VMware Tools\\vmtoolsd.exe'\n    filter2:\n        ProcessName: 'C:\\Windows\\System32\\VBoxService.exe'\n    filter3:\n        ProcessName: 'C:\\Windows\\System32\\svchost.exe'\n        SubjectUserSid: 'S-1-5-19'\n    condition: selection and not ( filter1 or filter2 or filter3 )\nfalsepositives:\n    - HyperV or other virtualization technologies with binary not listed in filter portion of detection\nlevel: medium\n", "object_marking_refs": ["marking-definition--0a872d70-1d05-45dd-a25f-031af547a102"], "created_by_ref": "identity--082ca4f0-d825-45b6-aa42-ab9afd1e5503", "type": "indicator", "spec_version": "2.1", "id": "indicator--1bbc3b63-0302-4409-9473-e7a0e9ef29ab", "modified": "2020-04-02T07:59:02.159Z"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--1da38474-ca34-4f6f-89fe-9ea2fd5dbbde", "created": "2020-04-02T07:59:02.170Z", "modified": "2020-04-02T07:59:02.170Z", "source_ref": "indicator--1bbc3b63-0302-4409-9473-e7a0e9ef29ab", "relationship_type": "indicates", "target_ref": "attack-pattern--128c55d3-aeba-469f-bd3e-c8996ab4112a"}, {"name": "External Disk Drive or USB Storage Device", "description": "Detects external diskdrives or plugged in USB devices", "created": "2019-11-20T00:00:00.000Z", "valid_from": "2019-11-20T00:00:00Z", "indicator_types": ["malicious-activity"], "pattern_type": "sigma", "pattern": "title: External Disk Drive or USB Storage Device\nid: f69a87ea-955e-4fb4-adb2-bb9fd6685632\ndescription: Detects external diskdrives or plugged in USB devices\nstatus: experimental\nauthor: Keith Wright\ndate: 2019/11/20\ntags:\n    - attack.t1091\n    - attack.t1200\n    - attack.lateral_movement\n    - attack.initial_access\nlogsource:\n    product: windows\n    service: security\ndetection:\n    selection:\n        EventID: \n            - 6416\n        DeviceClassName: 'DiskDrive'  \n    selection2:\n        DeviceDescription: 'USB Mass Storage Device'\n    condition: selection or selection2\nfalsepositives: \n    - Legitimate administrative activity\nlevel: low\n", "object_marking_refs": ["marking-definition--0a872d70-1d05-45dd-a25f-031af547a102"], "created_by_ref": "identity--082ca4f0-d825-45b6-aa42-ab9afd1e5503", "type": "indicator", "spec_version": "2.1", "id": "indicator--907498d8-6b6b-4e25-938e-10616dd9fa4c", "modified": "2020-04-02T07:59:02.173Z"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--760d11e4-c43b-407a-8d6f-5008227fb205", "created": "2020-04-02T07:59:02.181Z", "modified": "2020-04-02T07:59:02.181Z", "source_ref": "indicator--907498d8-6b6b-4e25-938e-10616dd9fa4c", "relationship_type": "indicates", "target_ref": "attack-pattern--3b744087-9945-4a6f-91e8-9dbceda417a4"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--a68ccbcb-687c-4ed7-9370-73823a80fdff", "created": "2020-04-02T07:59:02.187Z", "modified": "2020-04-02T07:59:02.187Z", "source_ref": "indicator--907498d8-6b6b-4e25-938e-10616dd9fa4c", "relationship_type": "indicates", "target_ref": "attack-pattern--d40239b3-05ff-46d8-9bdd-b46d13463ef9"}, {"name": "Persistence and Execution at Scale via GPO Scheduled Task", "description": "Detect lateral movement using GPO scheduled task, ususally used to deploy ransomware at scale", "created": "2019-04-03T00:00:00.000Z", "valid_from": "2019-04-03T00:00:00Z", "indicator_types": ["malicious-activity"], "pattern_type": "sigma", "pattern": "title: Persistence and Execution at Scale via GPO Scheduled Task\nid: a8f29a7b-b137-4446-80a0-b804272f3da2\ndescription: Detect lateral movement using GPO scheduled task, ususally used to deploy ransomware at scale\nauthor: Samir Bousseaden\ndate: 2019/04/03\nreferences:\n    - https://twitter.com/menasec1/status/1106899890377052160\ntags:\n    - attack.persistence\n    - attack.lateral_movement\n    - attack.t1053\nlogsource:\n    product: windows\n    service: security\n    description: 'The advanced audit policy setting \"Object Access > Audit Detailed File Share\" must be configured for Success/Failure'\ndetection:\n    selection:\n        EventID: 5145\n        ShareName: \\\\*\\SYSVOL\n        RelativeTargetName: '*ScheduledTasks.xml'\n        Accesses: '*WriteData*'\n    condition: selection\nfalsepositives:\n    - if the source IP is not localhost then it's super suspicious, better to monitor both local and remote changes to GPO scheduledtasks\nlevel: high\n", "object_marking_refs": ["marking-definition--0a872d70-1d05-45dd-a25f-031af547a102"], "created_by_ref": "identity--082ca4f0-d825-45b6-aa42-ab9afd1e5503", "type": "indicator", "spec_version": "2.1", "id": "indicator--efa0a65e-6d14-428c-839d-d573b9204e0f", "modified": "2020-04-02T07:59:02.191Z"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--fa5187b6-699d-4e3e-bc4c-8a329065619f", "created": "2020-04-02T07:59:02.202Z", "modified": "2020-04-02T07:59:02.202Z", "source_ref": "indicator--efa0a65e-6d14-428c-839d-d573b9204e0f", "relationship_type": "indicates", "target_ref": "attack-pattern--35dd844a-b219-4e2b-a6bb-efa9a75995a9"}, {"name": "Credential Dumping Tools Service Execution", "description": "Detects well-known credential dumping tools execution via service execution events", "created": "2017-03-05T00:00:00.000Z", "modified": "2019-11-01T00:00:00.000Z", "valid_from": "2017-03-05T00:00:00Z", "indicator_types": ["malicious-activity"], "pattern_type": "sigma", "pattern": "\naction: global\ntitle: Credential Dumping Tools Service Execution\ndescription: Detects well-known credential dumping tools execution via service execution events\nauthor: Florian Roth, Teymur Kheirkhabarov, Daniil Yugoslavskiy, oscd.community\nid: 4976aa50-8f41-45c6-8b15-ab3fc10e79ed\ndate: 2017/03/05\nmodified: 2019/11/01\nreferences:\n    - https://www.slideshare.net/heirhabarov/hunting-for-credentials-dumping-in-windows-environment\ntags:\n    - attack.credential_access\n    - attack.execution\n    - attack.t1003\n    - attack.t1035\n    - attack.s0005\ndetection:\n    selection_1:\n        - ServiceName|contains:\n            - 'fgexec'\n            - 'wceservice'\n            - 'wce service'\n            - 'pwdump'\n            - 'gsecdump'\n            - 'cachedump'\n            - 'mimikatz'\n            - 'mimidrv'\n        - ImagePath|contains:\n            - 'fgexec'\n            - 'dumpsvc'\n            - 'cachedump'\n            - 'mimidrv'\n            - 'gsecdump'\n            - 'servpw'\n            - 'pwdump'\n        - ImagePath|re: '((\\\\\\\\.*\\\\.*|.*\\\\)([{]?[0-9A-Fa-f]{8}-[0-9A-Fa-f]{4}-[0-9A-Fa-f]{4}-[0-9A-Fa-f]{4}-[0-9A-Fa-f]{12}[}])?\\.(exe|scr|cpl|bat|js|cmd|vbs).*)'\n    condition: selection and selection_1\nfalsepositives:\n    - Legitimate Administrator using credential dumping tool for password recovery\nlevel: high\n", "object_marking_refs": ["marking-definition--0a872d70-1d05-45dd-a25f-031af547a102"], "created_by_ref": "identity--082ca4f0-d825-45b6-aa42-ab9afd1e5503", "type": "indicator", "spec_version": "2.1", "id": "indicator--3346e171-679d-4359-9479-a66ff6dc7347"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--92f2177e-f0a2-4031-8ec4-08329b6d817d", "created": "2020-04-02T07:59:02.217Z", "modified": "2020-04-02T07:59:02.217Z", "source_ref": "indicator--3346e171-679d-4359-9479-a66ff6dc7347", "relationship_type": "indicates", "target_ref": "attack-pattern--0a3ead4e-6d47-4ccb-854c-a6a4f9d96b22"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--19fa6a11-9c30-4475-b6a7-992aed8a9deb", "created": "2020-04-02T07:59:02.225Z", "modified": "2020-04-02T07:59:02.225Z", "source_ref": "indicator--3346e171-679d-4359-9479-a66ff6dc7347", "relationship_type": "indicates", "target_ref": "attack-pattern--f44731de-ea9f-406d-9b83-30ecbb9b4392"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--cdef9aff-0706-495d-845f-2b951ae67f1c", "created": "2020-04-02T07:59:02.231Z", "modified": "2020-04-02T07:59:02.231Z", "source_ref": "indicator--3346e171-679d-4359-9479-a66ff6dc7347", "relationship_type": "indicates", "target_ref": "tool--242f3da3-4425-4d11-8f5c-b842886da966"}, {"name": "Turla Service Install", "description": "This method detects a service install of malicious services mentioned in Carbon Paper - Turla report by ESET", "created": "2017-03-31T00:00:00.000Z", "valid_from": "2017-03-31T00:00:00Z", "indicator_types": ["malicious-activity"], "pattern_type": "sigma", "pattern": "title: Turla Service Install\nid: 1df8b3da-b0ac-4d8a-b7c7-6cb7c24160e4\ndescription: This method detects a service install of malicious services mentioned in Carbon Paper - Turla report by ESET\nreferences:\n    - https://www.welivesecurity.com/2017/03/30/carbon-paper-peering-turlas-second-stage-backdoor/\ntags:\n    - attack.persistence\n    - attack.g0010\n    - attack.t1050\ndate: 2017/03/31\nauthor: Florian Roth\nlogsource:\n    product: windows\n    service: system\ndetection:\n    selection:\n        EventID: 7045\n        ServiceName:\n            - 'srservice'\n            - 'ipvpn'\n            - 'hkmsvc'\n    condition: selection\nfalsepositives:\n    - Unknown\nlevel: high\n", "object_marking_refs": ["marking-definition--0a872d70-1d05-45dd-a25f-031af547a102"], "created_by_ref": "identity--082ca4f0-d825-45b6-aa42-ab9afd1e5503", "type": "indicator", "spec_version": "2.1", "id": "indicator--f96bb6ab-018e-48f2-bde0-85606244d2be", "modified": "2020-04-02T07:59:02.239Z"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--26949ca1-4ddd-48b3-a598-a7279978a58a", "created": "2020-04-02T07:59:02.250Z", "modified": "2020-04-02T07:59:02.250Z", "source_ref": "indicator--f96bb6ab-018e-48f2-bde0-85606244d2be", "relationship_type": "indicates", "target_ref": "intrusion-set--7a19ecb1-3c65-4de3-a230-993516aed6a6"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--b46fe1aa-eef7-4c2f-a3bf-057ed086382f", "created": "2020-04-02T07:59:02.260Z", "modified": "2020-04-02T07:59:02.260Z", "source_ref": "indicator--f96bb6ab-018e-48f2-bde0-85606244d2be", "relationship_type": "indicates", "target_ref": "attack-pattern--478aa214-2ca7-4ec0-9978-18798e514790"}, {"name": "SysKey Registry Keys Access", "description": "Detects handle requests and access operations to specific registry keys to calculate the SysKey", "created": "2019-08-12T00:00:00.000Z", "modified": "2019-11-10T00:00:00.000Z", "valid_from": "2019-08-12T00:00:00Z", "indicator_types": ["malicious-activity"], "pattern_type": "sigma", "pattern": "title: SysKey Registry Keys Access\nid: 9a4ff3b8-6187-4fd2-8e8b-e0eae1129495\ndescription: Detects handle requests and access operations to specific registry keys to calculate the SysKey\nstatus: experimental\ndate: 2019/08/12\nmodified: 2019/11/10\nauthor: Roberto Rodriguez @Cyb3rWard0g\nreferences:\n    - https://github.com/hunters-forge/ThreatHunter-Playbook/blob/master/playbooks/windows/07_discovery/T1012_query_registry/syskey_registry_keys_access.md\ntags:\n    - attack.discovery\n    - attack.t1012\nlogsource:\n    product: windows\n    service: security\ndetection:\n    selection:\n        EventID:\n            - 4656\n            - 4663\n        ObjectType: 'key'\n        ObjectName|endswith:\n            - 'lsa\\JD'\n            - 'lsa\\GBG'\n            - 'lsa\\Skew1'\n            - 'lsa\\Data'\n    condition: selection\nfalsepositives:\n    - Unknown\nlevel: critical", "object_marking_refs": ["marking-definition--0a872d70-1d05-45dd-a25f-031af547a102"], "created_by_ref": "identity--082ca4f0-d825-45b6-aa42-ab9afd1e5503", "type": "indicator", "spec_version": "2.1", "id": "indicator--49a16dc4-0d3c-4dd9-ad5a-71cf437e196d"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--03146046-d315-4efd-9229-6c5463b2abf5", "created": "2020-04-02T07:59:02.276Z", "modified": "2020-04-02T07:59:02.276Z", "source_ref": "indicator--49a16dc4-0d3c-4dd9-ad5a-71cf437e196d", "relationship_type": "indicates", "target_ref": "attack-pattern--c32f7008-9fea-41f7-8366-5eb9b74bd896"}, {"name": "Remote PowerShell Sessions", "description": "Detects basic PowerShell Remoting by monitoring for network inbound connections to ports 5985 OR 5986", "created": "2019-09-12T00:00:00.000Z", "valid_from": "2019-09-12T00:00:00Z", "indicator_types": ["malicious-activity"], "pattern_type": "sigma", "pattern": "title: Remote PowerShell Sessions\nid: 13acf386-b8c6-4fe0-9a6e-c4756b974698\ndescription: Detects basic PowerShell Remoting by monitoring for network inbound connections to ports 5985 OR 5986\nstatus: experimental\ndate: 2019/09/12\nauthor: Roberto Rodriguez @Cyb3rWard0g\nreferences:\n    - https://github.com/Cyb3rWard0g/ThreatHunter-Playbook/tree/master/playbooks/windows/02_execution/T1086_powershell/powershell_remote_session.md\ntags:\n    - attack.execution\n    - attack.t1086\nlogsource:\n    product: windows\n    service: security\ndetection:\n    selection: \n        EventID: 5156\n        DestPort:\n            - 5985\n            - 5986\n        LayerRTID: 44\n    condition: selection\nfalsepositives:\n    - Legitimate use of remote PowerShell execution\nlevel: high\n", "object_marking_refs": ["marking-definition--0a872d70-1d05-45dd-a25f-031af547a102"], "created_by_ref": "identity--082ca4f0-d825-45b6-aa42-ab9afd1e5503", "type": "indicator", "spec_version": "2.1", "id": "indicator--aff97c0a-c266-447c-8a8d-2dd473b815a2", "modified": "2020-04-02T07:59:02.280Z"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--ca7e70aa-c30a-4149-be29-ad9d8549d011", "created": "2020-04-02T07:59:02.291Z", "modified": "2020-04-02T07:59:02.291Z", "source_ref": "indicator--aff97c0a-c266-447c-8a8d-2dd473b815a2", "relationship_type": "indicates", "target_ref": "attack-pattern--f4882e23-8aa7-4b12-b28a-b349c12ee9e0"}, {"name": "New or Renamed User Account with '$' in Attribute 'SamAccountName'.", "description": "Detects possible bypass EDR and SIEM via abnormal user account name.", "created": "2019-10-25T00:00:00.000Z", "modified": "2019-11-13T00:00:00.000Z", "valid_from": "2019-10-25T00:00:00Z", "indicator_types": ["malicious-activity"], "pattern_type": "sigma", "pattern": "title: New or Renamed User Account with '$' in Attribute 'SamAccountName'.\nid: cfeed607-6aa4-4bbd-9627-b637deb723c8\nstatus: experimental\ndescription: Detects possible bypass EDR and SIEM via abnormal user account name.\ntags:\n    - attack.defense_evasion\n    - attack.t1036\nauthor: Ilyas Ochkov, oscd.community\ndate: 2019/10/25\nmodified: 2019/11/13\nlogsource:\n    product: windows\n    service: security\ndetection:\n    selection:\n        EventID: \n            - 4720 # create user\n            - 4781 # rename user\n        UserName|contains: '$'    #SamAccountName\n    condition: selection\nfields:\n    - EventID\n    - UserName\n    - SubjectAccountName\nfalsepositives:\n    - Unkown\nlevel: high\n", "object_marking_refs": ["marking-definition--0a872d70-1d05-45dd-a25f-031af547a102"], "created_by_ref": "identity--082ca4f0-d825-45b6-aa42-ab9afd1e5503", "type": "indicator", "spec_version": "2.1", "id": "indicator--9c9a1047-9323-4623-ad38-f1843423670d"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--d3aea2d5-d1a7-4ea7-8a12-2b120d019ff2", "created": "2020-04-02T07:59:02.307Z", "modified": "2020-04-02T07:59:02.307Z", "source_ref": "indicator--9c9a1047-9323-4623-ad38-f1843423670d", "relationship_type": "indicates", "target_ref": "attack-pattern--42e8de7b-37b2-4258-905a-6897815e58e0"}, {"name": "Account Tampering - Suspicious Failed Logon Reasons", "description": "This method uses uncommon error codes on failed logons to determine suspicious activity and tampering with accounts that have been disabled or somehow restricted.", "created": "2017-02-19T00:00:00.000Z", "modified": "2019-03-01T00:00:00.000Z", "valid_from": "2017-02-19T00:00:00Z", "indicator_types": ["malicious-activity"], "pattern_type": "sigma", "pattern": "title: Account Tampering - Suspicious Failed Logon Reasons\nid: 9eb99343-d336-4020-a3cd-67f3819e68ee\ndescription: This method uses uncommon error codes on failed logons to determine suspicious activity and tampering with accounts that have been disabled or somehow\n    restricted.\nauthor: Florian Roth\ndate: 2017/02/19\nmodified: 2019/03/01\nreferences:\n    - https://twitter.com/SBousseaden/status/1101431884540710913\ntags:\n    - attack.persistence\n    - attack.privilege_escalation\n    - attack.t1078\nlogsource:\n    product: windows\n    service: security\ndetection:\n    selection:\n        EventID:\n            - 4625\n            - 4776\n        Status:\n            - '0xC0000072'  # User logon to account disabled by administrator\n            - '0xC000006F'  # User logon outside authorized hours\n            - '0xC0000070'  # User logon from unauthorized workstation\n            - '0xC0000413'  # Logon Failure: The machine you are logging onto is protected by an authentication firewall. The specified account is not allowed to authenticate to the machine\n            - '0xC000018C'  # The logon request failed because the trust relationship between the primary domain and the trusted domain failed\n            - '0xC000015B'  # The user has not been granted the requested logon type (aka logon right) at this machine\n    condition: selection\nfalsepositives:\n    - User using a disabled account\nlevel: high\n", "object_marking_refs": ["marking-definition--0a872d70-1d05-45dd-a25f-031af547a102"], "created_by_ref": "identity--082ca4f0-d825-45b6-aa42-ab9afd1e5503", "type": "indicator", "spec_version": "2.1", "id": "indicator--dbb0b8b5-9ace-4549-a19a-b759ce21b05e"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--b166940e-b898-4378-a086-564c6e7f432b", "created": "2020-04-02T07:59:02.325Z", "modified": "2020-04-02T07:59:02.325Z", "source_ref": "indicator--dbb0b8b5-9ace-4549-a19a-b759ce21b05e", "relationship_type": "indicates", "target_ref": "attack-pattern--b17a1a56-e99c-403c-8948-561df0cffe81"}, {"name": "Mimikatz DC Sync", "description": "Detects Mimikatz DC sync security events", "created": "2018-06-03T00:00:00.000Z", "modified": "2019-10-08T00:00:00.000Z", "valid_from": "2018-06-03T00:00:00Z", "indicator_types": ["malicious-activity"], "pattern_type": "sigma", "pattern": "title: Mimikatz DC Sync\nid: 611eab06-a145-4dfa-a295-3ccc5c20f59a\ndescription: Detects Mimikatz DC sync security events\nstatus: experimental\ndate: 2018/06/03\nmodified: 2019/10/08\nauthor: Benjamin Delpy, Florian Roth\nreferences:\n    - https://twitter.com/gentilkiwi/status/1003236624925413376\n    - https://gist.github.com/gentilkiwi/dcc132457408cf11ad2061340dcb53c2\ntags:\n    - attack.credential_access\n    - attack.s0002\n    - attack.t1003\nlogsource:\n    product: windows\n    service: security\ndetection:\n    selection:\n        EventID: 4662\n        Properties: \n            - '*Replicating Directory Changes All*'\n            - '*1131f6ad-9c07-11d1-f79f-00c04fc2dcd2*'\n    filter1:\n        SubjectDomainName: 'Window Manager'\n    filter2: \n        SubjectUserName:\n            - 'NT AUTHORITY*'\n            - '*$'\n    condition: selection and not filter1 and not filter2\nfalsepositives:\n    - Valid DC Sync that is not covered by the filters; please report\nlevel: high\n\n", "object_marking_refs": ["marking-definition--0a872d70-1d05-45dd-a25f-031af547a102"], "created_by_ref": "identity--082ca4f0-d825-45b6-aa42-ab9afd1e5503", "type": "indicator", "spec_version": "2.1", "id": "indicator--4f0b2e22-298b-44a0-b58c-ac1202435172"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--09b73676-2ff7-4184-9655-1a207dbd21e0", "created": "2020-04-02T07:59:02.342Z", "modified": "2020-04-02T07:59:02.342Z", "source_ref": "indicator--4f0b2e22-298b-44a0-b58c-ac1202435172", "relationship_type": "indicates", "target_ref": "tool--afc079f3-c0ea-4096-b75d-3f05338b7f60"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--831ee1fe-fe5d-4181-bdc5-1bfeaade29a1", "created": "2020-04-02T07:59:02.351Z", "modified": "2020-04-02T07:59:02.351Z", "source_ref": "indicator--4f0b2e22-298b-44a0-b58c-ac1202435172", "relationship_type": "indicates", "target_ref": "attack-pattern--0a3ead4e-6d47-4ccb-854c-a6a4f9d96b22"}, {"name": "RDP Login from Localhost", "description": "RDP login with localhost source address may be a tunnelled login", "created": "2019-01-28T00:00:00.000Z", "modified": "2019-01-29T00:00:00.000Z", "valid_from": "2019-01-28T00:00:00Z", "indicator_types": ["malicious-activity"], "pattern_type": "sigma", "pattern": "title: RDP Login from Localhost\nid: 51e33403-2a37-4d66-a574-1fda1782cc31\ndescription: RDP login with localhost source address may be a tunnelled login\nreferences:\n    - https://www.fireeye.com/blog/threat-research/2019/01/bypassing-network-restrictions-through-rdp-tunneling.html\ndate: 2019/01/28\nmodified: 2019/01/29\ntags:\n    - attack.lateral_movement\n    - attack.t1076\n    - car.2013-07-002\nstatus: experimental\nauthor: Thomas Patzke\nlogsource:\n    product: windows\n    service: security\ndetection:\n    selection:\n        EventID: 4624\n        LogonType: 10\n        SourceNetworkAddress:\n            - \"::1\"\n            - \"127.0.0.1\"\n    condition: selection\nfalsepositives:\n    - Unknown\nlevel: high\n", "object_marking_refs": ["marking-definition--0a872d70-1d05-45dd-a25f-031af547a102"], "created_by_ref": "identity--082ca4f0-d825-45b6-aa42-ab9afd1e5503", "type": "indicator", "spec_version": "2.1", "id": "indicator--6d14d4f4-fb58-4e50-9ff8-8994738050c1"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--74e2a015-3a68-447a-b55e-5690b2be423e", "created": "2020-04-02T07:59:02.367Z", "modified": "2020-04-02T07:59:02.367Z", "source_ref": "indicator--6d14d4f4-fb58-4e50-9ff8-8994738050c1", "relationship_type": "indicates", "target_ref": "attack-pattern--51dea151-0898-4a45-967c-3ebee0420484"}, {"name": "Remote Service Activity via SVCCTL Named Pipe", "description": "Detects remote remote service activity via remote access to the svcctl named pipe", "created": "2019-04-03T00:00:00.000Z", "valid_from": "2019-04-03T00:00:00Z", "indicator_types": ["malicious-activity"], "pattern_type": "sigma", "pattern": "title: Remote Service Activity via SVCCTL Named Pipe\nid: 586a8d6b-6bfe-4ad9-9d78-888cd2fe50c3\ndescription: Detects remote remote service activity via remote access to the svcctl named pipe\nauthor: Samir Bousseaden\ndate: 2019/04/03\nreferences:\n    - https://blog.menasec.net/2019/03/threat-hunting-26-remote-windows.html\ntags:\n    - attack.lateral_movement\n    - attack.persistence\nlogsource:\n    product: windows\n    service: security\n    description: 'The advanced audit policy setting \"Object Access > Audit Detailed File Share\" must be configured for Success/Failure'\ndetection:\n    selection:\n        EventID: 5145\n        ShareName: \\\\*\\IPC$\n        RelativeTargetName: svcctl\n        Accesses: '*WriteData*'\n    condition: selection\nfalsepositives:\n    - pentesting\nlevel: medium\n", "object_marking_refs": ["marking-definition--0a872d70-1d05-45dd-a25f-031af547a102"], "created_by_ref": "identity--082ca4f0-d825-45b6-aa42-ab9afd1e5503", "type": "indicator", "spec_version": "2.1", "id": "indicator--be248cfc-da37-4b66-b5d4-96db17267bf1", "modified": "2020-04-02T07:59:02.371Z"}, {"name": "AD Privileged Users or Groups Reconnaissance", "description": "Detect priv users or groups recon based on 4661 eventid and known privileged users or groups SIDs", "created": "2019-04-03T00:00:00.000Z", "valid_from": "2019-04-03T00:00:00Z", "indicator_types": ["malicious-activity"], "pattern_type": "sigma", "pattern": "title: AD Privileged Users or Groups Reconnaissance\nid: 35ba1d85-724d-42a3-889f-2e2362bcaf23\ndescription: Detect priv users or groups recon based on 4661 eventid and known privileged users or groups SIDs\nreferences:\n    - https://blog.menasec.net/2019/02/threat-hunting-5-detecting-enumeration.html\ntags:\n    - attack.discovery\n    - attack.t1087\nstatus: experimental\nauthor: Samir Bousseaden\ndate: 2019/04/03\nlogsource:\n    product: windows\n    service: security\n    definition: 'Requirements: enable Object Access SAM on your Domain Controllers'\ndetection:\n    selection:\n        EventID: 4661\n        ObjectType:\n        - 'SAM_USER'\n        - 'SAM_GROUP'\n        ObjectName:\n         - '*-512'\n         - '*-502'\n         - '*-500'\n         - '*-505'\n         - '*-519'\n         - '*-520'\n         - '*-544'\n         - '*-551'\n         - '*-555'\n         - '*admin*'\n    condition: selection\nfalsepositives:\n    - if source account name is not an admin then its super suspicious\nlevel: high\n", "object_marking_refs": ["marking-definition--0a872d70-1d05-45dd-a25f-031af547a102"], "created_by_ref": "identity--082ca4f0-d825-45b6-aa42-ab9afd1e5503", "type": "indicator", "spec_version": "2.1", "id": "indicator--1933c349-0ad8-4cb4-84d4-49cdbfcd1238", "modified": "2020-04-02T07:59:02.377Z"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--42f1caff-b195-4cb3-b4e3-7bee151f076e", "created": "2020-04-02T07:59:02.386Z", "modified": "2020-04-02T07:59:02.386Z", "source_ref": "indicator--1933c349-0ad8-4cb4-84d4-49cdbfcd1238", "relationship_type": "indicates", "target_ref": "attack-pattern--72b74d71-8169-42aa-92e0-e7b04b9f5a08"}, {"name": "Secure Deletion with SDelete", "description": "Detects renaming of file while deletion with SDelete tool", "created": "2017-06-14T00:00:00.000Z", "valid_from": "2017-06-14T00:00:00Z", "indicator_types": ["malicious-activity"], "pattern_type": "sigma", "pattern": "title: Secure Deletion with SDelete\nid: 39a80702-d7ca-4a83-b776-525b1f86a36d\nstatus: experimental\ndescription: Detects renaming of file while deletion with SDelete tool\nauthor: Thomas Patzke\ndate: 2017/06/14\nreferences:\n    - https://jpcertcc.github.io/ToolAnalysisResultSheet\n    - https://www.jpcert.or.jp/english/pub/sr/ir_research.html\n    - https://technet.microsoft.com/en-us/en-en/sysinternals/sdelete.aspx\ntags:\n    - attack.defense_evasion\n    - attack.t1107\n    - attack.t1066\n    - attack.s0195\nlogsource:\n    product: windows\n    service: security\ndetection:\n    selection:\n        EventID:\n            - 4656\n            - 4663\n            - 4658\n        ObjectName:\n            - '*.AAA'\n            - '*.ZZZ'\n    condition: selection\nfalsepositives:\n    - Legitime usage of SDelete\nlevel: medium\n", "object_marking_refs": ["marking-definition--0a872d70-1d05-45dd-a25f-031af547a102"], "created_by_ref": "identity--082ca4f0-d825-45b6-aa42-ab9afd1e5503", "type": "indicator", "spec_version": "2.1", "id": "indicator--b612a495-3b9c-4e90-93eb-eae2d740848b", "modified": "2020-04-02T07:59:02.390Z"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--a5211062-56d5-4a77-bf3f-7c9f0a105400", "created": "2020-04-02T07:59:02.402Z", "modified": "2020-04-02T07:59:02.402Z", "source_ref": "indicator--b612a495-3b9c-4e90-93eb-eae2d740848b", "relationship_type": "indicates", "target_ref": "attack-pattern--56fca983-1cf1-4fd1-bda0-5e170a37ab59"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--c33acba4-76cd-486a-a20d-a69767af9be5", "created": "2020-04-02T07:59:02.413Z", "modified": "2020-04-02T07:59:02.413Z", "source_ref": "indicator--b612a495-3b9c-4e90-93eb-eae2d740848b", "relationship_type": "indicates", "target_ref": "attack-pattern--00d0b012-8a03-410e-95de-5826bf542de6"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--85c7e7db-0ae6-421b-9d84-d7c3c68e1fbb", "created": "2020-04-02T07:59:02.421Z", "modified": "2020-04-02T07:59:02.421Z", "source_ref": "indicator--b612a495-3b9c-4e90-93eb-eae2d740848b", "relationship_type": "indicates", "target_ref": "tool--d8d19e33-94fd-4aa3-b94a-08ee801a2153"}, {"name": "Pass the Hash Activity 2", "description": "Detects the attack technique pass the hash which is used to move laterally inside the network", "created": "2019-06-14T00:00:00.000Z", "valid_from": "2019-06-14T00:00:00Z", "indicator_types": ["malicious-activity"], "pattern_type": "sigma", "pattern": "title: Pass the Hash Activity 2\nid: 8eef149c-bd26-49f2-9e5a-9b00e3af499b\nstatus: production\ndescription: Detects the attack technique pass the hash which is used to move laterally inside the network\nreferences:\n    - https://github.com/iadgov/Event-Forwarding-Guidance/tree/master/Events\n    - https://blog.binarydefense.com/reliably-detecting-pass-the-hash-through-event-log-analysis\n    - https://blog.stealthbits.com/how-to-detect-pass-the-hash-attacks/\nauthor: Dave Kennedy, Jeff Warren (method) / David Vassallo (rule)\ndate: 2019/06/14\ntags:\n    - attack.lateral_movement\n    - attack.t1075\nlogsource:\n    product: windows\n    service: security\n    definition: The successful use of PtH for lateral movement between workstations would trigger event ID 4624\ndetection:\n    selection:\n        - EventID: 4624\n          SubjectUserSid: 'S-1-0-0'\n          LogonType: '3'\n          LogonProcessName: 'NtLmSsp'\n          KeyLength: '0'\n        - EventID: 4624\n          LogonType: '9'\n          LogonProcessName: 'seclogo'\n    filter:\n        AccountName: 'ANONYMOUS LOGON'\n    condition: selection and not filter\nfalsepositives:\n    - Administrator activity\n    - Penetration tests\nlevel: medium\n", "object_marking_refs": ["marking-definition--0a872d70-1d05-45dd-a25f-031af547a102"], "created_by_ref": "identity--082ca4f0-d825-45b6-aa42-ab9afd1e5503", "type": "indicator", "spec_version": "2.1", "id": "indicator--096e1ccb-9814-4352-bd32-fdd90e60ed8b", "modified": "2020-04-02T07:59:02.426Z"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--e8ee7cf7-31e6-4dd2-a4e0-1d6a43726d8f", "created": "2020-04-02T07:59:02.437Z", "modified": "2020-04-02T07:59:02.437Z", "source_ref": "indicator--096e1ccb-9814-4352-bd32-fdd90e60ed8b", "relationship_type": "indicates", "target_ref": "attack-pattern--c23b740b-a42b-47a1-aec2-9d48ddd547ff"}, {"name": "Active Directory User Backdoors", "description": "Detects scenarios where one can control another users or computers account without having to use their credentials.", "created": "2017-04-13T00:00:00.000Z", "valid_from": "2017-04-13T00:00:00Z", "indicator_types": ["malicious-activity"], "pattern_type": "sigma", "pattern": "title: Active Directory User Backdoors\nid: 300bac00-e041-4ee2-9c36-e262656a6ecc\ndescription: Detects scenarios where one can control another users or computers account without having to use their credentials.\nreferences:\n    - https://msdn.microsoft.com/en-us/library/cc220234.aspx\n    - https://adsecurity.org/?p=3466\n    - https://www.harmj0y.net/blog/redteaming/another-word-on-delegation/\nauthor: '@neu5ron'\ndate: 2017/04/13\ntags:\n    - attack.t1098\n    - attack.credential_access\n    - attack.persistence\nlogsource:\n    product: windows\n    service: security\n    definition1: 'Requirements: Audit Policy : Account Management > Audit User Account Management, Group Policy : Computer Configuration\\Windows Settings\\Security Settings\\Advanced Audit Policy Configuration\\Audit Policies\\Account Management\\Audit User Account Management'\n    definition2: 'Requirements: Audit Policy : DS Access > Audit Directory Service Changes, Group Policy : Computer Configuration\\Windows Settings\\Security Settings\\Advanced Audit Policy Configuration\\Audit Policies\\DS Access\\Audit Directory Service Changes'\ndetection:\n    selection1:\n        EventID: 4738\n    filter1:\n        AllowedToDelegateTo: \n            - null\n            - '-'\n    selection2:\n        EventID: 5136\n        AttributeLDAPDisplayName: 'msDS-AllowedToDelegateTo'\n    selection3:\n        EventID: 5136\n        ObjectClass: 'user'\n        AttributeLDAPDisplayName: 'servicePrincipalName'\n    selection4:\n        EventID: 5136\n        AttributeLDAPDisplayName: 'msDS-AllowedToActOnBehalfOfOtherIdentity'\n    condition: (selection1 and not 1 of filter*) or selection2 or selection3 or selection4\nfalsepositives:\n    - Unknown\nlevel: high\n", "object_marking_refs": ["marking-definition--0a872d70-1d05-45dd-a25f-031af547a102"], "created_by_ref": "identity--082ca4f0-d825-45b6-aa42-ab9afd1e5503", "type": "indicator", "spec_version": "2.1", "id": "indicator--20fcf58a-8232-4ff2-a74e-2eb08232c2c2", "modified": "2020-04-02T07:59:02.444Z"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--6f3d8725-8563-49e5-81c8-ee04cb9b1940", "created": "2020-04-02T07:59:02.453Z", "modified": "2020-04-02T07:59:02.453Z", "source_ref": "indicator--20fcf58a-8232-4ff2-a74e-2eb08232c2c2", "relationship_type": "indicates", "target_ref": "attack-pattern--a10641f4-87b4-45a3-a906-92a149cb2c27"}, {"name": "QuarksPwDump Clearing Access History", "description": "Detects QuarksPwDump clearing access history in hive", "created": "2017-05-15T00:00:00.000Z", "modified": "2019-11-13T00:00:00.000Z", "valid_from": "2017-05-15T00:00:00Z", "indicator_types": ["malicious-activity"], "pattern_type": "sigma", "pattern": "title: QuarksPwDump Clearing Access History\nid: 39f919f3-980b-4e6f-a975-8af7e507ef2b\nstatus: experimental\ndescription: Detects QuarksPwDump clearing access history in hive\nauthor: Florian Roth\ndate: 2017/05/15\nmodified: 2019/11/13\ntags:\n    - attack.credential_access\n    - attack.t1003\nlevel: critical\nlogsource:\n    product: windows\n    service: system\ndetection:\n    selection:\n        EventID: 16\n        HiveName|contains: '\\AppData\\Local\\Temp\\SAM'\n        HiveName|endswith: '.dmp'\n    condition: selection\nfalsepositives:\n    - Unknown\n", "object_marking_refs": ["marking-definition--0a872d70-1d05-45dd-a25f-031af547a102"], "created_by_ref": "identity--082ca4f0-d825-45b6-aa42-ab9afd1e5503", "type": "indicator", "spec_version": "2.1", "id": "indicator--04bc890a-13ae-458a-bc12-191b2916bbc4"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--c4bfc6ff-a127-4f80-ae09-75231c3ee701", "created": "2020-04-02T07:59:02.468Z", "modified": "2020-04-02T07:59:02.468Z", "source_ref": "indicator--04bc890a-13ae-458a-bc12-191b2916bbc4", "relationship_type": "indicates", "target_ref": "attack-pattern--0a3ead4e-6d47-4ccb-854c-a6a4f9d96b22"}, {"name": "Addition of SID History to Active Directory Object", "description": "An attacker can use the SID history attribute to gain additional privileges.", "created": "2017-02-19T00:00:00.000Z", "valid_from": "2017-02-19T00:00:00Z", "indicator_types": ["malicious-activity"], "pattern_type": "sigma", "pattern": "title: Addition of SID History to Active Directory Object\nid: 2632954e-db1c-49cb-9936-67d1ef1d17d2\nstatus: stable\ndescription: An attacker can use the SID history attribute to gain additional privileges.\nreferences:\n    - https://adsecurity.org/?p=1772\nauthor: Thomas Patzke, @atc_project (improvements)\ndate: 2017/02/19\ntags:\n    - attack.persistence\n    - attack.privilege_escalation\n    - attack.t1178\nlogsource:\n    product: windows\n    service: security\ndetection:\n    selection1:\n        EventID:\n            - 4765\n            - 4766\n    selection2:\n        EventID: 4738\n    selection3:\n        SidHistory:\n            - '-'\n            - '%%1793'\n    condition: selection1 or (selection2 and not selection3)\nfalsepositives:\n    - Migration of an account into a new domain\nlevel: medium\n", "object_marking_refs": ["marking-definition--0a872d70-1d05-45dd-a25f-031af547a102"], "created_by_ref": "identity--082ca4f0-d825-45b6-aa42-ab9afd1e5503", "type": "indicator", "spec_version": "2.1", "id": "indicator--af080f3b-0d5f-4fbf-b4d8-5d4138fe0175", "modified": "2020-04-02T07:59:02.473Z"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--a4ac4def-0390-453d-8539-308437d77465", "created": "2020-04-02T07:59:02.484Z", "modified": "2020-04-02T07:59:02.484Z", "source_ref": "indicator--af080f3b-0d5f-4fbf-b4d8-5d4138fe0175", "relationship_type": "indicates", "target_ref": "attack-pattern--1df0326d-2fbc-4d08-a16b-48365f1e742d"}, {"name": "Meterpreter or Cobalt Strike Getsystem Service Installation", "description": "Detects the use of getsystem Meterpreter/Cobalt Strike command by detecting a specific service installation", "created": "2019-10-26T00:00:00.000Z", "modified": "2019-11-11T00:00:00.000Z", "valid_from": "2019-10-26T00:00:00Z", "indicator_types": ["malicious-activity"], "pattern_type": "sigma", "pattern": "action: global\ntitle: Meterpreter or Cobalt Strike Getsystem Service Installation\nid: 843544a7-56e0-4dcc-a44f-5cc266dd97d6\ndescription: Detects the use of getsystem Meterpreter/Cobalt Strike command by detecting a specific service installation\nauthor: Teymur Kheirkhabarov\ndate: 2019/10/26\nmodified: 2019/11/11\nreferences:\n    - https://speakerdeck.com/heirhabarov/hunting-for-privilege-escalation-in-windows-environment\n    - https://blog.cobaltstrike.com/2014/04/02/what-happens-when-i-type-getsystem/\ntags:\n    - attack.privilege_escalation\n    - attack.t1134\ndetection:\n    selection:\n        - ServiceFileName|contains:\n            - 'cmd'\n            - 'comspec'\n        # meterpreter getsystem technique 1: cmd.exe /c echo 559891bb017 > \\\\.\\pipe\\5e120a\n        - ServiceFileName|contains|all:\n            - 'cmd'\n            - '/c'\n            - 'echo'\n            - '\\pipe\\'\n        # cobaltstrike getsystem technique 1: %COMSPEC% /c echo 559891bb017 > \\\\.\\pipe\\5e120a\n        - ServiceFileName|contains|all:\n            - '%COMSPEC%'\n            - '/c'\n            - 'echo'\n            - '\\pipe\\'\n        # meterpreter getsystem technique 2: rundll32.exe C:\\Users\\test\\AppData\\Local\\Temp\\tmexsn.dll,a /p:tmexsn\n        - ServiceFileName|contains|all:\n            - 'rundll32'\n            - '.dll,a'\n            - '/p:'\n    condition: selection\nfields:\n    - ComputerName\n    - SubjectDomainName\n    - SubjectUserName\n    - ServiceFileName\nfalsepositives:\n    - Highly unlikely\nlevel: critical\n", "object_marking_refs": ["marking-definition--0a872d70-1d05-45dd-a25f-031af547a102"], "created_by_ref": "identity--082ca4f0-d825-45b6-aa42-ab9afd1e5503", "type": "indicator", "spec_version": "2.1", "id": "indicator--14486942-c1d8-4269-9445-d86c4cffba2e"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--bca954b4-b7e5-436d-8b2c-6bd3a5bea51e", "created": "2020-04-02T07:59:02.500Z", "modified": "2020-04-02T07:59:02.500Z", "source_ref": "indicator--14486942-c1d8-4269-9445-d86c4cffba2e", "relationship_type": "indicates", "target_ref": "attack-pattern--dcaa092b-7de9-4a21-977f-7fcb77e89c48"}, {"name": "NTLM Logon", "description": "Detects logons using NTLM, which could be caused by a legacy source or attackers", "created": "2018-06-08T00:00:00.000Z", "valid_from": "2018-06-08T00:00:00Z", "indicator_types": ["malicious-activity"], "pattern_type": "sigma", "pattern": "title: NTLM Logon\nid: 98c3bcf1-56f2-49dc-9d8d-c66cf190238b\nstatus: experimental\ndescription: Detects logons using NTLM, which could be caused by a legacy source or attackers\nreferences:\n    - https://twitter.com/JohnLaTwC/status/1004895028995477505\n    - https://goo.gl/PsqrhT\nauthor: Florian Roth\ndate: 2018/06/08\ntags:\n    - attack.lateral_movement\n    - attack.t1075\nlogsource:\n    product: windows\n    service: ntlm\n    definition: Reqiures events from Microsoft-Windows-NTLM/Operational\ndetection:\n    selection:\n        EventID: 8002\n        CallingProcessName: '*'  # We use this to avoid false positives with ID 8002 on other log sources if the logsource isn't set correctly\n    condition: selection\nfalsepositives:\n    - Legacy hosts\nlevel: low\n", "object_marking_refs": ["marking-definition--0a872d70-1d05-45dd-a25f-031af547a102"], "created_by_ref": "identity--082ca4f0-d825-45b6-aa42-ab9afd1e5503", "type": "indicator", "spec_version": "2.1", "id": "indicator--2badc58b-9f88-460d-b144-1de5a85fd768", "modified": "2020-04-02T07:59:02.506Z"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--cb41a29f-cdf8-4fe4-975d-4de8e092bfb2", "created": "2020-04-02T07:59:02.516Z", "modified": "2020-04-02T07:59:02.516Z", "source_ref": "indicator--2badc58b-9f88-460d-b144-1de5a85fd768", "relationship_type": "indicates", "target_ref": "attack-pattern--c23b740b-a42b-47a1-aec2-9d48ddd547ff"}, {"name": "Invoke-Obfuscation Obfuscated IEX Invocation", "description": "Detects all variations of obfuscated powershell IEX invocation code generated by Invoke-Obfuscation framework from the following code block \u2014 https://github.com/danielbohannon/Invoke-Obfuscation/blob/master/Out-ObfuscatedStringCommand.ps1#L873-L888", "created": "2019-11-08T00:00:00.000Z", "valid_from": "2019-11-08T00:00:00Z", "indicator_types": ["malicious-activity"], "pattern_type": "sigma", "pattern": "action: global\ntitle: Invoke-Obfuscation Obfuscated IEX Invocation\nid: 51aa9387-1c53-4153-91cc-d73c59ae1ca9\ndescription: \"Detects all variations of obfuscated powershell IEX invocation code generated by Invoke-Obfuscation framework from the following code block \\u2014 https://github.com/danielbohannon/Invoke-Obfuscation/blob/master/Out-ObfuscatedStringCommand.ps1#L873-L888\"\nstatus: experimental\nauthor: Daniel Bohannon (@Mandiant/@FireEye), oscd.community\ndate: 2019/11/08\ntags:\n    - attack.defense_evasion\n    - attack.t1027\nfalsepositives:\n    - Unknown\nlevel: high\ndetection:\n    selection:\n        - ImagePath|re: '\\$PSHome\\[\\s*\\d{1,3}\\s*\\]\\s*\\+\\s*\\$PSHome\\['\n        - ImagePath|re: '\\$ShellId\\[\\s*\\d{1,3}\\s*\\]\\s*\\+\\s*\\$ShellId\\['\n        - ImagePath|re: '\\$env:Public\\[\\s*\\d{1,3}\\s*\\]\\s*\\+\\s*\\$env:Public\\['\n        - ImagePath|re: '\\$env:ComSpec\\[(\\s*\\d{1,3}\\s*,){2}'\n        - ImagePath|re: '\\*mdr\\*\\W\\s*\\)\\.Name'\n        - ImagePath|re: '\\$VerbosePreference\\.ToString\\('\n        - ImagePath|re: '\\String\\]\\s*\\$VerbosePreference'\n    condition: selection\n", "object_marking_refs": ["marking-definition--0a872d70-1d05-45dd-a25f-031af547a102"], "created_by_ref": "identity--082ca4f0-d825-45b6-aa42-ab9afd1e5503", "type": "indicator", "spec_version": "2.1", "id": "indicator--9d3f56d3-ac70-4688-bf0c-15dc8e394cf8", "modified": "2020-04-02T07:59:02.521Z"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--b76c965d-d262-4b44-9914-11743a893c5d", "created": "2020-04-02T07:59:02.531Z", "modified": "2020-04-02T07:59:02.531Z", "source_ref": "indicator--9d3f56d3-ac70-4688-bf0c-15dc8e394cf8", "relationship_type": "indicates", "target_ref": "attack-pattern--b3d682b6-98f2-4fb0-aa3b-b4df007ca70a"}, {"name": "Admin User Remote Logon", "description": "Detect remote login by Administrator user depending on internal pattern", "created": "2017-10-29T00:00:00.000Z", "valid_from": "2017-10-29T00:00:00Z", "indicator_types": ["malicious-activity"], "pattern_type": "sigma", "pattern": "title: Admin User Remote Logon\nid: 0f63e1ef-1eb9-4226-9d54-8927ca08520a\ndescription: Detect remote login by Administrator user depending on internal pattern\nreferences:\n    - https://car.mitre.org/wiki/CAR-2016-04-005\ntags:\n    - attack.lateral_movement\n    - attack.t1078\n    - car.2016-04-005\nstatus: experimental\nauthor: juju4\ndate: 2017/10/29\nlogsource:\n    product: windows\n    service: security\n    definition: 'Requirements: Identifiable administrators usernames (pattern or special unique character. ex: \"Admin-*\"), internal policy mandating use only as secondary account'\ndetection:\n    selection:\n        EventID: 4624\n        LogonType: 10\n        AuthenticationPackageName: Negotiate\n        AccountName: 'Admin-*'\n    condition: selection\nfalsepositives:\n    - Legitimate administrative activity\nlevel: low\n", "object_marking_refs": ["marking-definition--0a872d70-1d05-45dd-a25f-031af547a102"], "created_by_ref": "identity--082ca4f0-d825-45b6-aa42-ab9afd1e5503", "type": "indicator", "spec_version": "2.1", "id": "indicator--837534f6-66de-49bf-93d7-4a52ecf291f9", "modified": "2020-04-02T07:59:02.537Z"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--e65c4f36-d699-4f50-ab5c-1a78e5b1861a", "created": "2020-04-02T07:59:02.548Z", "modified": "2020-04-02T07:59:02.548Z", "source_ref": "indicator--837534f6-66de-49bf-93d7-4a52ecf291f9", "relationship_type": "indicates", "target_ref": "attack-pattern--b17a1a56-e99c-403c-8948-561df0cffe81"}, {"name": "Addition of Domain Trusts", "description": "Addition of domains is seldom and should be verified for legitimacy.", "created": "2019-12-03T00:00:00.000Z", "valid_from": "2019-12-03T00:00:00Z", "indicator_types": ["malicious-activity"], "pattern_type": "sigma", "pattern": "title: Addition of Domain Trusts\nid: 0255a820-e564-4e40-af2b-6ac61160335c\nstatus: stable\ndescription: Addition of domains is seldom and should be verified for legitimacy.\nauthor: Thomas Patzke\ndate: 2019/12/03\ntags:\n    - attack.persistence\nlogsource:\n    product: windows\n    service: security\ndetection:\n    selection:\n        EventID: 4706\n    condition: selection\nfalsepositives:\n    - Legitimate extension of domain structure\nlevel: medium\n", "object_marking_refs": ["marking-definition--0a872d70-1d05-45dd-a25f-031af547a102"], "created_by_ref": "identity--082ca4f0-d825-45b6-aa42-ab9afd1e5503", "type": "indicator", "spec_version": "2.1", "id": "indicator--aa241e47-d454-4dab-93c2-a773f1e4c388", "modified": "2020-04-02T07:59:02.551Z"}, {"name": "APT29 Google Update Service Install", "description": "This method detects malicious services mentioned in APT29 report by FireEye. The legitimate path for the Google update service is C:\\Program Files (x86)\\Google\\Update\\GoogleUpdate.exe so the service names and executable locations used by APT29 are specific enough to be detected in log files.", "created": "2017-11-01T00:00:00.000Z", "valid_from": "2017-11-01T00:00:00Z", "indicator_types": ["malicious-activity"], "pattern_type": "sigma", "pattern": "action: global\ntitle: APT29 Google Update Service Install\nid: c069f460-2b87-4010-8dcf-e45bab362624\ndescription: This method detects malicious services mentioned in APT29 report by FireEye. The legitimate path for the Google update service is C:\\Program Files (x86)\\Google\\Update\\GoogleUpdate.exe\n    so the service names and executable locations used by APT29 are specific enough to be detected in log files.\nreferences:\n    - https://www.fireeye.com/blog/threat-research/2017/03/apt29_domain_frontin.html\ntags:\n    - attack.persistence\n    - attack.g0016\n    - attack.t1050\ndate: 2017/11/01\nauthor: Thomas Patzke \nlogsource:\n    product: windows\n    service: system\ndetection:\n    service_install:\n        EventID: 7045\n        ServiceName: 'Google Update'\n    timeframe: 5m\n    condition: service_install | near process\nfalsepositives:\n    - Unknown\nlevel: high\n", "object_marking_refs": ["marking-definition--0a872d70-1d05-45dd-a25f-031af547a102"], "created_by_ref": "identity--082ca4f0-d825-45b6-aa42-ab9afd1e5503", "type": "indicator", "spec_version": "2.1", "id": "indicator--cb141f94-31cb-476e-b559-75459085d079", "modified": "2020-04-02T07:59:02.555Z"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--746a2625-ef40-416b-8f5a-c8161cae2210", "created": "2020-04-02T07:59:02.565Z", "modified": "2020-04-02T07:59:02.565Z", "source_ref": "indicator--cb141f94-31cb-476e-b559-75459085d079", "relationship_type": "indicates", "target_ref": "intrusion-set--899ce53f-13a0-479b-a0e4-67d46e241542"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--af92604d-a3fc-4bed-b465-94bd1e1f0373", "created": "2020-04-02T07:59:02.574Z", "modified": "2020-04-02T07:59:02.574Z", "source_ref": "indicator--cb141f94-31cb-476e-b559-75459085d079", "relationship_type": "indicates", "target_ref": "attack-pattern--478aa214-2ca7-4ec0-9978-18798e514790"}, {"name": "Local User Creation", "description": "Detects local user creation on windows servers, which shouldn't happen in an Active Directory environment. Apply this Sigma Use Case on your windows server logs and not on your DC logs.", "created": "2019-04-18T00:00:00.000Z", "valid_from": "2019-04-18T00:00:00Z", "indicator_types": ["malicious-activity"], "pattern_type": "sigma", "pattern": "title: Local User Creation\nid: 66b6be3d-55d0-4f47-9855-d69df21740ea\ndescription: Detects local user creation on windows servers, which shouldn't happen in an Active Directory environment. Apply this Sigma Use Case on your windows\n    server logs and not on your DC logs.\nstatus: experimental\ntags:\n    - attack.persistence\n    - attack.t1136\nreferences:\n    - https://patrick-bareiss.com/detecting-local-user-creation-in-ad-with-sigma/\nauthor: Patrick Bareiss\ndate: 2019/04/18\nlogsource:\n    product: windows\n    service: security\ndetection:\n    selection:\n        EventID: 4720\n    condition: selection\nfields:\n    - EventCode\n    - AccountName\n    - AccountDomain\nfalsepositives:\n    - Domain Controller Logs\n    - Local accounts managed by privileged account management tools\nlevel: low\n", "object_marking_refs": ["marking-definition--0a872d70-1d05-45dd-a25f-031af547a102"], "created_by_ref": "identity--082ca4f0-d825-45b6-aa42-ab9afd1e5503", "type": "indicator", "spec_version": "2.1", "id": "indicator--f7e11054-d41f-492d-b702-74469c5538aa", "modified": "2020-04-02T07:59:02.579Z"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--3a2cd3b7-7798-4c9f-a55f-1bb68034ab8f", "created": "2020-04-02T07:59:02.589Z", "modified": "2020-04-02T07:59:02.589Z", "source_ref": "indicator--f7e11054-d41f-492d-b702-74469c5538aa", "relationship_type": "indicates", "target_ref": "attack-pattern--e01be9c5-e763-4caf-aeb7-000b416aef67"}, {"name": "Transfering Files with Credential Data via Network Shares", "description": "Transfering files with well-known filenames (sensitive files with credential data) using network shares", "created": "2019-10-22T00:00:00.000Z", "valid_from": "2019-10-22T00:00:00Z", "indicator_types": ["malicious-activity"], "pattern_type": "sigma", "pattern": "title: Transfering Files with Credential Data via Network Shares\nid: 910ab938-668b-401b-b08c-b596e80fdca5\ndescription: Transfering files with well-known filenames (sensitive files with credential data) using network shares\nauthor: Teymur Kheirkhabarov, oscd.community\ndate: 2019/10/22\nreferences:\n    - https://www.slideshare.net/heirhabarov/hunting-for-credentials-dumping-in-windows-environment\ntags:\n    - attack.credential_access\n    - attack.t1003\nlogsource:\n    product: windows\n    service: security\ndetection:\n    selection:\n        EventID: 5145\n        RelativeTargetName|contains:\n            - '\\mimidrv'\n            - '\\lsass'\n            - '\\windows\\minidump\\'\n            - '\\hiberfil'\n            - '\\sqldmpr'\n            - '\\sam'\n            - '\\ntds.dit'\n            - '\\security'\n    condition: selection\nfalsepositives:\n    - Transfering sensitive files for legitimate administration work by legitimate administrator\nlevel: medium\nstatus: experimental\n", "object_marking_refs": ["marking-definition--0a872d70-1d05-45dd-a25f-031af547a102"], "created_by_ref": "identity--082ca4f0-d825-45b6-aa42-ab9afd1e5503", "type": "indicator", "spec_version": "2.1", "id": "indicator--6ef9847e-a285-44c7-b396-0f5480406f49", "modified": "2020-04-02T07:59:02.593Z"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--015e5d99-4488-4071-8e83-8236efe9fb68", "created": "2020-04-02T07:59:02.603Z", "modified": "2020-04-02T07:59:02.603Z", "source_ref": "indicator--6ef9847e-a285-44c7-b396-0f5480406f49", "relationship_type": "indicates", "target_ref": "attack-pattern--0a3ead4e-6d47-4ccb-854c-a6a4f9d96b22"}, {"name": "Rare Schtasks Creations", "description": "Detects rare scheduled tasks creations that only appear a few times per time frame and could reveal password dumpers, backdoor installs or other types of malicious code", "created": "2017-03-23T00:00:00.000Z", "valid_from": "2017-03-23T00:00:00Z", "indicator_types": ["malicious-activity"], "pattern_type": "sigma", "pattern": "title: Rare Schtasks Creations\nid: b0d77106-7bb0-41fe-bd94-d1752164d066\ndescription: Detects rare scheduled tasks creations that only appear a few times per time frame and could reveal password dumpers, backdoor installs or other types of malicious code\nstatus: experimental\nauthor: Florian Roth\ndate: 2017/03/23\ntags:\n    - attack.execution\n    - attack.privilege_escalation\n    - attack.persistence\n    - attack.t1053\n    - car.2013-08-001\nlogsource:\n    product: windows\n    service: security\n    definition: 'The Advanced Audit Policy setting Object Access > Audit Other Object Access Events has to be configured to allow this detection (not in the baseline recommendations by Microsoft). We also recommend extracting the Command field from the embedded XML in the event data.'\ndetection:\n    selection:\n        EventID: 4698\n    timeframe: 7d\n    condition: selection | count() by TaskName < 5\nfalsepositives:\n    - Software installation\n    - Software updates\nlevel: low\n", "object_marking_refs": ["marking-definition--0a872d70-1d05-45dd-a25f-031af547a102"], "created_by_ref": "identity--082ca4f0-d825-45b6-aa42-ab9afd1e5503", "type": "indicator", "spec_version": "2.1", "id": "indicator--59c7554a-c545-42e1-becf-f1b222fc7f1a", "modified": "2020-04-02T07:59:02.607Z"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--17f0bbb3-f19f-47a6-847b-70ba69a744b6", "created": "2020-04-02T07:59:02.617Z", "modified": "2020-04-02T07:59:02.617Z", "source_ref": "indicator--59c7554a-c545-42e1-becf-f1b222fc7f1a", "relationship_type": "indicates", "target_ref": "attack-pattern--35dd844a-b219-4e2b-a6bb-efa9a75995a9"}, {"name": "Successful Overpass the Hash Attempt", "description": "Detects successful logon with logon type 9 (NewCredentials) which matches the Overpass the Hash behavior of e.g Mimikatz's sekurlsa::pth module.", "created": "2018-02-12T00:00:00.000Z", "valid_from": "2018-02-12T00:00:00Z", "indicator_types": ["malicious-activity"], "pattern_type": "sigma", "pattern": "title: Successful Overpass the Hash Attempt\nid: 192a0330-c20b-4356-90b6-7b7049ae0b87\nstatus: experimental\ndescription: Detects successful logon with logon type 9 (NewCredentials) which matches the Overpass the Hash behavior of e.g Mimikatz's sekurlsa::pth module.\nreferences:\n    - https://cyberwardog.blogspot.de/2017/04/chronicles-of-threat-hunter-hunting-for.html\nauthor: Roberto Rodriguez (source), Dominik Schaudel (rule)\ndate: 2018/02/12\ntags:\n    - attack.lateral_movement\n    - attack.t1075\n    - attack.s0002\nlogsource:\n    product: windows\n    service: security\ndetection:\n    selection:\n        EventID: 4624\n        LogonType: 9\n        LogonProcessName: seclogo\n        AuthenticationPackageName: Negotiate\n    condition: selection\nfalsepositives:\n    - Runas command-line tool using /netonly parameter\nlevel: high\n", "object_marking_refs": ["marking-definition--0a872d70-1d05-45dd-a25f-031af547a102"], "created_by_ref": "identity--082ca4f0-d825-45b6-aa42-ab9afd1e5503", "type": "indicator", "spec_version": "2.1", "id": "indicator--b50cf264-b170-4e50-97c9-e2ac593e57df", "modified": "2020-04-02T07:59:02.620Z"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--159e2ea0-3df6-4f8a-9934-05cc43bb296d", "created": "2020-04-02T07:59:02.629Z", "modified": "2020-04-02T07:59:02.629Z", "source_ref": "indicator--b50cf264-b170-4e50-97c9-e2ac593e57df", "relationship_type": "indicates", "target_ref": "attack-pattern--c23b740b-a42b-47a1-aec2-9d48ddd547ff"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--d5502d74-5157-4075-b878-93ba35262cbd", "created": "2020-04-02T07:59:02.636Z", "modified": "2020-04-02T07:59:02.636Z", "source_ref": "indicator--b50cf264-b170-4e50-97c9-e2ac593e57df", "relationship_type": "indicates", "target_ref": "tool--afc079f3-c0ea-4096-b75d-3f05338b7f60"}, {"name": "Security Eventlog Cleared", "description": "Some threat groups tend to delete the local 'Security' Eventlog using certain utitlities", "created": "2017-02-19T00:00:00.000Z", "valid_from": "2017-02-19T00:00:00Z", "indicator_types": ["malicious-activity"], "pattern_type": "sigma", "pattern": "title: Security Eventlog Cleared\nid: f2f01843-e7b8-4f95-a35a-d23584476423\ndescription: Some threat groups tend to delete the local 'Security' Eventlog using certain utitlities\ntags:\n    - attack.defense_evasion\n    - attack.t1070\n    - car.2016-04-002\nauthor: Florian Roth\ndate: 2017/02/19\nlogsource:\n    product: windows\n    service: security\ndetection:\n    selection:\n        EventID:\n            - 517\n            - 1102\n    condition: selection\nfalsepositives:\n    - Rollout of log collection agents (the setup routine often includes a reset of the local Eventlog)\n    - System provisioning (system reset before the golden image creation)\nlevel: high\n", "object_marking_refs": ["marking-definition--0a872d70-1d05-45dd-a25f-031af547a102"], "created_by_ref": "identity--082ca4f0-d825-45b6-aa42-ab9afd1e5503", "type": "indicator", "spec_version": "2.1", "id": "indicator--c046dcd9-f1b8-4ccf-9518-ce21dd5ab006", "modified": "2020-04-02T07:59:02.642Z"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--3360692b-521d-4b5f-860c-2d91d715648f", "created": "2020-04-02T07:59:02.652Z", "modified": "2020-04-02T07:59:02.652Z", "source_ref": "indicator--c046dcd9-f1b8-4ccf-9518-ce21dd5ab006", "relationship_type": "indicates", "target_ref": "attack-pattern--799ace7f-e227-4411-baa0-8868704f2a69"}, {"name": "StoneDrill Service Install", "description": "This method detects a service install of the malicious Microsoft Network Realtime Inspection Service service described in StoneDrill report by Kaspersky", "created": "2017-03-07T00:00:00.000Z", "valid_from": "2017-03-07T00:00:00Z", "indicator_types": ["malicious-activity"], "pattern_type": "sigma", "pattern": "title: StoneDrill Service Install\nid: 9e987c6c-4c1e-40d8-bd85-dd26fba8fdd6\ndescription: This method detects a service install of the malicious Microsoft Network Realtime Inspection Service service described in StoneDrill report by Kaspersky\nauthor: Florian Roth\ndate: 2017/03/07\nreferences:\n    - https://securelist.com/blog/research/77725/from-shamoon-to-stonedrill/\ntags:\n    - attack.persistence\n    - attack.g0064\n    - attack.t1050\nlogsource:\n    product: windows\n    service: system\ndetection:\n    selection:\n        EventID: 7045\n        ServiceName: NtsSrv\n        ServiceFileName: '* LocalService'\n    condition: selection\nfalsepositives:\n    - Unlikely\nlevel: high\n", "object_marking_refs": ["marking-definition--0a872d70-1d05-45dd-a25f-031af547a102"], "created_by_ref": "identity--082ca4f0-d825-45b6-aa42-ab9afd1e5503", "type": "indicator", "spec_version": "2.1", "id": "indicator--318b70ea-a676-4eab-bf44-1cb3b38914fc", "modified": "2020-04-02T07:59:02.656Z"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--7236f86d-6c38-4264-8cc6-afe624d0545a", "created": "2020-04-02T07:59:02.665Z", "modified": "2020-04-02T07:59:02.665Z", "source_ref": "indicator--318b70ea-a676-4eab-bf44-1cb3b38914fc", "relationship_type": "indicates", "target_ref": "intrusion-set--fbd29c89-18ba-4c2d-b792-51c0adee049f"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--de0b5bbb-90ef-440a-80be-8c0ec4a0cb8e", "created": "2020-04-02T07:59:02.672Z", "modified": "2020-04-02T07:59:02.672Z", "source_ref": "indicator--318b70ea-a676-4eab-bf44-1cb3b38914fc", "relationship_type": "indicates", "target_ref": "attack-pattern--478aa214-2ca7-4ec0-9978-18798e514790"}, {"name": "Suspicious LDAP-Attributes Used", "description": "detects the usage of particular AttributeLDAPDisplayNames, which are known for data exchange via LDAP by the tool LDAPFragger and are additionally not commonly used in companies.", "created": "2019-03-24T00:00:00.000Z", "valid_from": "2019-03-24T00:00:00Z", "indicator_types": ["malicious-activity"], "pattern_type": "sigma", "pattern": "title: Suspicious LDAP-Attributes Used\nid: d00a9a72-2c09-4459-ad03-5e0a23351e36\ndescription: detects the usage of particular AttributeLDAPDisplayNames, which are known for data exchange via LDAP by the tool LDAPFragger and are additionally not commonly used in companies.\nstatus: experimental\ndate: 2019/03/24\nauthor: xknow @xknow_infosec\nreferences:\n    - https://medium.com/@ivecodoe/detecting-ldapfragger-a-newly-released-cobalt-strike-beacon-using-ldap-for-c2-communication-c274a7f00961\n    - https://blog.fox-it.com/2020/03/19/ldapfragger-command-and-control-over-ldap-attributes/\n    - https://github.com/fox-it/LDAPFragger\ntags:\n    - attack.t1041\n    - attack.persistence\nlogsource:\n    product: windows\n    service: security\ndetection:\n    selection:\n        EventID: 5136\n        AttributeValue: '*'\n        AttributeLDAPDisplayName:\n            - 'primaryInternationalISDNNumber'\n            - 'otherFacsimileTelephoneNumber'\n            - 'primaryTelexNumber'\n    condition: selection\nfalsepositives:\n    - Companies, who may use these default LDAP-Attributes for personal information\nlevel: high\n", "object_marking_refs": ["marking-definition--0a872d70-1d05-45dd-a25f-031af547a102"], "created_by_ref": "identity--082ca4f0-d825-45b6-aa42-ab9afd1e5503", "type": "indicator", "spec_version": "2.1", "id": "indicator--2adcc633-225f-4631-b444-97e30e6f6ec3", "modified": "2020-04-02T07:59:02.676Z"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--ffc49459-bf24-46f3-87a6-483033ce83c6", "created": "2020-04-02T07:59:02.686Z", "modified": "2020-04-02T07:59:02.686Z", "source_ref": "indicator--2adcc633-225f-4631-b444-97e30e6f6ec3", "relationship_type": "indicates", "target_ref": "attack-pattern--92d7da27-2d91-488e-a00c-059dc162766d"}, {"name": "Eventlog Cleared", "description": "One of the Windows Eventlogs has been cleared. e.g. caused by \"wevtutil cl\" command execution", "created": "2017-01-10T00:00:00.000Z", "valid_from": "2017-01-10T00:00:00Z", "indicator_types": ["malicious-activity"], "pattern_type": "sigma", "pattern": "title: Eventlog Cleared\nid: d99b79d2-0a6f-4f46-ad8b-260b6e17f982\ndescription: One of the Windows Eventlogs has been cleared. e.g. caused by \"wevtutil cl\" command execution\nreferences:\n    - https://twitter.com/deviouspolack/status/832535435960209408\n    - https://www.hybrid-analysis.com/sample/027cc450ef5f8c5f653329641ec1fed91f694e0d229928963b30f6b0d7d3a745?environmentId=100\nauthor: Florian Roth\ndate: 2017/01/10\ntags:\n    - attack.defense_evasion\n    - attack.t1070\n    - car.2016-04-002\nlogsource:\n    product: windows\n    service: system\ndetection:\n    selection:\n        EventID: 104\n        Source: Microsoft-Windows-Eventlog\n    condition: selection\nfalsepositives:\n    - Unknown\nlevel: medium\n", "object_marking_refs": ["marking-definition--0a872d70-1d05-45dd-a25f-031af547a102"], "created_by_ref": "identity--082ca4f0-d825-45b6-aa42-ab9afd1e5503", "type": "indicator", "spec_version": "2.1", "id": "indicator--dbeba624-85c6-4d32-aff9-6c4491fc5fa6", "modified": "2020-04-02T07:59:02.689Z"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--4da3d57e-ebf4-4b48-a60f-cba3a3dae951", "created": "2020-04-02T07:59:02.699Z", "modified": "2020-04-02T07:59:02.699Z", "source_ref": "indicator--dbeba624-85c6-4d32-aff9-6c4491fc5fa6", "relationship_type": "indicates", "target_ref": "attack-pattern--799ace7f-e227-4411-baa0-8868704f2a69"}, {"name": "Powerview Add-DomainObjectAcl DCSync AD Extend Right", "description": "backdooring domain object to grant the rights associated with DCSync to a regular user or machine account using Powerview\\Add-DomainObjectAcl DCSync Extended Right cmdlet, will allow to re-obtain the pwd hashes of any user/computer", "created": "2019-04-03T00:00:00.000Z", "valid_from": "2019-04-03T00:00:00Z", "indicator_types": ["malicious-activity"], "pattern_type": "sigma", "pattern": "title: Powerview Add-DomainObjectAcl DCSync AD Extend Right\nid: 2c99737c-585d-4431-b61a-c911d86ff32f\ndescription: backdooring domain object to grant the rights associated with DCSync to a regular user or machine account using Powerview\\Add-DomainObjectAcl DCSync\n    Extended Right cmdlet, will allow to re-obtain the pwd hashes of any user/computer\nstatus: experimental\ndate: 2019/04/03\nauthor: Samir Bousseaden; Roberto Rodriguez @Cyb3rWard0g; oscd.community\nreferences:\n    - https://twitter.com/menasec1/status/1111556090137903104\n    - https://www.specterops.io/assets/resources/an_ace_up_the_sleeve.pdf\ntags:\n    - attack.credential_access\n    - attack.persistence\nlogsource:\n    product: windows\n    service: security\ndetection:\n    selection:\n        EventID: 5136\n        LDAPDisplayName: 'ntSecurityDescriptor'\n        Value|contains: \n         - '1131f6ad-9c07-11d1-f79f-00c04fc2dcd2'\n         - '1131f6aa-9c07-11d1-f79f-00c04fc2dcd2'\n         - '89e95b76-444d-4c62-991a-0facbeda640c'\n    condition: selection\nfalsepositives:\n    - New Domain Controller computer account, check user SIDs witin the value attribute of event 5136 and verify if it's a regular user or DC computer account.\nlevel: critical\n", "object_marking_refs": ["marking-definition--0a872d70-1d05-45dd-a25f-031af547a102"], "created_by_ref": "identity--082ca4f0-d825-45b6-aa42-ab9afd1e5503", "type": "indicator", "spec_version": "2.1", "id": "indicator--da3c4970-f418-4392-af27-ad827594d808", "modified": "2020-04-02T07:59:02.704Z"}, {"name": "Suspicious Windows ANONYMOUS LOGON Local Account Created", "description": "Detects the creation of suspicious accounts simliar to ANONYMOUS LOGON, such as using additional spaces. Created as an covering detection for exclusion of Logon Type 3 from ANONYMOUS LOGON accounts.", "created": "2019-10-31T00:00:00.000Z", "valid_from": "2019-10-31T00:00:00Z", "indicator_types": ["malicious-activity"], "pattern_type": "sigma", "pattern": "title: Suspicious Windows ANONYMOUS LOGON Local Account Created\nid: 1bbf25b9-8038-4154-a50b-118f2a32be27\nstatus: experimental\ndescription: Detects the creation of suspicious accounts simliar to ANONYMOUS LOGON, such as using additional spaces. Created as an covering detection for exclusion of Logon Type 3 from ANONYMOUS LOGON accounts.\nreferences:\n    - https://twitter.com/SBousseaden/status/1189469425482829824\nauthor: James Pemberton / @4A616D6573\ndate: 2019/10/31\ntags:\n    - attack.persistence\n    - attack.t1136\nlogsource:\n    product: windows\n    service: security\ndetection:\n    selection:\n        EventID: 4720\n        SAMAccountName: '*ANONYMOUS*LOGON*'\n    condition: selection\nfalsepositives:\n    - Unknown\nlevel: high\n", "object_marking_refs": ["marking-definition--0a872d70-1d05-45dd-a25f-031af547a102"], "created_by_ref": "identity--082ca4f0-d825-45b6-aa42-ab9afd1e5503", "type": "indicator", "spec_version": "2.1", "id": "indicator--881e965c-f59e-43ca-903f-b9349f5babac", "modified": "2020-04-02T07:59:02.707Z"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--3d3447d0-2574-4c18-9c40-a5c34cc03e60", "created": "2020-04-02T07:59:02.715Z", "modified": "2020-04-02T07:59:02.715Z", "source_ref": "indicator--881e965c-f59e-43ca-903f-b9349f5babac", "relationship_type": "indicates", "target_ref": "attack-pattern--e01be9c5-e763-4caf-aeb7-000b416aef67"}, {"name": "DHCP Server Loaded the CallOut DLL", "description": "This rule detects a DHCP server in which a specified Callout DLL (in registry) was loaded", "created": "2017-05-15T00:00:00.000Z", "valid_from": "2017-05-15T00:00:00Z", "indicator_types": ["malicious-activity"], "pattern_type": "sigma", "pattern": "title: DHCP Server Loaded the CallOut DLL\nid: 13fc89a9-971e-4ca6-b9dc-aa53a445bf40\nstatus: experimental\ndescription: This rule detects a DHCP server in which a specified Callout DLL (in registry) was loaded\nreferences:\n    - https://blog.3or.de/mimilib-dhcp-server-callout-dll-injection.html\n    - https://technet.microsoft.com/en-us/library/cc726884(v=ws.10).aspx\n    - https://msdn.microsoft.com/de-de/library/windows/desktop/aa363389(v=vs.85).aspx\ndate: 2017/05/15\nauthor: Dimitrios Slamaris\ntags:\n    - attack.defense_evasion\n    - attack.t1073\nlogsource:\n    product: windows\n    service: system\ndetection:\n    selection:\n        EventID: 1033\n        Source: Microsoft-Windows-DHCP-Server\n    condition: selection\nfalsepositives: \n    - Unknown\nlevel: critical\n", "object_marking_refs": ["marking-definition--0a872d70-1d05-45dd-a25f-031af547a102"], "created_by_ref": "identity--082ca4f0-d825-45b6-aa42-ab9afd1e5503", "type": "indicator", "spec_version": "2.1", "id": "indicator--5eca598a-0dad-431d-bcee-a3a025216890", "modified": "2020-04-02T07:59:02.718Z"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--307030f6-9e36-401b-b1c5-7ac4992f43c6", "created": "2020-04-02T07:59:02.727Z", "modified": "2020-04-02T07:59:02.727Z", "source_ref": "indicator--5eca598a-0dad-431d-bcee-a3a025216890", "relationship_type": "indicates", "target_ref": "attack-pattern--b2001907-166b-4d71-bb3c-9d26c871de09"}, {"name": "SAM Registry Hive Handle Request", "description": "Detects handles requested to SAM registry hive", "created": "2019-08-12T00:00:00.000Z", "modified": "2019-11-10T00:00:00.000Z", "valid_from": "2019-08-12T00:00:00Z", "indicator_types": ["malicious-activity"], "pattern_type": "sigma", "pattern": "title: SAM Registry Hive Handle Request\nid: f8748f2c-89dc-4d95-afb0-5a2dfdbad332\ndescription: Detects handles requested to SAM registry hive\nstatus: experimental\ndate: 2019/08/12\nmodified: 2019/11/10\nauthor: Roberto Rodriguez @Cyb3rWard0g\nreferences:\n    - https://github.com/Cyb3rWard0g/ThreatHunter-Playbook/tree/master/playbooks/windows/07_discovery/T1012_query_registry/sam_registry_hive_access.md\ntags:\n    - attack.discovery\n    - attack.t1012\nlogsource:\n    product: windows\n    service: security\ndetection:\n    selection: \n        EventID: 4656\n        ObjectType: 'Key'\n        ObjectName|endswith: '\\SAM'\n    condition: selection\nfields:\n    - ComputerName\n    - SubjectDomainName\n    - SubjectUserName\n    - ProcessName\n    - ObjectName\nfalsepositives:\n    - Unknown\nlevel: critical\n", "object_marking_refs": ["marking-definition--0a872d70-1d05-45dd-a25f-031af547a102"], "created_by_ref": "identity--082ca4f0-d825-45b6-aa42-ab9afd1e5503", "type": "indicator", "spec_version": "2.1", "id": "indicator--d618f883-98d1-49b6-a84c-7b39d7bcf2f8"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--f519342e-8821-43ed-8ba7-7fc94f4203cf", "created": "2020-04-02T07:59:02.742Z", "modified": "2020-04-02T07:59:02.742Z", "source_ref": "indicator--d618f883-98d1-49b6-a84c-7b39d7bcf2f8", "relationship_type": "indicates", "target_ref": "attack-pattern--c32f7008-9fea-41f7-8366-5eb9b74bd896"}, {"name": "MSHTA Suspicious Execution 01", "description": "Detection for mshta.exe suspicious execution patterns sometimes involving file polyglotism", "created": "2019-02-22T00:00:00.000Z", "modified": "2019-02-22T00:00:00.000Z", "valid_from": "2019-02-22T00:00:00Z", "indicator_types": ["malicious-activity"], "pattern_type": "sigma", "pattern": "title: MSHTA Suspicious Execution 01\nid: cc7abbd0-762b-41e3-8a26-57ad50d2eea3\nstatus: experimental\ndescription: Detection for mshta.exe suspicious execution patterns sometimes involving file polyglotism\ndate: 2019/02/22\nmodified: 2019/02/22\nauthor: Diego Perez (@darkquassar), Markus Neis, Swisscom (Improve Rule)\nreferences:\n    - http://blog.sevagas.com/?Hacking-around-HTA-files\n    - https://0x00sec.org/t/clientside-exploitation-in-2018-how-pentesting-has-changed/7356\n    - https://docs.microsoft.com/en-us/dotnet/standard/data/xml/xslt-stylesheet-scripting-using-msxsl-script\n    - https://medium.com/tsscyber/pentesting-and-hta-bypassing-powershell-constrained-language-mode-53a42856c997\ntags:\n    - attack.defense_evasion\n    - attack.t1140\nlogsource:\n    category: process_creation\n    product: windows\nfalsepositives: \n    - False positives depend on scripts and administrative tools used in the monitored environment\nlevel: high\ndetection:\n    selection1:\n        Image: '*\\mshta.exe'\n        CommandLine: \n            - '*vbscript*' \n            - '*.jpg*'\n            - '*.png*'\n            - '*.lnk*'\n            # - '*.chm*'  # could be prone to false positives\n            - '*.xls*'\n            - '*.doc*'\n            - '*.zip*'\n    condition:\n        selection1 \n", "object_marking_refs": ["marking-definition--0a872d70-1d05-45dd-a25f-031af547a102"], "created_by_ref": "identity--082ca4f0-d825-45b6-aa42-ab9afd1e5503", "type": "indicator", "spec_version": "2.1", "id": "indicator--a71689ae-5bfe-4893-8b27-133c08943e29"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--9905292a-89dd-46d5-b4c8-1d789fd2a4a1", "created": "2020-04-02T07:59:02.756Z", "modified": "2020-04-02T07:59:02.756Z", "source_ref": "indicator--a71689ae-5bfe-4893-8b27-133c08943e29", "relationship_type": "indicates", "target_ref": "attack-pattern--3ccef7ae-cb5e-48f6-8302-897105fbf55c"}, {"name": "Register new Logon Process by Rubeus", "description": "Detects potential use of Rubeus via registered new trusted logon process", "created": "2019-10-24T00:00:00.000Z", "valid_from": "2019-10-24T00:00:00Z", "indicator_types": ["malicious-activity"], "pattern_type": "sigma", "pattern": "title: Register new Logon Process by Rubeus\nid: 12e6d621-194f-4f59-90cc-1959e21e69f7\ndescription: Detects potential use of Rubeus via registered new trusted logon process\nstatus: experimental\nreferences:\n    - https://posts.specterops.io/hunting-in-active-directory-unconstrained-delegation-forests-trusts-71f2b33688e1\ntags:\n    - attack.lateral_movement\n    - attack.privilege_escalation\n    - attack.t1208\nauthor: Roberto Rodriguez (source), Ilyas Ochkov (rule), oscd.community\ndate: 2019/10/24\nlogsource:\n    product: windows\n    service: security\ndetection:\n    selection:\n        - EventID: 4611\n          LogonProcessName: 'User32LogonProcesss'\n    condition: selection\nfalsepositives:\n    - Unkown\nlevel: critical\n", "object_marking_refs": ["marking-definition--0a872d70-1d05-45dd-a25f-031af547a102"], "created_by_ref": "identity--082ca4f0-d825-45b6-aa42-ab9afd1e5503", "type": "indicator", "spec_version": "2.1", "id": "indicator--52718718-1d8c-474d-aa77-5daf0e0f0c0a", "modified": "2020-04-02T07:59:02.760Z"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--ff611934-c95d-45cc-af0f-5b2919510432", "created": "2020-04-02T07:59:02.772Z", "modified": "2020-04-02T07:59:02.772Z", "source_ref": "indicator--52718718-1d8c-474d-aa77-5daf0e0f0c0a", "relationship_type": "indicates", "target_ref": "attack-pattern--b39d03cb-7b98-41c4-a878-c40c1a913dc0"}, {"name": "Potential RDP Exploit CVE-2019-0708", "description": "Detect suspicious error on protocol RDP, potential CVE-2019-0708", "created": "2019-05-24T00:00:00.000Z", "valid_from": "2019-05-24T00:00:00Z", "indicator_types": ["malicious-activity"], "pattern_type": "sigma", "pattern": "title: Potential RDP Exploit CVE-2019-0708\nid: aaa5b30d-f418-420b-83a0-299cb6024885\ndescription: Detect suspicious error on protocol RDP, potential CVE-2019-0708\nreferences:\n    - https://github.com/zerosum0x0/CVE-2019-0708\n    - https://github.com/Ekultek/BlueKeep\ntags:\n    - attack.initial_access\n    - attack.lateral_movement\n    - attack.t1210\n    - attack.t1190\n    - car.2013-07-002\nstatus: experimental\nauthor: \"Lionel PRAT, Christophe BROCAS, @atc_project (improvements)\"\ndate: 2019/05/24\nlogsource:\n    product: windows\n    service: system\ndetection:\n    selection:\n        EventID:\n            - 56\n            - 50\n        Source: TermDD\n    condition: selection\nfalsepositives:\n    - Bad connections or network interruptions\nlevel: high\n", "object_marking_refs": ["marking-definition--0a872d70-1d05-45dd-a25f-031af547a102"], "created_by_ref": "identity--082ca4f0-d825-45b6-aa42-ab9afd1e5503", "type": "indicator", "spec_version": "2.1", "id": "indicator--da7a03fa-56e3-4e7a-b6ae-32bc227d2e44", "modified": "2020-04-02T07:59:02.776Z"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--373feef6-a168-4ced-b989-1e4f4a5af74b", "created": "2020-04-02T07:59:02.786Z", "modified": "2020-04-02T07:59:02.786Z", "source_ref": "indicator--da7a03fa-56e3-4e7a-b6ae-32bc227d2e44", "relationship_type": "indicates", "target_ref": "attack-pattern--9db0cf3a-a3c9-4012-8268-123b9db6fd82"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--9d466c23-026d-40e8-8a03-10bb5db0cc84", "created": "2020-04-02T07:59:02.796Z", "modified": "2020-04-02T07:59:02.796Z", "source_ref": "indicator--da7a03fa-56e3-4e7a-b6ae-32bc227d2e44", "relationship_type": "indicates", "target_ref": "attack-pattern--3f886f2a-874f-4333-b794-aa6075009b1c"}, {"name": "Suspicious Outbound Kerberos Connection", "description": "Detects suspicious outbound network activity via kerberos default port indicating possible lateral movement or first stage PrivEsc via delegation.", "created": "2019-10-24T00:00:00.000Z", "modified": "2019-11-13T00:00:00.000Z", "valid_from": "2019-10-24T00:00:00Z", "indicator_types": ["malicious-activity"], "pattern_type": "sigma", "pattern": "title: Suspicious Outbound Kerberos Connection\nid: eca91c7c-9214-47b9-b4c5-cb1d7e4f2350\nstatus: experimental\ndescription: Detects suspicious outbound network activity via kerberos default port indicating possible lateral movement or first stage PrivEsc via delegation.\nreferences:\n    - https://github.com/GhostPack/Rubeus8\nauthor: Ilyas Ochkov, oscd.community\ndate: 2019/10/24\nmodified: 2019/11/13\ntags:\n    - attack.lateral_movement\n    - attack.t1208\nlogsource:\n    product: windows\n    service: security\ndetection:\n    selection:\n        EventID: 5156\n        DestinationPort: 88\n    filter:\n        Image|endswith:\n            - '\\lsass.exe'\n            - '\\opera.exe'\n            - '\\chrome.exe'\n            - '\\firefox.exe'\n    condition: selection and not filter \nfalsepositives:\n    - Other browsers\nlevel: high\n", "object_marking_refs": ["marking-definition--0a872d70-1d05-45dd-a25f-031af547a102"], "created_by_ref": "identity--082ca4f0-d825-45b6-aa42-ab9afd1e5503", "type": "indicator", "spec_version": "2.1", "id": "indicator--4bc689a2-b8a9-4467-8c7a-51ce22cf3923"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--a3eab929-bf5b-44b8-a415-518d6a75ac05", "created": "2020-04-02T07:59:02.810Z", "modified": "2020-04-02T07:59:02.810Z", "source_ref": "indicator--4bc689a2-b8a9-4467-8c7a-51ce22cf3923", "relationship_type": "indicates", "target_ref": "attack-pattern--b39d03cb-7b98-41c4-a878-c40c1a913dc0"}, {"name": "smbexec.py Service Installation", "description": "Detects the use of smbexec.py tool by detecting a specific service installation", "created": "2018-03-20T00:00:00.000Z", "valid_from": "2018-03-20T00:00:00Z", "indicator_types": ["malicious-activity"], "pattern_type": "sigma", "pattern": "title: smbexec.py Service Installation\nid: 52a85084-6989-40c3-8f32-091e12e13f09\ndescription: Detects the use of smbexec.py tool by detecting a specific service installation\nauthor: Omer Faruk Celik\ndate: 2018/03/20\nreferences:\n    - https://blog.ropnop.com/using-credentials-to-own-windows-boxes-part-2-psexec-and-services/\ntags:\n    - attack.lateral_movement\n    - attack.execution\n    - attack.t1077\n    - attack.t1035\nlogsource:\n    product: windows\n    service: system\ndetection:\n    service_installation:\n        EventID: 7045\n        ServiceName: 'BTOBTO'\n        ServiceFileName: '*\\execute.bat'\n    condition: service_installation\nfields:\n    - ServiceName\n    - ServiceFileName\nfalsepositives:\n    - Penetration Test\n    - Unknown\nlevel: critical", "object_marking_refs": ["marking-definition--0a872d70-1d05-45dd-a25f-031af547a102"], "created_by_ref": "identity--082ca4f0-d825-45b6-aa42-ab9afd1e5503", "type": "indicator", "spec_version": "2.1", "id": "indicator--84d611ed-57d6-4986-a390-f7b22331bd3a", "modified": "2020-04-02T07:59:02.814Z"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--f79391af-10fa-4e66-a79d-299c8c4f073f", "created": "2020-04-02T07:59:02.823Z", "modified": "2020-04-02T07:59:02.823Z", "source_ref": "indicator--84d611ed-57d6-4986-a390-f7b22331bd3a", "relationship_type": "indicates", "target_ref": "attack-pattern--ffe742ed-9100-4686-9e00-c331da544787"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--be04b088-5722-4bdd-85f7-58f93a64ef82", "created": "2020-04-02T07:59:02.833Z", "modified": "2020-04-02T07:59:02.833Z", "source_ref": "indicator--84d611ed-57d6-4986-a390-f7b22331bd3a", "relationship_type": "indicates", "target_ref": "attack-pattern--f44731de-ea9f-406d-9b83-30ecbb9b4392"}, {"name": "DPAPI Domain Master Key Backup Attempt", "description": "Detects anyone attempting a backup for the DPAPI Master Key. This events gets generated at the source and not the Domain Controller.", "created": "2019-08-10T00:00:00.000Z", "valid_from": "2019-08-10T00:00:00Z", "indicator_types": ["malicious-activity"], "pattern_type": "sigma", "pattern": "title: DPAPI Domain Master Key Backup Attempt\nid: 39a94fd1-8c9a-4ff6-bf22-c058762f8014\ndescription: Detects anyone attempting a backup for the DPAPI Master Key. This events gets generated at the source and not the Domain Controller.\nstatus: experimental\ndate: 2019/08/10\nauthor: Roberto Rodriguez @Cyb3rWard0g\nreferences:\n    - https://github.com/Cyb3rWard0g/ThreatHunter-Playbook/tree/master/playbooks/windows/06_credential_access/T1003_credential_dumping/domain_dpapi_backupkey_extraction.md\ntags:\n    - attack.credential_access\n    - attack.t1003\nlogsource:\n    product: windows\n    service: security\ndetection:\n    selection: \n        EventID: 4692\n    condition: selection\nfields:\n    - ComputerName\n    - SubjectDomainName\n    - SubjectUserName\nfalsepositives:\n    - Unknown\nlevel: critical\n", "object_marking_refs": ["marking-definition--0a872d70-1d05-45dd-a25f-031af547a102"], "created_by_ref": "identity--082ca4f0-d825-45b6-aa42-ab9afd1e5503", "type": "indicator", "spec_version": "2.1", "id": "indicator--c146dae7-ee7c-4cdc-ac82-519aca80129f", "modified": "2020-04-02T07:59:02.837Z"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--b8f8cafb-f240-4c2a-86f8-61e5078677bc", "created": "2020-04-02T07:59:02.849Z", "modified": "2020-04-02T07:59:02.849Z", "source_ref": "indicator--c146dae7-ee7c-4cdc-ac82-519aca80129f", "relationship_type": "indicates", "target_ref": "attack-pattern--0a3ead4e-6d47-4ccb-854c-a6a4f9d96b22"}, {"name": "DNS Server Error Failed Loading the ServerLevelPluginDLL", "description": "This rule detects a DNS server error in which a specified plugin DLL (in registry) could not be loaded", "created": "2017-05-08T00:00:00.000Z", "valid_from": "2017-05-08T00:00:00Z", "indicator_types": ["malicious-activity"], "pattern_type": "sigma", "pattern": "title: DNS Server Error Failed Loading the ServerLevelPluginDLL\nid: cbe51394-cd93-4473-b555-edf0144952d9\ndescription: This rule detects a DNS server error in which a specified plugin DLL (in registry) could not be loaded\nstatus: experimental\ndate: 2017/05/08\nreferences:\n    - https://medium.com/@esnesenon/feature-not-bug-dnsadmin-to-dc-compromise-in-one-line-a0f779b8dc83\n    - https://technet.microsoft.com/en-us/library/cc735829(v=ws.10).aspx\n    - https://twitter.com/gentilkiwi/status/861641945944391680\ntags:\n    - attack.defense_evasion\n    - attack.t1073\nauthor: Florian Roth\nlogsource:\n    product: windows\n    service: dns-server\ndetection:\n    selection:\n        EventID: \n            - 150\n            - 770\n    condition: selection\nfalsepositives: \n    - Unknown\nlevel: critical\n\n\n", "object_marking_refs": ["marking-definition--0a872d70-1d05-45dd-a25f-031af547a102"], "created_by_ref": "identity--082ca4f0-d825-45b6-aa42-ab9afd1e5503", "type": "indicator", "spec_version": "2.1", "id": "indicator--7fc76435-b4ca-4d40-9659-cf14faf251fe", "modified": "2020-04-02T07:59:02.853Z"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--b1fe5c2f-5a9b-436e-874b-4ed464bec0a0", "created": "2020-04-02T07:59:02.863Z", "modified": "2020-04-02T07:59:02.863Z", "source_ref": "indicator--7fc76435-b4ca-4d40-9659-cf14faf251fe", "relationship_type": "indicates", "target_ref": "attack-pattern--b2001907-166b-4d71-bb3c-9d26c871de09"}, {"name": "Malicious Service Installations", "description": "Detects known malicious service installs that only appear in cases of lateral movement, credential dumping and other suspicious activity", "created": "2017-03-27T00:00:00.000Z", "modified": "2019-11-01T00:00:00.000Z", "valid_from": "2017-03-27T00:00:00Z", "indicator_types": ["malicious-activity"], "pattern_type": "sigma", "pattern": "title: Malicious Service Installations\nid: 5a105d34-05fc-401e-8553-272b45c1522d\ndescription: Detects known malicious service installs that only appear in cases of lateral movement, credential dumping and other suspicious activity\nauthor: Florian Roth, Daniil Yugoslavskiy, oscd.community (update)\ndate: 2017/03/27\nmodified: 2019/11/01\ntags:\n    - attack.persistence\n    - attack.privilege_escalation\n    - attack.t1003\n    - attack.t1035\n    - attack.t1050\n    - car.2013-09-005\nlogsource:\n    product: windows\n    service: system\ndetection:\n    selection:\n        EventID: 7045\n    malsvc_paexec:\n        ServiceFileName|contains: '\\PAExec'\n    malsvc_wannacry:\n        ServiceName: 'mssecsvc2.0'\n    malsvc_persistence:\n        ServiceFileName|contains: 'net user'\n    condition: selection and 1 of malsvc_*\nfalsepositives: \n    - Penetration testing\nlevel: critical\n", "object_marking_refs": ["marking-definition--0a872d70-1d05-45dd-a25f-031af547a102"], "created_by_ref": "identity--082ca4f0-d825-45b6-aa42-ab9afd1e5503", "type": "indicator", "spec_version": "2.1", "id": "indicator--cf59ca54-2353-4933-8ae2-bf3bf904b5d4"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--56d571cd-d90a-418b-8f87-48d82e174be4", "created": "2020-04-02T07:59:02.876Z", "modified": "2020-04-02T07:59:02.876Z", "source_ref": "indicator--cf59ca54-2353-4933-8ae2-bf3bf904b5d4", "relationship_type": "indicates", "target_ref": "attack-pattern--0a3ead4e-6d47-4ccb-854c-a6a4f9d96b22"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--26b37912-0300-4078-b43d-0902c96a2df0", "created": "2020-04-02T07:59:02.883Z", "modified": "2020-04-02T07:59:02.883Z", "source_ref": "indicator--cf59ca54-2353-4933-8ae2-bf3bf904b5d4", "relationship_type": "indicates", "target_ref": "attack-pattern--f44731de-ea9f-406d-9b83-30ecbb9b4392"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--23a0b401-abd0-4860-bf13-5bdff5e3944f", "created": "2020-04-02T07:59:02.890Z", "modified": "2020-04-02T07:59:02.890Z", "source_ref": "indicator--cf59ca54-2353-4933-8ae2-bf3bf904b5d4", "relationship_type": "indicates", "target_ref": "attack-pattern--478aa214-2ca7-4ec0-9978-18798e514790"}, {"name": "Hacktool Ruler", "description": "This events that are generated when using the hacktool Ruler by Sensepost", "created": "2017-05-31T00:00:00.000Z", "modified": "2019-07-26T00:00:00.000Z", "valid_from": "2017-05-31T00:00:00Z", "indicator_types": ["malicious-activity"], "pattern_type": "sigma", "pattern": "title: Hacktool Ruler\nid: 24549159-ac1b-479c-8175-d42aea947cae\ndescription: This events that are generated when using the hacktool Ruler by Sensepost\nauthor: Florian Roth\ndate: 2017/05/31\nmodified: 2019/07/26\nreferences:\n    - https://github.com/sensepost/ruler\n    - https://github.com/sensepost/ruler/issues/47\n    - https://github.com/staaldraad/go-ntlm/blob/master/ntlm/ntlmv1.go#L427\n    - https://docs.microsoft.com/en-us/windows/security/threat-protection/auditing/event-4776\n    - https://docs.microsoft.com/en-us/windows/security/threat-protection/auditing/event-4624\ntags:\n    - attack.discovery\n    - attack.execution\n    - attack.t1087\n    - attack.t1075\n    - attack.t1114\n    - attack.t1059\nlogsource:\n    product: windows\n    service: security\ndetection:\n    selection1:\n        EventID: \n          - 4776\n        Workstation: 'RULER'\n    selection2:\n        EventID:\n          - 4624\n          - 4625\n        WorkstationName: 'RULER'\n    condition: (1 of selection*)\nfalsepositives:\n    - Go utilities that use staaldraad awesome NTLM library\nlevel: high\n", "object_marking_refs": ["marking-definition--0a872d70-1d05-45dd-a25f-031af547a102"], "created_by_ref": "identity--082ca4f0-d825-45b6-aa42-ab9afd1e5503", "type": "indicator", "spec_version": "2.1", "id": "indicator--60fb971c-13fb-4870-97bb-bc89978c53b7"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--320f8d33-1ee2-4b2d-84c4-9ce0b57cc4c6", "created": "2020-04-02T07:59:02.908Z", "modified": "2020-04-02T07:59:02.908Z", "source_ref": "indicator--60fb971c-13fb-4870-97bb-bc89978c53b7", "relationship_type": "indicates", "target_ref": "attack-pattern--72b74d71-8169-42aa-92e0-e7b04b9f5a08"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--1ffc35d2-e283-41ba-8c97-d66f6f1602fa", "created": "2020-04-02T07:59:02.918Z", "modified": "2020-04-02T07:59:02.918Z", "source_ref": "indicator--60fb971c-13fb-4870-97bb-bc89978c53b7", "relationship_type": "indicates", "target_ref": "attack-pattern--c23b740b-a42b-47a1-aec2-9d48ddd547ff"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--d352d773-6375-438b-9575-443b82e2b215", "created": "2020-04-02T07:59:02.926Z", "modified": "2020-04-02T07:59:02.926Z", "source_ref": "indicator--60fb971c-13fb-4870-97bb-bc89978c53b7", "relationship_type": "indicates", "target_ref": "attack-pattern--1608f3e1-598a-42f4-a01a-2e252e81728f"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--3b76e729-fa53-4e2d-be1d-6d2467720aab", "created": "2020-04-02T07:59:02.935Z", "modified": "2020-04-02T07:59:02.935Z", "source_ref": "indicator--60fb971c-13fb-4870-97bb-bc89978c53b7", "relationship_type": "indicates", "target_ref": "attack-pattern--7385dfaf-6886-4229-9ecd-6fd678040830"}, {"name": "MMC20 Lateral Movement", "description": "Detects MMC20.Application Lateral Movement; specifically looks for the spawning of the parent MMC.exe with a command line of \"-Embedding\" as a child of svchost.exe", "created": "2020-03-04T00:00:00.000Z", "valid_from": "2020-03-04T00:00:00Z", "indicator_types": ["malicious-activity"], "pattern_type": "sigma", "pattern": "title: MMC20 Lateral Movement\nid: f1f3bf22-deb2-418d-8cce-e1a45e46a5bd\ndescription: Detects MMC20.Application Lateral Movement; specifically looks for the spawning of the parent MMC.exe with a command line of \"-Embedding\" as a child of svchost.exe \nauthor: '@2xxeformyshirt (Security Risk Advisors)'\ndate: 2020/03/04\nreferences:\n  - https://enigma0x3.net/2017/01/05/lateral-movement-using-the-mmc20-application-com-object/\n  - https://drive.google.com/file/d/1lKya3_mLnR3UQuCoiYruO3qgu052_iS_/view?usp=sharing \ntags:\n  - attack.execution\n  - attack.t1175\nlogsource:\n  category: process_creation\n  product: windows\ndetection:\n  selection:\n    ParentImage: '*\\svchost.exe'\n    Image: '*\\mmc.exe'\n    CommandLine: '*-Embedding*'\n  condition: selection\nfalsepositives:\n  - Unlikely\nlevel: high\n", "object_marking_refs": ["marking-definition--0a872d70-1d05-45dd-a25f-031af547a102"], "created_by_ref": "identity--082ca4f0-d825-45b6-aa42-ab9afd1e5503", "type": "indicator", "spec_version": "2.1", "id": "indicator--8386243a-f83f-4df6-bb31-829d05ffac66", "modified": "2020-04-02T07:59:02.939Z"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--b71acd62-01e2-4701-a36f-b69a892dc929", "created": "2020-04-02T07:59:02.949Z", "modified": "2020-04-02T07:59:02.949Z", "source_ref": "indicator--8386243a-f83f-4df6-bb31-829d05ffac66", "relationship_type": "indicates", "target_ref": "attack-pattern--772bc7a8-a157-42cc-8728-d648e25c7fe7"}, {"name": "Remote Registry Management Using Reg Utility", "description": "Remote registry management using REG utility from non-admin workstation", "created": "2019-10-22T00:00:00.000Z", "modified": "2019-11-13T00:00:00.000Z", "valid_from": "2019-10-22T00:00:00Z", "indicator_types": ["malicious-activity"], "pattern_type": "sigma", "pattern": "title: Remote Registry Management Using Reg Utility\nid: 68fcba0d-73a5-475e-a915-e8b4c576827e\ndescription: Remote registry management using REG utility from non-admin workstation\nauthor: Teymur Kheirkhabarov, oscd.community\ndate: 2019/10/22\nmodified: 2019/11/13\nreferences:\n    - https://www.slideshare.net/heirhabarov/hunting-for-credentials-dumping-in-windows-environment\ntags:\n    - attack.defense_evasion\n    - attack.discovery\n    - attack.t1112\n    - attack.t1012\n    - attack.s0075\nlogsource:\n    product: windows\n    service: security\ndetection:\n    selection_1:\n        EventID: 5145\n        RelativeTargetName|contains: '\\winreg'\n    selection_2:\n        IpAddress: '%Admins_Workstations%'\n    condition: selection_1 and not selection_2\nfalsepositives:\n    - Legitimate usage of remote registry management by administrator\nlevel: medium\nstatus: experimental\n", "object_marking_refs": ["marking-definition--0a872d70-1d05-45dd-a25f-031af547a102"], "created_by_ref": "identity--082ca4f0-d825-45b6-aa42-ab9afd1e5503", "type": "indicator", "spec_version": "2.1", "id": "indicator--d674c20a-d18f-4da3-a224-aed7cdad95b2"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--35cadb7f-83c0-4c19-b39d-8a98d7c7398d", "created": "2020-04-02T07:59:02.964Z", "modified": "2020-04-02T07:59:02.964Z", "source_ref": "indicator--d674c20a-d18f-4da3-a224-aed7cdad95b2", "relationship_type": "indicates", "target_ref": "attack-pattern--57340c81-c025-4189-8fa0-fc7ede51bae4"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--8bd8f955-0a72-4ddf-b852-5952b7456e70", "created": "2020-04-02T07:59:02.974Z", "modified": "2020-04-02T07:59:02.974Z", "source_ref": "indicator--d674c20a-d18f-4da3-a224-aed7cdad95b2", "relationship_type": "indicates", "target_ref": "attack-pattern--c32f7008-9fea-41f7-8366-5eb9b74bd896"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--bfeeccd9-ef8d-444e-aa34-91d5c5a8cfc1", "created": "2020-04-02T07:59:02.982Z", "modified": "2020-04-02T07:59:02.982Z", "source_ref": "indicator--d674c20a-d18f-4da3-a224-aed7cdad95b2", "relationship_type": "indicates", "target_ref": "tool--cde2d700-9ed1-46cf-9bce-07364fe8b24f"}, {"name": "AD Object WriteDAC Access", "description": "Detects WRITE_DAC access to a domain object", "created": "2019-09-12T00:00:00.000Z", "valid_from": "2019-09-12T00:00:00Z", "indicator_types": ["malicious-activity"], "pattern_type": "sigma", "pattern": "title: AD Object WriteDAC Access\nid: 028c7842-4243-41cd-be6f-12f3cf1a26c7\ndescription: Detects WRITE_DAC access to a domain object\nstatus: experimental\ndate: 2019/09/12\nauthor: Roberto Rodriguez @Cyb3rWard0g\nreferences:\n    - https://github.com/Cyb3rWard0g/ThreatHunter-Playbook/tree/master/playbooks/windows/05_defense_evasion/T1222_file_permissions_modification/ad_replication_user_backdoor.md\ntags:\n    - attack.defense_evasion\n    - attack.t1222\nlogsource:\n    product: windows\n    service: security\ndetection:\n    selection: \n        EventID: 4662\n        ObjectServer: 'DS'\n        AccessMask: 0x40000\n        ObjectType:\n            - '19195a5b-6da0-11d0-afd3-00c04fd930c9'\n            - 'domainDNS'\n    condition: selection\nfalsepositives:\n    - Unknown\nlevel: critical\n", "object_marking_refs": ["marking-definition--0a872d70-1d05-45dd-a25f-031af547a102"], "created_by_ref": "identity--082ca4f0-d825-45b6-aa42-ab9afd1e5503", "type": "indicator", "spec_version": "2.1", "id": "indicator--4ef863ed-87dd-43d6-bc07-9a4c886ae1dd", "modified": "2020-04-02T07:59:02.986Z"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--19e52e89-a0c7-49a4-ad74-0b3369b219d3", "created": "2020-04-02T07:59:02.997Z", "modified": "2020-04-02T07:59:02.997Z", "source_ref": "indicator--4ef863ed-87dd-43d6-bc07-9a4c886ae1dd", "relationship_type": "indicates", "target_ref": "attack-pattern--65917ae0-b854-4139-83fe-bf2441cf0196"}, {"name": "Mimikatz Use", "description": "This method detects mimikatz keywords in different Eventlogs (some of them only appear in older Mimikatz version that are however still used by different threat groups)", "created": "2017-01-10T00:00:00.000Z", "modified": "2019-10-11T00:00:00.000Z", "valid_from": "2017-01-10T00:00:00Z", "indicator_types": ["malicious-activity"], "pattern_type": "sigma", "pattern": "title: Mimikatz Use\nid: 06d71506-7beb-4f22-8888-e2e5e2ca7fd8\ndescription: This method detects mimikatz keywords in different Eventlogs (some of them only appear in older Mimikatz version that are however still used by different\n    threat groups)\nauthor: Florian Roth\ndate: 2017/01/10\nmodified: 2019/10/11\ntags:\n    - attack.s0002\n    - attack.t1003\n    - attack.lateral_movement\n    - attack.credential_access\n    - car.2013-07-001\n    - car.2019-04-004\nlogsource:\n    product: windows\ndetection:\n    keywords:\n        Message:\n        - \"* mimikatz *\"\n        - \"* mimilib *\"\n        - \"* <3 eo.oe *\"\n        - \"* eo.oe.kiwi *\"\n        - \"* privilege::debug *\"\n        - \"* sekurlsa::logonpasswords *\"\n        - \"* lsadump::sam *\"\n        - \"* mimidrv.sys *\"\n        - \"* p::d *\"\n        - \"* s::l *\"\n    condition: keywords\nfalsepositives:\n    - Naughty administrators\n    - Penetration test\nlevel: critical\n", "object_marking_refs": ["marking-definition--0a872d70-1d05-45dd-a25f-031af547a102"], "created_by_ref": "identity--082ca4f0-d825-45b6-aa42-ab9afd1e5503", "type": "indicator", "spec_version": "2.1", "id": "indicator--e2e36e1e-62f5-4b53-b16f-8253f1ae87dc"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--6c6400ba-7288-4b53-9c05-b9b06308c5f1", "created": "2020-04-02T07:59:03.013Z", "modified": "2020-04-02T07:59:03.013Z", "source_ref": "indicator--e2e36e1e-62f5-4b53-b16f-8253f1ae87dc", "relationship_type": "indicates", "target_ref": "tool--afc079f3-c0ea-4096-b75d-3f05338b7f60"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--4a42e0e0-ddea-4cb6-ada0-f32e365d4ecd", "created": "2020-04-02T07:59:03.023Z", "modified": "2020-04-02T07:59:03.023Z", "source_ref": "indicator--e2e36e1e-62f5-4b53-b16f-8253f1ae87dc", "relationship_type": "indicates", "target_ref": "attack-pattern--0a3ead4e-6d47-4ccb-854c-a6a4f9d96b22"}, {"name": "Suspicious Access to Sensitive File Extensions", "description": "Detects known sensitive file extensions", "created": "2019-04-03T00:00:00.000Z", "valid_from": "2019-04-03T00:00:00Z", "indicator_types": ["malicious-activity"], "pattern_type": "sigma", "pattern": "title: Suspicious Access to Sensitive File Extensions\nid: 91c945bc-2ad1-4799-a591-4d00198a1215\ndescription: Detects known sensitive file extensions\nauthor: Samir Bousseaden\ndate: 2019/04/03\ntags:\n    - attack.collection\nlogsource:\n    product: windows\n    service: security\ndetection:\n    selection:\n        EventID:\n            - 5145\n        RelativeTargetName:\n            - '*.pst'\n            - '*.ost'\n            - '*.msg'\n            - '*.nst'\n            - '*.oab'\n            - '*.edb'\n            - '*.nsf'\n            - '*.bak'\n            - '*.dmp'\n            - '*.kirbi'\n            - '*\\groups.xml'\n            - '*.rdp'\n    condition: selection\nfields:\n    - ComputerName\n    - SubjectDomainName\n    - SubjectUserName\n    - RelativeTargetName\nfalsepositives:\n    - Help Desk operator doing backup or re-imaging end user machine or pentest or backup software\n    - Users working with these data types or exchanging message files\nlevel: medium\n", "object_marking_refs": ["marking-definition--0a872d70-1d05-45dd-a25f-031af547a102"], "created_by_ref": "identity--082ca4f0-d825-45b6-aa42-ab9afd1e5503", "type": "indicator", "spec_version": "2.1", "id": "indicator--f1206770-f406-4bfe-b5ed-121772b20152", "modified": "2020-04-02T07:59:03.027Z"}, {"name": "Enabled User Right in AD to Control User Objects", "description": "Detects scenario where if a user is assigned the SeEnableDelegationPrivilege right in Active Directory it would allow control of other AD user objects.", "created": "2017-07-30T00:00:00.000Z", "valid_from": "2017-07-30T00:00:00Z", "indicator_types": ["malicious-activity"], "pattern_type": "sigma", "pattern": "title: Enabled User Right in AD to Control User Objects\nid: 311b6ce2-7890-4383-a8c2-663a9f6b43cd\ndescription: Detects scenario where if a user is assigned the SeEnableDelegationPrivilege right in Active Directory it would allow control of other AD user objects.\ntags:\n    - attack.privilege_escalation\n    - attack.t1078\nreferences:\n    - https://www.harmj0y.net/blog/activedirectory/the-most-dangerous-user-right-you-probably-have-never-heard-of/\nauthor: '@neu5ron'\ndate: 2017/07/30\nlogsource:\n    product: windows\n    service: security\n    definition: 'Requirements: Audit Policy : Policy Change > Audit Authorization Policy Change, Group Policy : Computer Configuration\\Windows Settings\\Security Settings\\Advanced Audit Policy Configuration\\Audit Policies\\Policy Change\\Audit Authorization Policy Change'\ndetection:\n    selection:\n        EventID: 4704\n    keywords:\n        Message:\n            - '*SeEnableDelegationPrivilege*'\n    condition: all of them\nfalsepositives:\n    - Unknown\nlevel: high\n", "object_marking_refs": ["marking-definition--0a872d70-1d05-45dd-a25f-031af547a102"], "created_by_ref": "identity--082ca4f0-d825-45b6-aa42-ab9afd1e5503", "type": "indicator", "spec_version": "2.1", "id": "indicator--4b8ca621-0ce6-45eb-96b0-1176eb5dad5d", "modified": "2020-04-02T07:59:03.032Z"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--55746c2e-5a12-417f-8235-1bad0c1874a3", "created": "2020-04-02T07:59:03.041Z", "modified": "2020-04-02T07:59:03.041Z", "source_ref": "indicator--4b8ca621-0ce6-45eb-96b0-1176eb5dad5d", "relationship_type": "indicates", "target_ref": "attack-pattern--b17a1a56-e99c-403c-8948-561df0cffe81"}, {"name": "DHCP Server Error Failed Loading the CallOut DLL", "description": "This rule detects a DHCP server error in which a specified Callout DLL (in registry) could not be loaded", "created": "2017-05-15T00:00:00.000Z", "modified": "2019-07-17T00:00:00.000Z", "valid_from": "2017-05-15T00:00:00Z", "indicator_types": ["malicious-activity"], "pattern_type": "sigma", "pattern": "title: DHCP Server Error Failed Loading the CallOut DLL\nid: 75edd3fd-7146-48e5-9848-3013d7f0282c\ndescription: This rule detects a DHCP server error in which a specified Callout DLL (in registry) could not be loaded\nstatus: experimental\nreferences:\n    - https://blog.3or.de/mimilib-dhcp-server-callout-dll-injection.html\n    - https://technet.microsoft.com/en-us/library/cc726884(v=ws.10).aspx\n    - https://msdn.microsoft.com/de-de/library/windows/desktop/aa363389(v=vs.85).aspx\ndate: 2017/05/15\nmodified: 2019/07/17\ntags:\n    - attack.defense_evasion\n    - attack.t1073\nauthor: \"Dimitrios Slamaris, @atc_project (fix)\"\nlogsource:\n    product: windows\n    service: system\ndetection:\n    selection:\n        EventID: \n            - 1031\n            - 1032\n            - 1034\n        Source: Microsoft-Windows-DHCP-Server            \n    condition: selection\nfalsepositives: \n    - Unknown\nlevel: critical\n", "object_marking_refs": ["marking-definition--0a872d70-1d05-45dd-a25f-031af547a102"], "created_by_ref": "identity--082ca4f0-d825-45b6-aa42-ab9afd1e5503", "type": "indicator", "spec_version": "2.1", "id": "indicator--b8d482a7-4ff6-4c0b-b5c7-71a511d290fb"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--71ae37c4-b3f4-4225-9a99-3d15d4d4d4b2", "created": "2020-04-02T07:59:03.056Z", "modified": "2020-04-02T07:59:03.056Z", "source_ref": "indicator--b8d482a7-4ff6-4c0b-b5c7-71a511d290fb", "relationship_type": "indicates", "target_ref": "attack-pattern--b2001907-166b-4d71-bb3c-9d26c871de09"}, {"name": "Disabling Windows Event Auditing", "description": "Detects scenarios where system auditing (ie: windows event log auditing) is disabled. This may be used in a scenario where an entity would want to bypass local logging to evade detection when windows event logging is enabled and reviewed. Also, it is recommended to turn off \"Local Group Policy Object Processing\" via GPO, which will make sure that Active Directory GPOs take precedence over local/edited computer policies via something such as \"gpedit.msc\". Please note, that disabling \"Local Group Policy Object Processing\" may cause an issue in scenarios of one off specific GPO modifications -- however it is recommended to perform these modifications in Active Directory anyways.", "created": "2017-11-19T00:00:00.000Z", "valid_from": "2017-11-19T00:00:00Z", "indicator_types": ["malicious-activity"], "pattern_type": "sigma", "pattern": "title: Disabling Windows Event Auditing\nid: 69aeb277-f15f-4d2d-b32a-55e883609563\ndescription: 'Detects scenarios where system auditing (ie: windows event log auditing) is disabled. This may be used in a scenario where an entity would want to bypass\n    local logging to evade detection when windows event logging is enabled and reviewed. Also, it is recommended to turn off \"Local Group Policy Object Processing\"\n    via GPO, which will make sure that Active Directory GPOs take precedence over local/edited computer policies via something such as \"gpedit.msc\". Please note,\n    that disabling \"Local Group Policy Object Processing\" may cause an issue in scenarios of one off specific GPO modifications -- however it is recommended to perform\n    these modifications in Active Directory anyways.'\nreferences:\n    - https://bit.ly/WinLogsZero2Hero\ntags:\n    - attack.defense_evasion\n    - attack.t1054\nauthor: '@neu5ron'\ndate: 2017/11/19\nlogsource:\n    product: windows\n    service: security\n    definition: 'Requirements: Audit Policy : Computer Management > Audit Policy Configuration, Group Policy : Computer Configuration\\Windows Settings\\Security Settings\\Advanced Audit Policy Configuration\\Audit Policies\\Policy Change\\Audit Authorization Policy Change'\ndetection:\n    selection:\n        EventID: 4719\n        AuditPolicyChanges: 'removed'\n    condition: selection\nfalsepositives:\n    - Unknown\nlevel: high\n", "object_marking_refs": ["marking-definition--0a872d70-1d05-45dd-a25f-031af547a102"], "created_by_ref": "identity--082ca4f0-d825-45b6-aa42-ab9afd1e5503", "type": "indicator", "spec_version": "2.1", "id": "indicator--37c22072-ca92-40f3-abc6-39df4246a5ad", "modified": "2020-04-02T07:59:03.060Z"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--66323dcf-ee53-4513-aad8-97b800fdfcff", "created": "2020-04-02T07:59:03.070Z", "modified": "2020-04-02T07:59:03.070Z", "source_ref": "indicator--37c22072-ca92-40f3-abc6-39df4246a5ad", "relationship_type": "indicates", "target_ref": "attack-pattern--6a5848a8-6201-4a2c-8a6a-ca5af8c6f3df"}, {"name": "Rare Service Installs", "description": "Detects rare service installs that only appear a few times per time frame and could reveal password dumpers, backdoor installs or other types of malicious services", "created": "2017-03-08T00:00:00.000Z", "valid_from": "2017-03-08T00:00:00Z", "indicator_types": ["malicious-activity"], "pattern_type": "sigma", "pattern": "title: Rare Service Installs\nid: 66bfef30-22a5-4fcd-ad44-8d81e60922ae\ndescription: Detects rare service installs that only appear a few times per time frame and could reveal password dumpers, backdoor installs or other types of malicious services\nstatus: experimental\nauthor: Florian Roth\ndate: 2017/03/08\ntags:\n    - attack.persistence\n    - attack.privilege_escalation\n    - attack.t1050\n    - car.2013-09-005\nlogsource:\n    product: windows\n    service: system\ndetection:\n    selection:\n        EventID: 7045\n    timeframe: 7d\n    condition: selection | count() by ServiceFileName < 5\nfalsepositives:\n    - Software installation\n    - Software updates\nlevel: low\n", "object_marking_refs": ["marking-definition--0a872d70-1d05-45dd-a25f-031af547a102"], "created_by_ref": "identity--082ca4f0-d825-45b6-aa42-ab9afd1e5503", "type": "indicator", "spec_version": "2.1", "id": "indicator--9e9b2bc7-0471-49bd-9e51-4a67884b4139", "modified": "2020-04-02T07:59:03.073Z"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--8233b9fd-f8ec-49d0-b90b-616d6408cd17", "created": "2020-04-02T07:59:03.082Z", "modified": "2020-04-02T07:59:03.082Z", "source_ref": "indicator--9e9b2bc7-0471-49bd-9e51-4a67884b4139", "relationship_type": "indicates", "target_ref": "attack-pattern--478aa214-2ca7-4ec0-9978-18798e514790"}, {"name": "Interactive Logon to Server Systems", "description": "Detects interactive console logons to", "created": "2017-03-17T00:00:00.000Z", "valid_from": "2017-03-17T00:00:00Z", "indicator_types": ["malicious-activity"], "pattern_type": "sigma", "pattern": "title: Interactive Logon to Server Systems\nid: 3ff152b2-1388-4984-9cd9-a323323fdadf\ndescription: Detects interactive console logons to\nauthor: Florian Roth\ndate: 2017/03/17\ntags:\n    - attack.lateral_movement\n    - attack.t1078\nlogsource:\n    product: windows\n    service: security\ndetection:\n    selection:\n        EventID:\n            - 528\n            - 529\n            - 4624\n            - 4625\n        LogonType: 2\n        ComputerName:\n            - '%ServerSystems%'\n            - '%DomainControllers%'\n    filter:\n        LogonProcessName: Advapi\n        ComputerName: '%Workstations%'\n    condition: selection and not filter\nfalsepositives:\n    - Administrative activity via KVM or ILO board\nlevel: medium\n", "object_marking_refs": ["marking-definition--0a872d70-1d05-45dd-a25f-031af547a102"], "created_by_ref": "identity--082ca4f0-d825-45b6-aa42-ab9afd1e5503", "type": "indicator", "spec_version": "2.1", "id": "indicator--9f108a5c-bffb-4fab-b274-7bc1b4fa7d32", "modified": "2020-04-02T07:59:03.086Z"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--23e506d4-0d25-45de-96f3-c00c29749004", "created": "2020-04-02T07:59:03.096Z", "modified": "2020-04-02T07:59:03.096Z", "source_ref": "indicator--9f108a5c-bffb-4fab-b274-7bc1b4fa7d32", "relationship_type": "indicates", "target_ref": "attack-pattern--b17a1a56-e99c-403c-8948-561df0cffe81"}, {"name": "Password Change on Directory Service Restore Mode (DSRM) Account", "description": "The Directory Service Restore Mode (DSRM) account is a local administrator account on Domain Controllers. Attackers may change the password to gain persistence.", "created": "2017-02-19T00:00:00.000Z", "valid_from": "2017-02-19T00:00:00Z", "indicator_types": ["malicious-activity"], "pattern_type": "sigma", "pattern": "title: Password Change on Directory Service Restore Mode (DSRM) Account\nid: 53ad8e36-f573-46bf-97e4-15ba5bf4bb51\nstatus: stable\ndescription: The Directory Service Restore Mode (DSRM) account is a local administrator account on Domain Controllers. Attackers may change the password to gain persistence.\nreferences:\n    - https://adsecurity.org/?p=1714\nauthor: Thomas Patzke\ndate: 2017/02/19\ntags:\n    - attack.persistence\n    - attack.privilege_escalation\n    - attack.t1098\nlogsource:\n    product: windows\n    service: security\ndetection:\n    selection:\n        EventID: 4794\n    condition: selection\nfalsepositives:\n    - Initial installation of a domain controller\nlevel: high\n", "object_marking_refs": ["marking-definition--0a872d70-1d05-45dd-a25f-031af547a102"], "created_by_ref": "identity--082ca4f0-d825-45b6-aa42-ab9afd1e5503", "type": "indicator", "spec_version": "2.1", "id": "indicator--9b99f3cb-ede7-4205-81bf-fad922f1aac8", "modified": "2020-04-02T07:59:03.099Z"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--3125f96c-d1fe-4e27-a1ab-7bb36637c351", "created": "2020-04-02T07:59:03.112Z", "modified": "2020-04-02T07:59:03.112Z", "source_ref": "indicator--9b99f3cb-ede7-4205-81bf-fad922f1aac8", "relationship_type": "indicates", "target_ref": "attack-pattern--a10641f4-87b4-45a3-a906-92a149cb2c27"}, {"name": "NetNTLM Downgrade Attack", "description": "Detects post exploitation using NetNTLM downgrade attacks", "created": "2018-03-20T00:00:00.000Z", "valid_from": "2018-03-20T00:00:00Z", "indicator_types": ["malicious-activity"], "pattern_type": "sigma", "pattern": "action: global\ntitle: NetNTLM Downgrade Attack\nid: d67572a0-e2ec-45d6-b8db-c100d14b8ef2\ndescription: Detects post exploitation using NetNTLM downgrade attacks\nreferences:\n    - https://www.optiv.com/blog/post-exploitation-using-netntlm-downgrade-attacks\nauthor: Florian Roth\ndate: 2018/03/20\ntags:\n    - attack.credential_access\n    - attack.t1212\ndetection:\n    condition: 1 of them\nfalsepositives:\n    - Unknown\nlevel: critical\n", "object_marking_refs": ["marking-definition--0a872d70-1d05-45dd-a25f-031af547a102"], "created_by_ref": "identity--082ca4f0-d825-45b6-aa42-ab9afd1e5503", "type": "indicator", "spec_version": "2.1", "id": "indicator--3f1109bf-00e2-445a-b334-0ce246a2204f", "modified": "2020-04-02T07:59:03.114Z"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--7315f098-fe47-4058-a78b-92f2bc2a0a31", "created": "2020-04-02T07:59:03.124Z", "modified": "2020-04-02T07:59:03.124Z", "source_ref": "indicator--3f1109bf-00e2-445a-b334-0ce246a2204f", "relationship_type": "indicates", "target_ref": "attack-pattern--9c306d8d-cde7-4b4c-b6e8-d0bb16caca36"}, {"name": "Protected Storage Service Access", "description": "Detects access to a protected_storage service over the network. Potential abuse of DPAPI to extract domain backup keys from Domain Controllers", "created": "2019-08-10T00:00:00.000Z", "modified": "2019-11-10T00:00:00.000Z", "valid_from": "2019-08-10T00:00:00Z", "indicator_types": ["malicious-activity"], "pattern_type": "sigma", "pattern": "title: Protected Storage Service Access\nid: 45545954-4016-43c6-855e-eae8f1c369dc\ndescription: Detects access to a protected_storage service over the network. Potential abuse of DPAPI to extract domain backup keys from Domain Controllers\nstatus: experimental\ndate: 2019/08/10\nmodified: 2019/11/10\nauthor: Roberto Rodriguez @Cyb3rWard0g\nreferences:\n    - https://github.com/Cyb3rWard0g/ThreatHunter-Playbook/tree/master/playbooks/windows/06_credential_access/T1003_credential_dumping/domain_dpapi_backupkey_extraction.md\ntags:\n    - attack.lateral_movement\n    - attack.t1021\nlogsource:\n    product: windows\n    service: security\ndetection:\n    selection: \n        EventID: 5145\n        ShareName|contains: 'IPC'\n        RelativeTargetName: \"protected_storage\"\n    condition: selection\nfalsepositives:\n    - Unknown\nlevel: critical", "object_marking_refs": ["marking-definition--0a872d70-1d05-45dd-a25f-031af547a102"], "created_by_ref": "identity--082ca4f0-d825-45b6-aa42-ab9afd1e5503", "type": "indicator", "spec_version": "2.1", "id": "indicator--792f3006-b375-414e-8fec-60562be12100"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--85fdb13c-6412-4d3d-aa5f-85a5e64c10ac", "created": "2020-04-02T07:59:03.141Z", "modified": "2020-04-02T07:59:03.141Z", "source_ref": "indicator--792f3006-b375-414e-8fec-60562be12100", "relationship_type": "indicates", "target_ref": "attack-pattern--54a649ff-439a-41a4-9856-8d144a2551ba"}, {"name": "Microsoft Malware Protection Engine Crash", "description": "This rule detects a suspicious crash of the Microsoft Malware Protection Engine", "created": "2017-05-09T00:00:00.000Z", "valid_from": "2017-05-09T00:00:00Z", "indicator_types": ["malicious-activity"], "pattern_type": "sigma", "pattern": "title: Microsoft Malware Protection Engine Crash\nid: 6c82cf5c-090d-4d57-9188-533577631108\ndescription: This rule detects a suspicious crash of the Microsoft Malware Protection Engine\ntags:\n    - attack.defense_evasion\n    - attack.t1089\n    - attack.t1211\nstatus: experimental\ndate: 2017/05/09\nreferences:\n    - https://bugs.chromium.org/p/project-zero/issues/detail?id=1252&desc=5\n    - https://technet.microsoft.com/en-us/library/security/4022344\nauthor: Florian Roth\nlogsource:\n    product: windows\n    service: application\ndetection:\n    selection1:\n        Source: 'Application Error'\n        EventID: 1000\n    selection2:\n        Source: 'Windows Error Reporting'\n        EventID: 1001\n    keywords:\n        Message:\n            - '*MsMpEng.exe*'\n            - '*mpengine.dll*'\n    condition: 1 of selection* and all of keywords\nfalsepositives:\n    - MsMpEng.exe can crash when C:\\ is full\nlevel: high\n", "object_marking_refs": ["marking-definition--0a872d70-1d05-45dd-a25f-031af547a102"], "created_by_ref": "identity--082ca4f0-d825-45b6-aa42-ab9afd1e5503", "type": "indicator", "spec_version": "2.1", "id": "indicator--7028b1f2-1ceb-4f15-81a3-61ba74cf55f8", "modified": "2020-04-02T07:59:03.145Z"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--54929a80-a945-425c-b2cd-a0ad37f1e5aa", "created": "2020-04-02T07:59:03.155Z", "modified": "2020-04-02T07:59:03.155Z", "source_ref": "indicator--7028b1f2-1ceb-4f15-81a3-61ba74cf55f8", "relationship_type": "indicates", "target_ref": "attack-pattern--2e0dd10b-676d-4964-acd0-8a404c92b044"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--f58c3db7-2c89-4326-b6b0-267886f18d1c", "created": "2020-04-02T07:59:03.165Z", "modified": "2020-04-02T07:59:03.165Z", "source_ref": "indicator--7028b1f2-1ceb-4f15-81a3-61ba74cf55f8", "relationship_type": "indicates", "target_ref": "attack-pattern--fe926152-f431-4baf-956c-4ad3cb0bf23b"}, {"name": "WCE wceaux.dll Access", "description": "Detects wceaux.dll access while WCE pass-the-hash remote command execution on source host", "created": "2017-06-14T00:00:00.000Z", "valid_from": "2017-06-14T00:00:00Z", "indicator_types": ["malicious-activity"], "pattern_type": "sigma", "pattern": "title: WCE wceaux.dll Access\nid: 1de68c67-af5c-4097-9c85-fe5578e09e67\nstatus: experimental\ndescription: Detects wceaux.dll access while WCE pass-the-hash remote command execution on source host\nauthor: Thomas Patzke\ndate: 2017/06/14\nreferences:\n    - https://www.jpcert.or.jp/english/pub/sr/ir_research.html\n    - https://jpcertcc.github.io/ToolAnalysisResultSheet\ntags:\n    - attack.credential_access\n    - attack.t1003\n    - attack.s0005\nlogsource:\n    product: windows\n    service: security\ndetection:\n    selection:\n        EventID:\n            - 4656\n            - 4658\n            - 4660\n            - 4663\n        ObjectName: '*\\wceaux.dll'\n    condition: selection\nfalsepositives:\n    - Penetration testing\nlevel: critical\n", "object_marking_refs": ["marking-definition--0a872d70-1d05-45dd-a25f-031af547a102"], "created_by_ref": "identity--082ca4f0-d825-45b6-aa42-ab9afd1e5503", "type": "indicator", "spec_version": "2.1", "id": "indicator--a1824e8f-6fca-421a-8756-63e8c41a8ef3", "modified": "2020-04-02T07:59:03.169Z"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--ef3157cd-4cae-4116-b979-60c96c8b5da9", "created": "2020-04-02T07:59:03.180Z", "modified": "2020-04-02T07:59:03.180Z", "source_ref": "indicator--a1824e8f-6fca-421a-8756-63e8c41a8ef3", "relationship_type": "indicates", "target_ref": "attack-pattern--0a3ead4e-6d47-4ccb-854c-a6a4f9d96b22"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--e400cf5a-bce9-48e1-a457-3319888cbff8", "created": "2020-04-02T07:59:03.190Z", "modified": "2020-04-02T07:59:03.190Z", "source_ref": "indicator--a1824e8f-6fca-421a-8756-63e8c41a8ef3", "relationship_type": "indicates", "target_ref": "tool--242f3da3-4425-4d11-8f5c-b842886da966"}, {"name": "Suspicious PsExec Execution", "description": "detects execution of psexec or paexec with renamed service name, this rule helps to filter out the noise if psexec is used for legit purposes or if attacker uses a different psexec client other than sysinternal one", "created": "2019-04-03T00:00:00.000Z", "valid_from": "2019-04-03T00:00:00Z", "indicator_types": ["malicious-activity"], "pattern_type": "sigma", "pattern": "title: Suspicious PsExec Execution\nid: c462f537-a1e3-41a6-b5fc-b2c2cef9bf82\ndescription: detects execution of psexec or paexec with renamed service name, this rule helps to filter out the noise if psexec is used for legit purposes or if attacker\n    uses a different psexec client other than sysinternal one\nauthor: Samir Bousseaden\ndate: 2019/04/03\nreferences:\n    - https://blog.menasec.net/2019/02/threat-hunting-3-detecting-psexec.html\ntags:\n    - attack.lateral_movement\n    - attack.t1077\nlogsource:\n    product: windows\n    service: security\n    description: 'The advanced audit policy setting \"Object Access > Audit Detailed File Share\" must be configured for Success/Failure'\ndetection:\n    selection1:\n        EventID: 5145\n        ShareName: \\\\*\\IPC$\n        RelativeTargetName:\n         - '*-stdin'\n         - '*-stdout'\n         - '*-stderr'\n    selection2:\n        EventID: 5145\n        ShareName: \\\\*\\IPC$\n        RelativeTargetName: 'PSEXESVC*'\n    condition: selection1 and not selection2\nfalsepositives:\n    - nothing observed so far\nlevel: high\n", "object_marking_refs": ["marking-definition--0a872d70-1d05-45dd-a25f-031af547a102"], "created_by_ref": "identity--082ca4f0-d825-45b6-aa42-ab9afd1e5503", "type": "indicator", "spec_version": "2.1", "id": "indicator--5abf5fde-4d0b-4e93-9254-2c3209ad473f", "modified": "2020-04-02T07:59:03.195Z"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--ad58cbe1-702d-44da-867c-c8ac199cae42", "created": "2020-04-02T07:59:03.205Z", "modified": "2020-04-02T07:59:03.205Z", "source_ref": "indicator--5abf5fde-4d0b-4e93-9254-2c3209ad473f", "relationship_type": "indicates", "target_ref": "attack-pattern--ffe742ed-9100-4686-9e00-c331da544787"}, {"name": "Backup Catalog Deleted", "description": "Detects backup catalog deletions", "created": "2017-05-12T00:00:00.000Z", "valid_from": "2017-05-12T00:00:00Z", "indicator_types": ["malicious-activity"], "pattern_type": "sigma", "pattern": "title: Backup Catalog Deleted\nid: 9703792d-fd9a-456d-a672-ff92efe4806a\nstatus: experimental\ndescription: Detects backup catalog deletions\nreferences:\n    - https://technet.microsoft.com/en-us/library/cc742154(v=ws.11).aspx\n    - https://www.hybrid-analysis.com/sample/ed01ebfbc9eb5bbea545af4d01bf5f1071661840480439c6e5babe8e080e41aa?environmentId=100\nauthor: Florian Roth (rule), Tom U. @c_APT_ure (collection)\ndate: 2017/05/12\ntags:\n    - attack.defense_evasion\n    - attack.t1107\nlogsource:\n    product: windows\n    service: application\ndetection:\n    selection:\n        EventID: 524\n        Source: Backup\n    condition: selection\nfalsepositives:\n    - Unknown\nlevel: medium\n", "object_marking_refs": ["marking-definition--0a872d70-1d05-45dd-a25f-031af547a102"], "created_by_ref": "identity--082ca4f0-d825-45b6-aa42-ab9afd1e5503", "type": "indicator", "spec_version": "2.1", "id": "indicator--4f3355d3-177a-4b85-93b8-284944fb3e4e", "modified": "2020-04-02T07:59:03.209Z"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--fa748aa5-b279-435b-bd04-f61c3f6f3c00", "created": "2020-04-02T07:59:03.218Z", "modified": "2020-04-02T07:59:03.218Z", "source_ref": "indicator--4f3355d3-177a-4b85-93b8-284944fb3e4e", "relationship_type": "indicates", "target_ref": "attack-pattern--56fca983-1cf1-4fd1-bda0-5e170a37ab59"}, {"name": "Kerberos Manipulation", "description": "This method triggers on rare Kerberos Failure Codes caused by manipulations of Kerberos messages", "created": "2017-02-10T00:00:00.000Z", "valid_from": "2017-02-10T00:00:00Z", "indicator_types": ["malicious-activity"], "pattern_type": "sigma", "pattern": "title: Kerberos Manipulation\nid: f7644214-0eb0-4ace-9455-331ec4c09253\ndescription: This method triggers on rare Kerberos Failure Codes caused by manipulations of Kerberos messages\nauthor: Florian Roth\ndate: 2017/02/10\ntags:\n    - attack.credential_access\n    - attack.t1212\nlogsource:\n    product: windows\n    service: security\ndetection:\n    selection:\n        EventID:\n          - 675\n          - 4768\n          - 4769\n          - 4771\n        FailureCode:\n          - '0x9'\n          - '0xA'\n          - '0xB'\n          - '0xF'\n          - '0x10'\n          - '0x11'\n          - '0x13'\n          - '0x14'\n          - '0x1A'\n          - '0x1F'\n          - '0x21'\n          - '0x22'\n          - '0x23'\n          - '0x24'\n          - '0x26'\n          - '0x27'\n          - '0x28'\n          - '0x29'\n          - '0x2C'\n          - '0x2D'\n          - '0x2E'\n          - '0x2F'\n          - '0x31'\n          - '0x32'\n          - '0x3E'\n          - '0x3F'\n          - '0x40'\n          - '0x41'\n          - '0x43'\n          - '0x44'\n    condition: selection\nfalsepositives:\n    - Faulty legacy applications\nlevel: high\n", "object_marking_refs": ["marking-definition--0a872d70-1d05-45dd-a25f-031af547a102"], "created_by_ref": "identity--082ca4f0-d825-45b6-aa42-ab9afd1e5503", "type": "indicator", "spec_version": "2.1", "id": "indicator--7ce94cb0-93ff-4767-8ac3-d4d0186b7719", "modified": "2020-04-02T07:59:03.227Z"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--8c5e9792-de06-4444-82d8-cedf76fec1ce", "created": "2020-04-02T07:59:03.237Z", "modified": "2020-04-02T07:59:03.237Z", "source_ref": "indicator--7ce94cb0-93ff-4767-8ac3-d4d0186b7719", "relationship_type": "indicates", "target_ref": "attack-pattern--9c306d8d-cde7-4b4c-b6e8-d0bb16caca36"}, {"name": "Weak Encryption Enabled and Kerberoast", "description": "Detects scenario where weak encryption is enabled for a user profile which could be used for hash/password cracking.", "created": "2017-07-30T00:00:00.000Z", "valid_from": "2017-07-30T00:00:00Z", "indicator_types": ["malicious-activity"], "pattern_type": "sigma", "pattern": "title: Weak Encryption Enabled and Kerberoast\nid: f6de9536-0441-4b3f-a646-f4e00f300ffd\ndescription: Detects scenario where weak encryption is enabled for a user profile which could be used for hash/password cracking.\nreferences:\n    - https://adsecurity.org/?p=2053\n    - https://www.harmj0y.net/blog/activedirectory/roasting-as-reps/\nauthor: '@neu5ron'\ndate: 2017/07/30\ntags:\n    - attack.defense_evasion\n    - attack.t1089\nlogsource:\n    product: windows\n    service: security\n    definition: 'Requirements: Audit Policy : Account Management > Audit User Account Management, Group Policy : Computer Configuration\\Windows Settings\\Security Settings\\Advanced Audit Policy Configuration\\Audit Policies\\Account Management\\Audit User Account Management'\ndetection:\n    selection:\n        EventID: 4738\n    keywords:\n        Message:\n        - '*DES*'\n        - '*Preauth*'\n        - '*Encrypted*'\n    filters:\n        Message:\n            - '*Enabled*'\n    condition: selection and keywords and filters\nfalsepositives:\n    - Unknown\nlevel: high\n", "object_marking_refs": ["marking-definition--0a872d70-1d05-45dd-a25f-031af547a102"], "created_by_ref": "identity--082ca4f0-d825-45b6-aa42-ab9afd1e5503", "type": "indicator", "spec_version": "2.1", "id": "indicator--146e0e25-2889-4ec6-a814-d9bdca1bc18a", "modified": "2020-04-02T07:59:03.242Z"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--611579de-4277-4227-a4ea-aeed39280958", "created": "2020-04-02T07:59:03.253Z", "modified": "2020-04-02T07:59:03.253Z", "source_ref": "indicator--146e0e25-2889-4ec6-a814-d9bdca1bc18a", "relationship_type": "indicates", "target_ref": "attack-pattern--2e0dd10b-676d-4964-acd0-8a404c92b044"}, {"name": "Tap Driver Installation", "description": "Well-known TAP software installation. Possible preparation for data exfiltration using tunnelling techniques", "created": "2019-10-24T00:00:00.000Z", "valid_from": "2019-10-24T00:00:00Z", "indicator_types": ["malicious-activity"], "pattern_type": "sigma", "pattern": "action: global\ntitle: Tap Driver Installation\nid: 8e4cf0e5-aa5d-4dc3-beff-dc26917744a9\ndescription: Well-known TAP software installation. Possible preparation for data exfiltration using tunnelling techniques\nstatus: experimental\nauthor: Daniil Yugoslavskiy, Ian Davis, oscd.community\ndate: 2019/10/24\ntags:\n    - attack.exfiltration\n    - attack.t1048\nfalsepositives:\n    - Legitimate OpenVPN TAP insntallation\nlevel: medium\ndetection:\n    selection:\n        ImagePath|contains: 'tap0901'\n    condition: selection\n", "object_marking_refs": ["marking-definition--0a872d70-1d05-45dd-a25f-031af547a102"], "created_by_ref": "identity--082ca4f0-d825-45b6-aa42-ab9afd1e5503", "type": "indicator", "spec_version": "2.1", "id": "indicator--6501ea28-c3dc-46e2-90cb-51066de2a4e4", "modified": "2020-04-02T07:59:03.256Z"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--ee1bf41d-13dc-4dc2-a88f-de0e480f3f40", "created": "2020-04-02T07:59:03.269Z", "modified": "2020-04-02T07:59:03.269Z", "source_ref": "indicator--6501ea28-c3dc-46e2-90cb-51066de2a4e4", "relationship_type": "indicates", "target_ref": "attack-pattern--a19e86f8-1c0a-4fea-8407-23b73d615776"}, {"name": "Possible Remote Password Change Through SAMR", "description": "Detects a possible remote NTLM hash change through SAMR API SamiChangePasswordUser() or SamSetInformationUser(). \"Audit User Account Management\" in \"Advanced Audit Policy Configuration\" has to be enabled in your local security policy / GPO to see this events.", "created": "2017-06-09T00:00:00.000Z", "valid_from": "2017-06-09T00:00:00Z", "indicator_types": ["malicious-activity"], "pattern_type": "sigma", "pattern": "title: Possible Remote Password Change Through SAMR\nid: 7818b381-5eb1-4641-bea5-ef9e4cfb5951\ndescription: Detects a possible remote NTLM hash change through SAMR API SamiChangePasswordUser() or SamSetInformationUser(). \"Audit User Account Management\" in \"Advanced\n    Audit Policy Configuration\" has to be enabled in your local security policy / GPO to see this events.\nauthor: Dimitrios Slamaris\ndate: 2017/06/09\ntags:\n    - attack.credential_access\n    - attack.t1212\nlogsource:\n    product: windows\n    service: security\ndetection:\n    samrpipe:\n        EventID: 5145\n        RelativeTargetName: samr\n    passwordchanged:\n        EventID: 4738\n    passwordchanged_filter:\n        PasswordLastSet: null\n    timeframe: 15s\n    condition: ( passwordchanged and not passwordchanged_filter ) | near samrpipe\nlevel: medium\n", "object_marking_refs": ["marking-definition--0a872d70-1d05-45dd-a25f-031af547a102"], "created_by_ref": "identity--082ca4f0-d825-45b6-aa42-ab9afd1e5503", "type": "indicator", "spec_version": "2.1", "id": "indicator--6ac4f81e-32f8-4352-aba3-483a08556948", "modified": "2020-04-02T07:59:03.275Z"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--6f30ead0-7b85-413e-a1c6-9d00c7144b5d", "created": "2020-04-02T07:59:03.285Z", "modified": "2020-04-02T07:59:03.285Z", "source_ref": "indicator--6ac4f81e-32f8-4352-aba3-483a08556948", "relationship_type": "indicates", "target_ref": "attack-pattern--9c306d8d-cde7-4b4c-b6e8-d0bb16caca36"}, {"name": "DPAPI Domain Backup Key Extraction", "description": "Detects tools extracting LSA secret DPAPI domain backup key from Domain Controllers", "created": "2019-06-20T00:00:00.000Z", "valid_from": "2019-06-20T00:00:00Z", "indicator_types": ["malicious-activity"], "pattern_type": "sigma", "pattern": "title: DPAPI Domain Backup Key Extraction\nid: 4ac1f50b-3bd0-4968-902d-868b4647937e\ndescription: Detects tools extracting LSA secret DPAPI domain backup key from Domain Controllers\nstatus: experimental\ndate: 2019/06/20\nauthor: Roberto Rodriguez @Cyb3rWard0g\nreferences:\n    - https://github.com/Cyb3rWard0g/ThreatHunter-Playbook/tree/master/playbooks/windows/06_credential_access/T1003_credential_dumping/domain_dpapi_backupkey_extraction.md\ntags:\n    - attack.credential_access\n    - attack.t1003\nlogsource:\n    product: windows\n    service: security\ndetection:\n    selection: \n        EventID: 4662\n        ObjectType: 'SecretObject'\n        AccessMask: '0x2'\n        ObjectName: 'BCKUPKEY'\n    condition: selection\nfalsepositives:\n    - Unknown\nlevel: critical", "object_marking_refs": ["marking-definition--0a872d70-1d05-45dd-a25f-031af547a102"], "created_by_ref": "identity--082ca4f0-d825-45b6-aa42-ab9afd1e5503", "type": "indicator", "spec_version": "2.1", "id": "indicator--713cdeca-144e-4697-863a-b292b386d489", "modified": "2020-04-02T07:59:03.289Z"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--18c2fd59-a007-4323-be90-ddfe86708283", "created": "2020-04-02T07:59:03.300Z", "modified": "2020-04-02T07:59:03.300Z", "source_ref": "indicator--713cdeca-144e-4697-863a-b292b386d489", "relationship_type": "indicates", "target_ref": "attack-pattern--0a3ead4e-6d47-4ccb-854c-a6a4f9d96b22"}, {"name": "RottenPotato Like Attack Pattern", "description": "Detects logon events that have characteristics of events generated during an attack with RottenPotato and the like", "created": "2019-11-15T00:00:00.000Z", "valid_from": "2019-11-15T00:00:00Z", "indicator_types": ["malicious-activity"], "pattern_type": "sigma", "pattern": "title: RottenPotato Like Attack Pattern\nid: 16f5d8ca-44bd-47c8-acbe-6fc95a16c12f\nstatus: experimental\ndescription: Detects logon events that have characteristics of events generated during an attack with RottenPotato and the like\nreferences:\n    - https://twitter.com/SBousseaden/status/1195284233729777665\nauthor: \"@SBousseaden, Florian Roth\"\ndate: 2019/11/15\ntags:\n    - attack.privilege_escalation\n    - attack.credential_access\n    - attack.t1171\nlogsource:\n    product: windows\n    service: security\ndetection:\n    selection:\n        EventID: 4624\n        LogonType: 3\n        TargetUserName: 'ANONYMOUS_LOGON'\n        WorkstationName: '-'\n        SourceNetworkAddress: '127.0.0.1'\n    condition: selection\nfalsepositives:\n    - Unknown\nlevel: high\n", "object_marking_refs": ["marking-definition--0a872d70-1d05-45dd-a25f-031af547a102"], "created_by_ref": "identity--082ca4f0-d825-45b6-aa42-ab9afd1e5503", "type": "indicator", "spec_version": "2.1", "id": "indicator--8d1d749c-836a-4c7b-b149-9b8ba68d4b43", "modified": "2020-04-02T07:59:03.305Z"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--6bdbf527-f4ff-4b9e-bbc2-156c3b181905", "created": "2020-04-02T07:59:03.316Z", "modified": "2020-04-02T07:59:03.316Z", "source_ref": "indicator--8d1d749c-836a-4c7b-b149-9b8ba68d4b43", "relationship_type": "indicates", "target_ref": "attack-pattern--0dbf5f1b-a560-4d51-ac1b-d70caab3e1f0"}, {"name": "First Time Seen Remote Named Pipe", "description": "This detection excludes known namped pipes accessible remotely and notify on newly observed ones, may help to detect lateral movement and remote exec using named pipes", "created": "2019-04-03T00:00:00.000Z", "valid_from": "2019-04-03T00:00:00Z", "indicator_types": ["malicious-activity"], "pattern_type": "sigma", "pattern": "title: First Time Seen Remote Named Pipe\nid: 52d8b0c6-53d6-439a-9e41-52ad442ad9ad\ndescription: This detection excludes known namped pipes accessible remotely and notify on newly observed ones, may help to detect lateral movement and remote exec\n    using named pipes\nauthor: Samir Bousseaden\ndate: 2019/04/03\nreferences:\n    - https://twitter.com/menasec1/status/1104489274387451904\ntags:\n    - attack.lateral_movement\n    - attack.t1077\nlogsource:\n    product: windows\n    service: security\n    description: 'The advanced audit policy setting \"Object Access > Audit Detailed File Share\" must be configured for Success/Failure'\ndetection:\n    selection1:\n        EventID: 5145\n        ShareName: \\\\*\\IPC$\n    selection2:\n        EventID: 5145\n        ShareName: \\\\*\\IPC$\n        RelativeTargetName:\n         - 'atsvc'\n         - 'samr'\n         - 'lsarpc'\n         - 'winreg'\n         - 'netlogon'\n         - 'srvsvc'\n         - 'protected_storage'\n         - 'wkssvc'\n         - 'browser'\n         - 'netdfs'\n         - 'svcctl'\n         - 'spoolss'\n         - 'ntsvcs'\n         - 'LSM_API_service'\n         - 'HydraLsPipe'\n         - 'TermSrv_API_service'\n         - 'MsFteWds'\n    condition: selection1 and not selection2\nfalsepositives:\n    - update the excluded named pipe to filter out any newly observed legit named pipe\nlevel: high\n", "object_marking_refs": ["marking-definition--0a872d70-1d05-45dd-a25f-031af547a102"], "created_by_ref": "identity--082ca4f0-d825-45b6-aa42-ab9afd1e5503", "type": "indicator", "spec_version": "2.1", "id": "indicator--b3bf528c-c4d6-4844-a2a2-ff47e955f5a6", "modified": "2020-04-02T07:59:03.322Z"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--d1438079-9ab0-4de1-8877-17bdd68a6339", "created": "2020-04-02T07:59:03.334Z", "modified": "2020-04-02T07:59:03.334Z", "source_ref": "indicator--b3bf528c-c4d6-4844-a2a2-ff47e955f5a6", "relationship_type": "indicates", "target_ref": "attack-pattern--ffe742ed-9100-4686-9e00-c331da544787"}, {"name": "Login with WMI", "description": "Detection of logins performed with WMI", "created": "2019-12-04T00:00:00.000Z", "valid_from": "2019-12-04T00:00:00Z", "indicator_types": ["malicious-activity"], "pattern_type": "sigma", "pattern": "title: Login with WMI\nid: 5af54681-df95-4c26-854f-2565e13cfab0\nstatus: stable\ndescription: Detection of logins performed with WMI\nauthor: Thomas Patzke\ndate: 2019/12/04\ntags:\n    - attack.execution\n    - attack.t1047\nlogsource:\n    product: windows\n    service: security\ndetection:\n    selection:\n        EventID: 4624\n        ProcessName: \"*\\\\WmiPrvSE.exe\"\n    condition: selection\nfalsepositives:\n    - Monitoring tools\n    - Legitimate system administration\nlevel: low\n", "object_marking_refs": ["marking-definition--0a872d70-1d05-45dd-a25f-031af547a102"], "created_by_ref": "identity--082ca4f0-d825-45b6-aa42-ab9afd1e5503", "type": "indicator", "spec_version": "2.1", "id": "indicator--893e4fa7-2daa-411e-acd2-17384ce4669e", "modified": "2020-04-02T07:59:03.338Z"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--b7148ebf-572e-4f3d-b3cb-110e0769ff9e", "created": "2020-04-02T07:59:03.346Z", "modified": "2020-04-02T07:59:03.346Z", "source_ref": "indicator--893e4fa7-2daa-411e-acd2-17384ce4669e", "relationship_type": "indicates", "target_ref": "attack-pattern--01a5a209-b94c-450b-b7f9-946497d91055"}, {"name": "USB Device Plugged", "description": "Detects plugged USB devices", "created": "2017-11-09T00:00:00.000Z", "valid_from": "2017-11-09T00:00:00Z", "indicator_types": ["malicious-activity"], "pattern_type": "sigma", "pattern": "title: USB Device Plugged\nid: 1a4bd6e3-4c6e-405d-a9a3-53a116e341d4\ndescription: Detects plugged USB devices\nreferences:\n    - https://df-stream.com/2014/01/the-windows-7-event-log-and-usb-device/\n    - https://www.techrepublic.com/article/how-to-track-down-usb-flash-drive-usage-in-windows-10s-event-viewer/\nstatus: experimental\nauthor: Florian Roth\ndate: 2017/11/09\ntags:\n    - attack.initial_access\n    - attack.t1200\nlogsource:\n    product: windows\n    service: driver-framework\ndetection:\n    selection:\n        EventID:\n            - 2003  # Loading drivers\n            - 2100  # Pnp or power management\n            - 2102  # Pnp or power management\n    condition: selection\nfalsepositives:\n    - Legitimate administrative activity\nlevel: low\n", "object_marking_refs": ["marking-definition--0a872d70-1d05-45dd-a25f-031af547a102"], "created_by_ref": "identity--082ca4f0-d825-45b6-aa42-ab9afd1e5503", "type": "indicator", "spec_version": "2.1", "id": "indicator--6ec085e7-f0ce-4abd-9f9c-ff617cff4895", "modified": "2020-04-02T07:59:03.349Z"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--c70871bb-401c-4898-8f0a-0a30be6664c3", "created": "2020-04-02T07:59:03.357Z", "modified": "2020-04-02T07:59:03.357Z", "source_ref": "indicator--6ec085e7-f0ce-4abd-9f9c-ff617cff4895", "relationship_type": "indicates", "target_ref": "attack-pattern--d40239b3-05ff-46d8-9bdd-b46d13463ef9"}, {"name": "Failed Code Integrity Checks", "description": "Code integrity failures may indicate tampered executables.", "created": "2019-12-03T00:00:00.000Z", "valid_from": "2019-12-03T00:00:00Z", "indicator_types": ["malicious-activity"], "pattern_type": "sigma", "pattern": "title: Failed Code Integrity Checks\nid: 470ec5fa-7b4e-4071-b200-4c753100f49b\nstatus: stable\ndescription: Code integrity failures may indicate tampered executables.\nauthor: Thomas Patzke\ndate: 2019/12/03\ntags:\n    - attack.defense_evasion\n    - attack.t1009\nlogsource:\n    product: windows\n    service: security\ndetection:\n    selection:\n        EventID:\n            - 5038\n            - 6281\n    condition: selection\nfalsepositives:\n    - Disk device errors\nlevel: low\n", "object_marking_refs": ["marking-definition--0a872d70-1d05-45dd-a25f-031af547a102"], "created_by_ref": "identity--082ca4f0-d825-45b6-aa42-ab9afd1e5503", "type": "indicator", "spec_version": "2.1", "id": "indicator--d2637178-7bca-462b-af9b-5cf65e4f6b14", "modified": "2020-04-02T07:59:03.360Z"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--58424e65-c15a-45bb-a034-f7401c651059", "created": "2020-04-02T07:59:03.372Z", "modified": "2020-04-02T07:59:03.372Z", "source_ref": "indicator--d2637178-7bca-462b-af9b-5cf65e4f6b14", "relationship_type": "indicates", "target_ref": "attack-pattern--519630c5-f03f-4882-825c-3af924935817"}, {"name": "LSASS Access from Non System Account", "description": "Detects potential mimikatz-like tools accessing LSASS from non system account", "created": "2019-06-20T00:00:00.000Z", "modified": "2019-11-10T00:00:00.000Z", "valid_from": "2019-06-20T00:00:00Z", "indicator_types": ["malicious-activity"], "pattern_type": "sigma", "pattern": "title: LSASS Access from Non System Account\nid: 962fe167-e48d-4fd6-9974-11e5b9a5d6d1\ndescription: Detects potential mimikatz-like tools accessing LSASS from non system account\nstatus: experimental\ndate: 2019/06/20\nmodified: 2019/11/10\nauthor: Roberto Rodriguez @Cyb3rWard0g\nreferences:\n    - https://github.com/Cyb3rWard0g/ThreatHunter-Playbook/tree/master/playbooks/windows/06_credential_access/T1003_credential_dumping/lsass_access_non_system_account.md\ntags:\n    - attack.credential_access\n    - attack.t1003\nlogsource:\n    product: windows\n    service: security\ndetection:\n    selection: \n        EventID:\n            - 4663\n            - 4656\n        ObjectType: 'Process'\n        ObjectName|endswith: '\\lsass.exe'\n    filter:\n        SubjectUserName|endswith: '$'\n    condition: selection and not filter\nfields:\n    - ComputerName\n    - ObjectName\n    - SubjectUserName\n    - ProcessName\nfalsepositives:\n    - Unknown\nlevel: critical\n", "object_marking_refs": ["marking-definition--0a872d70-1d05-45dd-a25f-031af547a102"], "created_by_ref": "identity--082ca4f0-d825-45b6-aa42-ab9afd1e5503", "type": "indicator", "spec_version": "2.1", "id": "indicator--3679c2d6-9c78-46c0-820f-02d924c39c6d"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--38610ffb-a830-4c40-a4d1-22fccb4f615f", "created": "2020-04-02T07:59:03.386Z", "modified": "2020-04-02T07:59:03.386Z", "source_ref": "indicator--3679c2d6-9c78-46c0-820f-02d924c39c6d", "relationship_type": "indicates", "target_ref": "attack-pattern--0a3ead4e-6d47-4ccb-854c-a6a4f9d96b22"}, {"name": "Possible Impacket SecretDump Remote Activity", "description": "Detect AD credential dumping using impacket secretdump HKTL", "created": "2019-04-03T00:00:00.000Z", "valid_from": "2019-04-03T00:00:00Z", "indicator_types": ["malicious-activity"], "pattern_type": "sigma", "pattern": "title: Possible Impacket SecretDump Remote Activity\nid: 252902e3-5830-4cf6-bf21-c22083dfd5cf\ndescription: Detect AD credential dumping using impacket secretdump HKTL\nauthor: Samir Bousseaden\ndate: 2019/04/03\nreferences:\n    - https://blog.menasec.net/2019/02/threat-huting-10-impacketsecretdump.html\ntags:\n    - attack.credential_access\n    - attack.t1003\nlogsource:\n    product: windows\n    service: security\n    description: 'The advanced audit policy setting \"Object Access > Audit Detailed File Share\" must be configured for Success/Failure'\ndetection:\n    selection:\n        EventID: 5145\n        ShareName: \\\\*\\ADMIN$\n        RelativeTargetName: 'SYSTEM32\\\\*.tmp'\n    condition: selection\nfalsepositives:\n    - pentesting\nlevel: high\n", "object_marking_refs": ["marking-definition--0a872d70-1d05-45dd-a25f-031af547a102"], "created_by_ref": "identity--082ca4f0-d825-45b6-aa42-ab9afd1e5503", "type": "indicator", "spec_version": "2.1", "id": "indicator--12adbd6a-f737-4d8f-bdf7-dd069de7e100", "modified": "2020-04-02T07:59:03.390Z"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--5205b37f-f035-4d0e-a447-58148ead4e5e", "created": "2020-04-02T07:59:03.401Z", "modified": "2020-04-02T07:59:03.401Z", "source_ref": "indicator--12adbd6a-f737-4d8f-bdf7-dd069de7e100", "relationship_type": "indicates", "target_ref": "attack-pattern--0a3ead4e-6d47-4ccb-854c-a6a4f9d96b22"}, {"name": "Possible DC Sync", "description": "Detects DC sync via create new SPN", "created": "2019-10-25T00:00:00.000Z", "valid_from": "2019-10-25T00:00:00Z", "indicator_types": ["malicious-activity"], "pattern_type": "sigma", "pattern": "title: Possible DC Sync\nid: 32e19d25-4aed-4860-a55a-be99cb0bf7ed\ndescription: Detects DC sync via create new SPN\nstatus: experimental\nauthor: Ilyas Ochkov, oscd.community\ndate: 2019/10/25\nreferences:\n    - https://github.com/Neo23x0/sigma/blob/ec5bb710499caae6667c7f7311ca9e92c03b9039/rules/windows/builtin/win_dcsync.yml\n    - https://twitter.com/gentilkiwi/status/1003236624925413376\n    - https://gist.github.com/gentilkiwi/dcc132457408cf11ad2061340dcb53c2\n    - https://jsecurity101.com/2019/Syncing-into-the-Shadows/\ntags:\n    - attack.credential_access\n    - attack.t1003\nlogsource:\n    product: windows\n    service: security\ndetection:\n    selection:\n        EventID: 4742\n        ServicePrincipalNames: '*GC/*'\n    condition: selection\nfalsepositives:\n    - Unkown\nlevel: high\n", "object_marking_refs": ["marking-definition--0a872d70-1d05-45dd-a25f-031af547a102"], "created_by_ref": "identity--082ca4f0-d825-45b6-aa42-ab9afd1e5503", "type": "indicator", "spec_version": "2.1", "id": "indicator--e560d1bc-cb91-48c9-8da5-f1c89aee0cb1", "modified": "2020-04-02T07:59:03.405Z"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--54f1035d-f2c9-4b8a-b68f-9ed7f2f663d9", "created": "2020-04-02T07:59:03.417Z", "modified": "2020-04-02T07:59:03.417Z", "source_ref": "indicator--e560d1bc-cb91-48c9-8da5-f1c89aee0cb1", "relationship_type": "indicates", "target_ref": "attack-pattern--0a3ead4e-6d47-4ccb-854c-a6a4f9d96b22"}, {"name": "Turla PNG Dropper Service", "description": "This method detects malicious services mentioned in Turla PNG dropper report by NCC Group in November 2018", "created": "2018-11-23T00:00:00.000Z", "valid_from": "2018-11-23T00:00:00Z", "indicator_types": ["malicious-activity"], "pattern_type": "sigma", "pattern": "title: Turla PNG Dropper Service\nid: 1228f8e2-7e79-4dea-b0ad-c91f1d5016c1\ndescription: This method detects malicious services mentioned in Turla PNG dropper report by NCC Group in November 2018\nreferences:\n    - https://www.nccgroup.trust/uk/about-us/newsroom-and-events/blogs/2018/november/turla-png-dropper-is-back/\nauthor: Florian Roth\ndate: 2018/11/23\ntags:\n    - attack.persistence\n    - attack.g0010\n    - attack.t1050\nlogsource:\n    product: windows\n    service: system\ndetection:\n    selection:\n        EventID: 7045\n        ServiceName: 'WerFaultSvc'\n    condition: selection\nfalsepositives:\n    - unlikely\nlevel: critical\n", "object_marking_refs": ["marking-definition--0a872d70-1d05-45dd-a25f-031af547a102"], "created_by_ref": "identity--082ca4f0-d825-45b6-aa42-ab9afd1e5503", "type": "indicator", "spec_version": "2.1", "id": "indicator--51b61356-2baf-4a60-bb1e-6ef349aac7e7", "modified": "2020-04-02T07:59:03.420Z"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--3da827f3-5ecf-473f-8ffe-4de54ccaa052", "created": "2020-04-02T07:59:03.428Z", "modified": "2020-04-02T07:59:03.428Z", "source_ref": "indicator--51b61356-2baf-4a60-bb1e-6ef349aac7e7", "relationship_type": "indicates", "target_ref": "intrusion-set--7a19ecb1-3c65-4de3-a230-993516aed6a6"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--2296adeb-9d49-4f15-a04a-047877cfeaf2", "created": "2020-04-02T07:59:03.439Z", "modified": "2020-04-02T07:59:03.439Z", "source_ref": "indicator--51b61356-2baf-4a60-bb1e-6ef349aac7e7", "relationship_type": "indicates", "target_ref": "attack-pattern--478aa214-2ca7-4ec0-9978-18798e514790"}, {"name": "Pass the Hash Activity", "description": "Detects the attack technique pass the hash which is used to move laterally inside the network", "created": "2017-03-08T00:00:00.000Z", "valid_from": "2017-03-08T00:00:00Z", "indicator_types": ["malicious-activity"], "pattern_type": "sigma", "pattern": "title: Pass the Hash Activity\nid: f8d98d6c-7a07-4d74-b064-dd4a3c244528\nstatus: experimental\ndescription: Detects the attack technique pass the hash which is used to move laterally inside the network\nreferences:\n    - https://github.com/iadgov/Event-Forwarding-Guidance/tree/master/Events\nauthor: Ilias el Matani (rule), The Information Assurance Directorate at the NSA (method)\ndate: 2017/03/08\ntags:\n    - attack.lateral_movement\n    - attack.t1075\n    - car.2016-04-004\nlogsource:\n    product: windows\n    service: security\n    definition: The successful use of PtH for lateral movement between workstations would trigger event ID 4624, a failed logon attempt would trigger an event ID 4625\ndetection:\n    selection:\n        - EventID: 4624\n          LogonType: '3'\n          LogonProcessName: 'NtLmSsp'\n          WorkstationName: '%Workstations%'\n          ComputerName: '%Workstations%'\n        - EventID: 4625\n          LogonType: '3'\n          LogonProcessName: 'NtLmSsp'\n          WorkstationName: '%Workstations%'\n          ComputerName: '%Workstations%'\n    filter:\n        AccountName: 'ANONYMOUS LOGON'\n    condition: selection and not filter\nfalsepositives:\n    - Administrator activity\n    - Penetration tests\nlevel: medium\n", "object_marking_refs": ["marking-definition--0a872d70-1d05-45dd-a25f-031af547a102"], "created_by_ref": "identity--082ca4f0-d825-45b6-aa42-ab9afd1e5503", "type": "indicator", "spec_version": "2.1", "id": "indicator--dd659494-99eb-49c3-b05e-e0630f81e857", "modified": "2020-04-02T07:59:03.445Z"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--3f4ac1f5-35ac-4ff0-9699-b8ca929df651", "created": "2020-04-02T07:59:03.454Z", "modified": "2020-04-02T07:59:03.454Z", "source_ref": "indicator--dd659494-99eb-49c3-b05e-e0630f81e857", "relationship_type": "indicates", "target_ref": "attack-pattern--c23b740b-a42b-47a1-aec2-9d48ddd547ff"}, {"name": "Active Directory Replication from Non Machine Account", "description": "Detects potential abuse of Active Directory Replication Service (ADRS) from a non machine account to request credentials.", "created": "2019-07-26T00:00:00.000Z", "modified": "2020-03-02T00:00:00.000Z", "valid_from": "2019-07-26T00:00:00Z", "indicator_types": ["malicious-activity"], "pattern_type": "sigma", "pattern": "title: Active Directory Replication from Non Machine Account\nid: 17d619c1-e020-4347-957e-1d1207455c93\ndescription: Detects potential abuse of Active Directory Replication Service (ADRS) from a non machine account to request credentials.\nstatus: experimental\ndate: 2019/07/26\nmodified: 2020/03/02\nauthor: Roberto Rodriguez @Cyb3rWard0g\nreferences:\n    - https://github.com/Cyb3rWard0g/ThreatHunter-Playbook/tree/master/playbooks/windows/06_credential_access/T1003_credential_dumping/ad_replication_non_machine_account.md\ntags:\n    - attack.credential_access\n    - attack.t1003\nlogsource:\n    product: windows\n    service: security\ndetection:\n    selection:\n        EventID: 4662\n        AccessMask: '0x100'\n        Properties|contains:\n            - '1131f6aa-9c07-11d1-f79f-00c04fc2dcd2'\n            - '1131f6ad-9c07-11d1-f79f-00c04fc2dcd2'\n            - '89e95b76-444d-4c62-991a-0facbeda640c'\n    filter:\n        - SubjectUserName|endswith: '$'\n        - SubjectUserName|startswith: 'MSOL_' #https://docs.microsoft.com/en-us/azure/active-directory/hybrid/reference-connect-accounts-permissions#ad-ds-connector-account\n    condition: selection and not filter\nfields:\n    - ComputerName\n    - SubjectDomainName\n    - SubjectUserName\nfalsepositives:\n    - Unknown\nlevel: critical\n", "object_marking_refs": ["marking-definition--0a872d70-1d05-45dd-a25f-031af547a102"], "created_by_ref": "identity--082ca4f0-d825-45b6-aa42-ab9afd1e5503", "type": "indicator", "spec_version": "2.1", "id": "indicator--c5b0ee32-fc19-4a15-9f1f-720073c8bd91"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--00036b6b-b070-49dd-b5bd-eb4eb3b53309", "created": "2020-04-02T07:59:03.470Z", "modified": "2020-04-02T07:59:03.470Z", "source_ref": "indicator--c5b0ee32-fc19-4a15-9f1f-720073c8bd91", "relationship_type": "indicates", "target_ref": "attack-pattern--0a3ead4e-6d47-4ccb-854c-a6a4f9d96b22"}, {"name": "Access to ADMIN$ Share", "description": "Detects access to $ADMIN share", "created": "2017-03-04T00:00:00.000Z", "valid_from": "2017-03-04T00:00:00Z", "indicator_types": ["malicious-activity"], "pattern_type": "sigma", "pattern": "title: Access to ADMIN$ Share\nid: 098d7118-55bc-4912-a836-dc6483a8d150\ndescription: Detects access to $ADMIN share\ntags:\n    - attack.lateral_movement\n    - attack.t1077\nstatus: experimental\nauthor: Florian Roth\ndate: 2017/03/04\nlogsource:\n    product: windows\n    service: security\n    definition: 'The advanced audit policy setting \"Object Access > Audit File Share\" must be configured for Success/Failure'\ndetection:\n    selection:\n        EventID: 5140\n        ShareName: Admin$\n    filter:\n        SubjectUserName: '*$'\n    condition: selection and not filter\nfalsepositives:\n    - Legitimate administrative activity\nlevel: low\n", "object_marking_refs": ["marking-definition--0a872d70-1d05-45dd-a25f-031af547a102"], "created_by_ref": "identity--082ca4f0-d825-45b6-aa42-ab9afd1e5503", "type": "indicator", "spec_version": "2.1", "id": "indicator--2d6b9b06-7dd4-4106-96ef-68238c68bd1c", "modified": "2020-04-02T07:59:03.474Z"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--00d0e0d4-a5a2-44a8-9bdb-75f3318b4a7e", "created": "2020-04-02T07:59:03.484Z", "modified": "2020-04-02T07:59:03.484Z", "source_ref": "indicator--2d6b9b06-7dd4-4106-96ef-68238c68bd1c", "relationship_type": "indicates", "target_ref": "attack-pattern--ffe742ed-9100-4686-9e00-c331da544787"}, {"name": "User Added to Local Administrators", "description": "This rule triggers on user accounts that are added to the local Administrators group, which could be legitimate activity or a sign of privilege escalation activity", "created": "2017-03-14T00:00:00.000Z", "valid_from": "2017-03-14T00:00:00Z", "indicator_types": ["malicious-activity"], "pattern_type": "sigma", "pattern": "title: User Added to Local Administrators\nid: c265cf08-3f99-46c1-8d59-328247057d57\ndescription: This rule triggers on user accounts that are added to the local Administrators group, which could be legitimate activity or a sign of privilege escalation\n    activity\nstatus: stable\nauthor: Florian Roth\ndate: 2017/03/14\ntags:\n    - attack.privilege_escalation\n    - attack.t1078\nlogsource:\n    product: windows\n    service: security\ndetection:\n    selection:\n        EventID: 4732\n    selection_group1:\n        GroupName: 'Administrators'\n    selection_group2:\n        GroupSid: 'S-1-5-32-544'\n    filter:\n        SubjectUserName: '*$'\n    condition: selection and (1 of selection_group*) and not filter\nfalsepositives:\n    - Legitimate administrative activity\nlevel: medium\n", "object_marking_refs": ["marking-definition--0a872d70-1d05-45dd-a25f-031af547a102"], "created_by_ref": "identity--082ca4f0-d825-45b6-aa42-ab9afd1e5503", "type": "indicator", "spec_version": "2.1", "id": "indicator--75226d70-b8f0-4e23-a017-16670926e87c", "modified": "2020-04-02T07:59:03.488Z"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--935641d4-0cda-4fcb-9e97-cd295f1d5f3f", "created": "2020-04-02T07:59:03.498Z", "modified": "2020-04-02T07:59:03.498Z", "source_ref": "indicator--75226d70-b8f0-4e23-a017-16670926e87c", "relationship_type": "indicates", "target_ref": "attack-pattern--b17a1a56-e99c-403c-8948-561df0cffe81"}, {"name": "Generic Password Dumper Activity on LSASS", "description": "Detects process handle on LSASS process with certain access mask", "created": "2019-11-01T00:00:00.000Z", "modified": "2019-11-07T00:00:00.000Z", "valid_from": "2019-11-01T00:00:00Z", "indicator_types": ["malicious-activity"], "pattern_type": "sigma", "pattern": "title: Generic Password Dumper Activity on LSASS\nid: 4a1b6da0-d94f-4fc3-98fc-2d9cb9e5ee76\ndescription: Detects process handle on LSASS process with certain access mask\nstatus: experimental\nauthor: Roberto Rodriguez, Teymur Kheirkhabarov, Dimitrios Slamaris, Mark Russinovich, Aleksey Potapov, oscd.community (update)\ndate: 2019/11/01\nmodified: 2019/11/07\nreferences:\n    - https://cyberwardog.blogspot.com/2017/03/chronicles-of-threat-hunter-hunting-for_22.html\n    - https://www.slideshare.net/heirhabarov/hunting-for-credentials-dumping-in-windows-environment\ntags:\n    - attack.credential_access\n    - attack.t1003\n    - car.2019-04-004\nlogsource:\n    product: windows\n    service: security\ndetection:\n    selection_1:\n        EventID: 4656\n        ObjectName|endswith: '\\lsass.exe'\n        AccessMask|contains:\n            - '0x40'\n            - '0x1400'\n            - '0x1000'\n            - '0x100000'\n            - '0x1410'    # car.2019-04-004\n            - '0x1010'    # car.2019-04-004\n            - '0x1438'    # car.2019-04-004\n            - '0x143a'    # car.2019-04-004\n            - '0x1418'    # car.2019-04-004\n            - '0x1f0fff'\n            - '0x1f1fff'\n            - '0x1f2fff'\n            - '0x1f3fff'\n    selection_2:\n        EventID: 4663\n        ObjectName|endswith: '\\lsass.exe'\n        AccessList|contains:\n            - '4484'\n            - '4416'\n    filter:\n        ProcessName|endswith: \n            - '\\wmiprvse.exe'\n            - '\\taskmgr.exe'\n            - '\\procexp64.exe'\n            - '\\procexp.exe'\n            - '\\lsm.exe'\n            - '\\csrss.exe'\n            - '\\wininit.exe'\n            - '\\vmtoolsd.exe'\n    condition: selection_1 or selection_2 and not filter\nfields:\n    - ComputerName\n    - SubjectDomainName\n    - SubjectUserName\n    - ProcessName\n    - ProcessID\nfalsepositives:\n    - Legitimate software accessing LSASS process for legitimate reason; update the whitelist with it\nlevel: high\n", "object_marking_refs": ["marking-definition--0a872d70-1d05-45dd-a25f-031af547a102"], "created_by_ref": "identity--082ca4f0-d825-45b6-aa42-ab9afd1e5503", "type": "indicator", "spec_version": "2.1", "id": "indicator--c1505c22-6dcf-46a6-ad9f-75677ea27e88"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--b60a27e9-677f-4a18-832a-ec9d070eada9", "created": "2020-04-02T07:59:03.511Z", "modified": "2020-04-02T07:59:03.511Z", "source_ref": "indicator--c1505c22-6dcf-46a6-ad9f-75677ea27e88", "relationship_type": "indicates", "target_ref": "attack-pattern--0a3ead4e-6d47-4ccb-854c-a6a4f9d96b22"}, {"name": "Password Dumper Activity on LSASS", "description": "Detects process handle on LSASS process with certain access mask and object type SAM_DOMAIN", "created": "2017-02-12T00:00:00.000Z", "valid_from": "2017-02-12T00:00:00Z", "indicator_types": ["malicious-activity"], "pattern_type": "sigma", "pattern": "title: Password Dumper Activity on LSASS\nid: aa1697b7-d611-4f9a-9cb2-5125b4ccfd5c\ndescription: Detects process handle on LSASS process with certain access mask and object type SAM_DOMAIN\nstatus: experimental\ndate: 2017/02/12\nreferences:\n    - https://twitter.com/jackcr/status/807385668833968128\ntags:\n    - attack.credential_access\n    - attack.t1003\nlogsource:\n    product: windows\n    service: security\ndetection:\n    selection:\n        EventID: 4656\n        ProcessName: 'C:\\Windows\\System32\\lsass.exe'\n        AccessMask: '0x705'\n        ObjectType: 'SAM_DOMAIN'\n    condition: selection\nfalsepositives:\n    - Unkown\nlevel: high\n", "object_marking_refs": ["marking-definition--0a872d70-1d05-45dd-a25f-031af547a102"], "created_by_ref": "identity--082ca4f0-d825-45b6-aa42-ab9afd1e5503", "type": "indicator", "spec_version": "2.1", "id": "indicator--249f96ce-b7b4-476c-8dc2-3490250a968f", "modified": "2020-04-02T07:59:03.515Z"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--e4bdb0ce-4d02-48f8-815a-e92ef385bce9", "created": "2020-04-02T07:59:03.524Z", "modified": "2020-04-02T07:59:03.524Z", "source_ref": "indicator--249f96ce-b7b4-476c-8dc2-3490250a968f", "relationship_type": "indicates", "target_ref": "attack-pattern--0a3ead4e-6d47-4ccb-854c-a6a4f9d96b22"}, {"name": "RDP over Reverse SSH Tunnel WFP", "description": "Detects svchost hosting RDP termsvcs communicating with the loopback address", "created": "2019-02-16T00:00:00.000Z", "valid_from": "2019-02-16T00:00:00Z", "indicator_types": ["malicious-activity"], "pattern_type": "sigma", "pattern": "title: RDP over Reverse SSH Tunnel WFP\nid: 5bed80b6-b3e8-428e-a3ae-d3c757589e41\nstatus: experimental\ndescription: Detects svchost hosting RDP termsvcs communicating with the loopback address\nreferences:\n    - https://twitter.com/SBousseaden/status/1096148422984384514\n    - https://github.com/sbousseaden/EVTX-ATTACK-SAMPLES/blob/master/Command%20and%20Control/DE_RDP_Tunnel_5156.evtx\nauthor: Samir Bousseaden\ndate: 2019/02/16\ntags:\n    - attack.defense_evasion\n    - attack.command_and_control\n    - attack.lateral_movement\n    - attack.t1076\n    - attack.t1090\n    - car.2013-07-002\nlogsource:\n    product: windows\n    service: security\ndetection:\n    selection:\n        EventID: 5156\n    sourceRDP:\n        SourcePort: 3389\n        DestinationAddress:\n            - '127.*'\n            - '::1'\n    destinationRDP:\n        DestinationPort: 3389\n        SourceAddress:\n            - '127.*'\n            - '::1'\n    condition: selection and ( sourceRDP or destinationRDP )\nfalsepositives:\n    - unknown\nlevel: high\n", "object_marking_refs": ["marking-definition--0a872d70-1d05-45dd-a25f-031af547a102"], "created_by_ref": "identity--082ca4f0-d825-45b6-aa42-ab9afd1e5503", "type": "indicator", "spec_version": "2.1", "id": "indicator--02baf023-7060-44ed-bb90-2d047f34219d", "modified": "2020-04-02T07:59:03.528Z"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--a08ec0cc-d602-4978-abb3-a56ce9b9a943", "created": "2020-04-02T07:59:03.538Z", "modified": "2020-04-02T07:59:03.538Z", "source_ref": "indicator--02baf023-7060-44ed-bb90-2d047f34219d", "relationship_type": "indicates", "target_ref": "attack-pattern--51dea151-0898-4a45-967c-3ebee0420484"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--6970a720-53d2-4ca2-9277-e598e25fe1de", "created": "2020-04-02T07:59:03.545Z", "modified": "2020-04-02T07:59:03.545Z", "source_ref": "indicator--02baf023-7060-44ed-bb90-2d047f34219d", "relationship_type": "indicates", "target_ref": "attack-pattern--731f4f55-b6d0-41d1-a7a9-072a66389aea"}, {"name": "AD User Enumeration", "description": "Detects access to a domain user from a non-machine account", "created": "2020-03-30T00:00:00.000Z", "valid_from": "2020-03-30T00:00:00Z", "indicator_types": ["malicious-activity"], "pattern_type": "sigma", "pattern": "title: AD User Enumeration\nid: ab6bffca-beff-4baa-af11-6733f296d57a\ndescription: Detects access to a domain user from a non-machine account\nstatus: experimental\ndate: 2020/03/30\nauthor: Maxime Thiebaut (@0xThiebaut)\nreferences:\n    - https://www.specterops.io/assets/resources/an_ace_up_the_sleeve.pdf\n    - http://www.stuffithoughtiknew.com/2019/02/detecting-bloodhound.html\n    - https://docs.microsoft.com/en-us/windows/win32/adschema/attributes-all # For further investigation of the accessed properties\ntags:\n    - attack.discovery\n    - attack.t1087\nlogsource:\n    product: windows\n    service: security\n    definition: Requires the \"Read all properties\" permission on the user object to be audited for the \"Everyone\" principal\ndetection:\n    selection:\n        EventID: 4662\n        ObjectType|contains: # Using contains as the data commonly is structured as \"%{bf967aba-0de6-11d0-a285-00aa003049e2}\"\n            - 'bf967aba-0de6-11d0-a285-00aa003049e2' # The user class (https://docs.microsoft.com/en-us/windows/win32/adschema/c-user)\n    filter:\n        - SubjectUserName|endswith: '$' # Exclude machine accounts\n        - SubjectUserName|startswith: 'MSOL_' # https://docs.microsoft.com/en-us/azure/active-directory/hybrid/reference-connect-accounts-permissions#ad-ds-connector-account\n    condition: selection and not filter\nfalsepositives:\n    - Administrators configuring new users.\nlevel: medium\n", "object_marking_refs": ["marking-definition--0a872d70-1d05-45dd-a25f-031af547a102"], "created_by_ref": "identity--082ca4f0-d825-45b6-aa42-ab9afd1e5503", "type": "indicator", "spec_version": "2.1", "id": "indicator--c98636d5-3508-4d39-b404-d2da04fce507", "modified": "2020-04-02T07:59:03.550Z"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--6d57e8ad-751a-4fab-9051-eab6c923cec5", "created": "2020-04-02T07:59:03.560Z", "modified": "2020-04-02T07:59:03.560Z", "source_ref": "indicator--c98636d5-3508-4d39-b404-d2da04fce507", "relationship_type": "indicates", "target_ref": "attack-pattern--72b74d71-8169-42aa-92e0-e7b04b9f5a08"}, {"name": "Remote Task Creation via ATSVC Named Pipe", "description": "Detects remote task creation via at.exe or API interacting with ATSVC namedpipe", "created": "2019-04-03T00:00:00.000Z", "valid_from": "2019-04-03T00:00:00Z", "indicator_types": ["malicious-activity"], "pattern_type": "sigma", "pattern": "title: Remote Task Creation via ATSVC Named Pipe\nid: f6de6525-4509-495a-8a82-1f8b0ed73a00\ndescription: Detects remote task creation via at.exe or API interacting with ATSVC namedpipe\nauthor: Samir Bousseaden\ndate: 2019/04/03\nreferences:\n    - https://blog.menasec.net/2019/03/threat-hunting-25-scheduled-tasks-for.html\ntags:\n    - attack.lateral_movement\n    - attack.persistence\n    - attack.t1053\n    - car.2013-05-004\n    - car.2015-04-001\nlogsource:\n    product: windows\n    service: security\n    description: 'The advanced audit policy setting \"Object Access > Audit Detailed File Share\" must be configured for Success/Failure'\ndetection:\n    selection:\n        EventID: 5145\n        ShareName: \\\\*\\IPC$\n        RelativeTargetName: atsvc\n        Accesses: '*WriteData*'\n    condition: selection\nfalsepositives:\n    - pentesting\nlevel: medium\n", "object_marking_refs": ["marking-definition--0a872d70-1d05-45dd-a25f-031af547a102"], "created_by_ref": "identity--082ca4f0-d825-45b6-aa42-ab9afd1e5503", "type": "indicator", "spec_version": "2.1", "id": "indicator--77a69b69-f9ad-4c72-95c3-5d731272b61f", "modified": "2020-04-02T07:59:03.563Z"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--e8b2b8c4-2205-45a7-838e-fd89414880a0", "created": "2020-04-02T07:59:03.573Z", "modified": "2020-04-02T07:59:03.573Z", "source_ref": "indicator--77a69b69-f9ad-4c72-95c3-5d731272b61f", "relationship_type": "indicates", "target_ref": "attack-pattern--35dd844a-b219-4e2b-a6bb-efa9a75995a9"}, {"name": "Scanner PoC for CVE-2019-0708 RDP RCE Vuln", "description": "Detects the use of a scanner by zerosum0x0 that discovers targets vulnerable to  CVE-2019-0708 RDP RCE aka BlueKeep", "created": "2019-06-02T00:00:00.000Z", "valid_from": "2019-06-02T00:00:00Z", "indicator_types": ["malicious-activity"], "pattern_type": "sigma", "pattern": "title: Scanner PoC for CVE-2019-0708 RDP RCE Vuln\nid: 8400629e-79a9-4737-b387-5db940ab2367\ndescription: Detects the use of a scanner by zerosum0x0 that discovers targets vulnerable to  CVE-2019-0708 RDP RCE aka BlueKeep\nreferences:\n    - https://twitter.com/AdamTheAnalyst/status/1134394070045003776\n    - https://github.com/zerosum0x0/CVE-2019-0708\ntags:\n    - attack.lateral_movement\n    - attack.t1210\n    - car.2013-07-002\nauthor: Florian Roth (rule), Adam Bradbury (idea)\ndate: 2019/06/02\nlogsource:\n    product: windows\n    service: security\ndetection:\n    selection:\n        EventID: 4625\n        AccountName: AAAAAAA\n    condition: selection\nfalsepositives:\n    - Unlikely\nlevel: critical\n", "object_marking_refs": ["marking-definition--0a872d70-1d05-45dd-a25f-031af547a102"], "created_by_ref": "identity--082ca4f0-d825-45b6-aa42-ab9afd1e5503", "type": "indicator", "spec_version": "2.1", "id": "indicator--7fd71fba-185d-4bdf-bc27-b89df849e206", "modified": "2020-04-02T07:59:03.576Z"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--27454ae1-d2d8-463f-a286-e66656ca3860", "created": "2020-04-02T07:59:03.584Z", "modified": "2020-04-02T07:59:03.584Z", "source_ref": "indicator--7fd71fba-185d-4bdf-bc27-b89df849e206", "relationship_type": "indicates", "target_ref": "attack-pattern--9db0cf3a-a3c9-4012-8268-123b9db6fd82"}, {"name": "User Couldn't Call a Privileged Service 'LsaRegisterLogonProcess'", "description": "The 'LsaRegisterLogonProcess' function verifies that the application making the function call is a logon process by checking that it has the SeTcbPrivilege privilege set. Possible Rubeus tries to get a handle to LSA.", "created": "2019-10-24T00:00:00.000Z", "valid_from": "2019-10-24T00:00:00Z", "indicator_types": ["malicious-activity"], "pattern_type": "sigma", "pattern": "title: User Couldn't Call a Privileged Service 'LsaRegisterLogonProcess'\nid: 6daac7fc-77d1-449a-a71a-e6b4d59a0e54\ndescription: The 'LsaRegisterLogonProcess' function verifies that the application making the function call is a logon process by checking that it has the SeTcbPrivilege\n    privilege set. Possible Rubeus tries to get a handle to LSA.\nstatus: experimental\nreferences:\n    - https://posts.specterops.io/hunting-in-active-directory-unconstrained-delegation-forests-trusts-71f2b33688e1\ntags:\n    - attack.lateral_movement\n    - attack.privilege_escalation\n    - attack.t1208\nauthor: Roberto Rodriguez (source), Ilyas Ochkov (rule), oscd.community\ndate: 2019/10/24\nlogsource:\n    product: windows\n    service: security\ndetection:\n    selection:\n        - EventID: 4673\n          Service: 'LsaRegisterLogonProcess()'\n          Keywords: '0x8010000000000000'   #failure\n    condition: selection\nfalsepositives:\n    - Unkown\nlevel: high\n", "object_marking_refs": ["marking-definition--0a872d70-1d05-45dd-a25f-031af547a102"], "created_by_ref": "identity--082ca4f0-d825-45b6-aa42-ab9afd1e5503", "type": "indicator", "spec_version": "2.1", "id": "indicator--1f8d732b-8945-4e4a-be8e-76eb7ca0ff5f", "modified": "2020-04-02T07:59:03.588Z"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--6ccf6380-91f9-4a67-9798-4125fab44772", "created": "2020-04-02T07:59:03.596Z", "modified": "2020-04-02T07:59:03.596Z", "source_ref": "indicator--1f8d732b-8945-4e4a-be8e-76eb7ca0ff5f", "relationship_type": "indicates", "target_ref": "attack-pattern--b39d03cb-7b98-41c4-a878-c40c1a913dc0"}, {"name": "LSASS Access Detected via Attack Surface Reduction", "description": "Detects Access to LSASS Process", "created": "2018-08-26T00:00:00.000Z", "valid_from": "2018-08-26T00:00:00Z", "indicator_types": ["malicious-activity"], "pattern_type": "sigma", "pattern": "title: LSASS Access Detected via Attack Surface Reduction\nid: a0a278fe-2c0e-4de2-ac3c-c68b08a9ba98\ndescription: Detects Access to LSASS Process\nstatus: experimental\nreferences:\n    - https://docs.microsoft.com/en-us/windows/security/threat-protection/windows-defender-exploit-guard/attack-surface-reduction-exploit-guard?WT.mc_id=twitter\nauthor: Markus Neis\ndate: 2018/08/26\ntags:\n    - attack.credential_access\n    - attack.t1003\n# Defender Attack Surface Reduction\nlogsource:\n    product: windows_defender\n    definition: 'Requirements:Enabled Block credential stealing from the Windows local security authority subsystem (lsass.exe) from Attack Surface Reduction (GUID: 9e6c4e1f-7d60-472f-ba1a-a39ef669e4b2)'\ndetection:\n    selection:\n        EventID: 1121\n        Path: '*\\lsass.exe'\n    condition: selection\nfalsepositives:\n    - Google Chrome GoogleUpdate.exe\n    - Some Taskmgr.exe related activity\nlevel: high\n", "object_marking_refs": ["marking-definition--0a872d70-1d05-45dd-a25f-031af547a102"], "created_by_ref": "identity--082ca4f0-d825-45b6-aa42-ab9afd1e5503", "type": "indicator", "spec_version": "2.1", "id": "indicator--54224760-d2f7-4abb-8d41-bfa6ee9b70ba", "modified": "2020-04-02T07:59:03.600Z"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--064df894-73f5-4bde-b5e3-33c5e44c45e5", "created": "2020-04-02T07:59:03.609Z", "modified": "2020-04-02T07:59:03.609Z", "source_ref": "indicator--54224760-d2f7-4abb-8d41-bfa6ee9b70ba", "relationship_type": "indicates", "target_ref": "attack-pattern--0a3ead4e-6d47-4ccb-854c-a6a4f9d96b22"}, {"name": "CVE-2020-0688 Exploitation via Eventlog", "description": "Detects the exploitation of Microsoft Exchange vulnerability as described in CVE-2020-0688", "created": "2020-02-29T00:00:00.000Z", "valid_from": "2020-02-29T00:00:00Z", "indicator_types": ["malicious-activity"], "pattern_type": "sigma", "pattern": "title: CVE-2020-0688 Exploitation via Eventlog\nid: d6266bf5-935e-4661-b477-78772735a7cb\nstatus: experimental\ndescription: Detects the exploitation of Microsoft Exchange vulnerability as described in CVE-2020-0688 \nreferences:\n    - https://www.trustedsec.com/blog/detecting-cve-20200688-remote-code-execution-vulnerability-on-microsoft-exchange-server/\nauthor: Florian Roth\ndate: 2020/02/29\ntags:\n    - attack.initial_access\n    - attack.t1190\nlogsource:\n    product: windows\n    service: application\ndetection:\n    selection1:\n        EventID: 4\n        Source: MSExchange Control Panel\n        Level: Error\n    selection2:\n        - '*&__VIEWSTATE=*'\n    condition: selection1 and selection2\nfalsepositives:\n    - Unknown\nlevel: high\n", "object_marking_refs": ["marking-definition--0a872d70-1d05-45dd-a25f-031af547a102"], "created_by_ref": "identity--082ca4f0-d825-45b6-aa42-ab9afd1e5503", "type": "indicator", "spec_version": "2.1", "id": "indicator--a90b0cd2-ae8e-4972-b454-51ea012e7e65", "modified": "2020-04-02T07:59:03.612Z"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--5e08e788-9c5f-496d-b136-1d1d10af7593", "created": "2020-04-02T07:59:03.622Z", "modified": "2020-04-02T07:59:03.622Z", "source_ref": "indicator--a90b0cd2-ae8e-4972-b454-51ea012e7e65", "relationship_type": "indicates", "target_ref": "attack-pattern--3f886f2a-874f-4333-b794-aa6075009b1c"}, {"name": "Failed Logins with Different Accounts from Single Source System", "description": "Detects suspicious failed logins with different user accounts from a single source system", "created": "2017-01-10T00:00:00.000Z", "valid_from": "2017-01-10T00:00:00Z", "indicator_types": ["malicious-activity"], "pattern_type": "sigma", "pattern": "title: Failed Logins with Different Accounts from Single Source System\nid: e98374a6-e2d9-4076-9b5c-11bdb2569995\ndescription: Detects suspicious failed logins with different user accounts from a single source system\nauthor: Florian Roth\ndate: 2017/01/10\ntags:\n    - attack.persistence\n    - attack.privilege_escalation\n    - attack.t1078\nlogsource:\n    product: windows\n    service: security\ndetection:\n    selection1:\n        EventID:\n            - 529\n            - 4625\n        UserName: '*'\n        WorkstationName: '*'\n    selection2:\n        EventID: 4776\n        UserName: '*'\n        Workstation: '*'\n    timeframe: 24h\n    condition:\n        - selection1 | count(UserName) by WorkstationName > 3\n        - selection2 | count(UserName) by Workstation > 3\nfalsepositives:\n    - Terminal servers\n    - Jump servers\n    - Other multiuser systems like Citrix server farms\n    - Workstations with frequently changing users\nlevel: medium\n", "object_marking_refs": ["marking-definition--0a872d70-1d05-45dd-a25f-031af547a102"], "created_by_ref": "identity--082ca4f0-d825-45b6-aa42-ab9afd1e5503", "type": "indicator", "spec_version": "2.1", "id": "indicator--062c1346-edcc-4a45-add0-82c9b0f41ccb", "modified": "2020-04-02T07:59:03.626Z"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--32224704-57ec-4739-97f1-9aa283ca115c", "created": "2020-04-02T07:59:03.632Z", "modified": "2020-04-02T07:59:03.632Z", "source_ref": "indicator--062c1346-edcc-4a45-add0-82c9b0f41ccb", "relationship_type": "indicates", "target_ref": "attack-pattern--b17a1a56-e99c-403c-8948-561df0cffe81"}, {"name": "Mimikatz Detection LSASS Access", "description": "Detects process access to LSASS which is typical for Mimikatz (0x1000 PROCESS_QUERY_ LIMITED_INFORMATION, 0x0400 PROCESS_QUERY_ INFORMATION \"only old versions\", 0x0010 PROCESS_VM_READ)", "created": "2017-10-18T00:00:00.000Z", "valid_from": "2017-10-18T00:00:00Z", "indicator_types": ["malicious-activity"], "pattern_type": "sigma", "pattern": "title: Mimikatz Detection LSASS Access\nid: 0d894093-71bc-43c3-8c4d-ecfc28dcf5d9\nstatus: experimental\ndescription: Detects process access to LSASS which is typical for Mimikatz (0x1000 PROCESS_QUERY_ LIMITED_INFORMATION, 0x0400 PROCESS_QUERY_ INFORMATION \"only old\n    versions\", 0x0010 PROCESS_VM_READ)\nreferences:\n    - https://onedrive.live.com/view.aspx?resid=D026B4699190F1E6!2843&ithint=file%2cpptx&app=PowerPoint&authkey=!AMvCRTKB_V1J5ow\n    - https://cyberwardog.blogspot.com/2017/03/chronicles-of-threat-hunter-hunting-for_22.html\ntags:\n    - attack.t1003\n    - attack.s0002\n    - attack.credential_access\n    - car.2019-04-004\nauthor: Sherif Eldeeb\ndate: 2017/10/18\nlogsource:\n    product: windows\n    service: sysmon\ndetection:\n    selection:\n        EventID: 10\n        TargetImage: 'C:\\windows\\system32\\lsass.exe'\n        GrantedAccess:\n            - '0x1410'\n            - '0x1010'\n    condition: selection\nfields:\n    - ComputerName\n    - User\n    - SourceImage\nfalsepositives:\n    - Some security products access LSASS in this way.\nlevel: high\n", "object_marking_refs": ["marking-definition--0a872d70-1d05-45dd-a25f-031af547a102"], "created_by_ref": "identity--082ca4f0-d825-45b6-aa42-ab9afd1e5503", "type": "indicator", "spec_version": "2.1", "id": "indicator--bd232177-cd13-4f1b-af9e-cc2158c7879a", "modified": "2020-04-02T07:59:03.637Z"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--4b9a2b69-cc7f-4d69-947c-c0fdfa765d2d", "created": "2020-04-02T07:59:03.647Z", "modified": "2020-04-02T07:59:03.647Z", "source_ref": "indicator--bd232177-cd13-4f1b-af9e-cc2158c7879a", "relationship_type": "indicates", "target_ref": "attack-pattern--0a3ead4e-6d47-4ccb-854c-a6a4f9d96b22"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--be8c366c-26ff-4973-9d54-e582a1479b6e", "created": "2020-04-02T07:59:03.654Z", "modified": "2020-04-02T07:59:03.654Z", "source_ref": "indicator--bd232177-cd13-4f1b-af9e-cc2158c7879a", "relationship_type": "indicates", "target_ref": "tool--afc079f3-c0ea-4096-b75d-3f05338b7f60"}, {"name": "Activity Related to NTDS.dit Domain Hash Retrieval", "description": "Detects suspicious commands that could be related to activity that uses volume shadow copy to steal and retrieve hashes from the NTDS.dit file remotely", "created": "2019-01-16T00:00:00.000Z", "valid_from": "2019-01-16T00:00:00Z", "indicator_types": ["malicious-activity"], "pattern_type": "sigma", "pattern": "title: Activity Related to NTDS.dit Domain Hash Retrieval\nid: b932b60f-fdda-4d53-8eda-a170c1d97bbd\nstatus: experimental\ndescription: Detects suspicious commands that could be related to activity that uses volume shadow copy to steal and retrieve hashes from the NTDS.dit file remotely\nauthor: Florian Roth, Michael Haag\ndate: 2019/01/16\nreferences:\n    - https://www.swordshield.com/2015/07/getting-hashes-from-ntds-dit-file/\n    - https://room362.com/post/2013/2013-06-10-volume-shadow-copy-ntdsdit-domain-hashes-remotely-part-1/\n    - https://www.trustwave.com/Resources/SpiderLabs-Blog/Tutorial-for-NTDS-goodness-(VSSADMIN,-WMIS,-NTDS-dit,-SYSTEM)/\n    - https://securingtomorrow.mcafee.com/mcafee-labs/new-teslacrypt-ransomware-arrives-via-spam/\n    - https://dfironthemountain.wordpress.com/2018/12/06/locked-file-access-using-esentutl-exe/\ntags:\n    - attack.credential_access\n    - attack.t1003\nlogsource:\n    category: process_creation\n    product: windows\ndetection:\n    selection:\n        CommandLine:\n            - vssadmin.exe Delete Shadows\n            - 'vssadmin create shadow /for=C:'\n            - copy \\\\?\\GLOBALROOT\\Device\\\\*\\windows\\ntds\\ntds.dit\n            - copy \\\\?\\GLOBALROOT\\Device\\\\*\\config\\SAM\n            - 'vssadmin delete shadows /for=C:'\n            - 'reg SAVE HKLM\\SYSTEM '\n            - esentutl.exe /y /vss *\\ntds.dit*\n            - esentutl.exe /y /vss *\\SAM\n            - esentutl.exe /y /vss *\\SYSTEM\n    condition: selection\nfields:\n    - CommandLine\n    - ParentCommandLine\nfalsepositives:\n    - Administrative activity\nlevel: high\n", "object_marking_refs": ["marking-definition--0a872d70-1d05-45dd-a25f-031af547a102"], "created_by_ref": "identity--082ca4f0-d825-45b6-aa42-ab9afd1e5503", "type": "indicator", "spec_version": "2.1", "id": "indicator--d4d8105c-2e56-4e85-beba-df8351350435", "modified": "2020-04-02T07:59:03.659Z"}, {"type": "relationship", "spec_version": "2.1", "id": "relationship--ca9924df-c3bc-41e8-a127-703be1569ad9", "created": "2020-04-02T07:59:03.669Z", "modified": "2020-04-02T07:59:03.669Z", "source_ref": "indicator--d4d8105c-2e56-4e85-beba-df8351350435", "relationship_type": "indicates", "target_ref": "attack-pattern--0a3ead4e-6d47-4ccb-854c-a6a4f9d96b22"}], "type": "bundle", "id": "bundle--a8af896e-429b-418b-987e-f751ad7ebd8d"}