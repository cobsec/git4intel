{
    "title": "incident",
    "description": "Mission Control specific structure for security incidents, consisting of multiple phases.",
    "type": "array",
    "contains": [
        {
            "title": "grouping--incident",
            "description": "Meta-object that represents the declaration of an incident context",
            "type": "object",
            "properties": {
                "type": {
                    "type": "string",
                    "const": "grouping"
                },
                "context": {
                    "type": "string",
                    "const": "incident"
                },
                "created_by_ref": {
                    "type": "string",
                    "pattern": "^identity--"
                }
            }
        },
        {
                "title": "attack-pattern--incident",
                "description": "Uses the STIX 2.1 attack pattern object for the master incident object",
                "type": "object",
                "properties": {
                    "report_type": {
                        "type": "string",
                        "const": "incident_report",
                        "required": true
                    },
                    "created_by_ref": {
                        "type": "string",
                        "pattern": "^identity--",
                        "required": true
                    },
                    "x_eiq_priority": {
                        "type": "string",
                        "required": true
                    },
                    "x_eiq_assigned_to": {
                        "type": "string",
                        "pattern": "^identity--",
                        "required": false
                    },
                }
        },
        {
            "title": "identity--user",
            "description": "Identity object that must indicate the individual user that created this incident.",
            "type": "object",
            "properties": {
                "type": {
                    "type": "string",
                    "description": "The type of this object, which MUST be the literal `identity`.",
                    "const": "identity"
                },
                "identity_class": {
                    "type": "string",
                    "description": "Individual or system that created this incident",
                    "enum": [
                        "individual",
                        "system"
                    ]
                }
            }
        },
        {
            "title": "identity--organization",
            "description": "Identity object that must indicate the target organization of this incident.",
            "type": "object",
            "properties": {
                "type": {
                    "type": "string",
                    "description": "The type of this object, which MUST be the literal `identity`.",
                    "const": "identity"
                },
                "identity_class": {
                    "type": "string",
                    "description": "The type of entity that this Identity describes, e.g., an individual or organization. Open Vocab - identity-class-ov",
                    "enum": [
                        "organization"
                    ]
                }
            }
        },
        {
            "title": "relationship--targets",
            "description": "Relationship linking attack pattern and target organization.",
            "type": "object",
            "properties": {
                "relationship_type": {
                    "type": "string",
                    "description": "Must be targets.",
                    "const": "targets"
                },
                "source_ref": {
                    "type": "string",
                    "pattern": "^attack-pattern--",
                    "required": true
                },
                "target_ref": {
                    "type": "string",
                    "pattern": "^identity--",
                    "required": true
                }
            }
        }

    ]
}